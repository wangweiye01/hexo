{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":0,"renderable":1},{"_id":"themes/next/source/images/1.jpg","path":"images/1.jpg","modified":0,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","path":"lib/algolia-instant-search/instantsearch.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","path":"lib/canvas-ribbon/canvas-ribbon.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/LICENSE","path":"lib/fastclick/LICENSE","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/README.md","path":"lib/fastclick/README.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/bower.json","path":"lib/fastclick/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","path":"lib/jquery_lazyload/CONTRIBUTING.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","path":"lib/jquery_lazyload/README.md","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","path":"lib/jquery_lazyload/jquery.lazyload.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","path":"lib/jquery_lazyload/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","path":"lib/jquery_lazyload/jquery.scrollstop.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","path":"lib/needsharebutton/needsharebutton.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","path":"lib/needsharebutton/font-embedded.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","path":"lib/needsharebutton/needsharebutton.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","path":"lib/pace/pace-theme-barber-shop.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","path":"lib/pace/pace-theme-big-counter.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","path":"lib/pace/pace-theme-center-atom.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","path":"lib/pace/pace-theme-bounce.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","path":"lib/pace/pace-theme-center-circle.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","path":"lib/pace/pace-theme-center-simple.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","path":"lib/pace/pace-theme-center-radar.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","path":"lib/pace/pace-theme-corner-indicator.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","path":"lib/pace/pace-theme-fill-left.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","path":"lib/pace/pace-theme-flash.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","path":"lib/pace/pace-theme-mac-osx.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","path":"lib/pace/pace-theme-loading-bar.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","path":"lib/pace/pace-theme-minimal.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","path":"lib/three/canvas_lines.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/pace/pace.min.js","path":"lib/pace/pace.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","path":"lib/three/canvas_sphere.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/three-waves.min.js","path":"lib/three/three-waves.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/bower.json","path":"lib/velocity/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.css","path":"lib/Han/dist/han.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.js","path":"lib/Han/dist/han.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","path":"lib/fancybox/source/blank.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","path":"lib/fancybox/source/fancybox_loading.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","path":"lib/fancybox/source/fancybox_loading@2x.gif","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","path":"lib/fancybox/source/fancybox_overlay.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","path":"lib/fancybox/source/fancybox_sprite.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","path":"lib/fancybox/source/fancybox_sprite@2x.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","path":"lib/fastclick/lib/fastclick.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","path":"lib/fastclick/lib/fastclick.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.css","path":"lib/Han/dist/han.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","path":"lib/Han/dist/font/han-space.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","path":"lib/Han/dist/font/han-space.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","path":"lib/Han/dist/font/han.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","path":"lib/Han/dist/font/han.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","path":"lib/Han/dist/font/han.woff2","modified":0,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.js","path":"lib/Han/dist/han.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","path":"lib/fancybox/source/helpers/fancybox_buttons.png","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","path":"lib/fancybox/source/helpers/jquery.fancybox-media.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","path":"lib/algolia-instant-search/instantsearch.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/three/three.min.js","path":"lib/three/three.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":0,"renderable":1}],"Cache":[{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1577152857560},{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1577152857560},{"_id":"themes/next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1577152857560},{"_id":"themes/next/.javascript_ignore","hash":"8a224b381155f10e6eb132a4d815c5b52962a9d1","modified":1577152857560},{"_id":"themes/next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1577152857560},{"_id":"themes/next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1577152857570},{"_id":"themes/next/.travis.yml","hash":"d60d4a5375fea23d53b2156b764a99b2e56fa660","modified":1577152857570},{"_id":"themes/next/LICENSE","hash":"f293bcfcdc06c0b77ba13570bb8af55eb5c059fd","modified":1577152857570},{"_id":"themes/next/README.cn.md","hash":"02713071ef9e260b3fe77f4403942189d55a00e9","modified":1577152857570},{"_id":"themes/next/README.md","hash":"529d53dfa97678f8ce4c95620b26e61154162a29","modified":1577152857570},{"_id":"themes/next/_config.yml","hash":"efadfa340c18b775bc37b3915fb47a845184167f","modified":1577152857570},{"_id":"themes/next/bower.json","hash":"6d6ae7531cf3fedc97c58cdad664f5793eb3cc88","modified":1577152857570},{"_id":"themes/next/gulpfile.coffee","hash":"031bffc483e417b20e90eceb6cf358e7596d2e69","modified":1577152857570},{"_id":"themes/next/package.json","hash":"93a74dbc0fe3a1208a02e9cec3c15c2375339cc1","modified":1577152857990},{"_id":"source/_posts/CentOS.md","hash":"507670b3b194610da02184eb8adaab43c24382e0","modified":1577152857330},{"_id":"source/_posts/access-log.md","hash":"1e8ee1213102150087c76902a9c162b623cc6b41","modified":1577152857330},{"_id":"source/_posts/access-token.md","hash":"50da66fe62a75341ae098d097b7646fbc8a31b27","modified":1577152857330},{"_id":"source/_posts/activemq.md","hash":"85ad544f6af1ada65a898da357102a6eb46bcc5b","modified":1577152857340},{"_id":"source/_posts/blockchain.md","hash":"0dc10213409f0a6d7b5f5f2e0d7f954f898cdbc1","modified":1577152857340},{"_id":"source/_posts/cache-db.md","hash":"bf66e25dd739e9a63740365c17adb943dd9ab0b1","modified":1577152857340},{"_id":"source/_posts/defent.md","hash":"62c4c9161d0ebb171ed530430b7f670bc6e69a6c","modified":1577152857340},{"_id":"source/_posts/delay-queue.md","hash":"990493b18c65997bd95e363ec493701d329d95eb","modified":1577152857340},{"_id":"source/_posts/distribute-lock.md","hash":"07677a919d70a6490d49bcff693b1fcf765f4eb9","modified":1577152857340},{"_id":"source/_posts/docker.md","hash":"bf6ca07486b765c4ede26d8e78297a33aae16acc","modified":1577152857340},{"_id":"source/_posts/floyd.md","hash":"10ee0c319dfd9b5097df7f11885a04c0c64b39fe","modified":1585039183470},{"_id":"source/_posts/git-remote.md","hash":"c4f0c39e118450e896afedfd82498fab6156a83a","modified":1577152857350},{"_id":"source/_posts/hello-world.md","hash":"7360d8ef93dc6f83cb013dce795171e173b3562e","modified":1577152857350},{"_id":"source/_posts/jasypt.md","hash":"0beab655ec6ac80b2d17b1aca97a2948c6937d36","modified":1577152857350},{"_id":"source/_posts/java-pack-unpack.md","hash":"bb2b58ac22c8a23bd29b94b324cb49bcf39b5fc6","modified":1577152857350},{"_id":"source/_posts/java-thread.md","hash":"65a469b94f609a385f2d30b8d7a98667684933f3","modified":1577152857350},{"_id":"source/_posts/java.md","hash":"4d3e0f3ef72ebe64e9ba3eade105df6ab7d34b34","modified":1577152857360},{"_id":"source/_posts/jenkins.md","hash":"f5ee84c51c9f7ad480b809478d298aa0aaec5ac5","modified":1577152857360},{"_id":"source/_posts/linux-safe.md","hash":"ab41bd3b9336bfe5baae0e542fc896428280de92","modified":1577152857360},{"_id":"source/_posts/mac-git.md","hash":"2a517ef626773677305c91bd22bf17bfa36ee31a","modified":1577152857360},{"_id":"source/_posts/master-slave.md","hash":"c41e9522c769c03c1f26e7cdae18e550861e36b1","modified":1577152857440},{"_id":"source/_posts/maven.md","hash":"d6b028d8fab6c2af704cf7ce25c7b263ac414b0c","modified":1577152857440},{"_id":"source/_posts/mybatis.md","hash":"8cc7fad76a1f352ed114979860b416ca037ea3ab","modified":1577152857440},{"_id":"source/_posts/mysql-back.md","hash":"d23238dda8ccaa7f073ca388c261f8c6d62ca40b","modified":1577152857440},{"_id":"source/_posts/mysql-linux.md","hash":"7fbed91eee4767493356d2a6347337ca88d56908","modified":1577152857450},{"_id":"source/_posts/mysql-out.md","hash":"c7d086186cfa42e6f66f71c6e5f071e45f081e7f","modified":1577152857450},{"_id":"source/_posts/nginx-cores.md","hash":"9a6893783b95049686b91a1b02942b46695dcbb8","modified":1577152857450},{"_id":"source/_posts/nginx-strategy.md","hash":"86fe5475b98280454d1786a645f3d531802c06e2","modified":1577152857450},{"_id":"source/_posts/nohup.md","hash":"7d7a3dc0a74ce074bacdb93ba248fd40bb7252ec","modified":1577152857450},{"_id":"source/_posts/observer.md","hash":"b9a12d1a19cc86226d3a80ee6ca7a962b436497d","modified":1577152857450},{"_id":"source/_posts/pattern-template.md","hash":"5ceacd068b80cf2ed692f6ba96b9ef033fe269cd","modified":1577152857450},{"_id":"source/_posts/promise-to-refreshtoken.md","hash":"cc9c6de312a8ad3369e8f23a63674cf468e61c74","modified":1577153699890},{"_id":"source/_posts/ratelimit.md","hash":"e1f5fc4e6b9272547ff607f5878899a4a7dbabe7","modified":1593745731740},{"_id":"source/_posts/round.md","hash":"a35ac472452e6e247e20793c3c1b1f885eeb7d8f","modified":1577152857450},{"_id":"source/_posts/scan-notify.md","hash":"05fe603f3c66b1fc1a3abf6291dc5b01488ce76c","modified":1602295921870},{"_id":"source/_posts/sequence.md","hash":"eb82a4586cc805d62566adc09d3947203eaa2f3f","modified":1577152857450},{"_id":"source/_posts/shadowsocks.md","hash":"ac543cd3c09b1cb88fa28acf984867111bd8fd42","modified":1577152857460},{"_id":"source/_posts/singleton.md","hash":"71a1ee72002277836d0213c60f93b653c39328fe","modified":1577152857460},{"_id":"source/_posts/snow-flake.md","hash":"41957c15f941ac661d5318361bfa8da29bc167d2","modified":1577152857460},{"_id":"source/_posts/socket.md","hash":"b36769c6c704ed2e77adefb41292c79b4d356415","modified":1577152857460},{"_id":"source/_posts/spring-boot-active.md","hash":"e0eefdaa43918923b81d823430299c848d8ffa03","modified":1577152857460},{"_id":"source/_posts/spring-boot-tomcat.md","hash":"8c768f2d754db8f07f8743da5fcf4f134afd7a61","modified":1577152857460},{"_id":"source/_posts/spring-cloud-eureka.md","hash":"adcf5338e234935e7b94e2c21b993cd19974b468","modified":1577152857460},{"_id":"source/_posts/spring-cloud10.md","hash":"1c327b8a508a2141787ce77513a6be6047009481","modified":1577152857460},{"_id":"source/_posts/spring-cloud2.md","hash":"50bf21131f94064e2e78a1a23dec9d69bec82ec6","modified":1577152857460},{"_id":"source/_posts/spring-cloud3.md","hash":"072f0307ebd556fd74784729bc4ff61a3eb4cf0c","modified":1577152857460},{"_id":"source/_posts/spring-cloud4.md","hash":"1afead7fdd2465563f1f48159e4d3e76b8c9cffe","modified":1577152857460},{"_id":"source/_posts/spring-cloud5.md","hash":"36856564e30ce85bc501f71e2a3d3188a95f33f7","modified":1577152857460},{"_id":"source/_posts/spring-cloud6.md","hash":"56b90c2cb55f79038ef4a590ae5b6063925d3d2c","modified":1577152857470},{"_id":"source/_posts/spring-cloud7.md","hash":"837d84515eb776ff4703d53d6b0d044bbf7bc243","modified":1577152857470},{"_id":"source/_posts/spring-cloud8.md","hash":"066e81023f0cf6b75fdd0d814d6ee9ee1533a96a","modified":1577152857470},{"_id":"source/_posts/spring-cloud9.md","hash":"fe7a17540045b89cb14fcaa0c5dc54cb7de39cb5","modified":1577152857470},{"_id":"source/_posts/ssh-broken.md","hash":"7a3fb3621ccc85888644c8801ef3f1e87e7c71bf","modified":1577152857470},{"_id":"source/_posts/ssh-no-pass.md","hash":"45818f282488a5c4b6ee5d5677b8a151cc6bd8a8","modified":1577152857470},{"_id":"source/_posts/ssh.md","hash":"00da3630d8f8a2aafdba55109058b6e272f324dd","modified":1577152857470},{"_id":"source/_posts/throttle.md","hash":"ef60f3b714e489eeb51568e001c56ff63d9f4f4e","modified":1577152857470},{"_id":"source/_posts/ubuntu_firefox.md","hash":"b8eda6edb04759efe5a3247ce662a6376073d5b4","modified":1577152857470},{"_id":"source/_posts/websocket.md","hash":"278e4db6d00465efa8ac4ca02218f7a1842efbd7","modified":1577152857480},{"_id":"source/categories/index.md","hash":"2401c8197faa03a41038f5d9fda5152fd76a8662","modified":1577152857480},{"_id":"themes/next/languages/de.yml","hash":"057e7df11ddeb1c8c15a5d7c5ff29430d725ec6b","modified":1577152857570},{"_id":"themes/next/languages/default.yml","hash":"44ef3f26917f467459326c2c8be2f73e4d947f35","modified":1577152857570},{"_id":"themes/next/languages/en.yml","hash":"7e680d9bb8f3a3a9d1ba1c9d312b3d257183dded","modified":1577152857580},{"_id":"themes/next/languages/fr-FR.yml","hash":"7e4eb7011b8feee641cfb11c6e73180b0ded1c0f","modified":1577152857580},{"_id":"themes/next/languages/id.yml","hash":"b5de1ea66dd9ef54cac9a1440eaa4e3f5fc011f5","modified":1577152857580},{"_id":"themes/next/languages/it.yml","hash":"aa595f2bda029f73ef7bfa104b4c55c3f4e9fb4c","modified":1577152857580},{"_id":"themes/next/languages/ja.yml","hash":"3c76e16fd19b262864475faa6854b718bc08c4d8","modified":1577152857580},{"_id":"themes/next/languages/ko.yml","hash":"ea5b46056e73ebcee121d5551627af35cbffc900","modified":1577152857580},{"_id":"themes/next/languages/nl-NL.yml","hash":"edca4f3598857dbc3cbf19ed412213329b6edd47","modified":1577152857580},{"_id":"themes/next/languages/pt-BR.yml","hash":"b1694ae766ed90277bcc4daca4b1cfa19cdcb72b","modified":1577152857580},{"_id":"themes/next/languages/pt.yml","hash":"44b61f2d085b827b507909a0b8f8ce31c6ef5d04","modified":1577152857580},{"_id":"themes/next/languages/ru.yml","hash":"98ec6f0b7183282e11cffc7ff586ceb82400dd75","modified":1577152857590},{"_id":"themes/next/languages/zh-Hans.yml","hash":"16ef56d0dea94638de7d200984c90ae56f26b4fe","modified":1577152857590},{"_id":"themes/next/languages/zh-hk.yml","hash":"9396f41ae76e4fef99b257c93c7354e661f6e0fa","modified":1577152857590},{"_id":"themes/next/languages/zh-tw.yml","hash":"50b71abb3ecc0686f9739e179e2f829cd074ecd9","modified":1577152857590},{"_id":"themes/next/layout/_layout.swig","hash":"da0929166674ea637e0ad454f85ad0d7bac4aff2","modified":1577152857590},{"_id":"themes/next/layout/archive.swig","hash":"f0a8225feafd971419837cdb4bcfec98a4a59b2f","modified":1577152857990},{"_id":"themes/next/layout/category.swig","hash":"4472255f4a3e3dd6d79201523a9526dcabdfbf18","modified":1577152857990},{"_id":"themes/next/layout/index.swig","hash":"783611349c941848a0e26ee2f1dc44dd14879bd1","modified":1577152857990},{"_id":"themes/next/layout/page.swig","hash":"969caaee05bdea725e99016eb63d810893a73e99","modified":1577152857990},{"_id":"themes/next/scripts/merge-configs.js","hash":"cb617ddf692f56e6b6129564d52e302f50b28243","modified":1577152857990},{"_id":"themes/next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1577152858000},{"_id":"themes/next/layout/post.swig","hash":"b3589a8e46288a10d20e41c7a5985d2493725aec","modified":1577152857990},{"_id":"themes/next/layout/schedule.swig","hash":"d86f8de4e118f8c4d778b285c140474084a271db","modified":1577152857990},{"_id":"themes/next/layout/tag.swig","hash":"7e0a7d7d832883eddb1297483ad22c184e4368de","modified":1577152857990},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1577152859810},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1577152859810},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1577152859810},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1577152858650},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1577152857590},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1577152857590},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"31322a7f57936cf2dc62e824af5490da5354cf02","modified":1577152857590},{"_id":"themes/next/layout/_macro/post-copyright.swig","hash":"665a928604f99d2ba7dc4a4a9150178229568cc6","modified":1577152857590},{"_id":"themes/next/layout/_macro/post.swig","hash":"446a35a2cd389f8cfc3aa38973a9b44ad0740134","modified":1577152857600},{"_id":"themes/next/layout/_macro/reward.swig","hash":"56e8d8556cf474c56ae1bef9cb7bbd26554adb07","modified":1577152857600},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"9efc455894921a66bbc074055d3b39c8a34a48a4","modified":1577152857600},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"39852700e4084ecccffa6d4669168e5cc0514c9e","modified":1577152857700},{"_id":"themes/next/layout/_partials/comments.swig","hash":"4a6f5b1792b2e5262b7fdab9a716b3108e2f09c7","modified":1577152857700},{"_id":"themes/next/layout/_partials/footer.swig","hash":"c4d6181f5d3db5365e622f78714af8cc58d7a45e","modified":1577152857700},{"_id":"themes/next/layout/_partials/head.swig","hash":"6b94fe8f3279daea5623c49ef4bb35917ba57510","modified":1577152857700},{"_id":"themes/next/layout/_partials/header.swig","hash":"ed042be6252848058c90109236ec988e392d91d4","modified":1577152857710},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"1efd925d34a5d4ba2dc0838d9c86ba911e705fc9","modified":1577152857710},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1577152857710},{"_id":"themes/next/layout/_partials/search.swig","hash":"9dbd378e94abfcb3f864a5b8dbbf18d212ca2ee0","modified":1577152857710},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1577152857720},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1577152857720},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"a266f96ad06ee87bdeae6e105a4b53cd587bbd04","modified":1577152857720},{"_id":"themes/next/layout/_third-party/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1577152857970},{"_id":"themes/next/layout/_third-party/mathjax.swig","hash":"6d25596d6a7c57700d37b607f8d9a62d89708683","modified":1577152857980},{"_id":"themes/next/layout/_third-party/exturl.swig","hash":"7c04a42319d728be356746363aff8ea247791d24","modified":1577152857970},{"_id":"themes/next/layout/_third-party/needsharebutton.swig","hash":"5fe0447cc88a5a63b530cf0426f93c4634811876","modified":1577152857980},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"fc93b1a7e6aed0dddb1f3910142b48d8ab61174e","modified":1577152857980},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"22369026c87fc23893c35a7f250b42f3bb1b60f1","modified":1577152857980},{"_id":"themes/next/layout/_third-party/scroll-cookie.swig","hash":"1ddb2336a1a19b47af3017047012c01ec5f54529","modified":1577152857980},{"_id":"themes/next/scripts/tags/button.js","hash":"d023f10a00077f47082b0517e2ad666e6e994f60","modified":1577152858000},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1577152858000},{"_id":"themes/next/scripts/tags/exturl.js","hash":"8d7e60f60779bde050d20fd76f6fdc36fc85e06d","modified":1577152858000},{"_id":"themes/next/scripts/tags/full-image.js","hash":"8eeb3fb89540299bdbb799edfdfdac3743b50596","modified":1577152858000},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1577152858000},{"_id":"themes/next/scripts/tags/label.js","hash":"2f8f41a7316372f0d1ed6b51190dc4acd3e16fff","modified":1577152858150},{"_id":"themes/next/scripts/tags/lazy-image.js","hash":"eeeabede68cf263de9e6593ecf682f620da16f0a","modified":1577152858150},{"_id":"themes/next/scripts/tags/note.js","hash":"64de4e9d01cf3b491ffc7d53afdf148ee5ad9779","modified":1577152858150},{"_id":"themes/next/scripts/tags/tabs.js","hash":"5786545d51c38e8ca38d1bfc7dd9e946fc70a316","modified":1577152858150},{"_id":"themes/next/source/css/main.styl","hash":"20702c48d6053c92c5bcdbc68e8d0ef1369848a0","modified":1577152858650},{"_id":"themes/next/source/images/1.jpg","hash":"fad9b4e8e2c4ffa3faca4cc5e05410ccf7b1b3e1","modified":1577152858650},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1577152858650},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1577152858650},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1577152858650},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1577152858650},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1577152858650},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1577152858650},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1577152858650},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1577152858660},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1577152858980},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1577152858660},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1577152858980},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1577152858980},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1577152858980},{"_id":"themes/next/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1577152858980},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1577152858980},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1577152858980},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1577152858980},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1577152858980},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1577152857720},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1577152857720},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1577152858620},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1577152858620},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1577152858620},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1577152858640},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1577152858640},{"_id":"themes/next/layout/_partials/head/custom-head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1577152857710},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1577152857710},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1577152857710},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1577152857710},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1577152857710},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1577152857720},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"048fd5e98149469f8c28c21ba3561a7a67952c9b","modified":1577152857720},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1577152857720},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1577152857710},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1577152857720},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1577152857720},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1577152857720},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"98df9d72e37dd071e882f2d5623c9d817815b139","modified":1577152857730},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"60426bf73f8a89ba61fb1be2df3ad5398e32c4ef","modified":1577152857730},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"deda6a814ed48debc694c4e0c466f06c127163d0","modified":1577152857730},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"18e7bef8923d83ea42df6c97405e515a876cede4","modified":1577152857730},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1577152857730},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"a234c5cd1f75ca5731e814d0dbb92fdcf9240d1b","modified":1577152857730},{"_id":"themes/next/layout/_third-party/analytics/firestore.swig","hash":"1cd01c6e92ab1913d48e556a92bb4f28b6dc4996","modified":1577152857730},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"5d9943d74cc2e0a91badcf4f755c6de77eab193a","modified":1577152857730},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"5e9bb24c750b49513d9a65799e832f07410002ac","modified":1577152857730},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"fc65b9c98a0a8ab43a5e7aabff6c5f03838e09c8","modified":1577152857730},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1577152857740},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"0ddc94ed4ba0c19627765fdf1abc4d8efbe53d5a","modified":1577152857740},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"c3971fd154d781088e1cc665035f8561a4098f4c","modified":1577152857740},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"0e3378f7c39b2b0f69638290873ede6b6b6825c0","modified":1577152857960},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"c316758546dc9ba6c60cb4d852c17ca6bb6d6724","modified":1577152857960},{"_id":"themes/next/layout/_third-party/comments/duoshuo.swig","hash":"a356b2185d40914447fde817eb3d358ab6b3e4c3","modified":1577152857960},{"_id":"themes/next/layout/_third-party/comments/gitment.swig","hash":"10160daceaa6f1ecf632323d422ebe2caae49ddf","modified":1577152857970},{"_id":"themes/next/layout/_third-party/comments/hypercomments.swig","hash":"3e8dc5c6c912628a37e3b5f886bec7b2e5ed14ea","modified":1577152857970},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"aa0629277d751c55c6d973e7691bf84af9b17a60","modified":1577152857970},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"8a2e393d2e49f7bf560766d8a07cd461bf3fce4f","modified":1577152857970},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"fcabbb241f894c9a6309c44e126cf3e8fea81fd4","modified":1577152857970},{"_id":"themes/next/layout/_third-party/comments/youyan.swig","hash":"8b6650f77fe0a824c8075b2659e0403e0c78a705","modified":1577152857970},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"c747fb5c6b1f500e8f0c583e44195878b66e4e29","modified":1577152857980},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"385c066af96bee30be2459dbec8aae1f15d382f5","modified":1577152857980},{"_id":"themes/next/layout/_third-party/search/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1577152857990},{"_id":"themes/next/layout/_third-party/seo/baidu-push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1577152857990},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1577152858620},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"2aa5b7166a85a8aa34b17792ae4f58a5a96df6cc","modified":1577152858620},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"9ab65361ba0a12a986edd103e56492644c2db0b8","modified":1577152858620},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"82f9055955920ed88a2ab6a20ab02169abb2c634","modified":1577152858620},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"99fbb4686ea9a3e03a4726ed7cf4d8f529034452","modified":1577152858640},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"be087dcc060e8179f7e7f60ab4feb65817bd3d9f","modified":1577152858640},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"f29165e36489a87ba32d17dddfd2720d84e3f3ec","modified":1577152858640},{"_id":"themes/next/source/css/_variables/base.styl","hash":"29c261fa6b4046322559074d75239c6b272fb8a3","modified":1577152858640},{"_id":"themes/next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1577152858990},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1577152858990},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"034bc8113e0966fe2096ba5b56061bbf10ef0512","modified":1577152858990},{"_id":"themes/next/source/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1577152858990},{"_id":"themes/next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1577152858990},{"_id":"themes/next/source/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1577152858990},{"_id":"themes/next/source/js/src/motion.js","hash":"754b294394f102c8fd9423a1789ddb1201677898","modified":1577152858990},{"_id":"themes/next/source/js/src/post-details.js","hash":"a13f45f7aa8291cf7244ec5ba93907d119c5dbdd","modified":1577152858990},{"_id":"themes/next/source/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1577152858990},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1577152859000},{"_id":"themes/next/source/js/src/utils.js","hash":"dbdc3d1300eec7da9632608ebc0e5b697779dad7","modified":1577152859000},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1577152859010},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1577152859230},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","hash":"ff5915eb2596e890a2fc6697c864f861a1995ec0","modified":1577152859230},{"_id":"themes/next/source/lib/fancybox/.bower.json","hash":"cc40a9b11e52348e554c84e4a5c058056f6b7aeb","modified":1577152859240},{"_id":"themes/next/source/lib/fancybox/.gitattributes","hash":"2db21acfbd457452462f71cc4048a943ee61b8e0","modified":1577152859240},{"_id":"themes/next/source/lib/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1577152859250},{"_id":"themes/next/source/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1577152859250},{"_id":"themes/next/source/lib/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1577152859260},{"_id":"themes/next/source/lib/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1577152859260},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1577152859260},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1577152859260},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1577152859260},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1577152859260},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1577152859260},{"_id":"themes/next/source/lib/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1577152859540},{"_id":"themes/next/source/lib/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1577152859540},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1577152859540},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1577152859540},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1577152859540},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1577152859540},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1577152859550},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","hash":"3ef0020a1815ca6151ea4886cd0d37421ae3695c","modified":1577152859550},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","hash":"c39d37278c1e178838732af21bd26cd0baeddfe0","modified":1577152859550},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","hash":"9885fd9bea5e7ebafc5b1de9d17be5e106248d96","modified":1577152859550},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1577152859550},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1577152859550},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1577152859550},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1577152859550},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1577152859550},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1577152859560},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1577152859560},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1577152859670},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1577152859670},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1577152859670},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1577152859670},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1577152859670},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1577152859670},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1577152859680},{"_id":"themes/next/source/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1577152859680},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1577152859680},{"_id":"themes/next/source/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1577152859680},{"_id":"themes/next/source/lib/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1577152859700},{"_id":"themes/next/source/lib/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1577152859700},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1577152859810},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1577152859800},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1577152859810},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1577152859540},{"_id":"themes/next/layout/_third-party/search/algolia-search/assets.swig","hash":"28ff4ed6714c59124569ffcbd10f1173d53ca923","modified":1577152857980},{"_id":"themes/next/layout/_third-party/search/algolia-search/dom.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1577152857980},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"7e509c7c28c59f905b847304dd3d14d94b6f3b8e","modified":1577152858160},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"4719ce717962663c5c33ef97b1119a0b3a4ecdc3","modified":1577152858160},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"31050fc7a25784805b4843550151c93bfa55c9c8","modified":1577152858160},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"a6bb5256be6195e76addbda12f4ed7c662d65e7a","modified":1577152858160},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1577152858160},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"c5d48863f332ff8ce7c88dec2c893f709d7331d3","modified":1577152858180},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1577152858420},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"9c25c75311e1bd4d68df031d3f2ae6d141a90766","modified":1577152858450},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"f7c44b0ee46cf2cf82a4c9455ba8d8b55299976f","modified":1577152858450},{"_id":"themes/next/source/css/_common/scaffolding/mobile.styl","hash":"47a46583a1f3731157a3f53f80ed1ed5e2753e8e","modified":1577152858450},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1577152858450},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1577152858450},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"a280a583b7615e939aaddbf778f5c108ef8a2a6c","modified":1577152858450},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"64f5d56c08d74a338813df1265580ca0cbf0190b","modified":1577152858620},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"18c3336ee3d09bd2da6a876e1336539f03d5a973","modified":1577152858620},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1577152858630},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1577152858630},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1577152858630},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1577152858630},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"3b25edfa187d1bbbd0d38b50dd013cef54758abf","modified":1577152858630},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1577152858630},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"9a5581a770af8964064fef7afd3e16963e45547f","modified":1577152858630},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1577152858630},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1577152858630},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"02fb8fa6b6c252b6bed469539cd057716606a787","modified":1577152858630},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1577152858630},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1577152858640},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"c4ed249798296f60bda02351fe6404fb3ef2126f","modified":1577152858640},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"5b93958239d3d2bf9aeaede44eced2434d784462","modified":1577152858640},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"215de948be49bcf14f06d500cef9f7035e406a43","modified":1577152858640},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1577152858640},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"bcf52192942c0afc410c74a0fb458e7936ddc3d5","modified":1577152858640},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"69ecd6c97e7cdfd822ac8102b45ad0ede85050db","modified":1577152858640},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"8050a5b2683d1d77238c5762b6bd89c543daed6e","modified":1577152858990},{"_id":"themes/next/source/lib/Han/dist/han.min.css","hash":"a0c9e32549a8b8cf327ab9227b037f323cdb60ee","modified":1577152859010},{"_id":"themes/next/source/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1577152859010},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1577152859240},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1577152859240},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1577152859240},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1577152859240},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1577152859240},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1577152859240},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1577152859250},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1577152859250},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1577152859260},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1577152859260},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1577152859260},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1577152859270},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1577152859270},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1577152859690},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1577152859700},{"_id":"themes/next/source/lib/Han/dist/han.css","hash":"bd40da3fba8735df5850956814e312bd7b3193d7","modified":1577152859010},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1577152859250},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1577152859540},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1577152859710},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"7905a7f625702b45645d8be1268cb8af3f698c70","modified":1577152858160},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"f5aa2ba3bfffc15475e7e72a55b5c9d18609fdf5","modified":1577152858170},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1577152858170},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"2039590632bba3943c39319d80ef630af7928185","modified":1577152858170},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1577152858170},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"a82afbb72d83ee394aedc7b37ac0008a9823b4f4","modified":1577152858170},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1577152858160},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1577152858160},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"8a2421cb9005352905fae9d41a847ae56957247e","modified":1577152858160},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1577152858160},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1577152858170},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1577152858170},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"25dc25f61a232f03ca72472b7852f882448ec185","modified":1577152858170},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1577152858170},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"e72a89e0f421444453e149ba32c77a64bd8e44e8","modified":1577152858180},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"0f7f522cc6bfb3401d5afd62b0fcdf48bb2d604b","modified":1577152858180},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"f54367c0feda6986c030cc4d15a0ca6ceea14bcb","modified":1577152858180},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1577152858180},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"535b3b4f8cb1eec2558e094320e7dfb01f94c0e7","modified":1577152858180},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1577152858180},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"aea21141015ca8c409d8b33e3e34ec505f464e93","modified":1577152858180},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"a5d8617a24d7cb6c5ad91ea621183ca2c0917331","modified":1577152858180},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"36332c8a91f089f545f3c3e8ea90d08aa4d6e60c","modified":1577152858180},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"017074ef58166e2d69c53bb7590a0e7a8947a1ed","modified":1577152858190},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1577152858190},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"d5a4e4fc17f1f7e7c3a61b52d8e2e9677e139de7","modified":1577152858190},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1577152858190},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"e4055a0d2cd2b0ad9dc55928e2f3e7bd4e499da3","modified":1577152858190},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"262debfd4442fa03d9919ceb88b948339df03fb0","modified":1577152858190},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"0a6c0efffdf18bddbc1d1238feaed282b09cd0fe","modified":1577152858410},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"920343e41c124221a17f050bbb989494d44f7a24","modified":1577152858420},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"efa5e5022e205b52786ce495d4879f5e7b8f84b2","modified":1577152858420},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1577152858420},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"89dd4f8b1f1cce3ad46cf2256038472712387d02","modified":1577152858420},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1577152858420},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"77c92a449ce84d558d26d052681f2e0dd77c70c9","modified":1577152858420},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"f7784aba0c1cd20d824c918c120012d57a5eaa2a","modified":1577152858420},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"50305b6ad7d09d2ffa4854e39f41ec1f4fe984fd","modified":1577152858420},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1577152858420},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1577152858430},{"_id":"themes/next/source/css/_common/components/tags/exturl.styl","hash":"1b3cc9f4e5a7f6e05b4100e9990b37b20d4a2005","modified":1577152858430},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"b8969e1654eec89a0fd10d88b337fee9cb03cd44","modified":1577152858430},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1577152858430},{"_id":"themes/next/source/css/_common/components/tags/label.styl","hash":"4a457d265d62f287c63d48764ce45d9bcfc9ec5a","modified":1577152858430},{"_id":"themes/next/source/css/_common/components/tags/note-modern.styl","hash":"ee7528900578ef4753effe05b346381c40de5499","modified":1577152858430},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"32c9156bea5bac9e9ad0b4c08ffbca8b3d9aac4b","modified":1577152858430},{"_id":"themes/next/source/css/_common/components/tags/tabs.styl","hash":"4ab5deed8c3b0c338212380f678f8382672e1bcb","modified":1577152858430},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"ead0d0f2321dc71505788c7f689f92257cf14947","modified":1577152858440},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"fd42777b9125fd8969dc39d4f15473e2b91b4142","modified":1577152858440},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1577152858440},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"d4e6d8d7b34dc69994593c208f875ae8f7e8a3ae","modified":1577152858440},{"_id":"themes/next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1577152858440},{"_id":"themes/next/source/css/_common/components/third-party/gitment.styl","hash":"34935b40237c074be5f5e8818c14ccfd802b7439","modified":1577152858440},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"cce6772e2cdb4db85d35486ae4c6c59367fbdd40","modified":1577152858440},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1577152858440},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"d89c4b562b528e4746696b2ad8935764d133bdae","modified":1577152858440},{"_id":"themes/next/source/css/_common/components/third-party/needsharebutton.styl","hash":"a5e3e6b4b4b814a9fe40b34d784fed67d6d977fa","modified":1577152858450},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"1ccfbd4d0f5754b2dc2719a91245c95f547a7652","modified":1577152858450},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1577152858630},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1577152858630},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1577152858640},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1577152859000},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1577152859000},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1577152859000},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1577152859000},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","hash":"623af3ed5423371ac136a4fe0e8cc7bb7396037a","modified":1577152859000},{"_id":"themes/next/source/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1577152859010},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1577152859240},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1577152859240},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1577152859250},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1577152859520},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1577152859250},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1577152859530},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1577152859250},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1577152859250},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1577152859270},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1577152859530},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1577152859030},{"_id":"themes/next/source/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1577152859690},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1577152859530},{"_id":"public/categories/index.html","hash":"4dec5366390689ebf11d86f91a57f779ee7ea1fc","modified":1593746179020},{"_id":"public/2017/12/14/mybatis/index.html","hash":"c95a4c5f306a53eeb505f70a8f0bc3f22995ea19","modified":1593746179021},{"_id":"public/2017/12/05/round/index.html","hash":"4df4f810d8d7b39ea37459ab01f5fea929e86acb","modified":1593746179021},{"_id":"public/2017/11/29/nohup/index.html","hash":"5fc310b61ac988b6000f252109b5b4ca712166ca","modified":1593746179022},{"_id":"public/archives/2017/page/3/index.html","hash":"3ec9658419c8b8383b450a97c75b6f97ab79ceb6","modified":1593746179022},{"_id":"public/archives/2017/01/index.html","hash":"621c1409cb9865f37723fde7d5d78f35f1838255","modified":1593746179022},{"_id":"public/archives/2017/12/page/2/index.html","hash":"1b468f65c43105cb3126edf7045ea57a9ca674f9","modified":1593746179022},{"_id":"public/archives/2018/02/index.html","hash":"9dc86b71b4a23dd4b9c8b5df57f3b9aac294a2c6","modified":1593746179022},{"_id":"public/archives/2018/03/index.html","hash":"b379171469c0bb0514848e54ad5ec17230377972","modified":1593746179023},{"_id":"public/archives/2018/06/index.html","hash":"3fc0f9401dafc177388045e8b54a71d8debc4b9d","modified":1593746179023},{"_id":"public/archives/2018/09/index.html","hash":"7283d3d7bee0a9a2b675d58e9b3be1e5bcce44bc","modified":1593746179023},{"_id":"public/archives/2018/12/index.html","hash":"01b06cdc81e456a3baeddb6668087794e67a5505","modified":1593746179024},{"_id":"public/archives/2019/index.html","hash":"896a9f58043be37e4e5708d93d587bc3552254b6","modified":1593746179024},{"_id":"public/archives/2019/02/index.html","hash":"9e574b79381fac565e819f5ea2e0f4e6bc2795b7","modified":1593746179024},{"_id":"public/archives/2019/10/index.html","hash":"8eb59618d09cc02ac3b0a3408ada8cd0ed0357bb","modified":1593746179024},{"_id":"public/archives/2019/12/index.html","hash":"c7ddb0ae49ed2c1749889a3bb515b1cf34ca95d8","modified":1593746179024},{"_id":"public/archives/2020/index.html","hash":"8cb725deab7fe44597a0ed1831379aaa1b8dc89f","modified":1593746179024},{"_id":"public/archives/2020/03/index.html","hash":"239f7e5853c7f932853f2f4d06b14957b85ae6d2","modified":1593746179024},{"_id":"public/categories//index.html","hash":"90293d67859e3e79b5308a24e49f182ec01961da","modified":1593746179024},{"_id":"public/tags//index.html","hash":"6eb101867787043e1510bc6d817c71ff80016574","modified":1593746179025},{"_id":"public/2020/07/03/ratelimit/index.html","hash":"5d6471519db76059ce1c62d95a036f059a2fd73a","modified":1593746179025},{"_id":"public/2020/03/24/floyd/index.html","hash":"060b41852c96f30bdcde8eaeb2a9ab482477bfd1","modified":1593746179025},{"_id":"public/2019/12/24/hello-world/index.html","hash":"40ef6704ab142904703efcb66c6973f03e654a5f","modified":1593746179025},{"_id":"public/2019/12/24/promise-to-refreshtoken/index.html","hash":"4f9360668fcd8d2aa992d68b5e11add46c603a56","modified":1593746179025},{"_id":"public/2019/10/19/throttle/index.html","hash":"bfb47066b13bfb0e4417f7dc9bc2c71c79d4ec94","modified":1593746179025},{"_id":"public/2019/02/13/distribute-lock/index.html","hash":"34660f725863862c0cd2c0a0389d7166906502d3","modified":1593746179025},{"_id":"public/2018/12/25/java-pack-unpack/index.html","hash":"a53c4199ce4d4db3ee269aa6e06177e221b4766c","modified":1593746179025},{"_id":"public/2018/09/18/jasypt/index.html","hash":"144eb06d43ab3e4730030ed66fba4d0cfc1b3bf6","modified":1593746179025},{"_id":"public/2018/06/16/pattern-template/index.html","hash":"a4a939e928b9a524ec561b33918165e5fada40bb","modified":1593746179025},{"_id":"public/2018/06/11/singleton/index.html","hash":"389e27b470e638415c53c26afbe29c2bbf690ef5","modified":1593746179026},{"_id":"public/2018/06/08/observer/index.html","hash":"7959adbe589f335abf7fd0767483d976bc4c281e","modified":1593746179026},{"_id":"public/2018/04/13/docker/index.html","hash":"193fd8e82d2d05984c4274889784eff9e4b7cbf6","modified":1593746179026},{"_id":"public/2018/04/13/access-log/index.html","hash":"9080bebd54c64724d7eb57157a00a6cdcc5d7477","modified":1593746179026},{"_id":"public/2018/04/12/spring-boot-tomcat/index.html","hash":"27776fae20622d0297d19dbd3d42cdd5fd20e8cb","modified":1593746179026},{"_id":"public/2018/04/11/spring-cloud10/index.html","hash":"1ddba23af1f62d3205573e259b24d6638dc43df7","modified":1593746179027},{"_id":"public/2018/04/11/spring-cloud8/index.html","hash":"971075851333c69785c13f37f291224bdf6f3436","modified":1593746179027},{"_id":"public/2018/04/11/spring-cloud9/index.html","hash":"a00d24e98cdfe5a3c8045cf9fb319b5f4b3f80db","modified":1593746179027},{"_id":"public/2018/04/11/spring-cloud7/index.html","hash":"2cd820e8effad93bd60a412857b42ca50abf1200","modified":1593746179027},{"_id":"public/2018/04/10/nginx-cores/index.html","hash":"eb74026c0247945c4651118c94bc8f8797a2cfd4","modified":1593746179027},{"_id":"public/2018/03/26/maven/index.html","hash":"5716a616e2cf6e716eb438edbecc84e6cd439582","modified":1593746179027},{"_id":"public/2018/03/05/scan-notify/index.html","hash":"73650f62600394e33c520addd4ca32080a044a90","modified":1602295988203},{"_id":"public/2018/03/01/websocket/index.html","hash":"70e77b729df0c47a74d0471bd511e4d516116248","modified":1593746179027},{"_id":"public/2018/02/02/git-remote/index.html","hash":"461c51d71a997026ff54d17a974bcd9cdf404652","modified":1593746179027},{"_id":"public/2018/02/02/delay-queue/index.html","hash":"e86c52e1c9ad86f48ed94747c0e26934e693196d","modified":1593746179028},{"_id":"public/2018/01/30/snow-flake/index.html","hash":"cfb49b453a3035f9615e64424fe393ccc55d8a25","modified":1593746179028},{"_id":"public/2018/01/26/master-slave/index.html","hash":"5c3b03aec6213542afc2e6dcc5d4997508105d52","modified":1593746179028},{"_id":"public/2018/01/23/java-thread/index.html","hash":"bccf855c12b2db9966a8c55ab9c090bf37d7f34b","modified":1593746179028},{"_id":"public/2018/01/20/java/index.html","hash":"49d00c6d055031437fe5774da722d018b6aaa4b4","modified":1593746179028},{"_id":"public/2018/01/19/blockchain/index.html","hash":"805c51dd9dcbdd0aececd600f3522faeb0e2ee48","modified":1593746179028},{"_id":"public/2018/01/10/spring-cloud6/index.html","hash":"62275f0d0df1c60b07670ad561cc53511f92e264","modified":1593746179029},{"_id":"public/2018/01/09/spring-cloud5/index.html","hash":"3b843287fdae16edaf64ee288208c76232f27f6e","modified":1593746179029},{"_id":"public/2018/01/08/spring-cloud4/index.html","hash":"fd8815c0130cb1b1c6a0d93fa968f2d08b0514cb","modified":1593746179029},{"_id":"public/2018/01/08/spring-cloud3/index.html","hash":"99db48003d218d1053e21f2b7ab9a5ea1185a21e","modified":1593746179029},{"_id":"public/2018/01/08/spring-cloud2/index.html","hash":"fe2aa3c532d46edc8d77eef6723b3c3e5e95e969","modified":1593746179029},{"_id":"public/2017/12/21/mysql-out/index.html","hash":"bd5ae2d65b943d676e3fdedc3e49ee2d26094602","modified":1593746179029},{"_id":"public/2017/12/20/linux-safe/index.html","hash":"6af074b96de041a25fbf656c553cdd15f76a2d14","modified":1593746179029},{"_id":"public/2017/12/20/ssh-broken/index.html","hash":"d189203ff4b558a13dcc5726ae095ca3f98cd5a2","modified":1593746179030},{"_id":"public/2017/12/18/ssh-no-pass/index.html","hash":"ffd409f9b2dec458e7c26603faee271386be414a","modified":1593746179030},{"_id":"public/2017/12/15/jenkins/index.html","hash":"750e2ec01574b185933b8e86bcc5a2cab9bf1b95","modified":1593746179030},{"_id":"public/2017/12/14/spring-cloud-eureka/index.html","hash":"920316c72528dfbda094de4562ce733d6463e667","modified":1593746179030},{"_id":"public/2017/12/13/mysql-back/index.html","hash":"57745605b0f5536a756a931f7c773c66761de3c0","modified":1593746179030},{"_id":"public/2017/12/08/mysql-linux/index.html","hash":"3cd13a43e92b994ee8a6343c8751bf4d02fe40fa","modified":1593746179030},{"_id":"public/2017/12/07/mac-git/index.html","hash":"71e1536ae32fd7ae16646bf506c3a03722d85ca3","modified":1593746179030},{"_id":"public/2017/12/04/sequence/index.html","hash":"ad3d37fd6953570fe2fb63657b491e80c048af9f","modified":1593746179031},{"_id":"public/2017/12/03/socket/index.html","hash":"85d98aee63be0a8dd211bd052e07dbb7b290305b","modified":1593746179031},{"_id":"public/2017/12/01/spring-boot-active/index.html","hash":"64e78ca3c5d26d555712ad8ebf746f621c1a5239","modified":1593746179031},{"_id":"public/2017/11/30/cache-db/index.html","hash":"9bdc98951d841b60f3dfba4020761dda38e83df3","modified":1593746179031},{"_id":"public/2017/11/29/activemq/index.html","hash":"901f7538434e502f9e9556c5233149feffe21e4f","modified":1593746179031},{"_id":"public/2017/11/29/defent/index.html","hash":"77889b82191b1ee403f476d3d49194b10eb7eb08","modified":1593746179031},{"_id":"public/2017/11/29/nginx-strategy/index.html","hash":"fa2f8b586a82d8363657b1b2df70f25edd41c517","modified":1593746179031},{"_id":"public/2017/11/28/CentOS/index.html","hash":"8d962c6b274fb384937c26126610d4f8fd9125f2","modified":1593746179031},{"_id":"public/2017/11/28/ubuntu_firefox/index.html","hash":"b38bd9daeea34d1d6fbe2624518a69689879453c","modified":1593746179031},{"_id":"public/2017/11/28/shadowsocks/index.html","hash":"2c40da41913243503b6c352bef0a32cf51f87417","modified":1593746179032},{"_id":"public/2017/11/27/ssh/index.html","hash":"91fa9ae20bd727fd71ae015b61df28b04aa78ce1","modified":1593746179032},{"_id":"public/2017/01/22/access-token/index.html","hash":"d18eb327ccdfcc01e08a37c50a9c1d9b8cb869e9","modified":1593746179032},{"_id":"public/archives/page/2/index.html","hash":"b71913cb930a5c50f97f77e250edc597671126f9","modified":1593746179032},{"_id":"public/archives/page/3/index.html","hash":"934032e80288a92e4fe388cb32d6f7963b4d3459","modified":1593746179032},{"_id":"public/archives/page/4/index.html","hash":"277d47fdf3c44ac05085890c515244db06c909a4","modified":1593746179032},{"_id":"public/archives/page/5/index.html","hash":"17f030425b52ec000dea8deefd1964bd6a7f0f77","modified":1593746179032},{"_id":"public/archives/2017/page/2/index.html","hash":"bfe4b400275248dff809f5cbe0f985897a47a8c8","modified":1593746179032},{"_id":"public/archives/index.html","hash":"89cd8f1176a330abeb4592d43fba806a2ef5f65e","modified":1593746179032},{"_id":"public/archives/page/6/index.html","hash":"a8f00e2d7a243856b55ff758d01a812cd47b21f6","modified":1593746179032},{"_id":"public/archives/2017/index.html","hash":"6346d06c4c84521bb7b595132957ab97983c1bde","modified":1593746179033},{"_id":"public/archives/2017/11/index.html","hash":"27c38a5b9d7295ad751d5f2394d6429fa9baa404","modified":1593746179033},{"_id":"public/archives/2017/12/index.html","hash":"2741ab088c2b6ef1eb32c774a2b6864deaccbfa5","modified":1593746179033},{"_id":"public/archives/2018/index.html","hash":"7135f295973be30f4c3c4586e72c9a25a84a9887","modified":1593746179033},{"_id":"public/archives/2018/page/2/index.html","hash":"13f372f484540abf56a74595c9b2ff4e1416bd32","modified":1593746179033},{"_id":"public/archives/2018/page/3/index.html","hash":"43b699241dd31eabb78b2d4b68e22e2c3b9e20d7","modified":1593746179033},{"_id":"public/archives/2018/01/index.html","hash":"bf864ac7f53be4a1e99951228e1f18ce5d4d264d","modified":1593746179033},{"_id":"public/archives/2018/04/index.html","hash":"313fc8b66edf6d2e2326d261707e19b087038492","modified":1593746179033},{"_id":"public/categories//index.html","hash":"596cac2fe2d1543e09797cd00007ae7a8e9d6990","modified":1593746179034},{"_id":"public/index.html","hash":"d0737ec29251bf7874176c1127d140b29979e2ce","modified":1602295988204},{"_id":"public/page/2/index.html","hash":"a1a41004b6e527c336ca1139918151af04b59ff4","modified":1593746179034},{"_id":"public/page/3/index.html","hash":"8469a9795eac6b42de5615c0593ee08c465bcd05","modified":1593746179034},{"_id":"public/page/4/index.html","hash":"17648a0372167efe5c84f00d21547b614e42ddc9","modified":1593746179035},{"_id":"public/page/5/index.html","hash":"075392cd9d470dac3e2a35696e2931d0ab635c59","modified":1593746179035},{"_id":"public/page/6/index.html","hash":"3a1021bed75ebccf316f1fd5762dbf2cf197e269","modified":1593746179035},{"_id":"public/archives/2020/07/index.html","hash":"4e7f3ffd0ff570343f0133ca8108fc88b163e25c","modified":1593746179041}],"Category":[{"name":"","_id":"ckc5n3jwg000t0j9k89extb4f"},{"name":"","_id":"ckc5n3jx700180j9k7g1xw1ht"}],"Data":[],"Page":[{"title":"Category","date":"2018-04-11T08:32:35.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: Category\ndate: 2018-04-11 16:32:35\ntype: \"categories\"\n---\n","updated":"2019-12-24T02:00:57.480Z","path":"categories/index.html","comments":1,"layout":"page","_id":"ckc5n3jv700010j9klwlrqm1g","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"CentOS7,","date":"2017-11-28T08:00:00.000Z","_content":"# :CentOSnginx,\n\n# :nginx80,\n\n# \n\n## \n\n```\nvim /etc/firewalld/zones/public.xml\n```\n\n## 80\n\n```\n<port protocol=\"tcp\" port=\"80\"/>\n```\n\n## \n\n```\nsystemctl restart firewalld.service\n```\n","source":"_posts/CentOS.md","raw":"---\ntitle: CentOS7,\ndate: 2017-11-28 16:00:00\ntags:\n---\n# :CentOSnginx,\n\n# :nginx80,\n\n# \n\n## \n\n```\nvim /etc/firewalld/zones/public.xml\n```\n\n## 80\n\n```\n<port protocol=\"tcp\" port=\"80\"/>\n```\n\n## \n\n```\nsystemctl restart firewalld.service\n```\n","slug":"CentOS","published":1,"updated":"2019-12-24T02:00:57.330Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3juy00000j9k3usdfs50","content":"<h1 id=\"-CentOSnginx-\"><a href=\"#-CentOSnginx-\" class=\"headerlink\" title=\":CentOSnginx,\"></a>:CentOSnginx,</h1><h1 id=\"-nginx80-\"><a href=\"#-nginx80-\" class=\"headerlink\" title=\":nginx80,\"></a>:nginx80,</h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/firewalld/zones/public.xml</span><br></pre></td></tr></table></figure>\n<h2 id=\"80\"><a href=\"#80\" class=\"headerlink\" title=\"80\"></a>80</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;port protocol=&quot;tcp&quot; port=&quot;80&quot;/&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart firewalld.service</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"-CentOSnginx-\"><a href=\"#-CentOSnginx-\" class=\"headerlink\" title=\":CentOSnginx,\"></a>:CentOSnginx,</h1><h1 id=\"-nginx80-\"><a href=\"#-nginx80-\" class=\"headerlink\" title=\":nginx80,\"></a>:nginx80,</h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/firewalld/zones/public.xml</span><br></pre></td></tr></table></figure>\n<h2 id=\"80\"><a href=\"#80\" class=\"headerlink\" title=\"80\"></a>80</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;port protocol=&quot;tcp&quot; port=&quot;80&quot;/&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart firewalld.service</span><br></pre></td></tr></table></figure>\n"},{"title":"Spring Bootaccess log","date":"2018-04-13T02:49:14.000Z","top":80,"_content":"\n> Spring BootlogbackTomcat Access Log\n\n# \n\nSpring boottomcat`server.tomcat.accesslog`tomcat access\n\n:\n\n```\nserver.tomcat.accesslog.buffered=true # true\nserver.tomcat.accesslog.directory=logs # tomcat \nserver.tomcat.accesslog.enabled=false # \nserver.tomcat.accesslog.file-date-format=.yyyy-MM-dd #  \nserver.tomcat.accesslog.pattern=common #  \nserver.tomcat.accesslog.prefix=access_log # \nserver.tomcat.accesslog.rename-on-rotate=false #  \nserver.tomcat.accesslog.request-attributes-enabled=false # IP \nserver.tomcat.accesslog.rotate=true # \nserver.tomcat.accesslog.suffix=.log # \n```\n\n## pattern\n\n- `%a` - ipipnginx \n\n- `%A` - ip\n\n- `%b` - HTTP' - '\n\n- `%B` - HTTP\n\n- `%h` - IPenableLookupsfalse\n\n- `%H` - \n\n- `%l` - Remote logical username from identd (always returns '-')\n\n- `%m` - GETPOST)\n\n- `%p` - \n\n- `%q` - '?'\n\n- `%r` - HTTPURI\n\n- `%s` - HTTP200,404\n\n- `%S` - User session ID\n\n- `%t` - Common Log Format\n\n- `%u` - \n\n- `%U` - Requested URL path\n\n- `%v` - Local server name\n\n- `%D` - Time taken to process the request, in millis\n\n- `%T` - Time taken to process the request, in seconds\n\n- `%I` - log\n\nAccess log cookieheadersessionServletRequestApache{xxx}\n\n- `%{xxx}i`  for incoming headersrequest header\n- `%{xxx}o`  for outgoing response headersresponse header\n- `%{xxx}c`  for a specific cookie\n- `%{xxx}r`  xxx is an attribute in the ServletRequest\n- `%{xxx}s`  xxx is an attribute in the HttpSession\n- `%{xxx}t`  xxx is an enhanced SimpleDateFormat pattern (see Configuration Reference document for details on supported time patterns)\n\n# \n\n`server.tomcat.accesslog.pattern`commoncombined\n\n- `common`: `%h %l %u %t \"%r\" %s %b`\n\n- `combined`: `%h %l %u %t \"%r\" %s %b \"%{Referer}i\" \"%{User-Agent}i\"`\n\n\n[Tomcat access log](http://www.cnblogs.com/chrischennx)\n","source":"_posts/access-log.md","raw":"---\ntitle: Spring Bootaccess log \ndate: 2018-04-13 10:49:14\ntags:\ntop: 80\n---\n\n> Spring BootlogbackTomcat Access Log\n\n# \n\nSpring boottomcat`server.tomcat.accesslog`tomcat access\n\n:\n\n```\nserver.tomcat.accesslog.buffered=true # true\nserver.tomcat.accesslog.directory=logs # tomcat \nserver.tomcat.accesslog.enabled=false # \nserver.tomcat.accesslog.file-date-format=.yyyy-MM-dd #  \nserver.tomcat.accesslog.pattern=common #  \nserver.tomcat.accesslog.prefix=access_log # \nserver.tomcat.accesslog.rename-on-rotate=false #  \nserver.tomcat.accesslog.request-attributes-enabled=false # IP \nserver.tomcat.accesslog.rotate=true # \nserver.tomcat.accesslog.suffix=.log # \n```\n\n## pattern\n\n- `%a` - ipipnginx \n\n- `%A` - ip\n\n- `%b` - HTTP' - '\n\n- `%B` - HTTP\n\n- `%h` - IPenableLookupsfalse\n\n- `%H` - \n\n- `%l` - Remote logical username from identd (always returns '-')\n\n- `%m` - GETPOST)\n\n- `%p` - \n\n- `%q` - '?'\n\n- `%r` - HTTPURI\n\n- `%s` - HTTP200,404\n\n- `%S` - User session ID\n\n- `%t` - Common Log Format\n\n- `%u` - \n\n- `%U` - Requested URL path\n\n- `%v` - Local server name\n\n- `%D` - Time taken to process the request, in millis\n\n- `%T` - Time taken to process the request, in seconds\n\n- `%I` - log\n\nAccess log cookieheadersessionServletRequestApache{xxx}\n\n- `%{xxx}i`  for incoming headersrequest header\n- `%{xxx}o`  for outgoing response headersresponse header\n- `%{xxx}c`  for a specific cookie\n- `%{xxx}r`  xxx is an attribute in the ServletRequest\n- `%{xxx}s`  xxx is an attribute in the HttpSession\n- `%{xxx}t`  xxx is an enhanced SimpleDateFormat pattern (see Configuration Reference document for details on supported time patterns)\n\n# \n\n`server.tomcat.accesslog.pattern`commoncombined\n\n- `common`: `%h %l %u %t \"%r\" %s %b`\n\n- `combined`: `%h %l %u %t \"%r\" %s %b \"%{Referer}i\" \"%{User-Agent}i\"`\n\n\n[Tomcat access log](http://www.cnblogs.com/chrischennx)\n","slug":"access-log","published":1,"updated":"2019-12-24T02:00:57.330Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jv800020j9k3aebi87o","content":"<blockquote>\n<p>Spring BootlogbackTomcat Access Log</p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring boottomcat<code>server.tomcat.accesslog</code>tomcat access</p>\n<p>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server.tomcat.accesslog.buffered=true # true</span><br><span class=\"line\">server.tomcat.accesslog.directory=logs # tomcat </span><br><span class=\"line\">server.tomcat.accesslog.enabled=false # </span><br><span class=\"line\">server.tomcat.accesslog.file-date-format=.yyyy-MM-dd #  </span><br><span class=\"line\">server.tomcat.accesslog.pattern=common #  </span><br><span class=\"line\">server.tomcat.accesslog.prefix=access_log # </span><br><span class=\"line\">server.tomcat.accesslog.rename-on-rotate=false #  </span><br><span class=\"line\">server.tomcat.accesslog.request-attributes-enabled=false # IP </span><br><span class=\"line\">server.tomcat.accesslog.rotate=true # </span><br><span class=\"line\">server.tomcat.accesslog.suffix=.log # </span><br></pre></td></tr></table></figure>\n<h2 id=\"pattern\"><a href=\"#pattern\" class=\"headerlink\" title=\"pattern\"></a>pattern</h2><ul>\n<li><p><code>%a</code> - ipipnginx </p>\n</li>\n<li><p><code>%A</code> - ip</p>\n</li>\n<li><p><code>%b</code> - HTTP - </p>\n</li>\n<li><p><code>%B</code> - HTTP</p>\n</li>\n<li><p><code>%h</code> - IPenableLookupsfalse</p>\n</li>\n<li><p><code>%H</code> - </p>\n</li>\n<li><p><code>%l</code> - Remote logical username from identd (always returns -)</p>\n</li>\n<li><p><code>%m</code> - GETPOST)</p>\n</li>\n<li><p><code>%p</code> - </p>\n</li>\n<li><p><code>%q</code> - ?</p>\n</li>\n<li><p><code>%r</code> - HTTPURI</p>\n</li>\n<li><p><code>%s</code> - HTTP200,404</p>\n</li>\n<li><p><code>%S</code> - User session ID</p>\n</li>\n<li><p><code>%t</code> - Common Log Format</p>\n</li>\n<li><p><code>%u</code> - </p>\n</li>\n<li><p><code>%U</code> - Requested URL path</p>\n</li>\n<li><p><code>%v</code> - Local server name</p>\n</li>\n<li><p><code>%D</code> - Time taken to process the request, in millis</p>\n</li>\n<li><p><code>%T</code> - Time taken to process the request, in seconds</p>\n</li>\n<li><p><code>%I</code> - log</p>\n</li>\n</ul>\n<p>Access log cookieheadersessionServletRequestApache{xxx}</p>\n<ul>\n<li><code>%{xxx}i</code>  for incoming headersrequest header</li>\n<li><code>%{xxx}o</code>  for outgoing response headersresponse header</li>\n<li><code>%{xxx}c</code>  for a specific cookie</li>\n<li><code>%{xxx}r</code>  xxx is an attribute in the ServletRequest</li>\n<li><code>%{xxx}s</code>  xxx is an attribute in the HttpSession</li>\n<li><code>%{xxx}t</code>  xxx is an enhanced SimpleDateFormat pattern (see Configuration Reference document for details on supported time patterns)</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>server.tomcat.accesslog.pattern</code>commoncombined</p>\n<ul>\n<li><p><code>common</code>: <code>%h %l %u %t &quot;%r&quot; %s %b</code></p>\n</li>\n<li><p><code>combined</code>: <code>%h %l %u %t &quot;%r&quot; %s %b &quot;%{Referer}i&quot; &quot;%{User-Agent}i&quot;</code></p>\n</li>\n</ul>\n<p><a href=\"http://www.cnblogs.com/chrischennx\" target=\"_blank\" rel=\"noopener\">Tomcat access log</a></p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>Spring BootlogbackTomcat Access Log</p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring boottomcat<code>server.tomcat.accesslog</code>tomcat access</p>\n<p>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server.tomcat.accesslog.buffered=true # true</span><br><span class=\"line\">server.tomcat.accesslog.directory=logs # tomcat </span><br><span class=\"line\">server.tomcat.accesslog.enabled=false # </span><br><span class=\"line\">server.tomcat.accesslog.file-date-format=.yyyy-MM-dd #  </span><br><span class=\"line\">server.tomcat.accesslog.pattern=common #  </span><br><span class=\"line\">server.tomcat.accesslog.prefix=access_log # </span><br><span class=\"line\">server.tomcat.accesslog.rename-on-rotate=false #  </span><br><span class=\"line\">server.tomcat.accesslog.request-attributes-enabled=false # IP </span><br><span class=\"line\">server.tomcat.accesslog.rotate=true # </span><br><span class=\"line\">server.tomcat.accesslog.suffix=.log # </span><br></pre></td></tr></table></figure>\n<h2 id=\"pattern\"><a href=\"#pattern\" class=\"headerlink\" title=\"pattern\"></a>pattern</h2><ul>\n<li><p><code>%a</code> - ipipnginx </p>\n</li>\n<li><p><code>%A</code> - ip</p>\n</li>\n<li><p><code>%b</code> - HTTP - </p>\n</li>\n<li><p><code>%B</code> - HTTP</p>\n</li>\n<li><p><code>%h</code> - IPenableLookupsfalse</p>\n</li>\n<li><p><code>%H</code> - </p>\n</li>\n<li><p><code>%l</code> - Remote logical username from identd (always returns -)</p>\n</li>\n<li><p><code>%m</code> - GETPOST)</p>\n</li>\n<li><p><code>%p</code> - </p>\n</li>\n<li><p><code>%q</code> - ?</p>\n</li>\n<li><p><code>%r</code> - HTTPURI</p>\n</li>\n<li><p><code>%s</code> - HTTP200,404</p>\n</li>\n<li><p><code>%S</code> - User session ID</p>\n</li>\n<li><p><code>%t</code> - Common Log Format</p>\n</li>\n<li><p><code>%u</code> - </p>\n</li>\n<li><p><code>%U</code> - Requested URL path</p>\n</li>\n<li><p><code>%v</code> - Local server name</p>\n</li>\n<li><p><code>%D</code> - Time taken to process the request, in millis</p>\n</li>\n<li><p><code>%T</code> - Time taken to process the request, in seconds</p>\n</li>\n<li><p><code>%I</code> - log</p>\n</li>\n</ul>\n<p>Access log cookieheadersessionServletRequestApache{xxx}</p>\n<ul>\n<li><code>%{xxx}i</code>  for incoming headersrequest header</li>\n<li><code>%{xxx}o</code>  for outgoing response headersresponse header</li>\n<li><code>%{xxx}c</code>  for a specific cookie</li>\n<li><code>%{xxx}r</code>  xxx is an attribute in the ServletRequest</li>\n<li><code>%{xxx}s</code>  xxx is an attribute in the HttpSession</li>\n<li><code>%{xxx}t</code>  xxx is an enhanced SimpleDateFormat pattern (see Configuration Reference document for details on supported time patterns)</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>server.tomcat.accesslog.pattern</code>commoncombined</p>\n<ul>\n<li><p><code>common</code>: <code>%h %l %u %t &quot;%r&quot; %s %b</code></p>\n</li>\n<li><p><code>combined</code>: <code>%h %l %u %t &quot;%r&quot; %s %b &quot;%{Referer}i&quot; &quot;%{User-Agent}i&quot;</code></p>\n</li>\n</ul>\n<p><a href=\"http://www.cnblogs.com/chrischennx\" target=\"_blank\" rel=\"noopener\">Tomcat access log</a></p>\n"},{"title":"access_token","date":"2017-01-22T03:25:20.000Z","_content":"![pic](http://www.wailian.work/images/2018/01/23/4f3eddad613cb4031652bfcd36a4e6500881bbe75c05c-ceNJBC_fw658.jpg)\n\n# \n\naccess_token\n\n\n\n  ****  access_tokenaccess_tokenaccess_token\n\n\n\n```\npublic JSONObject getAccessToken(String appid, String appsecret) {\n    String reqestUrl = ACCESS_TOKEN_URL.replace(\"APPID\", appid).replace(\"APPSECRET\", appsecret);\n\n    RedisUtils<String> redisUtils = new RedisUtils<>(redisTemplate);\n\n    String accessToken = redisUtils.get(ACCESS_TOKEN_CACHE_KEY);\n\n    if (StrUtil.isNotEmpty(accessToken)) {\n        return JSONObject.parseObject(accessToken);\n    }\n\n    JSONObject resultJSON = JSONObject.parseObject(HttpUtil.get(reqestUrl));\n\n    if (StrUtil.isNotEmpty(resultJSON.getString(\"errcode\"))) {\n        log.info(resultJSON.getString(\"errmsg\"));\n        return null;\n    }\n\n    redisUtils.set(ACCESS_TOKEN_CACHE_KEY, resultJSON.toJSONString(), 7000L);\n\n    return resultJSON;\n}\n```\n\n# \n\n\n\n```\npublic JSONObject getAccessToken(String appid, String appsecret) {\n    String reqestUrl = ACCESS_TOKEN_URL.replace(\"APPID\", appid).replace(\"APPSECRET\", appsecret);\n\n    RedisUtils<String> redisUtils = new RedisUtils<>(redisTemplate);\n\n    String accessToken = redisUtils.get(ACCESS_TOKEN_CACHE_KEY);\n\n    if (StrUtil.isNotEmpty(accessToken)) {\n        return JSONObject.parseObject(accessToken);\n    }\n\n    // access_token\n    synchronized (appid) {\n        // \n        String accessToken2 = redisUtils.get(ACCESS_TOKEN_CACHE_KEY);\n        if (StrUtil.isNotEmpty(accessToken2)) {\n            log.info(\"multi thread hits!\");\n            return JSONObject.parseObject(accessToken2);\n        }\n\n        JSONObject resultJSON = JSONObject.parseObject(HttpUtil.get(reqestUrl));\n\n        if (StrUtil.isNotEmpty(resultJSON.getString(\"errcode\"))) {\n            log.info(resultJSON.getString(\"errmsg\"));\n            return null;\n        }\n\n        redisUtils.set(ACCESS_TOKEN_CACHE_KEY, resultJSON.toJSONString(), 7000L);\n\n        return resultJSON;\n    }\n}\n```\n","source":"_posts/access-token.md","raw":"---\ntitle: access_token\ndate: 2017-01-22 11:25:20\ntags:\n---\n![pic](http://www.wailian.work/images/2018/01/23/4f3eddad613cb4031652bfcd36a4e6500881bbe75c05c-ceNJBC_fw658.jpg)\n\n# \n\naccess_token\n\n\n\n  ****  access_tokenaccess_tokenaccess_token\n\n\n\n```\npublic JSONObject getAccessToken(String appid, String appsecret) {\n    String reqestUrl = ACCESS_TOKEN_URL.replace(\"APPID\", appid).replace(\"APPSECRET\", appsecret);\n\n    RedisUtils<String> redisUtils = new RedisUtils<>(redisTemplate);\n\n    String accessToken = redisUtils.get(ACCESS_TOKEN_CACHE_KEY);\n\n    if (StrUtil.isNotEmpty(accessToken)) {\n        return JSONObject.parseObject(accessToken);\n    }\n\n    JSONObject resultJSON = JSONObject.parseObject(HttpUtil.get(reqestUrl));\n\n    if (StrUtil.isNotEmpty(resultJSON.getString(\"errcode\"))) {\n        log.info(resultJSON.getString(\"errmsg\"));\n        return null;\n    }\n\n    redisUtils.set(ACCESS_TOKEN_CACHE_KEY, resultJSON.toJSONString(), 7000L);\n\n    return resultJSON;\n}\n```\n\n# \n\n\n\n```\npublic JSONObject getAccessToken(String appid, String appsecret) {\n    String reqestUrl = ACCESS_TOKEN_URL.replace(\"APPID\", appid).replace(\"APPSECRET\", appsecret);\n\n    RedisUtils<String> redisUtils = new RedisUtils<>(redisTemplate);\n\n    String accessToken = redisUtils.get(ACCESS_TOKEN_CACHE_KEY);\n\n    if (StrUtil.isNotEmpty(accessToken)) {\n        return JSONObject.parseObject(accessToken);\n    }\n\n    // access_token\n    synchronized (appid) {\n        // \n        String accessToken2 = redisUtils.get(ACCESS_TOKEN_CACHE_KEY);\n        if (StrUtil.isNotEmpty(accessToken2)) {\n            log.info(\"multi thread hits!\");\n            return JSONObject.parseObject(accessToken2);\n        }\n\n        JSONObject resultJSON = JSONObject.parseObject(HttpUtil.get(reqestUrl));\n\n        if (StrUtil.isNotEmpty(resultJSON.getString(\"errcode\"))) {\n            log.info(resultJSON.getString(\"errmsg\"));\n            return null;\n        }\n\n        redisUtils.set(ACCESS_TOKEN_CACHE_KEY, resultJSON.toJSONString(), 7000L);\n\n        return resultJSON;\n    }\n}\n```\n","slug":"access-token","published":1,"updated":"2019-12-24T02:00:57.330Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jvc00030j9kw4mkwa24","content":"<p><img src=\"http://www.wailian.work/images/2018/01/23/4f3eddad613cb4031652bfcd36a4e6500881bbe75c05c-ceNJBC_fw658.jpg\" alt=\"pic\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>access_token</p>\n<p></p>\n<p>  <strong></strong>  access_tokenaccess_tokenaccess_token</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public JSONObject getAccessToken(String appid, String appsecret) &#123;</span><br><span class=\"line\">    String reqestUrl = ACCESS_TOKEN_URL.replace(&quot;APPID&quot;, appid).replace(&quot;APPSECRET&quot;, appsecret);</span><br><span class=\"line\"></span><br><span class=\"line\">    RedisUtils&lt;String&gt; redisUtils = new RedisUtils&lt;&gt;(redisTemplate);</span><br><span class=\"line\"></span><br><span class=\"line\">    String accessToken = redisUtils.get(ACCESS_TOKEN_CACHE_KEY);</span><br><span class=\"line\"></span><br><span class=\"line\">    if (StrUtil.isNotEmpty(accessToken)) &#123;</span><br><span class=\"line\">        return JSONObject.parseObject(accessToken);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    JSONObject resultJSON = JSONObject.parseObject(HttpUtil.get(reqestUrl));</span><br><span class=\"line\"></span><br><span class=\"line\">    if (StrUtil.isNotEmpty(resultJSON.getString(&quot;errcode&quot;))) &#123;</span><br><span class=\"line\">        log.info(resultJSON.getString(&quot;errmsg&quot;));</span><br><span class=\"line\">        return null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    redisUtils.set(ACCESS_TOKEN_CACHE_KEY, resultJSON.toJSONString(), 7000L);</span><br><span class=\"line\"></span><br><span class=\"line\">    return resultJSON;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public JSONObject getAccessToken(String appid, String appsecret) &#123;</span><br><span class=\"line\">    String reqestUrl = ACCESS_TOKEN_URL.replace(&quot;APPID&quot;, appid).replace(&quot;APPSECRET&quot;, appsecret);</span><br><span class=\"line\"></span><br><span class=\"line\">    RedisUtils&lt;String&gt; redisUtils = new RedisUtils&lt;&gt;(redisTemplate);</span><br><span class=\"line\"></span><br><span class=\"line\">    String accessToken = redisUtils.get(ACCESS_TOKEN_CACHE_KEY);</span><br><span class=\"line\"></span><br><span class=\"line\">    if (StrUtil.isNotEmpty(accessToken)) &#123;</span><br><span class=\"line\">        return JSONObject.parseObject(accessToken);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // access_token</span><br><span class=\"line\">    synchronized (appid) &#123;</span><br><span class=\"line\">        // </span><br><span class=\"line\">        String accessToken2 = redisUtils.get(ACCESS_TOKEN_CACHE_KEY);</span><br><span class=\"line\">        if (StrUtil.isNotEmpty(accessToken2)) &#123;</span><br><span class=\"line\">            log.info(&quot;multi thread hits!&quot;);</span><br><span class=\"line\">            return JSONObject.parseObject(accessToken2);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        JSONObject resultJSON = JSONObject.parseObject(HttpUtil.get(reqestUrl));</span><br><span class=\"line\"></span><br><span class=\"line\">        if (StrUtil.isNotEmpty(resultJSON.getString(&quot;errcode&quot;))) &#123;</span><br><span class=\"line\">            log.info(resultJSON.getString(&quot;errmsg&quot;));</span><br><span class=\"line\">            return null;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        redisUtils.set(ACCESS_TOKEN_CACHE_KEY, resultJSON.toJSONString(), 7000L);</span><br><span class=\"line\"></span><br><span class=\"line\">        return resultJSON;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/01/23/4f3eddad613cb4031652bfcd36a4e6500881bbe75c05c-ceNJBC_fw658.jpg\" alt=\"pic\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>access_token</p>\n<p></p>\n<p>  <strong></strong>  access_tokenaccess_tokenaccess_token</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public JSONObject getAccessToken(String appid, String appsecret) &#123;</span><br><span class=\"line\">    String reqestUrl = ACCESS_TOKEN_URL.replace(&quot;APPID&quot;, appid).replace(&quot;APPSECRET&quot;, appsecret);</span><br><span class=\"line\"></span><br><span class=\"line\">    RedisUtils&lt;String&gt; redisUtils = new RedisUtils&lt;&gt;(redisTemplate);</span><br><span class=\"line\"></span><br><span class=\"line\">    String accessToken = redisUtils.get(ACCESS_TOKEN_CACHE_KEY);</span><br><span class=\"line\"></span><br><span class=\"line\">    if (StrUtil.isNotEmpty(accessToken)) &#123;</span><br><span class=\"line\">        return JSONObject.parseObject(accessToken);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    JSONObject resultJSON = JSONObject.parseObject(HttpUtil.get(reqestUrl));</span><br><span class=\"line\"></span><br><span class=\"line\">    if (StrUtil.isNotEmpty(resultJSON.getString(&quot;errcode&quot;))) &#123;</span><br><span class=\"line\">        log.info(resultJSON.getString(&quot;errmsg&quot;));</span><br><span class=\"line\">        return null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    redisUtils.set(ACCESS_TOKEN_CACHE_KEY, resultJSON.toJSONString(), 7000L);</span><br><span class=\"line\"></span><br><span class=\"line\">    return resultJSON;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public JSONObject getAccessToken(String appid, String appsecret) &#123;</span><br><span class=\"line\">    String reqestUrl = ACCESS_TOKEN_URL.replace(&quot;APPID&quot;, appid).replace(&quot;APPSECRET&quot;, appsecret);</span><br><span class=\"line\"></span><br><span class=\"line\">    RedisUtils&lt;String&gt; redisUtils = new RedisUtils&lt;&gt;(redisTemplate);</span><br><span class=\"line\"></span><br><span class=\"line\">    String accessToken = redisUtils.get(ACCESS_TOKEN_CACHE_KEY);</span><br><span class=\"line\"></span><br><span class=\"line\">    if (StrUtil.isNotEmpty(accessToken)) &#123;</span><br><span class=\"line\">        return JSONObject.parseObject(accessToken);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // access_token</span><br><span class=\"line\">    synchronized (appid) &#123;</span><br><span class=\"line\">        // </span><br><span class=\"line\">        String accessToken2 = redisUtils.get(ACCESS_TOKEN_CACHE_KEY);</span><br><span class=\"line\">        if (StrUtil.isNotEmpty(accessToken2)) &#123;</span><br><span class=\"line\">            log.info(&quot;multi thread hits!&quot;);</span><br><span class=\"line\">            return JSONObject.parseObject(accessToken2);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        JSONObject resultJSON = JSONObject.parseObject(HttpUtil.get(reqestUrl));</span><br><span class=\"line\"></span><br><span class=\"line\">        if (StrUtil.isNotEmpty(resultJSON.getString(&quot;errcode&quot;))) &#123;</span><br><span class=\"line\">            log.info(resultJSON.getString(&quot;errmsg&quot;));</span><br><span class=\"line\">            return null;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        redisUtils.set(ACCESS_TOKEN_CACHE_KEY, resultJSON.toJSONString(), 7000L);</span><br><span class=\"line\"></span><br><span class=\"line\">        return resultJSON;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"Spring Bootactivemq","date":"2017-11-29T04:34:03.000Z","_content":"# activemq\n\n## \n\n[](http://activemq.apache.org/)\n\n## \n\n```\ntar -zxvf apache-activemq-5.14.0-bin.tar.gz\n```\nbin cd apache-activemq-5.14.0/bin  ./activemq start\n\n## web\n\nhttp://IP:8161/admin\n\nactiveMQtcp:61616web:8161confxmlhttpjetty\n\n# activemq\n\n## application.properties\n\n```\nspring.activemq.broker-url=tcp://localhost:61616 \nspring.activemq.user=admin \nspring.activemq.password=admin \nspring.activemq.pool.enabled=false\n```\n\n## \n```\n@Service\npublic class Producer {\n    @Resource\n    private JmsMessagingTemplate jmsMessagingTemplate;\n\n    public void sendMsg(String destName, String message) {\n        Destination destination = new ActiveMQQueue(destName);\n        jmsMessagingTemplate.convertAndSend(destination, message);\n    }\n}\n\n```\n\n## \n\n```\n@Service\npublic class Consumer {\n    @JmsListener(destination = \"test.queue\")\n    public void receiveMsg(String text) {\n        System.out.println(\">>>>->>>:\" + text);\n    }\n}\n```\n\n## \n\n```\n@Service\npublic class Publisher {\n    @Resource\n    private JmsMessagingTemplate jmsMessagingTemplate;\n\n    public void publish(String destName, String message) {\n        Destination destination = new ActiveMQTopic(destName);\n\n        jmsMessagingTemplate.convertAndSend(destination, message);\n    }\n}\n```\n\n## \n\n```\n@Service\npublic class Subscriber {\n    @JmsListener(destination = \"test.topic\", containerFactory = \"myJmsContainerFactory\")\n    public void subscribe(String text) {\n        System.out.println(\"===<<<<:\" + text);\n    }\n\n    @Bean\n    JmsListenerContainerFactory myJmsContainerFactory(ConnectionFactory connectionFactory) {\n        SimpleJmsListenerContainerFactory factory = new SimpleJmsListenerContainerFactory();\n        factory.setConnectionFactory(connectionFactory);\n        factory.setPubSubDomain(true);\n        return factory;\n    }\n}\n```\n\npub/subcontainerFactory\n\n> [github](https://github.com/wangweiye01/activemq)\n","source":"_posts/activemq.md","raw":"---\ntitle: Spring Bootactivemq\ndate: 2017-11-29 12:34:03\ntags:\n---\n# activemq\n\n## \n\n[](http://activemq.apache.org/)\n\n## \n\n```\ntar -zxvf apache-activemq-5.14.0-bin.tar.gz\n```\nbin cd apache-activemq-5.14.0/bin  ./activemq start\n\n## web\n\nhttp://IP:8161/admin\n\nactiveMQtcp:61616web:8161confxmlhttpjetty\n\n# activemq\n\n## application.properties\n\n```\nspring.activemq.broker-url=tcp://localhost:61616 \nspring.activemq.user=admin \nspring.activemq.password=admin \nspring.activemq.pool.enabled=false\n```\n\n## \n```\n@Service\npublic class Producer {\n    @Resource\n    private JmsMessagingTemplate jmsMessagingTemplate;\n\n    public void sendMsg(String destName, String message) {\n        Destination destination = new ActiveMQQueue(destName);\n        jmsMessagingTemplate.convertAndSend(destination, message);\n    }\n}\n\n```\n\n## \n\n```\n@Service\npublic class Consumer {\n    @JmsListener(destination = \"test.queue\")\n    public void receiveMsg(String text) {\n        System.out.println(\">>>>->>>:\" + text);\n    }\n}\n```\n\n## \n\n```\n@Service\npublic class Publisher {\n    @Resource\n    private JmsMessagingTemplate jmsMessagingTemplate;\n\n    public void publish(String destName, String message) {\n        Destination destination = new ActiveMQTopic(destName);\n\n        jmsMessagingTemplate.convertAndSend(destination, message);\n    }\n}\n```\n\n## \n\n```\n@Service\npublic class Subscriber {\n    @JmsListener(destination = \"test.topic\", containerFactory = \"myJmsContainerFactory\")\n    public void subscribe(String text) {\n        System.out.println(\"===<<<<:\" + text);\n    }\n\n    @Bean\n    JmsListenerContainerFactory myJmsContainerFactory(ConnectionFactory connectionFactory) {\n        SimpleJmsListenerContainerFactory factory = new SimpleJmsListenerContainerFactory();\n        factory.setConnectionFactory(connectionFactory);\n        factory.setPubSubDomain(true);\n        return factory;\n    }\n}\n```\n\npub/subcontainerFactory\n\n> [github](https://github.com/wangweiye01/activemq)\n","slug":"activemq","published":1,"updated":"2019-12-24T02:00:57.340Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jvd00040j9kiqq6twc1","content":"<h1 id=\"activemq\"><a href=\"#activemq\" class=\"headerlink\" title=\"activemq\"></a>activemq</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><a href=\"http://activemq.apache.org/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -zxvf apache-activemq-5.14.0-bin.tar.gz</span><br></pre></td></tr></table></figure>\n<p>bin cd apache-activemq-5.14.0/bin  ./activemq start</p>\n<h2 id=\"web\"><a href=\"#web\" class=\"headerlink\" title=\"web\"></a>web</h2><p><a href=\"http://IP:8161/admin\" target=\"_blank\" rel=\"noopener\">http://IP:8161/admin</a></p>\n<p>activeMQtcp:61616web:8161confxmlhttpjetty</p>\n<h1 id=\"activemq\"><a href=\"#activemq\" class=\"headerlink\" title=\"activemq\"></a>activemq</h1><h2 id=\"application-properties\"><a href=\"#application-properties\" class=\"headerlink\" title=\"application.properties\"></a>application.properties</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.activemq.broker-url=tcp://localhost:61616 </span><br><span class=\"line\">spring.activemq.user=admin </span><br><span class=\"line\">spring.activemq.password=admin </span><br><span class=\"line\">spring.activemq.pool.enabled=false</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Service</span><br><span class=\"line\">public class Producer &#123;</span><br><span class=\"line\">    @Resource</span><br><span class=\"line\">    private JmsMessagingTemplate jmsMessagingTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void sendMsg(String destName, String message) &#123;</span><br><span class=\"line\">        Destination destination = new ActiveMQQueue(destName);</span><br><span class=\"line\">        jmsMessagingTemplate.convertAndSend(destination, message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Service</span><br><span class=\"line\">public class Consumer &#123;</span><br><span class=\"line\">    @JmsListener(destination = &quot;test.queue&quot;)</span><br><span class=\"line\">    public void receiveMsg(String text) &#123;</span><br><span class=\"line\">        System.out.println(&quot;&gt;&gt;&gt;&gt;-&gt;&gt;&gt;:&quot; + text);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Service</span><br><span class=\"line\">public class Publisher &#123;</span><br><span class=\"line\">    @Resource</span><br><span class=\"line\">    private JmsMessagingTemplate jmsMessagingTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void publish(String destName, String message) &#123;</span><br><span class=\"line\">        Destination destination = new ActiveMQTopic(destName);</span><br><span class=\"line\"></span><br><span class=\"line\">        jmsMessagingTemplate.convertAndSend(destination, message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Service</span><br><span class=\"line\">public class Subscriber &#123;</span><br><span class=\"line\">    @JmsListener(destination = &quot;test.topic&quot;, containerFactory = &quot;myJmsContainerFactory&quot;)</span><br><span class=\"line\">    public void subscribe(String text) &#123;</span><br><span class=\"line\">        System.out.println(&quot;===&lt;&lt;&lt;&lt;:&quot; + text);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Bean</span><br><span class=\"line\">    JmsListenerContainerFactory myJmsContainerFactory(ConnectionFactory connectionFactory) &#123;</span><br><span class=\"line\">        SimpleJmsListenerContainerFactory factory = new SimpleJmsListenerContainerFactory();</span><br><span class=\"line\">        factory.setConnectionFactory(connectionFactory);</span><br><span class=\"line\">        factory.setPubSubDomain(true);</span><br><span class=\"line\">        return factory;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>pub/subcontainerFactory</p>\n<blockquote>\n<p><a href=\"https://github.com/wangweiye01/activemq\" target=\"_blank\" rel=\"noopener\">github</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"activemq\"><a href=\"#activemq\" class=\"headerlink\" title=\"activemq\"></a>activemq</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><a href=\"http://activemq.apache.org/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -zxvf apache-activemq-5.14.0-bin.tar.gz</span><br></pre></td></tr></table></figure>\n<p>bin cd apache-activemq-5.14.0/bin  ./activemq start</p>\n<h2 id=\"web\"><a href=\"#web\" class=\"headerlink\" title=\"web\"></a>web</h2><p><a href=\"http://IP:8161/admin\" target=\"_blank\" rel=\"noopener\">http://IP:8161/admin</a></p>\n<p>activeMQtcp:61616web:8161confxmlhttpjetty</p>\n<h1 id=\"activemq\"><a href=\"#activemq\" class=\"headerlink\" title=\"activemq\"></a>activemq</h1><h2 id=\"application-properties\"><a href=\"#application-properties\" class=\"headerlink\" title=\"application.properties\"></a>application.properties</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.activemq.broker-url=tcp://localhost:61616 </span><br><span class=\"line\">spring.activemq.user=admin </span><br><span class=\"line\">spring.activemq.password=admin </span><br><span class=\"line\">spring.activemq.pool.enabled=false</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Service</span><br><span class=\"line\">public class Producer &#123;</span><br><span class=\"line\">    @Resource</span><br><span class=\"line\">    private JmsMessagingTemplate jmsMessagingTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void sendMsg(String destName, String message) &#123;</span><br><span class=\"line\">        Destination destination = new ActiveMQQueue(destName);</span><br><span class=\"line\">        jmsMessagingTemplate.convertAndSend(destination, message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Service</span><br><span class=\"line\">public class Consumer &#123;</span><br><span class=\"line\">    @JmsListener(destination = &quot;test.queue&quot;)</span><br><span class=\"line\">    public void receiveMsg(String text) &#123;</span><br><span class=\"line\">        System.out.println(&quot;&gt;&gt;&gt;&gt;-&gt;&gt;&gt;:&quot; + text);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Service</span><br><span class=\"line\">public class Publisher &#123;</span><br><span class=\"line\">    @Resource</span><br><span class=\"line\">    private JmsMessagingTemplate jmsMessagingTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void publish(String destName, String message) &#123;</span><br><span class=\"line\">        Destination destination = new ActiveMQTopic(destName);</span><br><span class=\"line\"></span><br><span class=\"line\">        jmsMessagingTemplate.convertAndSend(destination, message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Service</span><br><span class=\"line\">public class Subscriber &#123;</span><br><span class=\"line\">    @JmsListener(destination = &quot;test.topic&quot;, containerFactory = &quot;myJmsContainerFactory&quot;)</span><br><span class=\"line\">    public void subscribe(String text) &#123;</span><br><span class=\"line\">        System.out.println(&quot;===&lt;&lt;&lt;&lt;:&quot; + text);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Bean</span><br><span class=\"line\">    JmsListenerContainerFactory myJmsContainerFactory(ConnectionFactory connectionFactory) &#123;</span><br><span class=\"line\">        SimpleJmsListenerContainerFactory factory = new SimpleJmsListenerContainerFactory();</span><br><span class=\"line\">        factory.setConnectionFactory(connectionFactory);</span><br><span class=\"line\">        factory.setPubSubDomain(true);</span><br><span class=\"line\">        return factory;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>pub/subcontainerFactory</p>\n<blockquote>\n<p><a href=\"https://github.com/wangweiye01/activemq\" target=\"_blank\" rel=\"noopener\">github</a></p>\n</blockquote>\n"},{"title":"","date":"2017-11-30T14:45:06.000Z","_content":"# \n\n- cachecache \n- cache \n- cache\n\n \n![](http://img.blog.csdn.net/20170726111231331?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n![](http://img.blog.csdn.net/20170726111304065?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n# ?\n\n\n\n## cache\n\nA,BA,BACAB\n\n## cache\n\nA,BABBBAA\n\n## cache\n\n-  \n-  \n- \n\n****\n","source":"_posts/cache-db.md","raw":"---\ntitle: \ndate: 2017-11-30 22:45:06\ntags:\n---\n# \n\n- cachecache \n- cache \n- cache\n\n \n![](http://img.blog.csdn.net/20170726111231331?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n![](http://img.blog.csdn.net/20170726111304065?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n# ?\n\n\n\n## cache\n\nA,BA,BACAB\n\n## cache\n\nA,BABBBAA\n\n## cache\n\n-  \n-  \n- \n\n****\n","slug":"cache-db","published":1,"updated":"2019-12-24T02:00:57.340Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jvf00050j9kvt31e09o","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>cachecache </li>\n<li>cache </li>\n<li>cache</li>\n</ul>\n<p><br><img src=\"http://img.blog.csdn.net/20170726111231331?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"\"></p>\n<p><img src=\"http://img.blog.csdn.net/20170726111304065?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"?\"></a>?</h1><p></p>\n<h2 id=\"cache\"><a href=\"#cache\" class=\"headerlink\" title=\"cache\"></a>cache</h2><p>A,BA,BACAB</p>\n<h2 id=\"cache\"><a href=\"#cache\" class=\"headerlink\" title=\"cache\"></a>cache</h2><p>A,BABBBAA</p>\n<h2 id=\"cache\"><a href=\"#cache\" class=\"headerlink\" title=\"cache\"></a>cache</h2><ul>\n<li> </li>\n<li> </li>\n<li></li>\n</ul>\n<p><strong></strong></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>cachecache </li>\n<li>cache </li>\n<li>cache</li>\n</ul>\n<p><br><img src=\"http://img.blog.csdn.net/20170726111231331?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"\"></p>\n<p><img src=\"http://img.blog.csdn.net/20170726111304065?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"?\"></a>?</h1><p></p>\n<h2 id=\"cache\"><a href=\"#cache\" class=\"headerlink\" title=\"cache\"></a>cache</h2><p>A,BA,BACAB</p>\n<h2 id=\"cache\"><a href=\"#cache\" class=\"headerlink\" title=\"cache\"></a>cache</h2><p>A,BABBBAA</p>\n<h2 id=\"cache\"><a href=\"#cache\" class=\"headerlink\" title=\"cache\"></a>cache</h2><ul>\n<li> </li>\n<li> </li>\n<li></li>\n</ul>\n<p><strong></strong></p>\n"},{"title":"","date":"2017-11-29T03:35:30.000Z","_content":"\n# (CSRF)\n\n## \n\n\n\n## \n\nlist.phpURLidURL\n\n```\nhttp://localhost/list.php?action=delete&id=12\n```\n\nCSFR http://test.com/csrf.php html\n\n```\n<img alt=\"\" src=\"http://localhost/list.php?action=delete&id=12\"/>\n```\n\n## post\n\n```\n<?php\n$action=$_POST['action'];\n$id=$_POST['id'];\ndelete($action,$id);\n?>\n```\n\n```\n<!DOCTYPE html>\n<html>\n<body>\n<iframe display=\"none\">\n<form method=\"post\" action=\"http://localhost/list.php\">\n<input type=\"hidden\" name=\"action\" value=\"delete\">\n <input type=\"hidden\" name=\"id\" value=\"12\">\n<input id=\"csfr\" type=\"submit\"/>\n</form>\n</iframe>\n\n<script type=\"text/javascript\">\n document.getElementById('csfr').submit();\n</script>\n</body>\n</html>\n```\n\n## \n\n1. postget\n2. \n3. \n\n# (XSS)\n\n## \n\n(Cross Site ScriptCSSXSS)WebhtmlWebhtm\nl\n\n## \n\n\n```\n<!DOCTYPE html>\n<html>\n<head>\n<?php include('/components/headerinclude.php');?></head>\n<style type=\"text/css\">\n.comment-title{\n    font-size:14px;\nmargin: 6px 0px 2px 4px;\n}\n\n.comment-body{\n    font-size: 14px;\ncolor:#ccc;\n      font-style: italic;\n      border-bottom: dashed 1px #ccc;\nmargin: 4px;\n}\n</style>\n<script type=\"text/javascript\" src=\"/js/cookies.js\"></script>\n<body>\n<form method=\"post\" action=\"list.php\">\n<div style=\"margin:20px;\">\n<div style=\"font-size:16px;font-weight:bold;\">Your Comment</div>\n<div style=\"padding:6px;\">\nNick Name:\n<br/>\n<input name=\"name\" type=\"text\" style=\"width:300px;\"/>\n</div>\n<div style=\"padding:6px;\">\nComment:\n<br/>\n<textarea name=\"comment\" style=\"height:100px; width:300px;\"></textarea>\n</div>\n<div style=\"padding-left:230px;\">\n<input type=\"submit\" value=\"POST\" style=\"padding:4px 0px; width:80px;\"/>\n</div>\n<div style=\"border-bottom:solid 1px #fff;margin-top:10px;\">\n<div style=\"font-size:16px;font-weight:bold;\">Comments</div>\n</div>\n<?php \nrequire('/components/comments.php'); \nif(!empty($_POST['name'])){\n    addElement($_POST['name'],$_POST['comment']);\n}\nrenderComments();\n?>\n</div>\n</form>\n</body>\n</html>\n```\naddElement()renderComments()\n![](http://img.blog.csdn.net/20171008105555518?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n\n![](http://img.blog.csdn.net/20171008104916455?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\nHey you are a fool fish!\n\n\n## \n\nXSS<,>XSSASP.NETvalidateRequestXSS[XSS](http://www.cnblogs.com/dsky/archive/2012/04/06/2434768.html)\n\n","source":"_posts/defent.md","raw":"---\ntitle: \ndate: 2017-11-29 11:35:30\ntags:\n---\n\n# (CSRF)\n\n## \n\n\n\n## \n\nlist.phpURLidURL\n\n```\nhttp://localhost/list.php?action=delete&id=12\n```\n\nCSFR http://test.com/csrf.php html\n\n```\n<img alt=\"\" src=\"http://localhost/list.php?action=delete&id=12\"/>\n```\n\n## post\n\n```\n<?php\n$action=$_POST['action'];\n$id=$_POST['id'];\ndelete($action,$id);\n?>\n```\n\n```\n<!DOCTYPE html>\n<html>\n<body>\n<iframe display=\"none\">\n<form method=\"post\" action=\"http://localhost/list.php\">\n<input type=\"hidden\" name=\"action\" value=\"delete\">\n <input type=\"hidden\" name=\"id\" value=\"12\">\n<input id=\"csfr\" type=\"submit\"/>\n</form>\n</iframe>\n\n<script type=\"text/javascript\">\n document.getElementById('csfr').submit();\n</script>\n</body>\n</html>\n```\n\n## \n\n1. postget\n2. \n3. \n\n# (XSS)\n\n## \n\n(Cross Site ScriptCSSXSS)WebhtmlWebhtm\nl\n\n## \n\n\n```\n<!DOCTYPE html>\n<html>\n<head>\n<?php include('/components/headerinclude.php');?></head>\n<style type=\"text/css\">\n.comment-title{\n    font-size:14px;\nmargin: 6px 0px 2px 4px;\n}\n\n.comment-body{\n    font-size: 14px;\ncolor:#ccc;\n      font-style: italic;\n      border-bottom: dashed 1px #ccc;\nmargin: 4px;\n}\n</style>\n<script type=\"text/javascript\" src=\"/js/cookies.js\"></script>\n<body>\n<form method=\"post\" action=\"list.php\">\n<div style=\"margin:20px;\">\n<div style=\"font-size:16px;font-weight:bold;\">Your Comment</div>\n<div style=\"padding:6px;\">\nNick Name:\n<br/>\n<input name=\"name\" type=\"text\" style=\"width:300px;\"/>\n</div>\n<div style=\"padding:6px;\">\nComment:\n<br/>\n<textarea name=\"comment\" style=\"height:100px; width:300px;\"></textarea>\n</div>\n<div style=\"padding-left:230px;\">\n<input type=\"submit\" value=\"POST\" style=\"padding:4px 0px; width:80px;\"/>\n</div>\n<div style=\"border-bottom:solid 1px #fff;margin-top:10px;\">\n<div style=\"font-size:16px;font-weight:bold;\">Comments</div>\n</div>\n<?php \nrequire('/components/comments.php'); \nif(!empty($_POST['name'])){\n    addElement($_POST['name'],$_POST['comment']);\n}\nrenderComments();\n?>\n</div>\n</form>\n</body>\n</html>\n```\naddElement()renderComments()\n![](http://img.blog.csdn.net/20171008105555518?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n\n![](http://img.blog.csdn.net/20171008104916455?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\nHey you are a fool fish!\n\n\n## \n\nXSS<,>XSSASP.NETvalidateRequestXSS[XSS](http://www.cnblogs.com/dsky/archive/2012/04/06/2434768.html)\n\n","slug":"defent","published":1,"updated":"2019-12-24T02:00:57.340Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jvg00060j9krkkrqecu","content":"<h1 id=\"-CSRF\"><a href=\"#-CSRF\" class=\"headerlink\" title=\"(CSRF)\"></a>(CSRF)</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>list.phpURLidURL</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://localhost/list.php?action=delete&amp;id=12</span><br></pre></td></tr></table></figure>\n<p>CSFR <a href=\"http://test.com/csrf.php\" target=\"_blank\" rel=\"noopener\">http://test.com/csrf.php</a> html<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;img alt=&quot;&quot; src=&quot;http://localhost/list.php?action=delete&amp;id=12&quot;/&gt;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"post\"><a href=\"#post\" class=\"headerlink\" title=\"post\"></a>post</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">$action=$_POST[&apos;action&apos;];</span><br><span class=\"line\">$id=$_POST[&apos;id&apos;];</span><br><span class=\"line\">delete($action,$id);</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">&lt;iframe display=&quot;none&quot;&gt;</span><br><span class=\"line\">&lt;form method=&quot;post&quot; action=&quot;http://localhost/list.php&quot;&gt;</span><br><span class=\"line\">&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;delete&quot;&gt;</span><br><span class=\"line\"> &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;12&quot;&gt;</span><br><span class=\"line\">&lt;input id=&quot;csfr&quot; type=&quot;submit&quot;/&gt;</span><br><span class=\"line\">&lt;/form&gt;</span><br><span class=\"line\">&lt;/iframe&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class=\"line\"> document.getElementById(&apos;csfr&apos;).submit();</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li>postget</li>\n<li></li>\n<li></li>\n</ol>\n<h1 id=\"-XSS\"><a href=\"#-XSS\" class=\"headerlink\" title=\"(XSS)\"></a>(XSS)</h1><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p>(Cross Site ScriptCSSXSS)WebhtmlWebhtm<br>l</p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">&lt;head&gt;</span><br><span class=\"line\">&lt;?php include(&apos;/components/headerinclude.php&apos;);?&gt;&lt;/head&gt;</span><br><span class=\"line\">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class=\"line\">.comment-title&#123;</span><br><span class=\"line\">    font-size:14px;</span><br><span class=\"line\">margin: 6px 0px 2px 4px;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">.comment-body&#123;</span><br><span class=\"line\">    font-size: 14px;</span><br><span class=\"line\">color:#ccc;</span><br><span class=\"line\">      font-style: italic;</span><br><span class=\"line\">      border-bottom: dashed 1px #ccc;</span><br><span class=\"line\">margin: 4px;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/style&gt;</span><br><span class=\"line\">&lt;script type=&quot;text/javascript&quot; src=&quot;/js/cookies.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">&lt;form method=&quot;post&quot; action=&quot;list.php&quot;&gt;</span><br><span class=\"line\">&lt;div style=&quot;margin:20px;&quot;&gt;</span><br><span class=\"line\">&lt;div style=&quot;font-size:16px;font-weight:bold;&quot;&gt;Your Comment&lt;/div&gt;</span><br><span class=\"line\">&lt;div style=&quot;padding:6px;&quot;&gt;</span><br><span class=\"line\">Nick Name:</span><br><span class=\"line\">&lt;br/&gt;</span><br><span class=\"line\">&lt;input name=&quot;name&quot; type=&quot;text&quot; style=&quot;width:300px;&quot;/&gt;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\">&lt;div style=&quot;padding:6px;&quot;&gt;</span><br><span class=\"line\">Comment:</span><br><span class=\"line\">&lt;br/&gt;</span><br><span class=\"line\">&lt;textarea name=&quot;comment&quot; style=&quot;height:100px; width:300px;&quot;&gt;&lt;/textarea&gt;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\">&lt;div style=&quot;padding-left:230px;&quot;&gt;</span><br><span class=\"line\">&lt;input type=&quot;submit&quot; value=&quot;POST&quot; style=&quot;padding:4px 0px; width:80px;&quot;/&gt;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\">&lt;div style=&quot;border-bottom:solid 1px #fff;margin-top:10px;&quot;&gt;</span><br><span class=\"line\">&lt;div style=&quot;font-size:16px;font-weight:bold;&quot;&gt;Comments&lt;/div&gt;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\">&lt;?php </span><br><span class=\"line\">require(&apos;/components/comments.php&apos;); </span><br><span class=\"line\">if(!empty($_POST[&apos;name&apos;]))&#123;</span><br><span class=\"line\">    addElement($_POST[&apos;name&apos;],$_POST[&apos;comment&apos;]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">renderComments();</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\">&lt;/form&gt;</span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>\n<p>addElement()renderComments()<br><img src=\"http://img.blog.csdn.net/20171008105555518?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"\"></p>\n<p><br><img src=\"http://img.blog.csdn.net/20171008104916455?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"\"><br>Hey you are a fool fish!<br></p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p>XSS&lt;,&gt;XSSASP.NETvalidateRequestXSS<a href=\"http://www.cnblogs.com/dsky/archive/2012/04/06/2434768.html\" target=\"_blank\" rel=\"noopener\">XSS</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"-CSRF\"><a href=\"#-CSRF\" class=\"headerlink\" title=\"(CSRF)\"></a>(CSRF)</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>list.phpURLidURL</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://localhost/list.php?action=delete&amp;id=12</span><br></pre></td></tr></table></figure>\n<p>CSFR <a href=\"http://test.com/csrf.php\" target=\"_blank\" rel=\"noopener\">http://test.com/csrf.php</a> html<br><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;img alt=&quot;&quot; src=&quot;http://localhost/list.php?action=delete&amp;id=12&quot;/&gt;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"post\"><a href=\"#post\" class=\"headerlink\" title=\"post\"></a>post</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">$action=$_POST[&apos;action&apos;];</span><br><span class=\"line\">$id=$_POST[&apos;id&apos;];</span><br><span class=\"line\">delete($action,$id);</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">&lt;iframe display=&quot;none&quot;&gt;</span><br><span class=\"line\">&lt;form method=&quot;post&quot; action=&quot;http://localhost/list.php&quot;&gt;</span><br><span class=\"line\">&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;delete&quot;&gt;</span><br><span class=\"line\"> &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;12&quot;&gt;</span><br><span class=\"line\">&lt;input id=&quot;csfr&quot; type=&quot;submit&quot;/&gt;</span><br><span class=\"line\">&lt;/form&gt;</span><br><span class=\"line\">&lt;/iframe&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class=\"line\"> document.getElementById(&apos;csfr&apos;).submit();</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li>postget</li>\n<li></li>\n<li></li>\n</ol>\n<h1 id=\"-XSS\"><a href=\"#-XSS\" class=\"headerlink\" title=\"(XSS)\"></a>(XSS)</h1><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p>(Cross Site ScriptCSSXSS)WebhtmlWebhtm<br>l</p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">&lt;head&gt;</span><br><span class=\"line\">&lt;?php include(&apos;/components/headerinclude.php&apos;);?&gt;&lt;/head&gt;</span><br><span class=\"line\">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class=\"line\">.comment-title&#123;</span><br><span class=\"line\">    font-size:14px;</span><br><span class=\"line\">margin: 6px 0px 2px 4px;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">.comment-body&#123;</span><br><span class=\"line\">    font-size: 14px;</span><br><span class=\"line\">color:#ccc;</span><br><span class=\"line\">      font-style: italic;</span><br><span class=\"line\">      border-bottom: dashed 1px #ccc;</span><br><span class=\"line\">margin: 4px;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/style&gt;</span><br><span class=\"line\">&lt;script type=&quot;text/javascript&quot; src=&quot;/js/cookies.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">&lt;form method=&quot;post&quot; action=&quot;list.php&quot;&gt;</span><br><span class=\"line\">&lt;div style=&quot;margin:20px;&quot;&gt;</span><br><span class=\"line\">&lt;div style=&quot;font-size:16px;font-weight:bold;&quot;&gt;Your Comment&lt;/div&gt;</span><br><span class=\"line\">&lt;div style=&quot;padding:6px;&quot;&gt;</span><br><span class=\"line\">Nick Name:</span><br><span class=\"line\">&lt;br/&gt;</span><br><span class=\"line\">&lt;input name=&quot;name&quot; type=&quot;text&quot; style=&quot;width:300px;&quot;/&gt;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\">&lt;div style=&quot;padding:6px;&quot;&gt;</span><br><span class=\"line\">Comment:</span><br><span class=\"line\">&lt;br/&gt;</span><br><span class=\"line\">&lt;textarea name=&quot;comment&quot; style=&quot;height:100px; width:300px;&quot;&gt;&lt;/textarea&gt;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\">&lt;div style=&quot;padding-left:230px;&quot;&gt;</span><br><span class=\"line\">&lt;input type=&quot;submit&quot; value=&quot;POST&quot; style=&quot;padding:4px 0px; width:80px;&quot;/&gt;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\">&lt;div style=&quot;border-bottom:solid 1px #fff;margin-top:10px;&quot;&gt;</span><br><span class=\"line\">&lt;div style=&quot;font-size:16px;font-weight:bold;&quot;&gt;Comments&lt;/div&gt;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\">&lt;?php </span><br><span class=\"line\">require(&apos;/components/comments.php&apos;); </span><br><span class=\"line\">if(!empty($_POST[&apos;name&apos;]))&#123;</span><br><span class=\"line\">    addElement($_POST[&apos;name&apos;],$_POST[&apos;comment&apos;]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">renderComments();</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\">&lt;/form&gt;</span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>\n<p>addElement()renderComments()<br><img src=\"http://img.blog.csdn.net/20171008105555518?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"\"></p>\n<p><br><img src=\"http://img.blog.csdn.net/20171008104916455?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"\"><br>Hey you are a fool fish!<br></p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p>XSS&lt;,&gt;XSSASP.NETvalidateRequestXSS<a href=\"http://www.cnblogs.com/dsky/archive/2012/04/06/2434768.html\" target=\"_blank\" rel=\"noopener\">XSS</a></p>\n"},{"title":"","date":"2019-02-13T01:52:28.000Z","_content":"\n# \n\nCAPConsistencyAvailabilityPartition tolerance\n\n````JavaAPIAPIJava Api\n\n# \n\n1. ;\n2. ;\n3. ;\n4. ;\n5. ;\n6. \n\n# Redis\n\n## Redis\n\n- `SETNX key val` keysetkeyval1key0\n- `expire key timeout` keysecond\n- `delete key` key\n\n## \n\n1. setnxexpirevalueUUID\n2. \n3. UUIDdelete\n\n## Redis\n\n``` java\nimport redis.clients.jedis.Jedis;\n\nimport java.util.Collections;\n\npublic class RedisTool {\n\n    private static final String LOCK_SUCCESS = \"OK\";\n    private static final String SET_IF_NOT_EXIST = \"NX\";\n    private static final String SET_WITH_EXPIRE_TIME = \"PX\";\n\n    /**\n     * \n     *\n     * @param jedis      Redis\n     * @param lockKey    \n     * @param requestId  \n     * @param expireTime \n     * @return \n     */\n    public static boolean tryGetDistributedLock(Jedis jedis, String lockKey, String requestId, int expireTime) {\n\n        String result = jedis.set(lockKey, requestId, SET_IF_NOT_EXIST, SET_WITH_EXPIRE_TIME, expireTime);\n\n        if (LOCK_SUCCESS.equals(result)) {\n            return true;\n        }\n        return false;\n    }\n\n    private static final Long RELEASE_SUCCESS = 1L;\n\n    /**\n     * \n     *\n     * @param jedis     Redis\n     * @param lockKey   \n     * @param requestId \n     * @return \n     */\n    public boolean releaseDistributedLock(Jedis jedis, String lockKey, String requestId) {\n\n        String script = \"if redis.call('get', KEYS[1]) == ARGV[1] then return redis.call('del', KEYS[1]) else return 0 end\";\n        Object result = jedis.eval(script, Collections.singletonList(lockKey), Collections.singletonList(requestId));\n\n        if (RELEASE_SUCCESS.equals(result)) {\n            return true;\n        }\n        return false;\n\n    }\n}\n```\n\n## \n\n``` java\nimport cc.wangweiye.distributelock.DistributedLock;\nimport redis.clients.jedis.Jedis;\nimport redis.clients.jedis.JedisPool;\nimport redis.clients.jedis.JedisPoolConfig;\n\nimport java.util.UUID;\n\npublic class Service2 {\n\n    private static JedisPool pool = null;\n    private RedisTool lock = new RedisTool();\n\n    int n = 500;\n\n    static {\n        JedisPoolConfig config = new JedisPoolConfig();\n        // \n        config.setMaxTotal(500);\n        // \n        config.setMaxIdle(8);\n        // \n        config.setMaxWaitMillis(1000 * 100);\n        // borrowjedistruejedis\n        config.setTestOnBorrow(true);\n        pool = new JedisPool(config, \"127.0.0.1\", 6379, 3000);\n    }\n\n    public void seckill() {\n        Jedis jedis = pool.getResource();\n        // value\n        String uuid = UUID.randomUUID().toString();\n\n        while (true) {\n            boolean locked = lock.tryGetDistributedLock(jedis, \"resource\", uuid, 500);\n\n            if (locked) {\n                System.out.println(Thread.currentThread().getName() + \"\");\n                System.out.println(--n);\n                break;\n            }\n        }\n\n        lock.releaseDistributedLock(jedis, \"resource\", uuid);\n    }\n}\n```\n\n## \n\n``` java\npublic class ThreadB extends Thread {\n    private Service2 service2;\n\n    public ThreadB(Service2 service2) {\n        this.service2 = service2;\n    }\n\n    @Override\n    public void run() {\n        service2.seckill();\n    }\n}\n```\n\n## \n\n``` java\npublic class Test2 {\n    public static void main(String[] args) {\n        Service2 service2 = new Service2();\n        for (int i = 0; i < 499; i++) {\n            ThreadB threadB = new ThreadB(service2);\n            threadB.start();\n        }\n    }\n}\n```\n","source":"_posts/distribute-lock.md","raw":"---\ntitle: \ndate: 2019-02-13 09:52:28\ntags:\n---\n\n# \n\nCAPConsistencyAvailabilityPartition tolerance\n\n````JavaAPIAPIJava Api\n\n# \n\n1. ;\n2. ;\n3. ;\n4. ;\n5. ;\n6. \n\n# Redis\n\n## Redis\n\n- `SETNX key val` keysetkeyval1key0\n- `expire key timeout` keysecond\n- `delete key` key\n\n## \n\n1. setnxexpirevalueUUID\n2. \n3. UUIDdelete\n\n## Redis\n\n``` java\nimport redis.clients.jedis.Jedis;\n\nimport java.util.Collections;\n\npublic class RedisTool {\n\n    private static final String LOCK_SUCCESS = \"OK\";\n    private static final String SET_IF_NOT_EXIST = \"NX\";\n    private static final String SET_WITH_EXPIRE_TIME = \"PX\";\n\n    /**\n     * \n     *\n     * @param jedis      Redis\n     * @param lockKey    \n     * @param requestId  \n     * @param expireTime \n     * @return \n     */\n    public static boolean tryGetDistributedLock(Jedis jedis, String lockKey, String requestId, int expireTime) {\n\n        String result = jedis.set(lockKey, requestId, SET_IF_NOT_EXIST, SET_WITH_EXPIRE_TIME, expireTime);\n\n        if (LOCK_SUCCESS.equals(result)) {\n            return true;\n        }\n        return false;\n    }\n\n    private static final Long RELEASE_SUCCESS = 1L;\n\n    /**\n     * \n     *\n     * @param jedis     Redis\n     * @param lockKey   \n     * @param requestId \n     * @return \n     */\n    public boolean releaseDistributedLock(Jedis jedis, String lockKey, String requestId) {\n\n        String script = \"if redis.call('get', KEYS[1]) == ARGV[1] then return redis.call('del', KEYS[1]) else return 0 end\";\n        Object result = jedis.eval(script, Collections.singletonList(lockKey), Collections.singletonList(requestId));\n\n        if (RELEASE_SUCCESS.equals(result)) {\n            return true;\n        }\n        return false;\n\n    }\n}\n```\n\n## \n\n``` java\nimport cc.wangweiye.distributelock.DistributedLock;\nimport redis.clients.jedis.Jedis;\nimport redis.clients.jedis.JedisPool;\nimport redis.clients.jedis.JedisPoolConfig;\n\nimport java.util.UUID;\n\npublic class Service2 {\n\n    private static JedisPool pool = null;\n    private RedisTool lock = new RedisTool();\n\n    int n = 500;\n\n    static {\n        JedisPoolConfig config = new JedisPoolConfig();\n        // \n        config.setMaxTotal(500);\n        // \n        config.setMaxIdle(8);\n        // \n        config.setMaxWaitMillis(1000 * 100);\n        // borrowjedistruejedis\n        config.setTestOnBorrow(true);\n        pool = new JedisPool(config, \"127.0.0.1\", 6379, 3000);\n    }\n\n    public void seckill() {\n        Jedis jedis = pool.getResource();\n        // value\n        String uuid = UUID.randomUUID().toString();\n\n        while (true) {\n            boolean locked = lock.tryGetDistributedLock(jedis, \"resource\", uuid, 500);\n\n            if (locked) {\n                System.out.println(Thread.currentThread().getName() + \"\");\n                System.out.println(--n);\n                break;\n            }\n        }\n\n        lock.releaseDistributedLock(jedis, \"resource\", uuid);\n    }\n}\n```\n\n## \n\n``` java\npublic class ThreadB extends Thread {\n    private Service2 service2;\n\n    public ThreadB(Service2 service2) {\n        this.service2 = service2;\n    }\n\n    @Override\n    public void run() {\n        service2.seckill();\n    }\n}\n```\n\n## \n\n``` java\npublic class Test2 {\n    public static void main(String[] args) {\n        Service2 service2 = new Service2();\n        for (int i = 0; i < 499; i++) {\n            ThreadB threadB = new ThreadB(service2);\n            threadB.start();\n        }\n    }\n}\n```\n","slug":"distribute-lock","published":1,"updated":"2019-12-24T02:00:57.340Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jvh00070j9k9bvdzv2m","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>CAPConsistencyAvailabilityPartition tolerance</p>\n<p><code></code><code></code>JavaAPIAPIJava Api</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ol>\n<li>;</li>\n<li>;</li>\n<li>;</li>\n<li>;</li>\n<li>;</li>\n<li></li>\n</ol>\n<h1 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h1><h2 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h2><ul>\n<li><code>SETNX key val</code> keysetkeyval1key0</li>\n<li><code>expire key timeout</code> keysecond</li>\n<li><code>delete key</code> key</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li>setnxexpirevalueUUID</li>\n<li></li>\n<li>UUIDdelete</li>\n</ol>\n<h2 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> redis.clients.jedis.Jedis;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Collections;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RedisTool</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String LOCK_SUCCESS = <span class=\"string\">\"OK\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String SET_IF_NOT_EXIST = <span class=\"string\">\"NX\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String SET_WITH_EXPIRE_TIME = <span class=\"string\">\"PX\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jedis      Redis</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> lockKey    </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> requestId  </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> expireTime </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">tryGetDistributedLock</span><span class=\"params\">(Jedis jedis, String lockKey, String requestId, <span class=\"keyword\">int</span> expireTime)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        String result = jedis.set(lockKey, requestId, SET_IF_NOT_EXIST, SET_WITH_EXPIRE_TIME, expireTime);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (LOCK_SUCCESS.equals(result)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Long RELEASE_SUCCESS = <span class=\"number\">1L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jedis     Redis</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> lockKey   </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> requestId </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">releaseDistributedLock</span><span class=\"params\">(Jedis jedis, String lockKey, String requestId)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        String script = <span class=\"string\">\"if redis.call('get', KEYS[1]) == ARGV[1] then return redis.call('del', KEYS[1]) else return 0 end\"</span>;</span><br><span class=\"line\">        Object result = jedis.eval(script, Collections.singletonList(lockKey), Collections.singletonList(requestId));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (RELEASE_SUCCESS.equals(result)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> cc.wangweiye.distributelock.DistributedLock;</span><br><span class=\"line\"><span class=\"keyword\">import</span> redis.clients.jedis.Jedis;</span><br><span class=\"line\"><span class=\"keyword\">import</span> redis.clients.jedis.JedisPool;</span><br><span class=\"line\"><span class=\"keyword\">import</span> redis.clients.jedis.JedisPoolConfig;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.UUID;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Service2</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> JedisPool pool = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> RedisTool lock = <span class=\"keyword\">new</span> RedisTool();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = <span class=\"number\">500</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        JedisPoolConfig config = <span class=\"keyword\">new</span> JedisPoolConfig();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        config.setMaxTotal(<span class=\"number\">500</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        config.setMaxIdle(<span class=\"number\">8</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        config.setMaxWaitMillis(<span class=\"number\">1000</span> * <span class=\"number\">100</span>);</span><br><span class=\"line\">        <span class=\"comment\">// borrowjedistruejedis</span></span><br><span class=\"line\">        config.setTestOnBorrow(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        pool = <span class=\"keyword\">new</span> JedisPool(config, <span class=\"string\">\"127.0.0.1\"</span>, <span class=\"number\">6379</span>, <span class=\"number\">3000</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">seckill</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        Jedis jedis = pool.getResource();</span><br><span class=\"line\">        <span class=\"comment\">// value</span></span><br><span class=\"line\">        String uuid = UUID.randomUUID().toString();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">boolean</span> locked = lock.tryGetDistributedLock(jedis, <span class=\"string\">\"resource\"</span>, uuid, <span class=\"number\">500</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (locked) &#123;</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                System.out.println(--n);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        lock.releaseDistributedLock(jedis, <span class=\"string\">\"resource\"</span>, uuid);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ThreadB</span> <span class=\"keyword\">extends</span> <span class=\"title\">Thread</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Service2 service2;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ThreadB</span><span class=\"params\">(Service2 service2)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.service2 = service2;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        service2.seckill();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test2</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Service2 service2 = <span class=\"keyword\">new</span> Service2();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">499</span>; i++) &#123;</span><br><span class=\"line\">            ThreadB threadB = <span class=\"keyword\">new</span> ThreadB(service2);</span><br><span class=\"line\">            threadB.start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>CAPConsistencyAvailabilityPartition tolerance</p>\n<p><code></code><code></code>JavaAPIAPIJava Api</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ol>\n<li>;</li>\n<li>;</li>\n<li>;</li>\n<li>;</li>\n<li>;</li>\n<li></li>\n</ol>\n<h1 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h1><h2 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h2><ul>\n<li><code>SETNX key val</code> keysetkeyval1key0</li>\n<li><code>expire key timeout</code> keysecond</li>\n<li><code>delete key</code> key</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li>setnxexpirevalueUUID</li>\n<li></li>\n<li>UUIDdelete</li>\n</ol>\n<h2 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> redis.clients.jedis.Jedis;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Collections;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RedisTool</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String LOCK_SUCCESS = <span class=\"string\">\"OK\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String SET_IF_NOT_EXIST = <span class=\"string\">\"NX\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String SET_WITH_EXPIRE_TIME = <span class=\"string\">\"PX\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jedis      Redis</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> lockKey    </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> requestId  </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> expireTime </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">tryGetDistributedLock</span><span class=\"params\">(Jedis jedis, String lockKey, String requestId, <span class=\"keyword\">int</span> expireTime)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        String result = jedis.set(lockKey, requestId, SET_IF_NOT_EXIST, SET_WITH_EXPIRE_TIME, expireTime);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (LOCK_SUCCESS.equals(result)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Long RELEASE_SUCCESS = <span class=\"number\">1L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jedis     Redis</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> lockKey   </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> requestId </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">releaseDistributedLock</span><span class=\"params\">(Jedis jedis, String lockKey, String requestId)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        String script = <span class=\"string\">\"if redis.call('get', KEYS[1]) == ARGV[1] then return redis.call('del', KEYS[1]) else return 0 end\"</span>;</span><br><span class=\"line\">        Object result = jedis.eval(script, Collections.singletonList(lockKey), Collections.singletonList(requestId));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (RELEASE_SUCCESS.equals(result)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> cc.wangweiye.distributelock.DistributedLock;</span><br><span class=\"line\"><span class=\"keyword\">import</span> redis.clients.jedis.Jedis;</span><br><span class=\"line\"><span class=\"keyword\">import</span> redis.clients.jedis.JedisPool;</span><br><span class=\"line\"><span class=\"keyword\">import</span> redis.clients.jedis.JedisPoolConfig;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.UUID;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Service2</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> JedisPool pool = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> RedisTool lock = <span class=\"keyword\">new</span> RedisTool();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = <span class=\"number\">500</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        JedisPoolConfig config = <span class=\"keyword\">new</span> JedisPoolConfig();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        config.setMaxTotal(<span class=\"number\">500</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        config.setMaxIdle(<span class=\"number\">8</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        config.setMaxWaitMillis(<span class=\"number\">1000</span> * <span class=\"number\">100</span>);</span><br><span class=\"line\">        <span class=\"comment\">// borrowjedistruejedis</span></span><br><span class=\"line\">        config.setTestOnBorrow(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        pool = <span class=\"keyword\">new</span> JedisPool(config, <span class=\"string\">\"127.0.0.1\"</span>, <span class=\"number\">6379</span>, <span class=\"number\">3000</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">seckill</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        Jedis jedis = pool.getResource();</span><br><span class=\"line\">        <span class=\"comment\">// value</span></span><br><span class=\"line\">        String uuid = UUID.randomUUID().toString();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">boolean</span> locked = lock.tryGetDistributedLock(jedis, <span class=\"string\">\"resource\"</span>, uuid, <span class=\"number\">500</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (locked) &#123;</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                System.out.println(--n);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        lock.releaseDistributedLock(jedis, <span class=\"string\">\"resource\"</span>, uuid);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ThreadB</span> <span class=\"keyword\">extends</span> <span class=\"title\">Thread</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Service2 service2;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ThreadB</span><span class=\"params\">(Service2 service2)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.service2 = service2;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        service2.seckill();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test2</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Service2 service2 = <span class=\"keyword\">new</span> Service2();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">499</span>; i++) &#123;</span><br><span class=\"line\">            ThreadB threadB = <span class=\"keyword\">new</span> ThreadB(service2);</span><br><span class=\"line\">            threadB.start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"docker","date":"2018-04-13T13:06:56.000Z","top":110,"_content":"\n![](http://www.wailian.work/images/2018/04/18/1211be9c.jpg)\n\n# Docker\n\nDocker  Linux  --[](https://baike.baidu.com/item/Docker/13344470?fr=aladdin)\n\nDocker\n\ndockerdocker --[](https://www.zhihu.com/question/28300645/answer/67707287)\n\n# \n\nDocker  Docker \n\n# \n\n\nDockerDocker\n\n# Docker\n\n## Mac\n\nMacDocker  [dmg](https://docs.docker.com/docker-for-mac/install/#download-docker-for-mac)\n\ndocker\n\n```\ndocker -v\n```\n\n## CentOS\n\n```\nyum install docker\n```\n\ndocker\n\n```\ndocker version\n```\n\n# Docker\n\n- [Docker](https://hub.docker.com) \n- [](https://c.163yun.com) \n\n# Spring Boot+Docker\n\n## Spring InitializrSpring Boot\n\n```\n@SpringBootApplication\n@RestController\npublic class DockerApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(DockerApplication.class, args);\n    }\n\n    @RequestMapping(\"/\")\n    public String home() {\n        return \"Hello Spring Boot, Docker and CloudComb!\";\n    }\n}\n```\n\n## jar\n\n```\nmvn clean package\n```\n\n![](http://www.wailian.work/images/2018/04/13/dabao.png)\n\n```\njava -jar docker-0.0.1-SNAPSHOT.jar\n```\n\n`http://127.0.0.1:8080`\n\n# \n\n## Dockerfile\n\n`Dockerfile`\n\n```\nFROM hub.c.163.com/bingohuang/jdk8:latest\n\nMAINTAINER wangweiye wwyknight@163.com\n\nCOPY target/docker-0.0.1-SNAPSHOT.jar app.jar\n\nENTRYPOINT [\"java\",\"-jar\",\"/app.jar\"]\n```\n\nDockerfile`java -jar /app.jar`\n\n## docker\n\n```\ndocker build -t spring-boot:latest .\n```\n\n`-t`docker\n\n[docker build](https://docs.docker.com/engine/reference/commandline/build/)\n\n## docker\n\n```\ndocker run -d -p 9999:8080 spring-boot\n```\n\n`-d` Run container in background and print container ID(ID)\n\n`-p` \n\n[docker run](https://docs.docker.com/engine/reference/commandline/run/)\n\n## \n\n`http://127.0.0.1:8080`\n\n## \n\n,[](https://www.163yun.com/?h=fc)\n\n\n\n```\ndocker login hub.c.163.com\nUsername: wwyknight@163.com\nPassword:\nLogin Succeeded\n```\n\n[](https://www.163yun.com/help/documents/15587826830438400)\n\n```\ndocker tag {ID} hub.c.163.com/{}/{}\n```\n\n`hub.c.163.com/{}/{}`\nAttention:  \n\n\n\n```\ndocker push hub.c.163.com/{}/{}\n```\n\n\n![](http://www.wailian.work/images/2018/04/13/12.png)\n","source":"_posts/docker.md","raw":"---\ntitle: docker\ndate: 2018-04-13 21:06:56\ntags:\ntop: 110\n---\n\n![](http://www.wailian.work/images/2018/04/18/1211be9c.jpg)\n\n# Docker\n\nDocker  Linux  --[](https://baike.baidu.com/item/Docker/13344470?fr=aladdin)\n\nDocker\n\ndockerdocker --[](https://www.zhihu.com/question/28300645/answer/67707287)\n\n# \n\nDocker  Docker \n\n# \n\n\nDockerDocker\n\n# Docker\n\n## Mac\n\nMacDocker  [dmg](https://docs.docker.com/docker-for-mac/install/#download-docker-for-mac)\n\ndocker\n\n```\ndocker -v\n```\n\n## CentOS\n\n```\nyum install docker\n```\n\ndocker\n\n```\ndocker version\n```\n\n# Docker\n\n- [Docker](https://hub.docker.com) \n- [](https://c.163yun.com) \n\n# Spring Boot+Docker\n\n## Spring InitializrSpring Boot\n\n```\n@SpringBootApplication\n@RestController\npublic class DockerApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(DockerApplication.class, args);\n    }\n\n    @RequestMapping(\"/\")\n    public String home() {\n        return \"Hello Spring Boot, Docker and CloudComb!\";\n    }\n}\n```\n\n## jar\n\n```\nmvn clean package\n```\n\n![](http://www.wailian.work/images/2018/04/13/dabao.png)\n\n```\njava -jar docker-0.0.1-SNAPSHOT.jar\n```\n\n`http://127.0.0.1:8080`\n\n# \n\n## Dockerfile\n\n`Dockerfile`\n\n```\nFROM hub.c.163.com/bingohuang/jdk8:latest\n\nMAINTAINER wangweiye wwyknight@163.com\n\nCOPY target/docker-0.0.1-SNAPSHOT.jar app.jar\n\nENTRYPOINT [\"java\",\"-jar\",\"/app.jar\"]\n```\n\nDockerfile`java -jar /app.jar`\n\n## docker\n\n```\ndocker build -t spring-boot:latest .\n```\n\n`-t`docker\n\n[docker build](https://docs.docker.com/engine/reference/commandline/build/)\n\n## docker\n\n```\ndocker run -d -p 9999:8080 spring-boot\n```\n\n`-d` Run container in background and print container ID(ID)\n\n`-p` \n\n[docker run](https://docs.docker.com/engine/reference/commandline/run/)\n\n## \n\n`http://127.0.0.1:8080`\n\n## \n\n,[](https://www.163yun.com/?h=fc)\n\n\n\n```\ndocker login hub.c.163.com\nUsername: wwyknight@163.com\nPassword:\nLogin Succeeded\n```\n\n[](https://www.163yun.com/help/documents/15587826830438400)\n\n```\ndocker tag {ID} hub.c.163.com/{}/{}\n```\n\n`hub.c.163.com/{}/{}`\nAttention:  \n\n\n\n```\ndocker push hub.c.163.com/{}/{}\n```\n\n\n![](http://www.wailian.work/images/2018/04/13/12.png)\n","slug":"docker","published":1,"updated":"2019-12-24T02:00:57.340Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jvj00080j9k8dyjv7ik","content":"<p><img src=\"http://www.wailian.work/images/2018/04/18/1211be9c.jpg\" alt=\"\"></p>\n<h1 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h1><p>Docker  Linux  <a href=\"https://baike.baidu.com/item/Docker/13344470?fr=aladdin\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p>Docker</p>\n<p>dockerdocker <a href=\"https://www.zhihu.com/question/28300645/answer/67707287\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Docker  Docker </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><br>DockerDocker</p>\n<h1 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h1><h2 id=\"Mac\"><a href=\"#Mac\" class=\"headerlink\" title=\"Mac\"></a>Mac</h2><p>MacDocker  <a href=\"https://docs.docker.com/docker-for-mac/install/#download-docker-for-mac\" target=\"_blank\" rel=\"noopener\">dmg</a></p>\n<p>docker</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker -v</span><br></pre></td></tr></table></figure>\n<h2 id=\"CentOS\"><a href=\"#CentOS\" class=\"headerlink\" title=\"CentOS\"></a>CentOS</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install docker</span><br></pre></td></tr></table></figure>\n<p>docker</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker version</span><br></pre></td></tr></table></figure>\n<h1 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h1><ul>\n<li><a href=\"https://hub.docker.com\" target=\"_blank\" rel=\"noopener\">Docker</a> </li>\n<li><a href=\"https://c.163yun.com\" target=\"_blank\" rel=\"noopener\"></a> </li>\n</ul>\n<h1 id=\"Spring-Boot-Docker\"><a href=\"#Spring-Boot-Docker\" class=\"headerlink\" title=\"Spring Boot+Docker\"></a>Spring Boot+Docker</h1><h2 id=\"Spring-InitializrSpring-Boot\"><a href=\"#Spring-InitializrSpring-Boot\" class=\"headerlink\" title=\"Spring InitializrSpring Boot\"></a>Spring InitializrSpring Boot</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">@RestController</span><br><span class=\"line\">public class DockerApplication &#123;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        SpringApplication.run(DockerApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @RequestMapping(&quot;/&quot;)</span><br><span class=\"line\">    public String home() &#123;</span><br><span class=\"line\">        return &quot;Hello Spring Boot, Docker and CloudComb!&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"jar\"><a href=\"#jar\" class=\"headerlink\" title=\"jar\"></a>jar</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mvn clean package</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://www.wailian.work/images/2018/04/13/dabao.png\" alt=\"\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java -jar docker-0.0.1-SNAPSHOT.jar</span><br></pre></td></tr></table></figure>\n<p><code>http://127.0.0.1:8080</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Dockerfile\"><a href=\"#Dockerfile\" class=\"headerlink\" title=\"Dockerfile\"></a>Dockerfile</h2><p><code>Dockerfile</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FROM hub.c.163.com/bingohuang/jdk8:latest</span><br><span class=\"line\"></span><br><span class=\"line\">MAINTAINER wangweiye wwyknight@163.com</span><br><span class=\"line\"></span><br><span class=\"line\">COPY target/docker-0.0.1-SNAPSHOT.jar app.jar</span><br><span class=\"line\"></span><br><span class=\"line\">ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]</span><br></pre></td></tr></table></figure>\n<p>Dockerfile<code>java -jar /app.jar</code></p>\n<h2 id=\"docker\"><a href=\"#docker\" class=\"headerlink\" title=\"docker\"></a>docker</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker build -t spring-boot:latest .</span><br></pre></td></tr></table></figure>\n<p><code>-t</code>docker</p>\n<p><a href=\"https://docs.docker.com/engine/reference/commandline/build/\" target=\"_blank\" rel=\"noopener\">docker build</a></p>\n<h2 id=\"docker\"><a href=\"#docker\" class=\"headerlink\" title=\"docker\"></a>docker</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d -p 9999:8080 spring-boot</span><br></pre></td></tr></table></figure>\n<p><code>-d</code> Run container in background and print container ID(ID)</p>\n<p><code>-p</code> </p>\n<p><a href=\"https://docs.docker.com/engine/reference/commandline/run/\" target=\"_blank\" rel=\"noopener\">docker run</a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>http://127.0.0.1:8080</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,<a href=\"https://www.163yun.com/?h=fc\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker login hub.c.163.com</span><br><span class=\"line\">Username: wwyknight@163.com</span><br><span class=\"line\">Password:</span><br><span class=\"line\">Login Succeeded</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://www.163yun.com/help/documents/15587826830438400\" target=\"_blank\" rel=\"noopener\"></a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker tag &#123;ID&#125; hub.c.163.com/&#123;&#125;/&#123;&#125;</span><br></pre></td></tr></table></figure>\n<p><code>hub.c.163.com/{}/{}</code><br>Attention:  <br><br></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker push hub.c.163.com/&#123;&#125;/&#123;&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"http://www.wailian.work/images/2018/04/13/12.png\" alt=\"\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/04/18/1211be9c.jpg\" alt=\"\"></p>\n<h1 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h1><p>Docker  Linux  <a href=\"https://baike.baidu.com/item/Docker/13344470?fr=aladdin\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p>Docker</p>\n<p>dockerdocker <a href=\"https://www.zhihu.com/question/28300645/answer/67707287\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Docker  Docker </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><br>DockerDocker</p>\n<h1 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h1><h2 id=\"Mac\"><a href=\"#Mac\" class=\"headerlink\" title=\"Mac\"></a>Mac</h2><p>MacDocker  <a href=\"https://docs.docker.com/docker-for-mac/install/#download-docker-for-mac\" target=\"_blank\" rel=\"noopener\">dmg</a></p>\n<p>docker</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker -v</span><br></pre></td></tr></table></figure>\n<h2 id=\"CentOS\"><a href=\"#CentOS\" class=\"headerlink\" title=\"CentOS\"></a>CentOS</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install docker</span><br></pre></td></tr></table></figure>\n<p>docker</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker version</span><br></pre></td></tr></table></figure>\n<h1 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h1><ul>\n<li><a href=\"https://hub.docker.com\" target=\"_blank\" rel=\"noopener\">Docker</a> </li>\n<li><a href=\"https://c.163yun.com\" target=\"_blank\" rel=\"noopener\"></a> </li>\n</ul>\n<h1 id=\"Spring-Boot-Docker\"><a href=\"#Spring-Boot-Docker\" class=\"headerlink\" title=\"Spring Boot+Docker\"></a>Spring Boot+Docker</h1><h2 id=\"Spring-InitializrSpring-Boot\"><a href=\"#Spring-InitializrSpring-Boot\" class=\"headerlink\" title=\"Spring InitializrSpring Boot\"></a>Spring InitializrSpring Boot</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">@RestController</span><br><span class=\"line\">public class DockerApplication &#123;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        SpringApplication.run(DockerApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @RequestMapping(&quot;/&quot;)</span><br><span class=\"line\">    public String home() &#123;</span><br><span class=\"line\">        return &quot;Hello Spring Boot, Docker and CloudComb!&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"jar\"><a href=\"#jar\" class=\"headerlink\" title=\"jar\"></a>jar</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mvn clean package</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://www.wailian.work/images/2018/04/13/dabao.png\" alt=\"\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java -jar docker-0.0.1-SNAPSHOT.jar</span><br></pre></td></tr></table></figure>\n<p><code>http://127.0.0.1:8080</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Dockerfile\"><a href=\"#Dockerfile\" class=\"headerlink\" title=\"Dockerfile\"></a>Dockerfile</h2><p><code>Dockerfile</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FROM hub.c.163.com/bingohuang/jdk8:latest</span><br><span class=\"line\"></span><br><span class=\"line\">MAINTAINER wangweiye wwyknight@163.com</span><br><span class=\"line\"></span><br><span class=\"line\">COPY target/docker-0.0.1-SNAPSHOT.jar app.jar</span><br><span class=\"line\"></span><br><span class=\"line\">ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]</span><br></pre></td></tr></table></figure>\n<p>Dockerfile<code>java -jar /app.jar</code></p>\n<h2 id=\"docker\"><a href=\"#docker\" class=\"headerlink\" title=\"docker\"></a>docker</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker build -t spring-boot:latest .</span><br></pre></td></tr></table></figure>\n<p><code>-t</code>docker</p>\n<p><a href=\"https://docs.docker.com/engine/reference/commandline/build/\" target=\"_blank\" rel=\"noopener\">docker build</a></p>\n<h2 id=\"docker\"><a href=\"#docker\" class=\"headerlink\" title=\"docker\"></a>docker</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d -p 9999:8080 spring-boot</span><br></pre></td></tr></table></figure>\n<p><code>-d</code> Run container in background and print container ID(ID)</p>\n<p><code>-p</code> </p>\n<p><a href=\"https://docs.docker.com/engine/reference/commandline/run/\" target=\"_blank\" rel=\"noopener\">docker run</a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>http://127.0.0.1:8080</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>,<a href=\"https://www.163yun.com/?h=fc\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker login hub.c.163.com</span><br><span class=\"line\">Username: wwyknight@163.com</span><br><span class=\"line\">Password:</span><br><span class=\"line\">Login Succeeded</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://www.163yun.com/help/documents/15587826830438400\" target=\"_blank\" rel=\"noopener\"></a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker tag &#123;ID&#125; hub.c.163.com/&#123;&#125;/&#123;&#125;</span><br></pre></td></tr></table></figure>\n<p><code>hub.c.163.com/{}/{}</code><br>Attention:  <br><br></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker push hub.c.163.com/&#123;&#125;/&#123;&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"http://www.wailian.work/images/2018/04/13/12.png\" alt=\"\"></p>\n"},{"title":"floyd","date":"2020-03-24T07:39:41.000Z","_content":"\n## floyd\n\n****\n\n## \n\n\n\n\n\n### \n\n13\n\n![6.10.png](http://s1.wailian.download/2020/03/24/6.10.png)\n\n1->2->3-1\n\n## \n\n![6.2-floyd.png](http://s1.wailian.download/2020/03/24/6.2-floyd.png)\n\n\n\n()0\n\n[![6.3-.png](http://s1.wailian.download/2020/03/24/6.3-.png)](http://www.wailian.work/image/Ae1zve)\n\nabka->k->ba->bk1ka->k1->k2>b\n\n4->31214->1->3111ije[i][1]+e[1][j]e[i][j]\n\n```python\n#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\nimport copy\n\n# 44\nm = [[0]*4 for i in range(4)]\n\n# \nm[0][0] = 0\nm[0][1] = 2\nm[0][2] = 6\nm[0][3] = 4\nm[1][0] = 9999\nm[1][1] = 0\nm[1][2] = 3\nm[1][3] = 9999\nm[2][0] = 7\nm[2][1] = 9999\nm[2][2] = 0\nm[2][3] = 1\nm[3][0] = 5\nm[3][1] = 9999\nm[3][2] = 12\nm[3][3] = 0\n\nprint(':', m)\n\n# 1\nn = copy.deepcopy(m)\ni = 0\nj = 0\n\nfor i in range(4):\n    for j in range(4):\n        if (n[i][j] > n[i][0] + n[0][j]):\n                n[i][j] = n[i][0] + n[0][j]\n\nprint('1:', n)\n```\n\n\n\n: [[0, 2, 6, 4], [9999, 0, 3, 9999], [7, 9999, 0, 1], [5, 9999, 12, 0]]\n\n1: [[0, 2, 6, 4], [9999, 0, 3, 9999], [7, 9, 0, 1], [5, 7, 11, 0]]\n\n![6.5-1.png](http://s1.wailian.download/2020/03/24/6.5-1.png)\n\n1,3->2,4->2,4->3\n\n1212ij\n\n```python\n# 2\no = copy.deepcopy(n)\ni = 0\nj = 0\n\nfor i in range(4):\n    for j in range(4):\n        if(o[i][j] > o[i][1] + o[1][j]):\n            o[i][j] = o[i][1] + o[1][j]\n\nprint('2:', o)\n```\n\n\n\n2: [[0, 2, 5, 4], [9999, 0, 3, 9999], [7, 9, 0, 1], [5, 7, 10, 0]]\n\n![6.6-1-2.png](http://s1.wailian.download/2020/03/24/6.6-1-2.png)\n\n\n123\n\n![6.7-1-2-3.png](http://s1.wailian.download/2020/03/24/6.7-1-2-3.png)\n\n\n\n\n![6.8-1-2-3-4.png](http://s1.wailian.download/2020/03/24/6.8-1-2-3-4.png)\n\n\n\n```python\nk = 0\ni = 0\nj = 0\n\nfor k in range(4):\n    for i in range(4):\n        for j in range(4):\n            if (m[i][j] > m[i][k] + m[k][j]):\n                m[i][j] = m[i][k] + m[k][j]\n\nprint(':', m)\n```\n\n: [[0, 2, 5, 4], [9, 0, 3, 4], [6, 8, 0, 1], [5, 7, 10, 0]]\n\n O(n<sup>3</sup>)\n","source":"_posts/floyd.md","raw":"---\ntitle: floyd\ndate: 2020-03-24 15:39:41\ntags:\n---\n\n## floyd\n\n****\n\n## \n\n\n\n\n\n### \n\n13\n\n![6.10.png](http://s1.wailian.download/2020/03/24/6.10.png)\n\n1->2->3-1\n\n## \n\n![6.2-floyd.png](http://s1.wailian.download/2020/03/24/6.2-floyd.png)\n\n\n\n()0\n\n[![6.3-.png](http://s1.wailian.download/2020/03/24/6.3-.png)](http://www.wailian.work/image/Ae1zve)\n\nabka->k->ba->bk1ka->k1->k2>b\n\n4->31214->1->3111ije[i][1]+e[1][j]e[i][j]\n\n```python\n#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\nimport copy\n\n# 44\nm = [[0]*4 for i in range(4)]\n\n# \nm[0][0] = 0\nm[0][1] = 2\nm[0][2] = 6\nm[0][3] = 4\nm[1][0] = 9999\nm[1][1] = 0\nm[1][2] = 3\nm[1][3] = 9999\nm[2][0] = 7\nm[2][1] = 9999\nm[2][2] = 0\nm[2][3] = 1\nm[3][0] = 5\nm[3][1] = 9999\nm[3][2] = 12\nm[3][3] = 0\n\nprint(':', m)\n\n# 1\nn = copy.deepcopy(m)\ni = 0\nj = 0\n\nfor i in range(4):\n    for j in range(4):\n        if (n[i][j] > n[i][0] + n[0][j]):\n                n[i][j] = n[i][0] + n[0][j]\n\nprint('1:', n)\n```\n\n\n\n: [[0, 2, 6, 4], [9999, 0, 3, 9999], [7, 9999, 0, 1], [5, 9999, 12, 0]]\n\n1: [[0, 2, 6, 4], [9999, 0, 3, 9999], [7, 9, 0, 1], [5, 7, 11, 0]]\n\n![6.5-1.png](http://s1.wailian.download/2020/03/24/6.5-1.png)\n\n1,3->2,4->2,4->3\n\n1212ij\n\n```python\n# 2\no = copy.deepcopy(n)\ni = 0\nj = 0\n\nfor i in range(4):\n    for j in range(4):\n        if(o[i][j] > o[i][1] + o[1][j]):\n            o[i][j] = o[i][1] + o[1][j]\n\nprint('2:', o)\n```\n\n\n\n2: [[0, 2, 5, 4], [9999, 0, 3, 9999], [7, 9, 0, 1], [5, 7, 10, 0]]\n\n![6.6-1-2.png](http://s1.wailian.download/2020/03/24/6.6-1-2.png)\n\n\n123\n\n![6.7-1-2-3.png](http://s1.wailian.download/2020/03/24/6.7-1-2-3.png)\n\n\n\n\n![6.8-1-2-3-4.png](http://s1.wailian.download/2020/03/24/6.8-1-2-3-4.png)\n\n\n\n```python\nk = 0\ni = 0\nj = 0\n\nfor k in range(4):\n    for i in range(4):\n        for j in range(4):\n            if (m[i][j] > m[i][k] + m[k][j]):\n                m[i][j] = m[i][k] + m[k][j]\n\nprint(':', m)\n```\n\n: [[0, 2, 5, 4], [9, 0, 3, 4], [6, 8, 0, 1], [5, 7, 10, 0]]\n\n O(n<sup>3</sup>)\n","slug":"floyd","published":1,"updated":"2020-03-24T08:39:43.470Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jvm00090j9kjw2xicsb","content":"<h2 id=\"floyd\"><a href=\"#floyd\" class=\"headerlink\" title=\"floyd\"></a>floyd</h2><p><strong></strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>13</p>\n<p><img src=\"http://s1.wailian.download/2020/03/24/6.10.png\" alt=\"6.10.png\"></p>\n<p>1-&gt;2-&gt;3-1</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"http://s1.wailian.download/2020/03/24/6.2-floyd.png\" alt=\"6.2-floyd.png\"></p>\n<p></p>\n<p>()0</p>\n<p><a href=\"http://www.wailian.work/image/Ae1zve\" target=\"_blank\" rel=\"noopener\"><img src=\"http://s1.wailian.download/2020/03/24/6.3-.png\" alt=\"6.3-.png\"></a></p>\n<p>abka-&gt;k-&gt;ba-&gt;bk1ka-&gt;k1-&gt;k2&gt;b</p>\n<p>4-&gt;31214-&gt;1-&gt;3111ije[i][1]+e[1][j]e[i][j]</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python3</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> copy</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 44</span></span><br><span class=\"line\">m = [[<span class=\"number\">0</span>]*<span class=\"number\">4</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">m[<span class=\"number\">0</span>][<span class=\"number\">0</span>] = <span class=\"number\">0</span></span><br><span class=\"line\">m[<span class=\"number\">0</span>][<span class=\"number\">1</span>] = <span class=\"number\">2</span></span><br><span class=\"line\">m[<span class=\"number\">0</span>][<span class=\"number\">2</span>] = <span class=\"number\">6</span></span><br><span class=\"line\">m[<span class=\"number\">0</span>][<span class=\"number\">3</span>] = <span class=\"number\">4</span></span><br><span class=\"line\">m[<span class=\"number\">1</span>][<span class=\"number\">0</span>] = <span class=\"number\">9999</span></span><br><span class=\"line\">m[<span class=\"number\">1</span>][<span class=\"number\">1</span>] = <span class=\"number\">0</span></span><br><span class=\"line\">m[<span class=\"number\">1</span>][<span class=\"number\">2</span>] = <span class=\"number\">3</span></span><br><span class=\"line\">m[<span class=\"number\">1</span>][<span class=\"number\">3</span>] = <span class=\"number\">9999</span></span><br><span class=\"line\">m[<span class=\"number\">2</span>][<span class=\"number\">0</span>] = <span class=\"number\">7</span></span><br><span class=\"line\">m[<span class=\"number\">2</span>][<span class=\"number\">1</span>] = <span class=\"number\">9999</span></span><br><span class=\"line\">m[<span class=\"number\">2</span>][<span class=\"number\">2</span>] = <span class=\"number\">0</span></span><br><span class=\"line\">m[<span class=\"number\">2</span>][<span class=\"number\">3</span>] = <span class=\"number\">1</span></span><br><span class=\"line\">m[<span class=\"number\">3</span>][<span class=\"number\">0</span>] = <span class=\"number\">5</span></span><br><span class=\"line\">m[<span class=\"number\">3</span>][<span class=\"number\">1</span>] = <span class=\"number\">9999</span></span><br><span class=\"line\">m[<span class=\"number\">3</span>][<span class=\"number\">2</span>] = <span class=\"number\">12</span></span><br><span class=\"line\">m[<span class=\"number\">3</span>][<span class=\"number\">3</span>] = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">print(<span class=\"string\">':'</span>, m)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 1</span></span><br><span class=\"line\">n = copy.deepcopy(m)</span><br><span class=\"line\">i = <span class=\"number\">0</span></span><br><span class=\"line\">j = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (n[i][j] &gt; n[i][<span class=\"number\">0</span>] + n[<span class=\"number\">0</span>][j]):</span><br><span class=\"line\">                n[i][j] = n[i][<span class=\"number\">0</span>] + n[<span class=\"number\">0</span>][j]</span><br><span class=\"line\"></span><br><span class=\"line\">print(<span class=\"string\">'1:'</span>, n)</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>: [[0, 2, 6, 4], [9999, 0, 3, 9999], [7, 9999, 0, 1], [5, 9999, 12, 0]]</p>\n<p>1: [[0, 2, 6, 4], [9999, 0, 3, 9999], [7, 9, 0, 1], [5, 7, 11, 0]]</p>\n<p><img src=\"http://s1.wailian.download/2020/03/24/6.5-1.png\" alt=\"6.5-1.png\"></p>\n<p>1,3-&gt;2,4-&gt;2,4-&gt;3</p>\n<p>1212ij</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 2</span></span><br><span class=\"line\">o = copy.deepcopy(n)</span><br><span class=\"line\">i = <span class=\"number\">0</span></span><br><span class=\"line\">j = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(o[i][j] &gt; o[i][<span class=\"number\">1</span>] + o[<span class=\"number\">1</span>][j]):</span><br><span class=\"line\">            o[i][j] = o[i][<span class=\"number\">1</span>] + o[<span class=\"number\">1</span>][j]</span><br><span class=\"line\"></span><br><span class=\"line\">print(<span class=\"string\">'2:'</span>, o)</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>2: [[0, 2, 5, 4], [9999, 0, 3, 9999], [7, 9, 0, 1], [5, 7, 10, 0]]</p>\n<p><img src=\"http://s1.wailian.download/2020/03/24/6.6-1-2.png\" alt=\"6.6-1-2.png\"></p>\n<p>123</p>\n<p><img src=\"http://s1.wailian.download/2020/03/24/6.7-1-2-3.png\" alt=\"6.7-1-2-3.png\"></p>\n<p></p>\n<p><img src=\"http://s1.wailian.download/2020/03/24/6.8-1-2-3-4.png\" alt=\"6.8-1-2-3-4.png\"></p>\n<p></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">k = <span class=\"number\">0</span></span><br><span class=\"line\">i = <span class=\"number\">0</span></span><br><span class=\"line\">j = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> k <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (m[i][j] &gt; m[i][k] + m[k][j]):</span><br><span class=\"line\">                m[i][j] = m[i][k] + m[k][j]</span><br><span class=\"line\"></span><br><span class=\"line\">print(<span class=\"string\">':'</span>, m)</span><br></pre></td></tr></table></figure>\n<p>: [[0, 2, 5, 4], [9, 0, 3, 4], [6, 8, 0, 1], [5, 7, 10, 0]]</p>\n<p> O(n<sup>3</sup>)</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"floyd\"><a href=\"#floyd\" class=\"headerlink\" title=\"floyd\"></a>floyd</h2><p><strong></strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>13</p>\n<p><img src=\"http://s1.wailian.download/2020/03/24/6.10.png\" alt=\"6.10.png\"></p>\n<p>1-&gt;2-&gt;3-1</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"http://s1.wailian.download/2020/03/24/6.2-floyd.png\" alt=\"6.2-floyd.png\"></p>\n<p></p>\n<p>()0</p>\n<p><a href=\"http://www.wailian.work/image/Ae1zve\" target=\"_blank\" rel=\"noopener\"><img src=\"http://s1.wailian.download/2020/03/24/6.3-.png\" alt=\"6.3-.png\"></a></p>\n<p>abka-&gt;k-&gt;ba-&gt;bk1ka-&gt;k1-&gt;k2&gt;b</p>\n<p>4-&gt;31214-&gt;1-&gt;3111ije[i][1]+e[1][j]e[i][j]</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python3</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> copy</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 44</span></span><br><span class=\"line\">m = [[<span class=\"number\">0</span>]*<span class=\"number\">4</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">m[<span class=\"number\">0</span>][<span class=\"number\">0</span>] = <span class=\"number\">0</span></span><br><span class=\"line\">m[<span class=\"number\">0</span>][<span class=\"number\">1</span>] = <span class=\"number\">2</span></span><br><span class=\"line\">m[<span class=\"number\">0</span>][<span class=\"number\">2</span>] = <span class=\"number\">6</span></span><br><span class=\"line\">m[<span class=\"number\">0</span>][<span class=\"number\">3</span>] = <span class=\"number\">4</span></span><br><span class=\"line\">m[<span class=\"number\">1</span>][<span class=\"number\">0</span>] = <span class=\"number\">9999</span></span><br><span class=\"line\">m[<span class=\"number\">1</span>][<span class=\"number\">1</span>] = <span class=\"number\">0</span></span><br><span class=\"line\">m[<span class=\"number\">1</span>][<span class=\"number\">2</span>] = <span class=\"number\">3</span></span><br><span class=\"line\">m[<span class=\"number\">1</span>][<span class=\"number\">3</span>] = <span class=\"number\">9999</span></span><br><span class=\"line\">m[<span class=\"number\">2</span>][<span class=\"number\">0</span>] = <span class=\"number\">7</span></span><br><span class=\"line\">m[<span class=\"number\">2</span>][<span class=\"number\">1</span>] = <span class=\"number\">9999</span></span><br><span class=\"line\">m[<span class=\"number\">2</span>][<span class=\"number\">2</span>] = <span class=\"number\">0</span></span><br><span class=\"line\">m[<span class=\"number\">2</span>][<span class=\"number\">3</span>] = <span class=\"number\">1</span></span><br><span class=\"line\">m[<span class=\"number\">3</span>][<span class=\"number\">0</span>] = <span class=\"number\">5</span></span><br><span class=\"line\">m[<span class=\"number\">3</span>][<span class=\"number\">1</span>] = <span class=\"number\">9999</span></span><br><span class=\"line\">m[<span class=\"number\">3</span>][<span class=\"number\">2</span>] = <span class=\"number\">12</span></span><br><span class=\"line\">m[<span class=\"number\">3</span>][<span class=\"number\">3</span>] = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">print(<span class=\"string\">':'</span>, m)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 1</span></span><br><span class=\"line\">n = copy.deepcopy(m)</span><br><span class=\"line\">i = <span class=\"number\">0</span></span><br><span class=\"line\">j = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (n[i][j] &gt; n[i][<span class=\"number\">0</span>] + n[<span class=\"number\">0</span>][j]):</span><br><span class=\"line\">                n[i][j] = n[i][<span class=\"number\">0</span>] + n[<span class=\"number\">0</span>][j]</span><br><span class=\"line\"></span><br><span class=\"line\">print(<span class=\"string\">'1:'</span>, n)</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>: [[0, 2, 6, 4], [9999, 0, 3, 9999], [7, 9999, 0, 1], [5, 9999, 12, 0]]</p>\n<p>1: [[0, 2, 6, 4], [9999, 0, 3, 9999], [7, 9, 0, 1], [5, 7, 11, 0]]</p>\n<p><img src=\"http://s1.wailian.download/2020/03/24/6.5-1.png\" alt=\"6.5-1.png\"></p>\n<p>1,3-&gt;2,4-&gt;2,4-&gt;3</p>\n<p>1212ij</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 2</span></span><br><span class=\"line\">o = copy.deepcopy(n)</span><br><span class=\"line\">i = <span class=\"number\">0</span></span><br><span class=\"line\">j = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(o[i][j] &gt; o[i][<span class=\"number\">1</span>] + o[<span class=\"number\">1</span>][j]):</span><br><span class=\"line\">            o[i][j] = o[i][<span class=\"number\">1</span>] + o[<span class=\"number\">1</span>][j]</span><br><span class=\"line\"></span><br><span class=\"line\">print(<span class=\"string\">'2:'</span>, o)</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>2: [[0, 2, 5, 4], [9999, 0, 3, 9999], [7, 9, 0, 1], [5, 7, 10, 0]]</p>\n<p><img src=\"http://s1.wailian.download/2020/03/24/6.6-1-2.png\" alt=\"6.6-1-2.png\"></p>\n<p>123</p>\n<p><img src=\"http://s1.wailian.download/2020/03/24/6.7-1-2-3.png\" alt=\"6.7-1-2-3.png\"></p>\n<p></p>\n<p><img src=\"http://s1.wailian.download/2020/03/24/6.8-1-2-3-4.png\" alt=\"6.8-1-2-3-4.png\"></p>\n<p></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">k = <span class=\"number\">0</span></span><br><span class=\"line\">i = <span class=\"number\">0</span></span><br><span class=\"line\">j = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> k <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (m[i][j] &gt; m[i][k] + m[k][j]):</span><br><span class=\"line\">                m[i][j] = m[i][k] + m[k][j]</span><br><span class=\"line\"></span><br><span class=\"line\">print(<span class=\"string\">':'</span>, m)</span><br></pre></td></tr></table></figure>\n<p>: [[0, 2, 5, 4], [9, 0, 3, 4], [6, 8, 0, 1], [5, 7, 10, 0]]</p>\n<p> O(n<sup>3</sup>)</p>\n"},{"title":"Git","date":"2018-02-02T05:58:28.000Z","_content":"\n![pic](http://www.wailian.work/images/2018/02/06/e58c7755f88b1e0ad82a30100cd3f781e3fe8f5970ada-GGAkXt_fw658.jpg)\n\n# \n\n## GitHub\n\nGitHubREADME\n\n## \n\n```\ngit init\n```\n\n## \n\n```\ngit remote add origin git@git.oschina.net:wangweiye/SpringBoot-Learning.git\n```\n\n## \n\n```\ngit add .\n\ngit commit -m \"\"\n\ngit pull origin master\n\ngit push -u origin master\n```\n\n# \n\n## \n\n```\ngit tag\n```\n\n## \n\n```\ngit tag v1.0.0\n```\n\n## \n\n```\ngit push origin [tagname]\n```\n\n## tag\n\n```\ngit push origin --delete tag [tagname]\n```\n\n# .gitignore\n\n.gitignore.gitignore(track)(add)(commit)\n\n```\ngit rm -r --cached .\ngit add .\ngit commit -m \"comment\"\n```\n","source":"_posts/git-remote.md","raw":"---\ntitle: Git\ndate: 2018-02-02 13:58:28\ntags:\n---\n\n![pic](http://www.wailian.work/images/2018/02/06/e58c7755f88b1e0ad82a30100cd3f781e3fe8f5970ada-GGAkXt_fw658.jpg)\n\n# \n\n## GitHub\n\nGitHubREADME\n\n## \n\n```\ngit init\n```\n\n## \n\n```\ngit remote add origin git@git.oschina.net:wangweiye/SpringBoot-Learning.git\n```\n\n## \n\n```\ngit add .\n\ngit commit -m \"\"\n\ngit pull origin master\n\ngit push -u origin master\n```\n\n# \n\n## \n\n```\ngit tag\n```\n\n## \n\n```\ngit tag v1.0.0\n```\n\n## \n\n```\ngit push origin [tagname]\n```\n\n## tag\n\n```\ngit push origin --delete tag [tagname]\n```\n\n# .gitignore\n\n.gitignore.gitignore(track)(add)(commit)\n\n```\ngit rm -r --cached .\ngit add .\ngit commit -m \"comment\"\n```\n","slug":"git-remote","published":1,"updated":"2019-12-24T02:00:57.350Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jvo000a0j9k7fbli8yv","content":"<p><img src=\"http://www.wailian.work/images/2018/02/06/e58c7755f88b1e0ad82a30100cd3f781e3fe8f5970ada-GGAkXt_fw658.jpg\" alt=\"pic\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"GitHub\"><a href=\"#GitHub\" class=\"headerlink\" title=\"GitHub\"></a>GitHub</h2><p>GitHubREADME</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git init</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote add origin git@git.oschina.net:wangweiye/SpringBoot-Learning.git</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\"></span><br><span class=\"line\">git commit -m &quot;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">git pull origin master</span><br><span class=\"line\"></span><br><span class=\"line\">git push -u origin master</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git tag</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git tag v1.0.0</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git push origin [tagname]</span><br></pre></td></tr></table></figure>\n<h2 id=\"tag\"><a href=\"#tag\" class=\"headerlink\" title=\"tag\"></a>tag</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git push origin --delete tag [tagname]</span><br></pre></td></tr></table></figure>\n<h1 id=\"gitignore\"><a href=\"#gitignore\" class=\"headerlink\" title=\".gitignore\"></a>.gitignore</h1><p>.gitignore.gitignore(track)(add)(commit)</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git rm -r --cached .</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m &quot;comment&quot;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/02/06/e58c7755f88b1e0ad82a30100cd3f781e3fe8f5970ada-GGAkXt_fw658.jpg\" alt=\"pic\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"GitHub\"><a href=\"#GitHub\" class=\"headerlink\" title=\"GitHub\"></a>GitHub</h2><p>GitHubREADME</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git init</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote add origin git@git.oschina.net:wangweiye/SpringBoot-Learning.git</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add .</span><br><span class=\"line\"></span><br><span class=\"line\">git commit -m &quot;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">git pull origin master</span><br><span class=\"line\"></span><br><span class=\"line\">git push -u origin master</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git tag</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git tag v1.0.0</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git push origin [tagname]</span><br></pre></td></tr></table></figure>\n<h2 id=\"tag\"><a href=\"#tag\" class=\"headerlink\" title=\"tag\"></a>tag</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git push origin --delete tag [tagname]</span><br></pre></td></tr></table></figure>\n<h1 id=\"gitignore\"><a href=\"#gitignore\" class=\"headerlink\" title=\".gitignore\"></a>.gitignore</h1><p>.gitignore.gitignore(track)(add)(commit)</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git rm -r --cached .</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m &quot;comment&quot;</span><br></pre></td></tr></table></figure>\n"},{"title":"Hello World","_content":"![pic](http://s1.wailian.download/2018/01/18/2850153e0f1cdea447791b1b3d0211ec7692fae81faba-YHBVwv_fw658.jpg)\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\n---\n![pic](http://s1.wailian.download/2018/01/18/2850153e0f1cdea447791b1b3d0211ec7692fae81faba-YHBVwv_fw658.jpg)\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","slug":"hello-world","published":1,"date":"2019-12-24T02:00:57.000Z","updated":"2019-12-24T02:00:57.350Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jvs000b0j9k3uqchwso","content":"<p><img src=\"http://s1.wailian.download/2018/01/18/2850153e0f1cdea447791b1b3d0211ec7692fae81faba-YHBVwv_fw658.jpg\" alt=\"pic\"><br>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://s1.wailian.download/2018/01/18/2850153e0f1cdea447791b1b3d0211ec7692fae81faba-YHBVwv_fw658.jpg\" alt=\"pic\"><br>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>\n"},{"title":"jasypt","date":"2018-09-18T00:41:27.000Z","_content":"![](http://www.wailian.work/images/2018/09/18/botanical-close-up-color-788485.jpg)\n\n# \n\nSpring Bootjasypt\n\n# \n\n1. (Application.java)`@EnableEncryptableProperties`;\n2. `jasypt.encryptor.password = xxxx`,;\n3. `ENC()`;\n4. maven;\n\n```\n<dependency>\n    <groupId>com.github.ulisesbocchio</groupId>\n    <artifactId>jasypt-spring-boot-starter</artifactId>\n    <version>1.9</version>\n</dependency>\n```\n\n## \n\n```\njava -cp /Users/wangweiye/.m2/repository/org/jasypt/jasypt/1.9.2/jasypt-1.9.2.jar org.jasypt.intf.cli.JasyptPBEStringEncryptionCLI input=\"root\" password=xxxx algorithm=PBEWithMD5AndDES\n```\n\n- input;\n- password;\n\n## Java\n\n### \n\n```\npublic void encrypt() {\n    // \n    StandardPBEStringEncryptor encryptor = new StandardPBEStringEncryptor();\n    // \n    EnvironmentStringPBEConfig config = new EnvironmentStringPBEConfig();\n    config.setAlgorithm(\"PBEWithMD5AndDES\");// \n    config.setPassword(\"xxxx\");// \n    encryptor.setConfig(config);\n\n    String plaintext = \"root\"; //\n    String ciphertext = encryptor.encrypt(plaintext); // \n    System.out.println(plaintext + \" : \" + ciphertext);// root : root : zLdyNB+Dj3iw+J+TXZiv5g==\n}\n```\n\n### \n\n```\npublic void decrypt() {\n    StandardPBEStringEncryptor encryptor = new StandardPBEStringEncryptor();\n    EnvironmentStringPBEConfig config = new EnvironmentStringPBEConfig();\n    config.setAlgorithm(\"PBEWithMD5AndDES\");\n    config.setPassword(\"xxxx\");\n    encryptor.setConfig(config);\n    String ciphertext = \"zLdyNB+Dj3iw+J+TXZiv5g==\";// \n\n    //\n    String plaintext = encryptor.decrypt(ciphertext); // \n    assertThat(plaintext).isEqualTo(\"root\");\n}\n```\n","source":"_posts/jasypt.md","raw":"---\ntitle: jasypt\ndate: 2018-09-18 08:41:27\ntags:\n---\n![](http://www.wailian.work/images/2018/09/18/botanical-close-up-color-788485.jpg)\n\n# \n\nSpring Bootjasypt\n\n# \n\n1. (Application.java)`@EnableEncryptableProperties`;\n2. `jasypt.encryptor.password = xxxx`,;\n3. `ENC()`;\n4. maven;\n\n```\n<dependency>\n    <groupId>com.github.ulisesbocchio</groupId>\n    <artifactId>jasypt-spring-boot-starter</artifactId>\n    <version>1.9</version>\n</dependency>\n```\n\n## \n\n```\njava -cp /Users/wangweiye/.m2/repository/org/jasypt/jasypt/1.9.2/jasypt-1.9.2.jar org.jasypt.intf.cli.JasyptPBEStringEncryptionCLI input=\"root\" password=xxxx algorithm=PBEWithMD5AndDES\n```\n\n- input;\n- password;\n\n## Java\n\n### \n\n```\npublic void encrypt() {\n    // \n    StandardPBEStringEncryptor encryptor = new StandardPBEStringEncryptor();\n    // \n    EnvironmentStringPBEConfig config = new EnvironmentStringPBEConfig();\n    config.setAlgorithm(\"PBEWithMD5AndDES\");// \n    config.setPassword(\"xxxx\");// \n    encryptor.setConfig(config);\n\n    String plaintext = \"root\"; //\n    String ciphertext = encryptor.encrypt(plaintext); // \n    System.out.println(plaintext + \" : \" + ciphertext);// root : root : zLdyNB+Dj3iw+J+TXZiv5g==\n}\n```\n\n### \n\n```\npublic void decrypt() {\n    StandardPBEStringEncryptor encryptor = new StandardPBEStringEncryptor();\n    EnvironmentStringPBEConfig config = new EnvironmentStringPBEConfig();\n    config.setAlgorithm(\"PBEWithMD5AndDES\");\n    config.setPassword(\"xxxx\");\n    encryptor.setConfig(config);\n    String ciphertext = \"zLdyNB+Dj3iw+J+TXZiv5g==\";// \n\n    //\n    String plaintext = encryptor.decrypt(ciphertext); // \n    assertThat(plaintext).isEqualTo(\"root\");\n}\n```\n","slug":"jasypt","published":1,"updated":"2019-12-24T02:00:57.350Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jvv000c0j9kk7jwphau","content":"<p><img src=\"http://www.wailian.work/images/2018/09/18/botanical-close-up-color-788485.jpg\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring Bootjasypt</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ol>\n<li>(Application.java)<code>@EnableEncryptableProperties</code>;</li>\n<li><code>jasypt.encryptor.password = xxxx</code>,;</li>\n<li><code>ENC()</code>;</li>\n<li>maven;</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;com.github.ulisesbocchio&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;jasypt-spring-boot-starter&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;1.9&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java -cp /Users/wangweiye/.m2/repository/org/jasypt/jasypt/1.9.2/jasypt-1.9.2.jar org.jasypt.intf.cli.JasyptPBEStringEncryptionCLI input=&quot;root&quot; password=xxxx algorithm=PBEWithMD5AndDES</span><br></pre></td></tr></table></figure>\n<ul>\n<li>input;</li>\n<li>password;</li>\n</ul>\n<h2 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public void encrypt() &#123;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    StandardPBEStringEncryptor encryptor = new StandardPBEStringEncryptor();</span><br><span class=\"line\">    // </span><br><span class=\"line\">    EnvironmentStringPBEConfig config = new EnvironmentStringPBEConfig();</span><br><span class=\"line\">    config.setAlgorithm(&quot;PBEWithMD5AndDES&quot;);// </span><br><span class=\"line\">    config.setPassword(&quot;xxxx&quot;);// </span><br><span class=\"line\">    encryptor.setConfig(config);</span><br><span class=\"line\"></span><br><span class=\"line\">    String plaintext = &quot;root&quot;; //</span><br><span class=\"line\">    String ciphertext = encryptor.encrypt(plaintext); // </span><br><span class=\"line\">    System.out.println(plaintext + &quot; : &quot; + ciphertext);// root : root : zLdyNB+Dj3iw+J+TXZiv5g==</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public void decrypt() &#123;</span><br><span class=\"line\">    StandardPBEStringEncryptor encryptor = new StandardPBEStringEncryptor();</span><br><span class=\"line\">    EnvironmentStringPBEConfig config = new EnvironmentStringPBEConfig();</span><br><span class=\"line\">    config.setAlgorithm(&quot;PBEWithMD5AndDES&quot;);</span><br><span class=\"line\">    config.setPassword(&quot;xxxx&quot;);</span><br><span class=\"line\">    encryptor.setConfig(config);</span><br><span class=\"line\">    String ciphertext = &quot;zLdyNB+Dj3iw+J+TXZiv5g==&quot;;// </span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    String plaintext = encryptor.decrypt(ciphertext); // </span><br><span class=\"line\">    assertThat(plaintext).isEqualTo(&quot;root&quot;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/09/18/botanical-close-up-color-788485.jpg\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring Bootjasypt</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ol>\n<li>(Application.java)<code>@EnableEncryptableProperties</code>;</li>\n<li><code>jasypt.encryptor.password = xxxx</code>,;</li>\n<li><code>ENC()</code>;</li>\n<li>maven;</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;com.github.ulisesbocchio&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;jasypt-spring-boot-starter&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;1.9&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java -cp /Users/wangweiye/.m2/repository/org/jasypt/jasypt/1.9.2/jasypt-1.9.2.jar org.jasypt.intf.cli.JasyptPBEStringEncryptionCLI input=&quot;root&quot; password=xxxx algorithm=PBEWithMD5AndDES</span><br></pre></td></tr></table></figure>\n<ul>\n<li>input;</li>\n<li>password;</li>\n</ul>\n<h2 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public void encrypt() &#123;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    StandardPBEStringEncryptor encryptor = new StandardPBEStringEncryptor();</span><br><span class=\"line\">    // </span><br><span class=\"line\">    EnvironmentStringPBEConfig config = new EnvironmentStringPBEConfig();</span><br><span class=\"line\">    config.setAlgorithm(&quot;PBEWithMD5AndDES&quot;);// </span><br><span class=\"line\">    config.setPassword(&quot;xxxx&quot;);// </span><br><span class=\"line\">    encryptor.setConfig(config);</span><br><span class=\"line\"></span><br><span class=\"line\">    String plaintext = &quot;root&quot;; //</span><br><span class=\"line\">    String ciphertext = encryptor.encrypt(plaintext); // </span><br><span class=\"line\">    System.out.println(plaintext + &quot; : &quot; + ciphertext);// root : root : zLdyNB+Dj3iw+J+TXZiv5g==</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public void decrypt() &#123;</span><br><span class=\"line\">    StandardPBEStringEncryptor encryptor = new StandardPBEStringEncryptor();</span><br><span class=\"line\">    EnvironmentStringPBEConfig config = new EnvironmentStringPBEConfig();</span><br><span class=\"line\">    config.setAlgorithm(&quot;PBEWithMD5AndDES&quot;);</span><br><span class=\"line\">    config.setPassword(&quot;xxxx&quot;);</span><br><span class=\"line\">    encryptor.setConfig(config);</span><br><span class=\"line\">    String ciphertext = &quot;zLdyNB+Dj3iw+J+TXZiv5g==&quot;;// </span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    String plaintext = encryptor.decrypt(ciphertext); // </span><br><span class=\"line\">    assertThat(plaintext).isEqualTo(&quot;root&quot;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"Java","date":"2018-12-25T07:07:05.000Z","_content":"\n# \n\nJava\n\n```java\nInteger i = 10; // \n\nint b = i; // \n```\n\nJava\n\nDouble\n\ndoubleValue;\n\nDouble.valueOf\n\n# \n\n## Integer\n\n```java\nInteger i1 = 100;\nInteger i2 = 100;\nInteger i3 = 200;\nInteger i4 = 200;\n\nassertThat(i1 == i2).isEqualTo(true);\nassertThat(i3 == i4).isEqualTo(false);\n```\n\n\n\n1. Integer.valueOf();\n\n2. \n\nIntegervalueOf\n\n```java\npublic static Integer valueOf(int i) {\n    if (i >= IntegerCache.low && i <= IntegerCache.high)\n        return IntegerCache.cache[i + (-IntegerCache.low)];\n    return new Integer(i);\n}\n```\n\n```java\nprivate static class IntegerCache {\n    static final int low = -128;\n    static final int high;\n    static final Integer cache[];\n\n    static {\n        // high value may be configured by property\n        int h = 127;\n        String integerCacheHighPropValue =\n            sun.misc.VM.getSavedProperty(\"java.lang.Integer.IntegerCache.high\");\n        if (integerCacheHighPropValue != null) {\n            try {\n                int i = parseInt(integerCacheHighPropValue);\n                i = Math.max(i, 127);\n                // Maximum array size is Integer.MAX_VALUE\n                h = Math.min(i, Integer.MAX_VALUE - (-low) -1);\n            } catch( NumberFormatException nfe) {\n                // If the property cannot be parsed into an int, ignore it.\n            }\n        }\n        high = h;\n\n        cache = new Integer[(high - low) + 1];\n        int j = low;\n        for(int k = 0; k < cache.length; k++)\n            cache[k] = new Integer(j++);\n\n        // range [-128, 127] must be interned (JLS7 5.1.7)\n        assert IntegerCache.high >= 127;\n    }\n\n    private IntegerCache() {}\n}\n```\n\nvalueOfInteger[-128,127]IntegerCache.cacheInteger\n\n## Double\n\nDouble\n\n```java\nDouble d1 = 100.0;\nDouble d2 = 100.0;\nDouble d3 = 200.0;\nDouble d4 = 200.0;\n\nassertThat(d1 == d2).isEqualTo(false);\nassertThat(d3 == d4).isEqualTo(false);\n```\n\n\b\bDouble.valueOf\n\n```java\npublic static Double valueOf(String s) throws NumberFormatException {\n    return new Double(parseDouble(s));\n}\n```\n\ndoub\ble\n\n## Boolean\n\n```java\nBoolean i1 = false;\nBoolean i2 = false;\nBoolean i3 = true;\nBoolean i4 = true;\n  \nassertThat(i1 == i2).isEqualTo(true);\nassertThat(i3 == i4).isEqualTo(true);\n```\n\nBoolean.valueOf\n\n```java\n\npublic static final Boolean TRUE = new Boolean(true);\n\npublic static final Boolean FALSE = new Boolean(false);\n\npublic static Boolean valueOf(boolean b) {\n    return (b ? TRUE : FALSE);\n}\n```\n\n# equals==\n\n## ==\n\n \n\n\n\n## equals\n\nequals\n\nStringDateequals","source":"_posts/java-pack-unpack.md","raw":"---\ntitle: Java\ndate: 2018-12-25 15:07:05\ntags:\n---\n\n# \n\nJava\n\n```java\nInteger i = 10; // \n\nint b = i; // \n```\n\nJava\n\nDouble\n\ndoubleValue;\n\nDouble.valueOf\n\n# \n\n## Integer\n\n```java\nInteger i1 = 100;\nInteger i2 = 100;\nInteger i3 = 200;\nInteger i4 = 200;\n\nassertThat(i1 == i2).isEqualTo(true);\nassertThat(i3 == i4).isEqualTo(false);\n```\n\n\n\n1. Integer.valueOf();\n\n2. \n\nIntegervalueOf\n\n```java\npublic static Integer valueOf(int i) {\n    if (i >= IntegerCache.low && i <= IntegerCache.high)\n        return IntegerCache.cache[i + (-IntegerCache.low)];\n    return new Integer(i);\n}\n```\n\n```java\nprivate static class IntegerCache {\n    static final int low = -128;\n    static final int high;\n    static final Integer cache[];\n\n    static {\n        // high value may be configured by property\n        int h = 127;\n        String integerCacheHighPropValue =\n            sun.misc.VM.getSavedProperty(\"java.lang.Integer.IntegerCache.high\");\n        if (integerCacheHighPropValue != null) {\n            try {\n                int i = parseInt(integerCacheHighPropValue);\n                i = Math.max(i, 127);\n                // Maximum array size is Integer.MAX_VALUE\n                h = Math.min(i, Integer.MAX_VALUE - (-low) -1);\n            } catch( NumberFormatException nfe) {\n                // If the property cannot be parsed into an int, ignore it.\n            }\n        }\n        high = h;\n\n        cache = new Integer[(high - low) + 1];\n        int j = low;\n        for(int k = 0; k < cache.length; k++)\n            cache[k] = new Integer(j++);\n\n        // range [-128, 127] must be interned (JLS7 5.1.7)\n        assert IntegerCache.high >= 127;\n    }\n\n    private IntegerCache() {}\n}\n```\n\nvalueOfInteger[-128,127]IntegerCache.cacheInteger\n\n## Double\n\nDouble\n\n```java\nDouble d1 = 100.0;\nDouble d2 = 100.0;\nDouble d3 = 200.0;\nDouble d4 = 200.0;\n\nassertThat(d1 == d2).isEqualTo(false);\nassertThat(d3 == d4).isEqualTo(false);\n```\n\n\b\bDouble.valueOf\n\n```java\npublic static Double valueOf(String s) throws NumberFormatException {\n    return new Double(parseDouble(s));\n}\n```\n\ndoub\ble\n\n## Boolean\n\n```java\nBoolean i1 = false;\nBoolean i2 = false;\nBoolean i3 = true;\nBoolean i4 = true;\n  \nassertThat(i1 == i2).isEqualTo(true);\nassertThat(i3 == i4).isEqualTo(true);\n```\n\nBoolean.valueOf\n\n```java\n\npublic static final Boolean TRUE = new Boolean(true);\n\npublic static final Boolean FALSE = new Boolean(false);\n\npublic static Boolean valueOf(boolean b) {\n    return (b ? TRUE : FALSE);\n}\n```\n\n# equals==\n\n## ==\n\n \n\n\n\n## equals\n\nequals\n\nStringDateequals","slug":"java-pack-unpack","published":1,"updated":"2019-12-24T02:00:57.350Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jvx000d0j9kzi9qsl45","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Integer i = <span class=\"number\">10</span>; <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> b = i; <span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n<p>Java</p>\n<p>Double</p>\n<p>doubleValue;</p>\n<p>Double.valueOf</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Integer\"><a href=\"#Integer\" class=\"headerlink\" title=\"Integer\"></a>Integer</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Integer i1 = <span class=\"number\">100</span>;</span><br><span class=\"line\">Integer i2 = <span class=\"number\">100</span>;</span><br><span class=\"line\">Integer i3 = <span class=\"number\">200</span>;</span><br><span class=\"line\">Integer i4 = <span class=\"number\">200</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">assertThat(i1 == i2).isEqualTo(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">assertThat(i3 == i4).isEqualTo(<span class=\"keyword\">false</span>);</span><br></pre></td></tr></table></figure>\n<p></p>\n<ol>\n<li><p>Integer.valueOf();</p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<p>IntegervalueOf</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Integer <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> IntegerCache.cache[i + (-IntegerCache.low)];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Integer(i);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IntegerCache</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> low = -<span class=\"number\">128</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> high;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Integer cache[];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// high value may be configured by property</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> h = <span class=\"number\">127</span>;</span><br><span class=\"line\">        String integerCacheHighPropValue =</span><br><span class=\"line\">            sun.misc.VM.getSavedProperty(<span class=\"string\">\"java.lang.Integer.IntegerCache.high\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (integerCacheHighPropValue != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">int</span> i = parseInt(integerCacheHighPropValue);</span><br><span class=\"line\">                i = Math.max(i, <span class=\"number\">127</span>);</span><br><span class=\"line\">                <span class=\"comment\">// Maximum array size is Integer.MAX_VALUE</span></span><br><span class=\"line\">                h = Math.min(i, Integer.MAX_VALUE - (-low) -<span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span>( NumberFormatException nfe) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// If the property cannot be parsed into an int, ignore it.</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        high = h;</span><br><span class=\"line\"></span><br><span class=\"line\">        cache = <span class=\"keyword\">new</span> Integer[(high - low) + <span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"keyword\">int</span> j = low;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> k = <span class=\"number\">0</span>; k &lt; cache.length; k++)</span><br><span class=\"line\">            cache[k] = <span class=\"keyword\">new</span> Integer(j++);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// range [-128, 127] must be interned (JLS7 5.1.7)</span></span><br><span class=\"line\">        <span class=\"keyword\">assert</span> IntegerCache.high &gt;= <span class=\"number\">127</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">IntegerCache</span><span class=\"params\">()</span> </span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>valueOfInteger[-128,127]IntegerCache.cacheInteger</p>\n<h2 id=\"Double\"><a href=\"#Double\" class=\"headerlink\" title=\"Double\"></a>Double</h2><p>Double</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Double d1 = <span class=\"number\">100.0</span>;</span><br><span class=\"line\">Double d2 = <span class=\"number\">100.0</span>;</span><br><span class=\"line\">Double d3 = <span class=\"number\">200.0</span>;</span><br><span class=\"line\">Double d4 = <span class=\"number\">200.0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">assertThat(d1 == d2).isEqualTo(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">assertThat(d3 == d4).isEqualTo(<span class=\"keyword\">false</span>);</span><br></pre></td></tr></table></figure>\n<p>\b\bDouble.valueOf</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Double <span class=\"title\">valueOf</span><span class=\"params\">(String s)</span> <span class=\"keyword\">throws</span> NumberFormatException </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Double(parseDouble(s));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>doub\ble</p>\n<h2 id=\"Boolean\"><a href=\"#Boolean\" class=\"headerlink\" title=\"Boolean\"></a>Boolean</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Boolean i1 = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">Boolean i2 = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">Boolean i3 = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">Boolean i4 = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">  </span><br><span class=\"line\">assertThat(i1 == i2).isEqualTo(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">assertThat(i3 == i4).isEqualTo(<span class=\"keyword\">true</span>);</span><br></pre></td></tr></table></figure>\n<p>Boolean.valueOf</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Boolean TRUE = <span class=\"keyword\">new</span> Boolean(<span class=\"keyword\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Boolean FALSE = <span class=\"keyword\">new</span> Boolean(<span class=\"keyword\">false</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Boolean <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">boolean</span> b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (b ? TRUE : FALSE);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"equals\"><a href=\"#equals\" class=\"headerlink\" title=\"equals==\"></a>equals==</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"==\"></a>==</h2><p> </p>\n<p></p>\n<h2 id=\"equals\"><a href=\"#equals\" class=\"headerlink\" title=\"equals\"></a>equals</h2><p>equals</p>\n<p>StringDateequals</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Integer i = <span class=\"number\">10</span>; <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> b = i; <span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n<p>Java</p>\n<p>Double</p>\n<p>doubleValue;</p>\n<p>Double.valueOf</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Integer\"><a href=\"#Integer\" class=\"headerlink\" title=\"Integer\"></a>Integer</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Integer i1 = <span class=\"number\">100</span>;</span><br><span class=\"line\">Integer i2 = <span class=\"number\">100</span>;</span><br><span class=\"line\">Integer i3 = <span class=\"number\">200</span>;</span><br><span class=\"line\">Integer i4 = <span class=\"number\">200</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">assertThat(i1 == i2).isEqualTo(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">assertThat(i3 == i4).isEqualTo(<span class=\"keyword\">false</span>);</span><br></pre></td></tr></table></figure>\n<p></p>\n<ol>\n<li><p>Integer.valueOf();</p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<p>IntegervalueOf</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Integer <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> IntegerCache.cache[i + (-IntegerCache.low)];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Integer(i);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IntegerCache</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> low = -<span class=\"number\">128</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> high;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Integer cache[];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// high value may be configured by property</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> h = <span class=\"number\">127</span>;</span><br><span class=\"line\">        String integerCacheHighPropValue =</span><br><span class=\"line\">            sun.misc.VM.getSavedProperty(<span class=\"string\">\"java.lang.Integer.IntegerCache.high\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (integerCacheHighPropValue != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">int</span> i = parseInt(integerCacheHighPropValue);</span><br><span class=\"line\">                i = Math.max(i, <span class=\"number\">127</span>);</span><br><span class=\"line\">                <span class=\"comment\">// Maximum array size is Integer.MAX_VALUE</span></span><br><span class=\"line\">                h = Math.min(i, Integer.MAX_VALUE - (-low) -<span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span>( NumberFormatException nfe) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// If the property cannot be parsed into an int, ignore it.</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        high = h;</span><br><span class=\"line\"></span><br><span class=\"line\">        cache = <span class=\"keyword\">new</span> Integer[(high - low) + <span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"keyword\">int</span> j = low;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> k = <span class=\"number\">0</span>; k &lt; cache.length; k++)</span><br><span class=\"line\">            cache[k] = <span class=\"keyword\">new</span> Integer(j++);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// range [-128, 127] must be interned (JLS7 5.1.7)</span></span><br><span class=\"line\">        <span class=\"keyword\">assert</span> IntegerCache.high &gt;= <span class=\"number\">127</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">IntegerCache</span><span class=\"params\">()</span> </span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>valueOfInteger[-128,127]IntegerCache.cacheInteger</p>\n<h2 id=\"Double\"><a href=\"#Double\" class=\"headerlink\" title=\"Double\"></a>Double</h2><p>Double</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Double d1 = <span class=\"number\">100.0</span>;</span><br><span class=\"line\">Double d2 = <span class=\"number\">100.0</span>;</span><br><span class=\"line\">Double d3 = <span class=\"number\">200.0</span>;</span><br><span class=\"line\">Double d4 = <span class=\"number\">200.0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">assertThat(d1 == d2).isEqualTo(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">assertThat(d3 == d4).isEqualTo(<span class=\"keyword\">false</span>);</span><br></pre></td></tr></table></figure>\n<p>\b\bDouble.valueOf</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Double <span class=\"title\">valueOf</span><span class=\"params\">(String s)</span> <span class=\"keyword\">throws</span> NumberFormatException </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Double(parseDouble(s));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>doub\ble</p>\n<h2 id=\"Boolean\"><a href=\"#Boolean\" class=\"headerlink\" title=\"Boolean\"></a>Boolean</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Boolean i1 = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">Boolean i2 = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">Boolean i3 = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">Boolean i4 = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">  </span><br><span class=\"line\">assertThat(i1 == i2).isEqualTo(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">assertThat(i3 == i4).isEqualTo(<span class=\"keyword\">true</span>);</span><br></pre></td></tr></table></figure>\n<p>Boolean.valueOf</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Boolean TRUE = <span class=\"keyword\">new</span> Boolean(<span class=\"keyword\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Boolean FALSE = <span class=\"keyword\">new</span> Boolean(<span class=\"keyword\">false</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Boolean <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">boolean</span> b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (b ? TRUE : FALSE);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"equals\"><a href=\"#equals\" class=\"headerlink\" title=\"equals==\"></a>equals==</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"==\"></a>==</h2><p> </p>\n<p></p>\n<h2 id=\"equals\"><a href=\"#equals\" class=\"headerlink\" title=\"equals\"></a>equals</h2><p>equals</p>\n<p>StringDateequals</p>\n"},{"title":"java","date":"2018-01-20T14:03:18.000Z","_content":"\n# Predicate\n\nJava 8CollectionremoveIf(Predicate filter)filterPredicatePredicateLamada\n\n```\nCollection books = new HashSet();\nbooks.add(new String(\"123\"));\nbooks.add(new String(\"1234\"));\nbooks.add(new String(\"12345\"));\nbooks.add(new String(\"123456\"));\n// Lamada\nbooks.removeIf(ele -> ((String)ele).length() < 3);\nSystem.out.println(books);\n```\n\nCollectionremoveIf()Lamada\n\nPredicateC\n\n```\npublic class Test {\n\n    public static void operate(Collection c, Predicate p) { // p\n        for (Object ele: c) {\n            if (p.test(ele)) {\n                System.out.println(ele);\n            }\n        }\n    }\n\n    public static void main(String[] args) {\n        Collection c = new ArrayList();\n        for (int i = 0; i < 10; i++) { // 0 ~ 9\n            c.add(String.valueOf(i));\n        }\n\n        operate(c, ele -> Integer.valueOf((String)ele) > 3); // 3\n    }\n}\n```\n","source":"_posts/java.md","raw":"---\ntitle: java\ndate: 2018-01-20 22:03:18\ntags:\n---\n\n# Predicate\n\nJava 8CollectionremoveIf(Predicate filter)filterPredicatePredicateLamada\n\n```\nCollection books = new HashSet();\nbooks.add(new String(\"123\"));\nbooks.add(new String(\"1234\"));\nbooks.add(new String(\"12345\"));\nbooks.add(new String(\"123456\"));\n// Lamada\nbooks.removeIf(ele -> ((String)ele).length() < 3);\nSystem.out.println(books);\n```\n\nCollectionremoveIf()Lamada\n\nPredicateC\n\n```\npublic class Test {\n\n    public static void operate(Collection c, Predicate p) { // p\n        for (Object ele: c) {\n            if (p.test(ele)) {\n                System.out.println(ele);\n            }\n        }\n    }\n\n    public static void main(String[] args) {\n        Collection c = new ArrayList();\n        for (int i = 0; i < 10; i++) { // 0 ~ 9\n            c.add(String.valueOf(i));\n        }\n\n        operate(c, ele -> Integer.valueOf((String)ele) > 3); // 3\n    }\n}\n```\n","slug":"java","published":1,"updated":"2019-12-24T02:00:57.360Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jvy000e0j9k7zyzc7p5","content":"<h1 id=\"Predicate\"><a href=\"#Predicate\" class=\"headerlink\" title=\"Predicate\"></a>Predicate</h1><p>Java 8CollectionremoveIf(Predicate filter)filterPredicatePredicateLamada</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Collection books = new HashSet();</span><br><span class=\"line\">books.add(new String(&quot;123&quot;));</span><br><span class=\"line\">books.add(new String(&quot;1234&quot;));</span><br><span class=\"line\">books.add(new String(&quot;12345&quot;));</span><br><span class=\"line\">books.add(new String(&quot;123456&quot;));</span><br><span class=\"line\">// Lamada</span><br><span class=\"line\">books.removeIf(ele -&gt; ((String)ele).length() &lt; 3);</span><br><span class=\"line\">System.out.println(books);</span><br></pre></td></tr></table></figure>\n<p>CollectionremoveIf()Lamada</p>\n<p>PredicateC</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Test &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void operate(Collection c, Predicate p) &#123; // p</span><br><span class=\"line\">        for (Object ele: c) &#123;</span><br><span class=\"line\">            if (p.test(ele)) &#123;</span><br><span class=\"line\">                System.out.println(ele);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        Collection c = new ArrayList();</span><br><span class=\"line\">        for (int i = 0; i &lt; 10; i++) &#123; // 0 ~ 9</span><br><span class=\"line\">            c.add(String.valueOf(i));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        operate(c, ele -&gt; Integer.valueOf((String)ele) &gt; 3); // 3</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Predicate\"><a href=\"#Predicate\" class=\"headerlink\" title=\"Predicate\"></a>Predicate</h1><p>Java 8CollectionremoveIf(Predicate filter)filterPredicatePredicateLamada</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Collection books = new HashSet();</span><br><span class=\"line\">books.add(new String(&quot;123&quot;));</span><br><span class=\"line\">books.add(new String(&quot;1234&quot;));</span><br><span class=\"line\">books.add(new String(&quot;12345&quot;));</span><br><span class=\"line\">books.add(new String(&quot;123456&quot;));</span><br><span class=\"line\">// Lamada</span><br><span class=\"line\">books.removeIf(ele -&gt; ((String)ele).length() &lt; 3);</span><br><span class=\"line\">System.out.println(books);</span><br></pre></td></tr></table></figure>\n<p>CollectionremoveIf()Lamada</p>\n<p>PredicateC</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Test &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void operate(Collection c, Predicate p) &#123; // p</span><br><span class=\"line\">        for (Object ele: c) &#123;</span><br><span class=\"line\">            if (p.test(ele)) &#123;</span><br><span class=\"line\">                System.out.println(ele);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        Collection c = new ArrayList();</span><br><span class=\"line\">        for (int i = 0; i &lt; 10; i++) &#123; // 0 ~ 9</span><br><span class=\"line\">            c.add(String.valueOf(i));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        operate(c, ele -&gt; Integer.valueOf((String)ele) &gt; 3); // 3</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"JenkinsSpring Boot","date":"2017-12-15T15:00:10.000Z","_content":"# \n\nContinuous integrationCI\n\n# \n\n\n\n# Jenkins\n\nJenkinsJavaJenkinsJava\n\n# Jenkins\n\n[](https://jenkins.io/download/)Jenkins\n\n## \n![](http://s1.wailian.download/2017/12/18/1eebae.png)\n## \n![](http://s1.wailian.download/2017/12/18/2625d8.png)\n\n8080Jenkins8080\n\n# Jenkins\n\n## \n\n- jdk\n![](http://s1.wailian.download/2017/12/18/2ad234.png)\n- maven\n![](http://s1.wailian.download/2017/12/18/3711fb.png)\n\n## \n\nJenkinsGit pluginMaven Integration pluginpublish over SSHSpring Boot\n\n## Credentials\n\nsshgit\n\n![](http://s1.wailian.download/2017/12/15/1.png)\n","source":"_posts/jenkins.md","raw":"---\ntitle: JenkinsSpring Boot\ndate: 2017-12-15 23:00:10\ntags:\n---\n# \n\nContinuous integrationCI\n\n# \n\n\n\n# Jenkins\n\nJenkinsJavaJenkinsJava\n\n# Jenkins\n\n[](https://jenkins.io/download/)Jenkins\n\n## \n![](http://s1.wailian.download/2017/12/18/1eebae.png)\n## \n![](http://s1.wailian.download/2017/12/18/2625d8.png)\n\n8080Jenkins8080\n\n# Jenkins\n\n## \n\n- jdk\n![](http://s1.wailian.download/2017/12/18/2ad234.png)\n- maven\n![](http://s1.wailian.download/2017/12/18/3711fb.png)\n\n## \n\nJenkinsGit pluginMaven Integration pluginpublish over SSHSpring Boot\n\n## Credentials\n\nsshgit\n\n![](http://s1.wailian.download/2017/12/15/1.png)\n","slug":"jenkins","published":1,"updated":"2019-12-24T02:00:57.360Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jvz000f0j9kpvpxwzo3","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Continuous integrationCI</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h1 id=\"Jenkins\"><a href=\"#Jenkins\" class=\"headerlink\" title=\"Jenkins\"></a>Jenkins</h1><p>JenkinsJavaJenkinsJava</p>\n<h1 id=\"Jenkins\"><a href=\"#Jenkins\" class=\"headerlink\" title=\"Jenkins\"></a>Jenkins</h1><p><a href=\"https://jenkins.io/download/\" target=\"_blank\" rel=\"noopener\"></a>Jenkins</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"http://s1.wailian.download/2017/12/18/1eebae.png\" alt=\"\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"http://s1.wailian.download/2017/12/18/2625d8.png\" alt=\"\"></p>\n<p>8080Jenkins8080</p>\n<h1 id=\"Jenkins\"><a href=\"#Jenkins\" class=\"headerlink\" title=\"Jenkins\"></a>Jenkins</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>jdk<br><img src=\"http://s1.wailian.download/2017/12/18/2ad234.png\" alt=\"\"></li>\n<li>maven<br><img src=\"http://s1.wailian.download/2017/12/18/3711fb.png\" alt=\"\"></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>JenkinsGit pluginMaven Integration pluginpublish over SSHSpring Boot</p>\n<h2 id=\"Credentials\"><a href=\"#Credentials\" class=\"headerlink\" title=\"Credentials\"></a>Credentials</h2><p>sshgit</p>\n<p><img src=\"http://s1.wailian.download/2017/12/15/1.png\" alt=\"\"></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Continuous integrationCI</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h1 id=\"Jenkins\"><a href=\"#Jenkins\" class=\"headerlink\" title=\"Jenkins\"></a>Jenkins</h1><p>JenkinsJavaJenkinsJava</p>\n<h1 id=\"Jenkins\"><a href=\"#Jenkins\" class=\"headerlink\" title=\"Jenkins\"></a>Jenkins</h1><p><a href=\"https://jenkins.io/download/\" target=\"_blank\" rel=\"noopener\"></a>Jenkins</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"http://s1.wailian.download/2017/12/18/1eebae.png\" alt=\"\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"http://s1.wailian.download/2017/12/18/2625d8.png\" alt=\"\"></p>\n<p>8080Jenkins8080</p>\n<h1 id=\"Jenkins\"><a href=\"#Jenkins\" class=\"headerlink\" title=\"Jenkins\"></a>Jenkins</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>jdk<br><img src=\"http://s1.wailian.download/2017/12/18/2ad234.png\" alt=\"\"></li>\n<li>maven<br><img src=\"http://s1.wailian.download/2017/12/18/3711fb.png\" alt=\"\"></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>JenkinsGit pluginMaven Integration pluginpublish over SSHSpring Boot</p>\n<h2 id=\"Credentials\"><a href=\"#Credentials\" class=\"headerlink\" title=\"Credentials\"></a>Credentials</h2><p>sshgit</p>\n<p><img src=\"http://s1.wailian.download/2017/12/15/1.png\" alt=\"\"></p>\n"},{"title":"Linux","date":"2017-12-20T08:10:19.000Z","_content":"\n![](http://www.wailian.work/images/2018/04/18/121.jpg)\n\nCentOSsshrootrootsudoroot\n\n# \n\n## \n\n```\nuseradd wangweiye\n```\n## \n\n```\npasswd wangweiye\n```\n\n## wheel\n\n```\nusermod -G wheel wangweiye\n```\n\n> Linuxwheel\n\nwangweiye,sudo\n\n`su`rootroot`su`root`su`rootrootUNIX`wheel`\n\nwheelroot\n\n1. `/etc/pam.d/su``#auth required /lib/security/$ISA/pam_wheel.so use_uid`\n\n2. `SU_WHEEL_ONLY yes``/etc/login.defs`\n\n# rootssh\n\n## \n\n`/etc/ssh/sshd_config``PermitRootLogin`no\n\n## ssh\n\n`systemctl restart sshd.service`ssh\n\n# sudo\n\nsudoroot(wheel)\n\n```\nvim /etc/sudoers\n```\n\n![](http://www.wailian.work/images/2018/04/18/121.png)\n","source":"_posts/linux-safe.md","raw":"---\ntitle: Linux\ndate: 2017-12-20 16:10:19\ntags:\n---\n\n![](http://www.wailian.work/images/2018/04/18/121.jpg)\n\nCentOSsshrootrootsudoroot\n\n# \n\n## \n\n```\nuseradd wangweiye\n```\n## \n\n```\npasswd wangweiye\n```\n\n## wheel\n\n```\nusermod -G wheel wangweiye\n```\n\n> Linuxwheel\n\nwangweiye,sudo\n\n`su`rootroot`su`root`su`rootrootUNIX`wheel`\n\nwheelroot\n\n1. `/etc/pam.d/su``#auth required /lib/security/$ISA/pam_wheel.so use_uid`\n\n2. `SU_WHEEL_ONLY yes``/etc/login.defs`\n\n# rootssh\n\n## \n\n`/etc/ssh/sshd_config``PermitRootLogin`no\n\n## ssh\n\n`systemctl restart sshd.service`ssh\n\n# sudo\n\nsudoroot(wheel)\n\n```\nvim /etc/sudoers\n```\n\n![](http://www.wailian.work/images/2018/04/18/121.png)\n","slug":"linux-safe","published":1,"updated":"2019-12-24T02:00:57.360Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jw0000g0j9k4kj76u6b","content":"<p><img src=\"http://www.wailian.work/images/2018/04/18/121.jpg\" alt=\"\"></p>\n<p>CentOSsshrootrootsudoroot</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useradd wangweiye</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">passwd wangweiye</span><br></pre></td></tr></table></figure>\n<h2 id=\"wheel\"><a href=\"#wheel\" class=\"headerlink\" title=\"wheel\"></a>wheel</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">usermod -G wheel wangweiye</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>Linuxwheel</p>\n</blockquote>\n<p>wangweiye,sudo</p>\n<p><code>su</code>rootroot<code>su</code>root<code>su</code>rootrootUNIX<code>wheel</code></p>\n<p>wheelroot</p>\n<ol>\n<li><p><code>/etc/pam.d/su</code><code>#auth required /lib/security/$ISA/pam_wheel.so use_uid</code></p>\n</li>\n<li><p><code>SU_WHEEL_ONLY yes</code><code>/etc/login.defs</code></p>\n</li>\n</ol>\n<h1 id=\"rootssh\"><a href=\"#rootssh\" class=\"headerlink\" title=\"rootssh\"></a>rootssh</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>/etc/ssh/sshd_config</code><code>PermitRootLogin</code>no</p>\n<h2 id=\"ssh\"><a href=\"#ssh\" class=\"headerlink\" title=\"ssh\"></a>ssh</h2><p><code>systemctl restart sshd.service</code>ssh</p>\n<h1 id=\"sudo\"><a href=\"#sudo\" class=\"headerlink\" title=\"sudo\"></a>sudo</h1><p>sudoroot(wheel)</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/sudoers</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://www.wailian.work/images/2018/04/18/121.png\" alt=\"\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/04/18/121.jpg\" alt=\"\"></p>\n<p>CentOSsshrootrootsudoroot</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">useradd wangweiye</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">passwd wangweiye</span><br></pre></td></tr></table></figure>\n<h2 id=\"wheel\"><a href=\"#wheel\" class=\"headerlink\" title=\"wheel\"></a>wheel</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">usermod -G wheel wangweiye</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>Linuxwheel</p>\n</blockquote>\n<p>wangweiye,sudo</p>\n<p><code>su</code>rootroot<code>su</code>root<code>su</code>rootrootUNIX<code>wheel</code></p>\n<p>wheelroot</p>\n<ol>\n<li><p><code>/etc/pam.d/su</code><code>#auth required /lib/security/$ISA/pam_wheel.so use_uid</code></p>\n</li>\n<li><p><code>SU_WHEEL_ONLY yes</code><code>/etc/login.defs</code></p>\n</li>\n</ol>\n<h1 id=\"rootssh\"><a href=\"#rootssh\" class=\"headerlink\" title=\"rootssh\"></a>rootssh</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>/etc/ssh/sshd_config</code><code>PermitRootLogin</code>no</p>\n<h2 id=\"ssh\"><a href=\"#ssh\" class=\"headerlink\" title=\"ssh\"></a>ssh</h2><p><code>systemctl restart sshd.service</code>ssh</p>\n<h1 id=\"sudo\"><a href=\"#sudo\" class=\"headerlink\" title=\"sudo\"></a>sudo</h1><p>sudoroot(wheel)</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/sudoers</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://www.wailian.work/images/2018/04/18/121.png\" alt=\"\"></p>\n"},{"title":"macgit","date":"2017-12-07T03:40:04.000Z","_content":"git\n```\nxcrun: error: invalid active developer path (/Library/Developer/CommandLineTools), missing xcrun at: /Library/Developer/CommandLineTools/usr/bin/xcrun\n```\n## \n\nxcode\n\n## \n\n\n```\nxcode-select --install\n```\n","source":"_posts/mac-git.md","raw":"---\ntitle: macgit\ndate: 2017-12-07 11:40:04\ntags:\n---\ngit\n```\nxcrun: error: invalid active developer path (/Library/Developer/CommandLineTools), missing xcrun at: /Library/Developer/CommandLineTools/usr/bin/xcrun\n```\n## \n\nxcode\n\n## \n\n\n```\nxcode-select --install\n```\n","slug":"mac-git","published":1,"updated":"2019-12-24T02:00:57.360Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jw1000h0j9kk5j9h6os","content":"<p>git<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xcrun: error: invalid active developer path (/Library/Developer/CommandLineTools), missing xcrun at: /Library/Developer/CommandLineTools/usr/bin/xcrun</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>xcode</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xcode-select --install</span><br></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<p>git<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xcrun: error: invalid active developer path (/Library/Developer/CommandLineTools), missing xcrun at: /Library/Developer/CommandLineTools/usr/bin/xcrun</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>xcode</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xcode-select --install</span><br></pre></td></tr></table></figure></p>\n"},{"title":"MySql","date":"2018-01-26T01:07:07.000Z","_content":"![pic](http://www.wailian.work/images/2018/01/26/5d274a04c82163baf3c74ae5c97d16e80a641ed24163c7-YnTeKa_fw658.jpg)\n\nmysql5.7.20\nIP:47.104.71.88IP:45.77.13.74\n\n# ()\n\n(master)(slave)\n\n# \n\n```\nGRANT REPLICATION SLAVE,RELOAD,SUPER ON *.* TO synchrouser@45.77.13.74 IDENTIFIED BY 'w123456W!';\n```\n\nsynchrouserw123456W!synchrouser\n\n# \n\n[mysqld]\n\n```\nserver-id=88\nlog_bin=mysql-bin\nbinlog_format=mixed\n```\n\nserver-idIP47.104.71.8888mysql\n\n# \n\n[mysqld]\n\n```\nserver-id=74\n```\n\nmysql\n\n:`show master status;`\n\n![](http://www.wailian.work/images/2018/01/26/WX20180126-091715.png)\n\n\n\n```\nchange master to master_host='47.104.71.88',master_user='synchrouser',master_password='w123456W!',master_log_file='mysql-bin.000005',master_log_pos=840;\n```\n\nmaster_log_fileFilemaster_log_posPosition\n\n# \n\n\n\n```\nstart slave;\n```\n\n# \n\n![](http://www.wailian.work/images/2018/01/26/4.png)\n\nSlave_IO_RunningSlave_SQL_RunningYes\n\n# \n\n\n\n## MySq\n\n# \n\n/etc/my.cnf\n\nreplicate-do-table=dbname.tablename\nreplicate-wild-do-table=dbname.tablename%\nreplicate-do-db=dbname\nreplicte-wild-do-db=dbname%\nreplicate-ignore-table=dbname.tablename\n","source":"_posts/master-slave.md","raw":"---\ntitle: MySql\ndate: 2018-01-26 09:07:07\ntags:\n---\n![pic](http://www.wailian.work/images/2018/01/26/5d274a04c82163baf3c74ae5c97d16e80a641ed24163c7-YnTeKa_fw658.jpg)\n\nmysql5.7.20\nIP:47.104.71.88IP:45.77.13.74\n\n# ()\n\n(master)(slave)\n\n# \n\n```\nGRANT REPLICATION SLAVE,RELOAD,SUPER ON *.* TO synchrouser@45.77.13.74 IDENTIFIED BY 'w123456W!';\n```\n\nsynchrouserw123456W!synchrouser\n\n# \n\n[mysqld]\n\n```\nserver-id=88\nlog_bin=mysql-bin\nbinlog_format=mixed\n```\n\nserver-idIP47.104.71.8888mysql\n\n# \n\n[mysqld]\n\n```\nserver-id=74\n```\n\nmysql\n\n:`show master status;`\n\n![](http://www.wailian.work/images/2018/01/26/WX20180126-091715.png)\n\n\n\n```\nchange master to master_host='47.104.71.88',master_user='synchrouser',master_password='w123456W!',master_log_file='mysql-bin.000005',master_log_pos=840;\n```\n\nmaster_log_fileFilemaster_log_posPosition\n\n# \n\n\n\n```\nstart slave;\n```\n\n# \n\n![](http://www.wailian.work/images/2018/01/26/4.png)\n\nSlave_IO_RunningSlave_SQL_RunningYes\n\n# \n\n\n\n## MySq\n\n# \n\n/etc/my.cnf\n\nreplicate-do-table=dbname.tablename\nreplicate-wild-do-table=dbname.tablename%\nreplicate-do-db=dbname\nreplicte-wild-do-db=dbname%\nreplicate-ignore-table=dbname.tablename\n","slug":"master-slave","published":1,"updated":"2019-12-24T02:00:57.440Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jw2000i0j9khtyo3t64","content":"<p><img src=\"http://www.wailian.work/images/2018/01/26/5d274a04c82163baf3c74ae5c97d16e80a641ed24163c7-YnTeKa_fw658.jpg\" alt=\"pic\"></p>\n<p>mysql5.7.20<br>IP:47.104.71.88IP:45.77.13.74</p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"()\"></a>()</h1><p>(master)(slave)</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GRANT REPLICATION SLAVE,RELOAD,SUPER ON *.* TO synchrouser@45.77.13.74 IDENTIFIED BY &apos;w123456W!&apos;;</span><br></pre></td></tr></table></figure>\n<p>synchrouserw123456W!synchrouser</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>[mysqld]</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server-id=88</span><br><span class=\"line\">log_bin=mysql-bin</span><br><span class=\"line\">binlog_format=mixed</span><br></pre></td></tr></table></figure>\n<p>server-idIP47.104.71.8888mysql</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>[mysqld]</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server-id=74</span><br></pre></td></tr></table></figure>\n<p>mysql</p>\n<p>:<code>show master status;</code></p>\n<p><img src=\"http://www.wailian.work/images/2018/01/26/WX20180126-091715.png\" alt=\"\"></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">change master to master_host=&apos;47.104.71.88&apos;,master_user=&apos;synchrouser&apos;,master_password=&apos;w123456W!&apos;,master_log_file=&apos;mysql-bin.000005&apos;,master_log_pos=840;</span><br></pre></td></tr></table></figure>\n<p>master_log_fileFilemaster_log_posPosition</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start slave;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"http://www.wailian.work/images/2018/01/26/4.png\" alt=\"\"></p>\n<p>Slave_IO_RunningSlave_SQL_RunningYes</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"MySq\"><a href=\"#MySq\" class=\"headerlink\" title=\"MySq\"></a>MySq</h2><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>/etc/my.cnf</p>\n<p>replicate-do-table=dbname.tablename<br>replicate-wild-do-table=dbname.tablename%<br>replicate-do-db=dbname<br>replicte-wild-do-db=dbname%<br>replicate-ignore-table=dbname.tablename</p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/01/26/5d274a04c82163baf3c74ae5c97d16e80a641ed24163c7-YnTeKa_fw658.jpg\" alt=\"pic\"></p>\n<p>mysql5.7.20<br>IP:47.104.71.88IP:45.77.13.74</p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"()\"></a>()</h1><p>(master)(slave)</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GRANT REPLICATION SLAVE,RELOAD,SUPER ON *.* TO synchrouser@45.77.13.74 IDENTIFIED BY &apos;w123456W!&apos;;</span><br></pre></td></tr></table></figure>\n<p>synchrouserw123456W!synchrouser</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>[mysqld]</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server-id=88</span><br><span class=\"line\">log_bin=mysql-bin</span><br><span class=\"line\">binlog_format=mixed</span><br></pre></td></tr></table></figure>\n<p>server-idIP47.104.71.8888mysql</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>[mysqld]</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server-id=74</span><br></pre></td></tr></table></figure>\n<p>mysql</p>\n<p>:<code>show master status;</code></p>\n<p><img src=\"http://www.wailian.work/images/2018/01/26/WX20180126-091715.png\" alt=\"\"></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">change master to master_host=&apos;47.104.71.88&apos;,master_user=&apos;synchrouser&apos;,master_password=&apos;w123456W!&apos;,master_log_file=&apos;mysql-bin.000005&apos;,master_log_pos=840;</span><br></pre></td></tr></table></figure>\n<p>master_log_fileFilemaster_log_posPosition</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start slave;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"http://www.wailian.work/images/2018/01/26/4.png\" alt=\"\"></p>\n<p>Slave_IO_RunningSlave_SQL_RunningYes</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"MySq\"><a href=\"#MySq\" class=\"headerlink\" title=\"MySq\"></a>MySq</h2><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>/etc/my.cnf</p>\n<p>replicate-do-table=dbname.tablename<br>replicate-wild-do-table=dbname.tablename%<br>replicate-do-db=dbname<br>replicte-wild-do-db=dbname%<br>replicate-ignore-table=dbname.tablename</p>\n"},{"title":"mavenSpring Boot","date":"2018-03-26T07:06:22.000Z","_content":"![](http://www.wailian.work/images/2018/03/28/f5462f69549047be1b086629e548eefc8d74eca329bea-IiKAbw_fw658.jpg)\n\n> MavenPOM\n\n# \n\n## maven\n\n![create](http://www.wailian.work/images/2018/03/26/1.png)\n\n![mvn](http://www.wailian.work/images/2018/03/26/2.png)\n\n## src\n\n![src](http://www.wailian.work/images/2018/03/26/3.png)\n\n## pom\n\n`<packaging>pom</packaging>`\n\n![](http://www.wailian.work/images/2018/03/26/4.png)\n\n# Spring Boot \n\nNew-Module\n\n![](http://www.wailian.work/images/2018/03/26/5.png)\n\nSpring Initializr\n\n![](http://www.wailian.work/images/2018/03/26/6.png)\n\n\n\n![](http://www.wailian.work/images/2018/03/26/7.png)\n\n\n\n![](http://www.wailian.work/images/2018/03/26/8.png)\n\n# pom\n\npomspring bootpom\n\n![](http://www.wailian.work/images/2018/03/26/9.png)\n\npom\n\n![](http://www.wailian.work/images/2018/03/26/10.png)\n\npom\n\n![](http://www.wailian.work/images/2018/03/26/11.png)\n\n# \n\nutilsapi\n\n# \n\n\n\npombuild,`mvn clean package`\n\n[](https://github.com/wangweiye01/maven)\n","source":"_posts/maven.md","raw":"---\ntitle: mavenSpring Boot\ndate: 2018-03-26 15:06:22\ntags:\n---\n![](http://www.wailian.work/images/2018/03/28/f5462f69549047be1b086629e548eefc8d74eca329bea-IiKAbw_fw658.jpg)\n\n> MavenPOM\n\n# \n\n## maven\n\n![create](http://www.wailian.work/images/2018/03/26/1.png)\n\n![mvn](http://www.wailian.work/images/2018/03/26/2.png)\n\n## src\n\n![src](http://www.wailian.work/images/2018/03/26/3.png)\n\n## pom\n\n`<packaging>pom</packaging>`\n\n![](http://www.wailian.work/images/2018/03/26/4.png)\n\n# Spring Boot \n\nNew-Module\n\n![](http://www.wailian.work/images/2018/03/26/5.png)\n\nSpring Initializr\n\n![](http://www.wailian.work/images/2018/03/26/6.png)\n\n\n\n![](http://www.wailian.work/images/2018/03/26/7.png)\n\n\n\n![](http://www.wailian.work/images/2018/03/26/8.png)\n\n# pom\n\npomspring bootpom\n\n![](http://www.wailian.work/images/2018/03/26/9.png)\n\npom\n\n![](http://www.wailian.work/images/2018/03/26/10.png)\n\npom\n\n![](http://www.wailian.work/images/2018/03/26/11.png)\n\n# \n\nutilsapi\n\n# \n\n\n\npombuild,`mvn clean package`\n\n[](https://github.com/wangweiye01/maven)\n","slug":"maven","published":1,"updated":"2019-12-24T02:00:57.440Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jw3000j0j9khmskkeec","content":"<p><img src=\"http://www.wailian.work/images/2018/03/28/f5462f69549047be1b086629e548eefc8d74eca329bea-IiKAbw_fw658.jpg\" alt=\"\"></p>\n<blockquote>\n<p>MavenPOM</p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"maven\"><a href=\"#maven\" class=\"headerlink\" title=\"maven\"></a>maven</h2><p><img src=\"http://www.wailian.work/images/2018/03/26/1.png\" alt=\"create\"></p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/2.png\" alt=\"mvn\"></p>\n<h2 id=\"src\"><a href=\"#src\" class=\"headerlink\" title=\"src\"></a>src</h2><p><img src=\"http://www.wailian.work/images/2018/03/26/3.png\" alt=\"src\"></p>\n<h2 id=\"pom\"><a href=\"#pom\" class=\"headerlink\" title=\"pom\"></a>pom</h2><p><code>&lt;packaging&gt;pom&lt;/packaging&gt;</code></p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/4.png\" alt=\"\"></p>\n<h1 id=\"Spring-Boot\"><a href=\"#Spring-Boot\" class=\"headerlink\" title=\"Spring Boot\"></a>Spring Boot</h1><p>New-Module</p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/5.png\" alt=\"\"></p>\n<p>Spring Initializr</p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/6.png\" alt=\"\"></p>\n<p></p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/7.png\" alt=\"\"></p>\n<p></p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/8.png\" alt=\"\"></p>\n<h1 id=\"pom\"><a href=\"#pom\" class=\"headerlink\" title=\"pom\"></a>pom</h1><p>pomspring bootpom</p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/9.png\" alt=\"\"></p>\n<p>pom</p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/10.png\" alt=\"\"></p>\n<p>pom</p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/11.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>utilsapi</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>pombuild,<code>mvn clean package</code></p>\n<p><a href=\"https://github.com/wangweiye01/maven\" target=\"_blank\" rel=\"noopener\"></a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/03/28/f5462f69549047be1b086629e548eefc8d74eca329bea-IiKAbw_fw658.jpg\" alt=\"\"></p>\n<blockquote>\n<p>MavenPOM</p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"maven\"><a href=\"#maven\" class=\"headerlink\" title=\"maven\"></a>maven</h2><p><img src=\"http://www.wailian.work/images/2018/03/26/1.png\" alt=\"create\"></p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/2.png\" alt=\"mvn\"></p>\n<h2 id=\"src\"><a href=\"#src\" class=\"headerlink\" title=\"src\"></a>src</h2><p><img src=\"http://www.wailian.work/images/2018/03/26/3.png\" alt=\"src\"></p>\n<h2 id=\"pom\"><a href=\"#pom\" class=\"headerlink\" title=\"pom\"></a>pom</h2><p><code>&lt;packaging&gt;pom&lt;/packaging&gt;</code></p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/4.png\" alt=\"\"></p>\n<h1 id=\"Spring-Boot\"><a href=\"#Spring-Boot\" class=\"headerlink\" title=\"Spring Boot\"></a>Spring Boot</h1><p>New-Module</p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/5.png\" alt=\"\"></p>\n<p>Spring Initializr</p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/6.png\" alt=\"\"></p>\n<p></p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/7.png\" alt=\"\"></p>\n<p></p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/8.png\" alt=\"\"></p>\n<h1 id=\"pom\"><a href=\"#pom\" class=\"headerlink\" title=\"pom\"></a>pom</h1><p>pomspring bootpom</p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/9.png\" alt=\"\"></p>\n<p>pom</p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/10.png\" alt=\"\"></p>\n<p>pom</p>\n<p><img src=\"http://www.wailian.work/images/2018/03/26/11.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>utilsapi</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>pombuild,<code>mvn clean package</code></p>\n<p><a href=\"https://github.com/wangweiye01/maven\" target=\"_blank\" rel=\"noopener\"></a></p>\n"},{"title":"mybatis Integer0","date":"2017-12-14T02:17:34.000Z","_content":"\nmybatis0\n1. != null 2. != ''Integer1\n","source":"_posts/mybatis.md","raw":"---\ntitle: mybatis Integer0\ndate: 2017-12-14 10:17:34\ntags:\n---\n\nmybatis0\n1. != null 2. != ''Integer1\n","slug":"mybatis","published":1,"updated":"2019-12-24T02:00:57.440Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jw4000k0j9ka1n5r715","content":"<p>mybatis0<br>1. != null 2. != Integer1</p>\n","site":{"data":{}},"excerpt":"","more":"<p>mybatis0<br>1. != null 2. != Integer1</p>\n"},{"title":"mysql","date":"2017-12-13T07:51:47.000Z","_content":"# \n\n\n\n# \n\n```\n# /bin/bash\nDB_NAME=\"exchange\"\nDB_USER=\"root\"\nDB_PASSWORD=\"abc123\"\nBIN_DIR=\"/usr/bin\"\nBACK_DIR=\"/root/data\"\nDATE=\"mysql-`date +'%Y%m%d-%H:%M:%S'`\"\nLogFile=\"$BACK_DIR\"/dbbakup.log\nBackNewFile=$DATE.sql\n\n$BIN_DIR/mysqldump -u$DB_USER -p$DB_PASSWORD $DB_NAME > $BACK_DIR/$DATE.sql\n\necho -----------------\"$(date +\"%y-%m-%d %H:%M:%S\")\"------------------ >> $LogFile\n\necho  createFile:\"$BackNewFile\" >> $LogFile\n\nfind \"/root/data/\" -ctime +0 -type f -name \"*.sql\" -print > deleted.txt\n\necho -e \"delete files:\\n\" >> $LogFile\n\ncat deleted.txt | while read LINE\ndo\n    rm -rf $LINE\n    echo $LINE>> $LogFile\ndone\n\necho \"---------------------------------------------------------------\" >> $LogFile\n```\n\n# cron\n\ncronsql\n 12:50mysqlback.sh\n```\n50 12 * * * /root/mysqlback.sh\n```\n","source":"_posts/mysql-back.md","raw":"---\ntitle: mysql\ndate: 2017-12-13 15:51:47\ntags:\n---\n# \n\n\n\n# \n\n```\n# /bin/bash\nDB_NAME=\"exchange\"\nDB_USER=\"root\"\nDB_PASSWORD=\"abc123\"\nBIN_DIR=\"/usr/bin\"\nBACK_DIR=\"/root/data\"\nDATE=\"mysql-`date +'%Y%m%d-%H:%M:%S'`\"\nLogFile=\"$BACK_DIR\"/dbbakup.log\nBackNewFile=$DATE.sql\n\n$BIN_DIR/mysqldump -u$DB_USER -p$DB_PASSWORD $DB_NAME > $BACK_DIR/$DATE.sql\n\necho -----------------\"$(date +\"%y-%m-%d %H:%M:%S\")\"------------------ >> $LogFile\n\necho  createFile:\"$BackNewFile\" >> $LogFile\n\nfind \"/root/data/\" -ctime +0 -type f -name \"*.sql\" -print > deleted.txt\n\necho -e \"delete files:\\n\" >> $LogFile\n\ncat deleted.txt | while read LINE\ndo\n    rm -rf $LINE\n    echo $LINE>> $LogFile\ndone\n\necho \"---------------------------------------------------------------\" >> $LogFile\n```\n\n# cron\n\ncronsql\n 12:50mysqlback.sh\n```\n50 12 * * * /root/mysqlback.sh\n```\n","slug":"mysql-back","published":1,"updated":"2019-12-24T02:00:57.440Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jw6000l0j9kkfbf7qc5","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># /bin/bash</span><br><span class=\"line\">DB_NAME=&quot;exchange&quot;</span><br><span class=\"line\">DB_USER=&quot;root&quot;</span><br><span class=\"line\">DB_PASSWORD=&quot;abc123&quot;</span><br><span class=\"line\">BIN_DIR=&quot;/usr/bin&quot;</span><br><span class=\"line\">BACK_DIR=&quot;/root/data&quot;</span><br><span class=\"line\">DATE=&quot;mysql-`date +&apos;%Y%m%d-%H:%M:%S&apos;`&quot;</span><br><span class=\"line\">LogFile=&quot;$BACK_DIR&quot;/dbbakup.log</span><br><span class=\"line\">BackNewFile=$DATE.sql</span><br><span class=\"line\"></span><br><span class=\"line\">$BIN_DIR/mysqldump -u$DB_USER -p$DB_PASSWORD $DB_NAME &gt; $BACK_DIR/$DATE.sql</span><br><span class=\"line\"></span><br><span class=\"line\">echo -----------------&quot;$(date +&quot;%y-%m-%d %H:%M:%S&quot;)&quot;------------------ &gt;&gt; $LogFile</span><br><span class=\"line\"></span><br><span class=\"line\">echo  createFile:&quot;$BackNewFile&quot; &gt;&gt; $LogFile</span><br><span class=\"line\"></span><br><span class=\"line\">find &quot;/root/data/&quot; -ctime +0 -type f -name &quot;*.sql&quot; -print &gt; deleted.txt</span><br><span class=\"line\"></span><br><span class=\"line\">echo -e &quot;delete files:\\n&quot; &gt;&gt; $LogFile</span><br><span class=\"line\"></span><br><span class=\"line\">cat deleted.txt | while read LINE</span><br><span class=\"line\">do</span><br><span class=\"line\">    rm -rf $LINE</span><br><span class=\"line\">    echo $LINE&gt;&gt; $LogFile</span><br><span class=\"line\">done</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;---------------------------------------------------------------&quot; &gt;&gt; $LogFile</span><br></pre></td></tr></table></figure>\n<h1 id=\"cron\"><a href=\"#cron\" class=\"headerlink\" title=\"cron\"></a>cron</h1><p>cronsql<br> 12:50mysqlback.sh<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">50 12 * * * /root/mysqlback.sh</span><br></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># /bin/bash</span><br><span class=\"line\">DB_NAME=&quot;exchange&quot;</span><br><span class=\"line\">DB_USER=&quot;root&quot;</span><br><span class=\"line\">DB_PASSWORD=&quot;abc123&quot;</span><br><span class=\"line\">BIN_DIR=&quot;/usr/bin&quot;</span><br><span class=\"line\">BACK_DIR=&quot;/root/data&quot;</span><br><span class=\"line\">DATE=&quot;mysql-`date +&apos;%Y%m%d-%H:%M:%S&apos;`&quot;</span><br><span class=\"line\">LogFile=&quot;$BACK_DIR&quot;/dbbakup.log</span><br><span class=\"line\">BackNewFile=$DATE.sql</span><br><span class=\"line\"></span><br><span class=\"line\">$BIN_DIR/mysqldump -u$DB_USER -p$DB_PASSWORD $DB_NAME &gt; $BACK_DIR/$DATE.sql</span><br><span class=\"line\"></span><br><span class=\"line\">echo -----------------&quot;$(date +&quot;%y-%m-%d %H:%M:%S&quot;)&quot;------------------ &gt;&gt; $LogFile</span><br><span class=\"line\"></span><br><span class=\"line\">echo  createFile:&quot;$BackNewFile&quot; &gt;&gt; $LogFile</span><br><span class=\"line\"></span><br><span class=\"line\">find &quot;/root/data/&quot; -ctime +0 -type f -name &quot;*.sql&quot; -print &gt; deleted.txt</span><br><span class=\"line\"></span><br><span class=\"line\">echo -e &quot;delete files:\\n&quot; &gt;&gt; $LogFile</span><br><span class=\"line\"></span><br><span class=\"line\">cat deleted.txt | while read LINE</span><br><span class=\"line\">do</span><br><span class=\"line\">    rm -rf $LINE</span><br><span class=\"line\">    echo $LINE&gt;&gt; $LogFile</span><br><span class=\"line\">done</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;---------------------------------------------------------------&quot; &gt;&gt; $LogFile</span><br></pre></td></tr></table></figure>\n<h1 id=\"cron\"><a href=\"#cron\" class=\"headerlink\" title=\"cron\"></a>cron</h1><p>cronsql<br> 12:50mysqlback.sh<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">50 12 * * * /root/mysqlback.sh</span><br></pre></td></tr></table></figure></p>\n"},{"title":"linuxmysql","date":"2017-12-08T05:55:18.000Z","_content":"## linuxsql\n\n```\nmysql -h [host] -u [userName] -p [databaseName] < [data].sql\n```\n\n## linux\n\n```\nmysqldump -h [host] -u [username] -p --databases [databasename] > [fileName].sql\n```\n\n## linux\n\n```\nmysqldump -h [host] -u [username] -p [dabaseName] [tableName] > [fileName].sql\n```\n","source":"_posts/mysql-linux.md","raw":"---\ntitle: linuxmysql\ndate: 2017-12-08 13:55:18\ntags:\n---\n## linuxsql\n\n```\nmysql -h [host] -u [userName] -p [databaseName] < [data].sql\n```\n\n## linux\n\n```\nmysqldump -h [host] -u [username] -p --databases [databasename] > [fileName].sql\n```\n\n## linux\n\n```\nmysqldump -h [host] -u [username] -p [dabaseName] [tableName] > [fileName].sql\n```\n","slug":"mysql-linux","published":1,"updated":"2019-12-24T02:00:57.450Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jw7000m0j9kor6bddyl","content":"<h2 id=\"linuxsql\"><a href=\"#linuxsql\" class=\"headerlink\" title=\"linuxsql\"></a>linuxsql</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -h [host] -u [userName] -p [databaseName] &lt; [data].sql</span><br></pre></td></tr></table></figure>\n<h2 id=\"linux\"><a href=\"#linux\" class=\"headerlink\" title=\"linux\"></a>linux</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqldump -h [host] -u [username] -p --databases [databasename] &gt; [fileName].sql</span><br></pre></td></tr></table></figure>\n<h2 id=\"linux\"><a href=\"#linux\" class=\"headerlink\" title=\"linux\"></a>linux</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqldump -h [host] -u [username] -p [dabaseName] [tableName] &gt; [fileName].sql</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"linuxsql\"><a href=\"#linuxsql\" class=\"headerlink\" title=\"linuxsql\"></a>linuxsql</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -h [host] -u [userName] -p [databaseName] &lt; [data].sql</span><br></pre></td></tr></table></figure>\n<h2 id=\"linux\"><a href=\"#linux\" class=\"headerlink\" title=\"linux\"></a>linux</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqldump -h [host] -u [username] -p --databases [databasename] &gt; [fileName].sql</span><br></pre></td></tr></table></figure>\n<h2 id=\"linux\"><a href=\"#linux\" class=\"headerlink\" title=\"linux\"></a>linux</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqldump -h [host] -u [username] -p [dabaseName] [tableName] &gt; [fileName].sql</span><br></pre></td></tr></table></figure>\n"},{"title":"mysql","date":"2017-12-21T08:45:54.000Z","_content":"![pic](http://s1.wailian.download/2018/01/18/3ce570ed091e852cd203a1e621362585d16831a072ccc-m7zSKp_fw658.jpg)\nmysql5.7\n\n# host\n\n## mysqluser\n\n```\nuse mysql\n```\n\n```\nupdate user set host='%' where user='root'\n```\n\n## \n```\nflush privileges\n```\n\n# \n\n## rootmypwdmysql\n\n```\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'%'  IDENTIFIED BY 'mypwd'  WITH GRANT OPTION\n```\n\n## IP192.168.1.11myusermypwdmysql\n\n```\nGRANT ALL PRIVILEGES ON *.* TO 'myuser'@'192.168.1.11' IDENTIFIED BY 'mypwd' WITH GRANT OPTION\n```\n\n## \n```\nflush privileges\n```\n\n# \n\n- mysqltcp\n- ECSmysql\n","source":"_posts/mysql-out.md","raw":"---\ntitle: mysql\ndate: 2017-12-21 16:45:54\ntags:\n---\n![pic](http://s1.wailian.download/2018/01/18/3ce570ed091e852cd203a1e621362585d16831a072ccc-m7zSKp_fw658.jpg)\nmysql5.7\n\n# host\n\n## mysqluser\n\n```\nuse mysql\n```\n\n```\nupdate user set host='%' where user='root'\n```\n\n## \n```\nflush privileges\n```\n\n# \n\n## rootmypwdmysql\n\n```\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'%'  IDENTIFIED BY 'mypwd'  WITH GRANT OPTION\n```\n\n## IP192.168.1.11myusermypwdmysql\n\n```\nGRANT ALL PRIVILEGES ON *.* TO 'myuser'@'192.168.1.11' IDENTIFIED BY 'mypwd' WITH GRANT OPTION\n```\n\n## \n```\nflush privileges\n```\n\n# \n\n- mysqltcp\n- ECSmysql\n","slug":"mysql-out","published":1,"updated":"2019-12-24T02:00:57.450Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jw8000n0j9kcdz2eua3","content":"<p><img src=\"http://s1.wailian.download/2018/01/18/3ce570ed091e852cd203a1e621362585d16831a072ccc-m7zSKp_fw658.jpg\" alt=\"pic\"><br>mysql5.7</p>\n<h1 id=\"host\"><a href=\"#host\" class=\"headerlink\" title=\"host\"></a>host</h1><h2 id=\"mysqluser\"><a href=\"#mysqluser\" class=\"headerlink\" title=\"mysqluser\"></a>mysqluser</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use mysql</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">update user set host=&apos;%&apos; where user=&apos;root&apos;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flush privileges</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"rootmypwdmysql\"><a href=\"#rootmypwdmysql\" class=\"headerlink\" title=\"rootmypwdmysql\"></a>rootmypwdmysql</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;%&apos;  IDENTIFIED BY &apos;mypwd&apos;  WITH GRANT OPTION</span><br></pre></td></tr></table></figure>\n<h2 id=\"IP192-168-1-11myusermypwdmysql\"><a href=\"#IP192-168-1-11myusermypwdmysql\" class=\"headerlink\" title=\"IP192.168.1.11myusermypwdmysql\"></a>IP192.168.1.11myusermypwdmysql</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GRANT ALL PRIVILEGES ON *.* TO &apos;myuser&apos;@&apos;192.168.1.11&apos; IDENTIFIED BY &apos;mypwd&apos; WITH GRANT OPTION</span><br></pre></td></tr></table></figure>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flush privileges</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>mysqltcp</li>\n<li>ECSmysql</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://s1.wailian.download/2018/01/18/3ce570ed091e852cd203a1e621362585d16831a072ccc-m7zSKp_fw658.jpg\" alt=\"pic\"><br>mysql5.7</p>\n<h1 id=\"host\"><a href=\"#host\" class=\"headerlink\" title=\"host\"></a>host</h1><h2 id=\"mysqluser\"><a href=\"#mysqluser\" class=\"headerlink\" title=\"mysqluser\"></a>mysqluser</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use mysql</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">update user set host=&apos;%&apos; where user=&apos;root&apos;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flush privileges</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"rootmypwdmysql\"><a href=\"#rootmypwdmysql\" class=\"headerlink\" title=\"rootmypwdmysql\"></a>rootmypwdmysql</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;%&apos;  IDENTIFIED BY &apos;mypwd&apos;  WITH GRANT OPTION</span><br></pre></td></tr></table></figure>\n<h2 id=\"IP192-168-1-11myusermypwdmysql\"><a href=\"#IP192-168-1-11myusermypwdmysql\" class=\"headerlink\" title=\"IP192.168.1.11myusermypwdmysql\"></a>IP192.168.1.11myusermypwdmysql</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GRANT ALL PRIVILEGES ON *.* TO &apos;myuser&apos;@&apos;192.168.1.11&apos; IDENTIFIED BY &apos;mypwd&apos; WITH GRANT OPTION</span><br></pre></td></tr></table></figure>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flush privileges</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>mysqltcp</li>\n<li>ECSmysql</li>\n</ul>\n"},{"title":"nginxCORS","date":"2018-04-10T06:58:37.000Z","top":99,"_content":"\n![toutu](http://www.wailian.work/images/2018/04/11/502af7eae3feeb1e4b5c376c2f24e9b206182f1b187f73-7ntUXd_fw658.jpg)\n\n> nginxJavaFilternginx\n\n# CORS\n\nCORSW3C(Cross-origin resource sharing)XMLHttpRequestAJAX\n\n# \n\n```\nserver {\n    listen       80;\n    server_name  agent.bater.top;\n\n    root /var/www/html/api_agent/public;\n\n    location / {\n\n        if ($request_method = 'OPTIONS') {\n            add_header Access-Control-Allow-Origin $http_origin;\n            add_header Access-Control-Allow-Credentials true;\n            add_header Access-Control-Allow-Methods 'GET,POST,PUT,DELETE,OPTIONS';\n            add_header Access-Control-Allow-Headers 'Authorization,X-Requested-With,Content-Type,Origin,Accept,Cookie';\n            add_header Access-Control-Max-Age 3600;\n            add_header Content-Length 0;\n            return 202;\n        }\n\n        add_header Access-Control-Allow-Origin $http_origin;\n        add_header Access-Control-Allow-Credentials true;\n        add_header Access-Control-Allow-Methods 'GET,POST,PUT,DELETE,OPTIONS';\n        add_header Access-Control-Allow-Headers 'Authorization,X-Requested-With,Content-Type,Origin,Accept,Cookie';\n        \n        proxy_pass http://localhost:8080/;\n    }\n}\n```\n\n`Access-Control-Allow-Origin`: W3C(Access Control Check)Access-Control-Allow-Origin \n\n`Access-Control-Allow-Credentials`: CookieCookieCORStrueCookietrueCookie \n\n`Access-Control-Allow-Methods`: \n\n`Access-Control-Allow-Headers`: \"\"\n\n`Access-Control-Max-Age`: 136003600\n\n`Content-Length`: HTTP\n","source":"_posts/nginx-cores.md","raw":"---\ntitle: nginxCORS\ndate: 2018-04-10 14:58:37\ntags:\ntop: 99\n---\n\n![toutu](http://www.wailian.work/images/2018/04/11/502af7eae3feeb1e4b5c376c2f24e9b206182f1b187f73-7ntUXd_fw658.jpg)\n\n> nginxJavaFilternginx\n\n# CORS\n\nCORSW3C(Cross-origin resource sharing)XMLHttpRequestAJAX\n\n# \n\n```\nserver {\n    listen       80;\n    server_name  agent.bater.top;\n\n    root /var/www/html/api_agent/public;\n\n    location / {\n\n        if ($request_method = 'OPTIONS') {\n            add_header Access-Control-Allow-Origin $http_origin;\n            add_header Access-Control-Allow-Credentials true;\n            add_header Access-Control-Allow-Methods 'GET,POST,PUT,DELETE,OPTIONS';\n            add_header Access-Control-Allow-Headers 'Authorization,X-Requested-With,Content-Type,Origin,Accept,Cookie';\n            add_header Access-Control-Max-Age 3600;\n            add_header Content-Length 0;\n            return 202;\n        }\n\n        add_header Access-Control-Allow-Origin $http_origin;\n        add_header Access-Control-Allow-Credentials true;\n        add_header Access-Control-Allow-Methods 'GET,POST,PUT,DELETE,OPTIONS';\n        add_header Access-Control-Allow-Headers 'Authorization,X-Requested-With,Content-Type,Origin,Accept,Cookie';\n        \n        proxy_pass http://localhost:8080/;\n    }\n}\n```\n\n`Access-Control-Allow-Origin`: W3C(Access Control Check)Access-Control-Allow-Origin \n\n`Access-Control-Allow-Credentials`: CookieCookieCORStrueCookietrueCookie \n\n`Access-Control-Allow-Methods`: \n\n`Access-Control-Allow-Headers`: \"\"\n\n`Access-Control-Max-Age`: 136003600\n\n`Content-Length`: HTTP\n","slug":"nginx-cores","published":1,"updated":"2019-12-24T02:00:57.450Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jw9000o0j9k8ga9w48q","content":"<p><img src=\"http://www.wailian.work/images/2018/04/11/502af7eae3feeb1e4b5c376c2f24e9b206182f1b187f73-7ntUXd_fw658.jpg\" alt=\"toutu\"></p>\n<blockquote>\n<p>nginxJavaFilternginx</p>\n</blockquote>\n<h1 id=\"CORS\"><a href=\"#CORS\" class=\"headerlink\" title=\"CORS\"></a>CORS</h1><p>CORSW3C(Cross-origin resource sharing)XMLHttpRequestAJAX</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen       80;</span><br><span class=\"line\">    server_name  agent.bater.top;</span><br><span class=\"line\"></span><br><span class=\"line\">    root /var/www/html/api_agent/public;</span><br><span class=\"line\"></span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        if ($request_method = &apos;OPTIONS&apos;) &#123;</span><br><span class=\"line\">            add_header Access-Control-Allow-Origin $http_origin;</span><br><span class=\"line\">            add_header Access-Control-Allow-Credentials true;</span><br><span class=\"line\">            add_header Access-Control-Allow-Methods &apos;GET,POST,PUT,DELETE,OPTIONS&apos;;</span><br><span class=\"line\">            add_header Access-Control-Allow-Headers &apos;Authorization,X-Requested-With,Content-Type,Origin,Accept,Cookie&apos;;</span><br><span class=\"line\">            add_header Access-Control-Max-Age 3600;</span><br><span class=\"line\">            add_header Content-Length 0;</span><br><span class=\"line\">            return 202;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        add_header Access-Control-Allow-Origin $http_origin;</span><br><span class=\"line\">        add_header Access-Control-Allow-Credentials true;</span><br><span class=\"line\">        add_header Access-Control-Allow-Methods &apos;GET,POST,PUT,DELETE,OPTIONS&apos;;</span><br><span class=\"line\">        add_header Access-Control-Allow-Headers &apos;Authorization,X-Requested-With,Content-Type,Origin,Accept,Cookie&apos;;</span><br><span class=\"line\">        </span><br><span class=\"line\">        proxy_pass http://localhost:8080/;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>Access-Control-Allow-Origin</code>: W3C(Access Control Check)Access-Control-Allow-Origin </p>\n<p><code>Access-Control-Allow-Credentials</code>: CookieCookieCORStrueCookietrueCookie </p>\n<p><code>Access-Control-Allow-Methods</code>: </p>\n<p><code>Access-Control-Allow-Headers</code>: </p>\n<p><code>Access-Control-Max-Age</code>: 136003600</p>\n<p><code>Content-Length</code>: HTTP</p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/04/11/502af7eae3feeb1e4b5c376c2f24e9b206182f1b187f73-7ntUXd_fw658.jpg\" alt=\"toutu\"></p>\n<blockquote>\n<p>nginxJavaFilternginx</p>\n</blockquote>\n<h1 id=\"CORS\"><a href=\"#CORS\" class=\"headerlink\" title=\"CORS\"></a>CORS</h1><p>CORSW3C(Cross-origin resource sharing)XMLHttpRequestAJAX</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen       80;</span><br><span class=\"line\">    server_name  agent.bater.top;</span><br><span class=\"line\"></span><br><span class=\"line\">    root /var/www/html/api_agent/public;</span><br><span class=\"line\"></span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        if ($request_method = &apos;OPTIONS&apos;) &#123;</span><br><span class=\"line\">            add_header Access-Control-Allow-Origin $http_origin;</span><br><span class=\"line\">            add_header Access-Control-Allow-Credentials true;</span><br><span class=\"line\">            add_header Access-Control-Allow-Methods &apos;GET,POST,PUT,DELETE,OPTIONS&apos;;</span><br><span class=\"line\">            add_header Access-Control-Allow-Headers &apos;Authorization,X-Requested-With,Content-Type,Origin,Accept,Cookie&apos;;</span><br><span class=\"line\">            add_header Access-Control-Max-Age 3600;</span><br><span class=\"line\">            add_header Content-Length 0;</span><br><span class=\"line\">            return 202;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        add_header Access-Control-Allow-Origin $http_origin;</span><br><span class=\"line\">        add_header Access-Control-Allow-Credentials true;</span><br><span class=\"line\">        add_header Access-Control-Allow-Methods &apos;GET,POST,PUT,DELETE,OPTIONS&apos;;</span><br><span class=\"line\">        add_header Access-Control-Allow-Headers &apos;Authorization,X-Requested-With,Content-Type,Origin,Accept,Cookie&apos;;</span><br><span class=\"line\">        </span><br><span class=\"line\">        proxy_pass http://localhost:8080/;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>Access-Control-Allow-Origin</code>: W3C(Access Control Check)Access-Control-Allow-Origin </p>\n<p><code>Access-Control-Allow-Credentials</code>: CookieCookieCORStrueCookietrueCookie </p>\n<p><code>Access-Control-Allow-Methods</code>: </p>\n<p><code>Access-Control-Allow-Headers</code>: </p>\n<p><code>Access-Control-Max-Age</code>: 136003600</p>\n<p><code>Content-Length</code>: HTTP</p>\n"},{"title":"nginx","date":"2017-11-29T00:50:05.000Z","_content":"# \n\ndown\n\n# \n\nweight\n```\nupstream servername { \n    server 192.168.0.1 weight=1; \n    server 192.168.0.2 weight=12; \n} \n```\n\n# IP ip_hash\niphashsession\n```\nupstream backserver { \n    ip_hash; \n    server 192.168.0.14:88; \n    server 192.168.0.15:80; \n} \n```\n\n# fair\n\n\n```\nupstream backserver { \n    server server1; \n    server server2; \n    fair; \n} \n```\n\n\n# url_hash\n\nurlhashurl\n```\nupstream backserver { \n    server squid1:3128; \n    server squid2:3128; \n    hash $request_uri; \n    hash_method crc32; \n} \n```\n","source":"_posts/nginx-strategy.md","raw":"---\ntitle: nginx\ndate: 2017-11-29 08:50:05\ntags:\n---\n# \n\ndown\n\n# \n\nweight\n```\nupstream servername { \n    server 192.168.0.1 weight=1; \n    server 192.168.0.2 weight=12; \n} \n```\n\n# IP ip_hash\niphashsession\n```\nupstream backserver { \n    ip_hash; \n    server 192.168.0.14:88; \n    server 192.168.0.15:80; \n} \n```\n\n# fair\n\n\n```\nupstream backserver { \n    server server1; \n    server server2; \n    fair; \n} \n```\n\n\n# url_hash\n\nurlhashurl\n```\nupstream backserver { \n    server squid1:3128; \n    server squid2:3128; \n    hash $request_uri; \n    hash_method crc32; \n} \n```\n","slug":"nginx-strategy","published":1,"updated":"2019-12-24T02:00:57.450Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jwa000p0j9kzdkmkdcj","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>down</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>weight<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream servername &#123; </span><br><span class=\"line\">    server 192.168.0.1 weight=1; </span><br><span class=\"line\">    server 192.168.0.2 weight=12; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"IP-ip-hash\"><a href=\"#IP-ip-hash\" class=\"headerlink\" title=\"IP ip_hash\"></a>IP ip_hash</h1><p>iphashsession<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream backserver &#123; </span><br><span class=\"line\">    ip_hash; </span><br><span class=\"line\">    server 192.168.0.14:88; </span><br><span class=\"line\">    server 192.168.0.15:80; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"fair\"><a href=\"#fair\" class=\"headerlink\" title=\"fair\"></a>fair</h1><p><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream backserver &#123; </span><br><span class=\"line\">    server server1; </span><br><span class=\"line\">    server server2; </span><br><span class=\"line\">    fair; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p></p>\n<h1 id=\"url-hash\"><a href=\"#url-hash\" class=\"headerlink\" title=\"url_hash\"></a>url_hash</h1><p>urlhashurl<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream backserver &#123; </span><br><span class=\"line\">    server squid1:3128; </span><br><span class=\"line\">    server squid2:3128; </span><br><span class=\"line\">    hash $request_uri; </span><br><span class=\"line\">    hash_method crc32; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>down</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>weight<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream servername &#123; </span><br><span class=\"line\">    server 192.168.0.1 weight=1; </span><br><span class=\"line\">    server 192.168.0.2 weight=12; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"IP-ip-hash\"><a href=\"#IP-ip-hash\" class=\"headerlink\" title=\"IP ip_hash\"></a>IP ip_hash</h1><p>iphashsession<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream backserver &#123; </span><br><span class=\"line\">    ip_hash; </span><br><span class=\"line\">    server 192.168.0.14:88; </span><br><span class=\"line\">    server 192.168.0.15:80; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"fair\"><a href=\"#fair\" class=\"headerlink\" title=\"fair\"></a>fair</h1><p><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream backserver &#123; </span><br><span class=\"line\">    server server1; </span><br><span class=\"line\">    server server2; </span><br><span class=\"line\">    fair; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p></p>\n<h1 id=\"url-hash\"><a href=\"#url-hash\" class=\"headerlink\" title=\"url_hash\"></a>url_hash</h1><p>urlhashurl<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream backserver &#123; </span><br><span class=\"line\">    server squid1:3128; </span><br><span class=\"line\">    server squid2:3128; </span><br><span class=\"line\">    hash $request_uri; </span><br><span class=\"line\">    hash_method crc32; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n"},{"title":"Spring Bootnohup.out","date":"2017-11-29T03:31:35.000Z","_content":"```\nnohup java -jar yatai_pro-0.0.1-SNAPSHOT.jar --spring.profiles.active=prod >/dev/null &\n```\n>/dev/null \n","source":"_posts/nohup.md","raw":"---\ntitle: Spring Bootnohup.out\ndate: 2017-11-29 11:31:35\ntags:\n---\n```\nnohup java -jar yatai_pro-0.0.1-SNAPSHOT.jar --spring.profiles.active=prod >/dev/null &\n```\n>/dev/null \n","slug":"nohup","published":1,"updated":"2019-12-24T02:00:57.450Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jwc000q0j9k9edifxnc","content":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup java -jar yatai_pro-0.0.1-SNAPSHOT.jar --spring.profiles.active=prod &gt;/dev/null &amp;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>/dev/null </p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup java -jar yatai_pro-0.0.1-SNAPSHOT.jar --spring.profiles.active=prod &gt;/dev/null &amp;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>/dev/null </p>\n</blockquote>\n"},{"title":"-","date":"2018-06-16T07:47:39.000Z","_content":"\n# \n\n\n\n\n\n\n\n1. \n2. \n3. \n4. \n\n\n->->->\n->->->\n\n13\n\n24\n\n4\"\"\n\nDrinkTemplate.java\n\nfinal\n\n```\npublic abstract class DrinkTemplate {\n    public final void drinkTemplate() {\n        // \n        boilWater();\n        // \n        brew();\n        // \n        pourInCup();\n        // \n        addCondiments();\n    }\n\n    // \n    protected abstract void addCondiments();\n\n    protected void pourInCup() {\n        System.out.println(\"\");\n    }\n\n    // \n    protected abstract void brew();\n\n    protected void boilWater() {\n        System.out.println(\"...\");\n    }\n}\n```\n\n\n\nMakeCoffee.java\n\n```\npublic class MakeCoffee extends DrinkTemplate{\n    @Override\n    protected void addCondiments() {\n        System.out.println(\"...\");\n    }\n\n    @Override\n    protected void brew() {\n        System.out.println(\"...\");\n    }\n}\n```\n\n\nMakeOrange.java\n\n```\npublic class MakeOrange extends DrinkTemplate{\n    @Override\n    protected void addCondiments() {\n        System.out.println(\"...\");\n    }\n\n    @Override\n    protected void brew() {\n        System.out.println(\"...\");\n    }\n\n    protected void pourInCup() {\n        System.out.println(\"\");\n    }\n}\n```\n\n`\n","source":"_posts/pattern-template.md","raw":"---\ntitle: -\ndate: 2018-06-16 15:47:39\ntags:\ncategories: \n---\n\n# \n\n\n\n\n\n\n\n1. \n2. \n3. \n4. \n\n\n->->->\n->->->\n\n13\n\n24\n\n4\"\"\n\nDrinkTemplate.java\n\nfinal\n\n```\npublic abstract class DrinkTemplate {\n    public final void drinkTemplate() {\n        // \n        boilWater();\n        // \n        brew();\n        // \n        pourInCup();\n        // \n        addCondiments();\n    }\n\n    // \n    protected abstract void addCondiments();\n\n    protected void pourInCup() {\n        System.out.println(\"\");\n    }\n\n    // \n    protected abstract void brew();\n\n    protected void boilWater() {\n        System.out.println(\"...\");\n    }\n}\n```\n\n\n\nMakeCoffee.java\n\n```\npublic class MakeCoffee extends DrinkTemplate{\n    @Override\n    protected void addCondiments() {\n        System.out.println(\"...\");\n    }\n\n    @Override\n    protected void brew() {\n        System.out.println(\"...\");\n    }\n}\n```\n\n\nMakeOrange.java\n\n```\npublic class MakeOrange extends DrinkTemplate{\n    @Override\n    protected void addCondiments() {\n        System.out.println(\"...\");\n    }\n\n    @Override\n    protected void brew() {\n        System.out.println(\"...\");\n    }\n\n    protected void pourInCup() {\n        System.out.println(\"\");\n    }\n}\n```\n\n`\n","slug":"pattern-template","published":1,"updated":"2019-12-24T02:00:57.450Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jwd000r0j9ksaqynoez","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p><br>-&gt;-&gt;-&gt;<br>-&gt;-&gt;-&gt;</p>\n<p>13</p>\n<p>24</p>\n<p>4</p>\n<p>DrinkTemplate.java</p>\n<p>final</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public abstract class DrinkTemplate &#123;</span><br><span class=\"line\">    public final void drinkTemplate() &#123;</span><br><span class=\"line\">        // </span><br><span class=\"line\">        boilWater();</span><br><span class=\"line\">        // </span><br><span class=\"line\">        brew();</span><br><span class=\"line\">        // </span><br><span class=\"line\">        pourInCup();</span><br><span class=\"line\">        // </span><br><span class=\"line\">        addCondiments();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    protected abstract void addCondiments();</span><br><span class=\"line\"></span><br><span class=\"line\">    protected void pourInCup() &#123;</span><br><span class=\"line\">        System.out.println(&quot;&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    protected abstract void brew();</span><br><span class=\"line\"></span><br><span class=\"line\">    protected void boilWater() &#123;</span><br><span class=\"line\">        System.out.println(&quot;...&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>MakeCoffee.java</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class MakeCoffee extends DrinkTemplate&#123;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void addCondiments() &#123;</span><br><span class=\"line\">        System.out.println(&quot;...&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void brew() &#123;</span><br><span class=\"line\">        System.out.println(&quot;...&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>MakeOrange.java</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class MakeOrange extends DrinkTemplate&#123;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void addCondiments() &#123;</span><br><span class=\"line\">        System.out.println(&quot;...&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void brew() &#123;</span><br><span class=\"line\">        System.out.println(&quot;...&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    protected void pourInCup() &#123;</span><br><span class=\"line\">        System.out.println(&quot;&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>`</p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p><br>-&gt;-&gt;-&gt;<br>-&gt;-&gt;-&gt;</p>\n<p>13</p>\n<p>24</p>\n<p>4</p>\n<p>DrinkTemplate.java</p>\n<p>final</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public abstract class DrinkTemplate &#123;</span><br><span class=\"line\">    public final void drinkTemplate() &#123;</span><br><span class=\"line\">        // </span><br><span class=\"line\">        boilWater();</span><br><span class=\"line\">        // </span><br><span class=\"line\">        brew();</span><br><span class=\"line\">        // </span><br><span class=\"line\">        pourInCup();</span><br><span class=\"line\">        // </span><br><span class=\"line\">        addCondiments();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    protected abstract void addCondiments();</span><br><span class=\"line\"></span><br><span class=\"line\">    protected void pourInCup() &#123;</span><br><span class=\"line\">        System.out.println(&quot;&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    protected abstract void brew();</span><br><span class=\"line\"></span><br><span class=\"line\">    protected void boilWater() &#123;</span><br><span class=\"line\">        System.out.println(&quot;...&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>MakeCoffee.java</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class MakeCoffee extends DrinkTemplate&#123;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void addCondiments() &#123;</span><br><span class=\"line\">        System.out.println(&quot;...&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void brew() &#123;</span><br><span class=\"line\">        System.out.println(&quot;...&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>MakeOrange.java</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class MakeOrange extends DrinkTemplate&#123;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void addCondiments() &#123;</span><br><span class=\"line\">        System.out.println(&quot;...&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void brew() &#123;</span><br><span class=\"line\">        System.out.println(&quot;...&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    protected void pourInCup() &#123;</span><br><span class=\"line\">        System.out.println(&quot;&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>`</p>\n"},{"title":"axiosPromisetoken","date":"2019-12-24T01:18:50.000Z","_content":"![](http://s1.wailian.download/2019/12/24/snow-ball-4708528_1280.jpg)\n\n# \n\n`token``refreshToken``token``refreshToken``token``refreshToken``token`\n\n# \n\n axios `token``token`\n\n# \n\n token  token \n\n# \n\n```javascript\nimport axios from \"axios\";\n\n// axios\nconst instance = axios.create({\n  baseURL: \"/api\",\n  timeout: 300000,\n  headers: {\n    \"Content-Type\": \"application/json\",\n    \"X-Token\": getLocalToken() // headerstoken\n  }\n});\n\n// localStoragetoken\nfunction getLocalToken() {\n  const token = window.localStorage.getItem(\"token\");\n  return token;\n}\n\n// setTokentokenheadertokenlocalStorage\ninstance.setToken = token => {\n  instance.defaults.headers[\"X-Token\"] = token;\n  window.localStorage.setItem(\"token\", token);\n};\n\nfunction refreshToken() {\n  // instancerequest.jsaxios\n  return instance.post(\"/refreshtoken\").then(res => res.data);\n}\n\n// \nlet isRefreshing = false;\n// \nlet retryRequests = [];\n//  axios.interceptors.request.use()\ninstance.interceptors.response.use(\n  response => {\n    const { code } = response.data;\n    // code === 4001token\n    if (code === 4001) {\n      // config\n      const config = response.config;\n      if (!isRefreshing) {\n        isRefreshing = true;\n        return refreshToken().then(res => {\n            const { token } = res.data;\n            instance.setToken(token);\n            config.headers[\"X-Token\"] = token;\n            //  baseURL\n            config.baseURL = \"\";\n            // \n            retryRequests.forEach(cb => cb(token));\n            retryRequests = [];\n            return instance(config);\n          }).catch(res => {\n            console.error(\"refreshtoken error =>\", res);\n            window.location.href = \"/\";\n          }).finally(() => {\n            // \n            isRefreshing = false;\n          });\n      } else {\n        // tokenresolvepromise\n        return new Promise(resolve => {\n          // resolvetoken\n          retryRequests.push(token => {\n            config.baseURL = \"\";\n            config.headers[\"X-Token\"] = token;\n            resolve(instance(config));\n          });\n        });\n      }\n    }\n    return response;\n  },\n  error => {\n    return Promise.reject(error);\n  }\n);\n\nexport default instance;\n```\n","source":"_posts/promise-to-refreshtoken.md","raw":"---\ntitle: axiosPromisetoken\ndate: 2019-12-24 09:18:50\ntags: \n---\n![](http://s1.wailian.download/2019/12/24/snow-ball-4708528_1280.jpg)\n\n# \n\n`token``refreshToken``token``refreshToken``token``refreshToken``token`\n\n# \n\n axios `token``token`\n\n# \n\n token  token \n\n# \n\n```javascript\nimport axios from \"axios\";\n\n// axios\nconst instance = axios.create({\n  baseURL: \"/api\",\n  timeout: 300000,\n  headers: {\n    \"Content-Type\": \"application/json\",\n    \"X-Token\": getLocalToken() // headerstoken\n  }\n});\n\n// localStoragetoken\nfunction getLocalToken() {\n  const token = window.localStorage.getItem(\"token\");\n  return token;\n}\n\n// setTokentokenheadertokenlocalStorage\ninstance.setToken = token => {\n  instance.defaults.headers[\"X-Token\"] = token;\n  window.localStorage.setItem(\"token\", token);\n};\n\nfunction refreshToken() {\n  // instancerequest.jsaxios\n  return instance.post(\"/refreshtoken\").then(res => res.data);\n}\n\n// \nlet isRefreshing = false;\n// \nlet retryRequests = [];\n//  axios.interceptors.request.use()\ninstance.interceptors.response.use(\n  response => {\n    const { code } = response.data;\n    // code === 4001token\n    if (code === 4001) {\n      // config\n      const config = response.config;\n      if (!isRefreshing) {\n        isRefreshing = true;\n        return refreshToken().then(res => {\n            const { token } = res.data;\n            instance.setToken(token);\n            config.headers[\"X-Token\"] = token;\n            //  baseURL\n            config.baseURL = \"\";\n            // \n            retryRequests.forEach(cb => cb(token));\n            retryRequests = [];\n            return instance(config);\n          }).catch(res => {\n            console.error(\"refreshtoken error =>\", res);\n            window.location.href = \"/\";\n          }).finally(() => {\n            // \n            isRefreshing = false;\n          });\n      } else {\n        // tokenresolvepromise\n        return new Promise(resolve => {\n          // resolvetoken\n          retryRequests.push(token => {\n            config.baseURL = \"\";\n            config.headers[\"X-Token\"] = token;\n            resolve(instance(config));\n          });\n        });\n      }\n    }\n    return response;\n  },\n  error => {\n    return Promise.reject(error);\n  }\n);\n\nexport default instance;\n```\n","slug":"promise-to-refreshtoken","published":1,"updated":"2019-12-24T02:14:59.890Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jwe000s0j9k30riapwx","content":"<p><img src=\"http://s1.wailian.download/2019/12/24/snow-ball-4708528_1280.jpg\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>token</code><code>refreshToken</code><code>token</code><code>refreshToken</code><code>token</code><code>refreshToken</code><code>token</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> axios <code>token</code><code>token</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> token  token </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> axios <span class=\"keyword\">from</span> <span class=\"string\">\"axios\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// axios</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> instance = axios.create(&#123;</span><br><span class=\"line\">  baseURL: <span class=\"string\">\"/api\"</span>,</span><br><span class=\"line\">  timeout: <span class=\"number\">300000</span>,</span><br><span class=\"line\">  headers: &#123;</span><br><span class=\"line\">    <span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"application/json\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"X-Token\"</span>: getLocalToken() <span class=\"comment\">// headerstoken</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// localStoragetoken</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getLocalToken</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> token = <span class=\"built_in\">window</span>.localStorage.getItem(<span class=\"string\">\"token\"</span>);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> token;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// setTokentokenheadertokenlocalStorage</span></span><br><span class=\"line\">instance.setToken = <span class=\"function\"><span class=\"params\">token</span> =&gt;</span> &#123;</span><br><span class=\"line\">  instance.defaults.headers[<span class=\"string\">\"X-Token\"</span>] = token;</span><br><span class=\"line\">  <span class=\"built_in\">window</span>.localStorage.setItem(<span class=\"string\">\"token\"</span>, token);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">refreshToken</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">// instancerequest.jsaxios</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> instance.post(<span class=\"string\">\"/refreshtoken\"</span>).then(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> res.data);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">let</span> isRefreshing = <span class=\"literal\">false</span>;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">let</span> retryRequests = [];</span><br><span class=\"line\"><span class=\"comment\">//  axios.interceptors.request.use()</span></span><br><span class=\"line\">instance.interceptors.response.use(</span><br><span class=\"line\">  response =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> &#123; code &#125; = response.data;</span><br><span class=\"line\">    <span class=\"comment\">// code === 4001token</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (code === <span class=\"number\">4001</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// config</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> config = response.config;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (!isRefreshing) &#123;</span><br><span class=\"line\">        isRefreshing = <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> refreshToken().then(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> &#123; token &#125; = res.data;</span><br><span class=\"line\">            instance.setToken(token);</span><br><span class=\"line\">            config.headers[<span class=\"string\">\"X-Token\"</span>] = token;</span><br><span class=\"line\">            <span class=\"comment\">//  baseURL</span></span><br><span class=\"line\">            config.baseURL = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            retryRequests.forEach(<span class=\"function\"><span class=\"params\">cb</span> =&gt;</span> cb(token));</span><br><span class=\"line\">            retryRequests = [];</span><br><span class=\"line\">            <span class=\"keyword\">return</span> instance(config);</span><br><span class=\"line\">          &#125;).catch(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.error(<span class=\"string\">\"refreshtoken error =&gt;\"</span>, res);</span><br><span class=\"line\">            <span class=\"built_in\">window</span>.location.href = <span class=\"string\">\"/\"</span>;</span><br><span class=\"line\">          &#125;).finally(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            isRefreshing = <span class=\"literal\">false</span>;</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// tokenresolvepromise</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"comment\">// resolvetoken</span></span><br><span class=\"line\">          retryRequests.push(<span class=\"function\"><span class=\"params\">token</span> =&gt;</span> &#123;</span><br><span class=\"line\">            config.baseURL = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">            config.headers[<span class=\"string\">\"X-Token\"</span>] = token;</span><br><span class=\"line\">            resolve(instance(config));</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> response;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  error =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">Promise</span>.reject(error);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> instance;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://s1.wailian.download/2019/12/24/snow-ball-4708528_1280.jpg\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>token</code><code>refreshToken</code><code>token</code><code>refreshToken</code><code>token</code><code>refreshToken</code><code>token</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> axios <code>token</code><code>token</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> token  token </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> axios <span class=\"keyword\">from</span> <span class=\"string\">\"axios\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// axios</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> instance = axios.create(&#123;</span><br><span class=\"line\">  baseURL: <span class=\"string\">\"/api\"</span>,</span><br><span class=\"line\">  timeout: <span class=\"number\">300000</span>,</span><br><span class=\"line\">  headers: &#123;</span><br><span class=\"line\">    <span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"application/json\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"X-Token\"</span>: getLocalToken() <span class=\"comment\">// headerstoken</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// localStoragetoken</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getLocalToken</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> token = <span class=\"built_in\">window</span>.localStorage.getItem(<span class=\"string\">\"token\"</span>);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> token;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// setTokentokenheadertokenlocalStorage</span></span><br><span class=\"line\">instance.setToken = <span class=\"function\"><span class=\"params\">token</span> =&gt;</span> &#123;</span><br><span class=\"line\">  instance.defaults.headers[<span class=\"string\">\"X-Token\"</span>] = token;</span><br><span class=\"line\">  <span class=\"built_in\">window</span>.localStorage.setItem(<span class=\"string\">\"token\"</span>, token);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">refreshToken</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">// instancerequest.jsaxios</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> instance.post(<span class=\"string\">\"/refreshtoken\"</span>).then(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> res.data);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">let</span> isRefreshing = <span class=\"literal\">false</span>;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">let</span> retryRequests = [];</span><br><span class=\"line\"><span class=\"comment\">//  axios.interceptors.request.use()</span></span><br><span class=\"line\">instance.interceptors.response.use(</span><br><span class=\"line\">  response =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> &#123; code &#125; = response.data;</span><br><span class=\"line\">    <span class=\"comment\">// code === 4001token</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (code === <span class=\"number\">4001</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// config</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> config = response.config;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (!isRefreshing) &#123;</span><br><span class=\"line\">        isRefreshing = <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> refreshToken().then(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> &#123; token &#125; = res.data;</span><br><span class=\"line\">            instance.setToken(token);</span><br><span class=\"line\">            config.headers[<span class=\"string\">\"X-Token\"</span>] = token;</span><br><span class=\"line\">            <span class=\"comment\">//  baseURL</span></span><br><span class=\"line\">            config.baseURL = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            retryRequests.forEach(<span class=\"function\"><span class=\"params\">cb</span> =&gt;</span> cb(token));</span><br><span class=\"line\">            retryRequests = [];</span><br><span class=\"line\">            <span class=\"keyword\">return</span> instance(config);</span><br><span class=\"line\">          &#125;).catch(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.error(<span class=\"string\">\"refreshtoken error =&gt;\"</span>, res);</span><br><span class=\"line\">            <span class=\"built_in\">window</span>.location.href = <span class=\"string\">\"/\"</span>;</span><br><span class=\"line\">          &#125;).finally(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            isRefreshing = <span class=\"literal\">false</span>;</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// tokenresolvepromise</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"comment\">// resolvetoken</span></span><br><span class=\"line\">          retryRequests.push(<span class=\"function\"><span class=\"params\">token</span> =&gt;</span> &#123;</span><br><span class=\"line\">            config.baseURL = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">            config.headers[<span class=\"string\">\"X-Token\"</span>] = token;</span><br><span class=\"line\">            resolve(instance(config));</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> response;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  error =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">Promise</span>.reject(error);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> instance;</span><br></pre></td></tr></table></figure>\n"},{"title":"","date":"2020-07-03T02:11:12.000Z","_content":"\n**** **** ****\n\n## \n\n\n\n## \n\n******** \n\n\n\n\n\n![4179645397-5b6e4903ec371_articlex.png](http://s1.wailian.download/2020/07/03/4179645397-5b6e4903ec371_articlex.png)\n\nGoogleGuavaRateLimiter\n\n\n\n\n```java\n@Inherited\n@Documented\n@Target({ElementType.METHOD, ElementType.FIELD, ElementType.TYPE})\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface RateLimitAspect {\n\n}\n```\n\n\n\n```java\n@Component\n@Scope\n@Aspect\npublic class RateLimitAop {\n    @Autowired(required = false)\n    private HttpServletResponse response;\n\n    private RateLimiter rateLimiter = RateLimiter.create(5); //\"\"5\n\n    @Pointcut(\"@annotation(cc.wangweiye.ratelimit.RateLimitAspect)\")\n    public void serviceLimit() {\n\n    }\n\n    @Around(\"serviceLimit()\")\n    public Object around(ProceedingJoinPoint joinPoint) {\n        Boolean flag = rateLimiter.tryAcquire();\n        Object obj = \"\";\n        try {\n            if (flag) {\n                obj = joinPoint.proceed();\n            } else {\n                String result = \"failure\";\n\n                output(response, result);\n            }\n        } catch (Throwable e) {\n            e.printStackTrace();\n        }\n        System.out.println(\"flag=\" + flag + \",obj=\" + obj);\n        return obj;\n    }\n\n    public void output(HttpServletResponse response, String msg) throws IOException {\n        response.setContentType(\"application/json;charset=UTF-8\");\n        ServletOutputStream outputStream = null;\n        try {\n            outputStream = response.getOutputStream();\n            outputStream.write(msg.getBytes(\"UTF-8\"));\n        } catch (IOException e) {\n            e.printStackTrace();\n        } finally {\n            outputStream.flush();\n            outputStream.close();\n        }\n    }\n}\n```\n\n[](https://github.com/wangweiye01/ratelimit)","source":"_posts/ratelimit.md","raw":"---\ntitle: \ndate: 2020-07-03 10:11:12\ntags:\n---\n\n**** **** ****\n\n## \n\n\n\n## \n\n******** \n\n\n\n\n\n![4179645397-5b6e4903ec371_articlex.png](http://s1.wailian.download/2020/07/03/4179645397-5b6e4903ec371_articlex.png)\n\nGoogleGuavaRateLimiter\n\n\n\n\n```java\n@Inherited\n@Documented\n@Target({ElementType.METHOD, ElementType.FIELD, ElementType.TYPE})\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface RateLimitAspect {\n\n}\n```\n\n\n\n```java\n@Component\n@Scope\n@Aspect\npublic class RateLimitAop {\n    @Autowired(required = false)\n    private HttpServletResponse response;\n\n    private RateLimiter rateLimiter = RateLimiter.create(5); //\"\"5\n\n    @Pointcut(\"@annotation(cc.wangweiye.ratelimit.RateLimitAspect)\")\n    public void serviceLimit() {\n\n    }\n\n    @Around(\"serviceLimit()\")\n    public Object around(ProceedingJoinPoint joinPoint) {\n        Boolean flag = rateLimiter.tryAcquire();\n        Object obj = \"\";\n        try {\n            if (flag) {\n                obj = joinPoint.proceed();\n            } else {\n                String result = \"failure\";\n\n                output(response, result);\n            }\n        } catch (Throwable e) {\n            e.printStackTrace();\n        }\n        System.out.println(\"flag=\" + flag + \",obj=\" + obj);\n        return obj;\n    }\n\n    public void output(HttpServletResponse response, String msg) throws IOException {\n        response.setContentType(\"application/json;charset=UTF-8\");\n        ServletOutputStream outputStream = null;\n        try {\n            outputStream = response.getOutputStream();\n            outputStream.write(msg.getBytes(\"UTF-8\"));\n        } catch (IOException e) {\n            e.printStackTrace();\n        } finally {\n            outputStream.flush();\n            outputStream.close();\n        }\n    }\n}\n```\n\n[](https://github.com/wangweiye01/ratelimit)","slug":"ratelimit","published":1,"updated":"2020-07-03T03:08:51.740Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jwu000u0j9kv3jvqiz2","content":"<p><strong></strong> <strong></strong> <strong></strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong><strong></strong> </p>\n<p></p>\n<p></p>\n<p><img src=\"http://s1.wailian.download/2020/07/03/4179645397-5b6e4903ec371_articlex.png\" alt=\"4179645397-5b6e4903ec371_articlex.png\"></p>\n<p>GoogleGuavaRateLimiter</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Inherited</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Target</span>(&#123;ElementType.METHOD, ElementType.FIELD, ElementType.TYPE&#125;)</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> RateLimitAspect &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@Scope</span></span><br><span class=\"line\"><span class=\"meta\">@Aspect</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RateLimitAop</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span>(required = <span class=\"keyword\">false</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> HttpServletResponse response;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> RateLimiter rateLimiter = RateLimiter.create(<span class=\"number\">5</span>); <span class=\"comment\">//\"\"5</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Pointcut</span>(<span class=\"string\">\"@annotation(cc.wangweiye.ratelimit.RateLimitAspect)\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">serviceLimit</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Around</span>(<span class=\"string\">\"serviceLimit()\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">around</span><span class=\"params\">(ProceedingJoinPoint joinPoint)</span> </span>&#123;</span><br><span class=\"line\">        Boolean flag = rateLimiter.tryAcquire();</span><br><span class=\"line\">        Object obj = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (flag) &#123;</span><br><span class=\"line\">                obj = joinPoint.proceed();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                String result = <span class=\"string\">\"failure\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                output(response, result);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Throwable e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"flag=\"</span> + flag + <span class=\"string\">\",obj=\"</span> + obj);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> obj;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">output</span><span class=\"params\">(HttpServletResponse response, String msg)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        response.setContentType(<span class=\"string\">\"application/json;charset=UTF-8\"</span>);</span><br><span class=\"line\">        ServletOutputStream outputStream = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            outputStream = response.getOutputStream();</span><br><span class=\"line\">            outputStream.write(msg.getBytes(<span class=\"string\">\"UTF-8\"</span>));</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            outputStream.flush();</span><br><span class=\"line\">            outputStream.close();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://github.com/wangweiye01/ratelimit\" target=\"_blank\" rel=\"noopener\"></a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><strong></strong> <strong></strong> <strong></strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong><strong></strong> </p>\n<p></p>\n<p></p>\n<p><img src=\"http://s1.wailian.download/2020/07/03/4179645397-5b6e4903ec371_articlex.png\" alt=\"4179645397-5b6e4903ec371_articlex.png\"></p>\n<p>GoogleGuavaRateLimiter</p>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Inherited</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Target</span>(&#123;ElementType.METHOD, ElementType.FIELD, ElementType.TYPE&#125;)</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> RateLimitAspect &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@Scope</span></span><br><span class=\"line\"><span class=\"meta\">@Aspect</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RateLimitAop</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span>(required = <span class=\"keyword\">false</span>)</span><br><span class=\"line\">    <span class=\"keyword\">private</span> HttpServletResponse response;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> RateLimiter rateLimiter = RateLimiter.create(<span class=\"number\">5</span>); <span class=\"comment\">//\"\"5</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Pointcut</span>(<span class=\"string\">\"@annotation(cc.wangweiye.ratelimit.RateLimitAspect)\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">serviceLimit</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Around</span>(<span class=\"string\">\"serviceLimit()\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">around</span><span class=\"params\">(ProceedingJoinPoint joinPoint)</span> </span>&#123;</span><br><span class=\"line\">        Boolean flag = rateLimiter.tryAcquire();</span><br><span class=\"line\">        Object obj = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (flag) &#123;</span><br><span class=\"line\">                obj = joinPoint.proceed();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                String result = <span class=\"string\">\"failure\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                output(response, result);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Throwable e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"flag=\"</span> + flag + <span class=\"string\">\",obj=\"</span> + obj);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> obj;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">output</span><span class=\"params\">(HttpServletResponse response, String msg)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        response.setContentType(<span class=\"string\">\"application/json;charset=UTF-8\"</span>);</span><br><span class=\"line\">        ServletOutputStream outputStream = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            outputStream = response.getOutputStream();</span><br><span class=\"line\">            outputStream.write(msg.getBytes(<span class=\"string\">\"UTF-8\"</span>));</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            outputStream.flush();</span><br><span class=\"line\">            outputStream.close();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://github.com/wangweiye01/ratelimit\" target=\"_blank\" rel=\"noopener\"></a></p>\n"},{"title":"mysql","date":"2017-12-05T10:04:35.000Z","_content":"```\nround(6378.138*2*asin(sqrt(pow(sin( (lat1*pi()/180-lat2*pi()/180)/2),2)+cos(lat1*pi()/180)*cos(lat2*pi()/180)* pow(sin( (lng1*pi()/180-lng2*pi()/180)/2),2)))*1000)\n```\n","source":"_posts/round.md","raw":"---\ntitle: mysql\ndate: 2017-12-05 18:04:35\ntags:\n---\n```\nround(6378.138*2*asin(sqrt(pow(sin( (lat1*pi()/180-lat2*pi()/180)/2),2)+cos(lat1*pi()/180)*cos(lat2*pi()/180)* pow(sin( (lng1*pi()/180-lng2*pi()/180)/2),2)))*1000)\n```\n","slug":"round","published":1,"updated":"2019-12-24T02:00:57.450Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jww000w0j9kcwt1fa13","content":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">round(6378.138*2*asin(sqrt(pow(sin( (lat1*pi()/180-lat2*pi()/180)/2),2)+cos(lat1*pi()/180)*cos(lat2*pi()/180)* pow(sin( (lng1*pi()/180-lng2*pi()/180)/2),2)))*1000)</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">round(6378.138*2*asin(sqrt(pow(sin( (lat1*pi()/180-lat2*pi()/180)/2),2)+cos(lat1*pi()/180)*cos(lat2*pi()/180)* pow(sin( (lng1*pi()/180-lng2*pi()/180)/2),2)))*1000)</span><br></pre></td></tr></table></figure>\n"},{"title":"","date":"2018-03-05T02:48:42.000Z","top":1000,"_content":"\n![](http://www.wailian.work/images/2018/03/05/1211.jpg)\n\n> \n\n\n\n\n\n\n\n# \n\n![pengding](http://www.wailian.work/images/2018/03/05/pending.png)\n\n\n\n![408](http://www.wailian.work/images/2018/03/05/408.png)\n\n408pending\n\n\n\n1. -(UUID)\n2. UUID\n3. \n4. (wait)\n5. (notify)\n6. \n\n3408timeout\n\n# UUID\n\n```\npublic static Map<String, ScanPool> cacheMap = new ConcurrentHashMap<String, ScanPool>();\n```\n\nConcurrentHashMapConcurrentModificationException\n\n\n\n\n\n\n\n# \n\n```\n@RequestMapping(\"/qrcode/{uuid}\")\n@ResponseBody\nString createQRCode(@PathVariable String uuid, HttpServletResponse response) {\n    System.out.println(\"\");\n\n    String text = \"http://2b082e46.ngrok.io/login/\" + uuid;\n    int width = 300;\n    int height = 300;\n    String format = \"png\";\n    //UUID\n    ScanPool pool = new ScanPool();\n    PoolCache.cacheMap.put(uuid, pool);\n    try {\n        Map<EncodeHintType, Object> hints = new HashMap<EncodeHintType, Object>();\n        hints.put(EncodeHintType.CHARACTER_SET, \"utf-8\");\n        hints.put(EncodeHintType.ERROR_CORRECTION, ErrorCorrectionLevel.H); //\n        BitMatrix bitMatrix = new MultiFormatWriter().encode(text, BarcodeFormat.QR_CODE, width, height, hints);\n        MatrixToImageWriter.writeToStream(bitMatrix, format, response.getOutputStream());\n    } catch (WriterException e) {\n        e.printStackTrace();\n    } catch (IOException e) {\n        e.printStackTrace();\n    }\n    return null;\n}\n```\n\nUUID\n\nurl[](https://ngrok.com/)\n\n\n# \n\n\n\n```\n@RequestMapping(\"/pool\")\n@ResponseBody\nString pool(String uuid) {\n    System.out.println(\"[\" + uuid + \"]\");\n\n    ScanPool pool = PoolCache.cacheMap.get(uuid);\n\n    if (pool == null) {\n        return \"timeout\";\n    }\n\n    //--\n    new Thread(new ScanCounter(pool)).start();\n\n    boolean scanFlag = pool.getScanStatus();\n\n    if (scanFlag) {\n        return \"success\";\n    } else {\n        return \"fail\";\n    }\n}\n```\n\n\n\n```\npublic synchronized boolean getScanStatus() {\n    try {\n        if (!isScan()) { //\n            this.wait();\n        }\n        if (isScan()) {\n            return true;\n        }\n    } catch (InterruptedException e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n    }\n    return false;\n}\n\npublic synchronized void notifyPool() {\n    try {\n        this.notifyAll();\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n}\n```\n\n\n\n```\nclass ScanCounter implements Runnable {\n\n    public Long timeout = 27000L;\n\n    //\n    private ScanPool scanPool;\n\n    public ScanCounter(ScanPool scanPool) {\n        this.scanPool = scanPool;\n    }\n\n    @Override\n    public void run() {\n        try {\n            Thread.sleep(timeout);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        notifyPool(scanPool);\n    }\n\n    public synchronized void notifyPool(ScanPool scanPool) {\n        scanPool.notifyPool();\n    }\n}\n```\n\n![verify](http://www.wailian.work/images/2018/03/05/code4c40c.png)\n\n# uuid\n\ncacheMap\n\n```\npublic class PoolCache {\n    // 80\n    private static Long timeOutSecond = 80L;\n\n    //1\n    private static Long cleanIntervalSecond = 60L;\n\n    public static Map<String, ScanPool> cacheMap = new ConcurrentHashMap<String, ScanPool>();\n\n    static {\n        new Thread(new Runnable() {\n\n            @Override\n            public void run() {\n                while (true) {\n                    try {\n                        Thread.sleep(cleanIntervalSecond * 1000);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    clean();\n                }\n            }\n\n            public void clean() {\n                System.out.println(\"...\");\n\n                if (cacheMap.keySet().size() > 0) {\n                    Iterator<String> iterator = cacheMap.keySet().iterator();\n                    while (iterator.hasNext()) {\n                        String key = iterator.next();\n                        ScanPool pool = cacheMap.get(key);\n                        if (System.currentTimeMillis() - pool.getCreateTime() > timeOutSecond * 1000) {\n                            cacheMap.remove(key);\n                            // pending\n                            pool.notifyPool();\n                        }\n                    }\n                }\n            }\n        }).start();\n    }\n\n}\n```\n\n\n# \n\n```\n@RequestMapping(\"/login/{uuid}\")\n@ResponseBody\nString login(@PathVariable String uuid) {\n\n    ScanPool pool = PoolCache.cacheMap.get(uuid);\n\n    if (pool == null) {\n        return \"timeout,scan fail\";\n    }\n    \n    // \n    pool.scanSuccess();\n\n    return \"\";\n}\n```\n\n\n\n```\npublic synchronized void scanSuccess() {\n    try {\n        setScan(true);\n        this.notifyAll();\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n}\n```\n\n![](http://www.wailian.work/images/2018/03/05/ok.png)\n\n\n\n![](http://www.wailian.work/images/2018/03/05/mobile.jpg)\n\n\n[](https://github.com/wangweiye01/scan_login)\n","source":"_posts/scan-notify.md","raw":"---\ntitle: \ndate: 2018-03-05 10:48:42\ntags:\ntop: 1000\n---\n\n![](http://www.wailian.work/images/2018/03/05/1211.jpg)\n\n> \n\n\n\n\n\n\n\n# \n\n![pengding](http://www.wailian.work/images/2018/03/05/pending.png)\n\n\n\n![408](http://www.wailian.work/images/2018/03/05/408.png)\n\n408pending\n\n\n\n1. -(UUID)\n2. UUID\n3. \n4. (wait)\n5. (notify)\n6. \n\n3408timeout\n\n# UUID\n\n```\npublic static Map<String, ScanPool> cacheMap = new ConcurrentHashMap<String, ScanPool>();\n```\n\nConcurrentHashMapConcurrentModificationException\n\n\n\n\n\n\n\n# \n\n```\n@RequestMapping(\"/qrcode/{uuid}\")\n@ResponseBody\nString createQRCode(@PathVariable String uuid, HttpServletResponse response) {\n    System.out.println(\"\");\n\n    String text = \"http://2b082e46.ngrok.io/login/\" + uuid;\n    int width = 300;\n    int height = 300;\n    String format = \"png\";\n    //UUID\n    ScanPool pool = new ScanPool();\n    PoolCache.cacheMap.put(uuid, pool);\n    try {\n        Map<EncodeHintType, Object> hints = new HashMap<EncodeHintType, Object>();\n        hints.put(EncodeHintType.CHARACTER_SET, \"utf-8\");\n        hints.put(EncodeHintType.ERROR_CORRECTION, ErrorCorrectionLevel.H); //\n        BitMatrix bitMatrix = new MultiFormatWriter().encode(text, BarcodeFormat.QR_CODE, width, height, hints);\n        MatrixToImageWriter.writeToStream(bitMatrix, format, response.getOutputStream());\n    } catch (WriterException e) {\n        e.printStackTrace();\n    } catch (IOException e) {\n        e.printStackTrace();\n    }\n    return null;\n}\n```\n\nUUID\n\nurl[](https://ngrok.com/)\n\n\n# \n\n\n\n```\n@RequestMapping(\"/pool\")\n@ResponseBody\nString pool(String uuid) {\n    System.out.println(\"[\" + uuid + \"]\");\n\n    ScanPool pool = PoolCache.cacheMap.get(uuid);\n\n    if (pool == null) {\n        return \"timeout\";\n    }\n\n    //--\n    new Thread(new ScanCounter(pool)).start();\n\n    boolean scanFlag = pool.getScanStatus();\n\n    if (scanFlag) {\n        return \"success\";\n    } else {\n        return \"fail\";\n    }\n}\n```\n\n\n\n```\npublic synchronized boolean getScanStatus() {\n    try {\n        if (!isScan()) { //\n            this.wait();\n        }\n        if (isScan()) {\n            return true;\n        }\n    } catch (InterruptedException e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n    }\n    return false;\n}\n\npublic synchronized void notifyPool() {\n    try {\n        this.notifyAll();\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n}\n```\n\n\n\n```\nclass ScanCounter implements Runnable {\n\n    public Long timeout = 27000L;\n\n    //\n    private ScanPool scanPool;\n\n    public ScanCounter(ScanPool scanPool) {\n        this.scanPool = scanPool;\n    }\n\n    @Override\n    public void run() {\n        try {\n            Thread.sleep(timeout);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        notifyPool(scanPool);\n    }\n\n    public synchronized void notifyPool(ScanPool scanPool) {\n        scanPool.notifyPool();\n    }\n}\n```\n\n![verify](http://www.wailian.work/images/2018/03/05/code4c40c.png)\n\n# uuid\n\ncacheMap\n\n```\npublic class PoolCache {\n    // 80\n    private static Long timeOutSecond = 80L;\n\n    //1\n    private static Long cleanIntervalSecond = 60L;\n\n    public static Map<String, ScanPool> cacheMap = new ConcurrentHashMap<String, ScanPool>();\n\n    static {\n        new Thread(new Runnable() {\n\n            @Override\n            public void run() {\n                while (true) {\n                    try {\n                        Thread.sleep(cleanIntervalSecond * 1000);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    clean();\n                }\n            }\n\n            public void clean() {\n                System.out.println(\"...\");\n\n                if (cacheMap.keySet().size() > 0) {\n                    Iterator<String> iterator = cacheMap.keySet().iterator();\n                    while (iterator.hasNext()) {\n                        String key = iterator.next();\n                        ScanPool pool = cacheMap.get(key);\n                        if (System.currentTimeMillis() - pool.getCreateTime() > timeOutSecond * 1000) {\n                            cacheMap.remove(key);\n                            // pending\n                            pool.notifyPool();\n                        }\n                    }\n                }\n            }\n        }).start();\n    }\n\n}\n```\n\n\n# \n\n```\n@RequestMapping(\"/login/{uuid}\")\n@ResponseBody\nString login(@PathVariable String uuid) {\n\n    ScanPool pool = PoolCache.cacheMap.get(uuid);\n\n    if (pool == null) {\n        return \"timeout,scan fail\";\n    }\n    \n    // \n    pool.scanSuccess();\n\n    return \"\";\n}\n```\n\n\n\n```\npublic synchronized void scanSuccess() {\n    try {\n        setScan(true);\n        this.notifyAll();\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n}\n```\n\n![](http://www.wailian.work/images/2018/03/05/ok.png)\n\n\n\n![](http://www.wailian.work/images/2018/03/05/mobile.jpg)\n\n\n[](https://github.com/wangweiye01/scan_login)\n","slug":"scan-notify","published":1,"updated":"2020-10-10T02:12:01.870Z","_id":"ckc5n3jwx000x0j9k8b7g8meb","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"http://www.wailian.work/images/2018/03/05/1211.jpg\" alt=\"\"></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p></p>\n<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"http://www.wailian.work/images/2018/03/05/pending.png\" alt=\"pengding\"></p>\n<p></p>\n<p><img src=\"http://www.wailian.work/images/2018/03/05/408.png\" alt=\"408\"></p>\n<p>408pending</p>\n<p></p>\n<ol>\n<li>-(UUID)</li>\n<li>UUID</li>\n<li></li>\n<li>(wait)</li>\n<li>(notify)</li>\n<li></li>\n</ol>\n<p>3408timeout</p>\n<h1 id=\"UUID\"><a href=\"#UUID\" class=\"headerlink\" title=\"UUID\"></a>UUID</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public static Map&lt;String, ScanPool&gt; cacheMap = new ConcurrentHashMap&lt;String, ScanPool&gt;();</span><br></pre></td></tr></table></figure>\n<p>ConcurrentHashMapConcurrentModificationException</p>\n<p></p>\n<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RequestMapping(&quot;/qrcode/&#123;uuid&#125;&quot;)</span><br><span class=\"line\">@ResponseBody</span><br><span class=\"line\">String createQRCode(@PathVariable String uuid, HttpServletResponse response) &#123;</span><br><span class=\"line\">    System.out.println(&quot;&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    String text = &quot;http://2b082e46.ngrok.io/login/&quot; + uuid;</span><br><span class=\"line\">    int width = 300;</span><br><span class=\"line\">    int height = 300;</span><br><span class=\"line\">    String format = &quot;png&quot;;</span><br><span class=\"line\">    //UUID</span><br><span class=\"line\">    ScanPool pool = new ScanPool();</span><br><span class=\"line\">    PoolCache.cacheMap.put(uuid, pool);</span><br><span class=\"line\">    try &#123;</span><br><span class=\"line\">        Map&lt;EncodeHintType, Object&gt; hints = new HashMap&lt;EncodeHintType, Object&gt;();</span><br><span class=\"line\">        hints.put(EncodeHintType.CHARACTER_SET, &quot;utf-8&quot;);</span><br><span class=\"line\">        hints.put(EncodeHintType.ERROR_CORRECTION, ErrorCorrectionLevel.H); //</span><br><span class=\"line\">        BitMatrix bitMatrix = new MultiFormatWriter().encode(text, BarcodeFormat.QR_CODE, width, height, hints);</span><br><span class=\"line\">        MatrixToImageWriter.writeToStream(bitMatrix, format, response.getOutputStream());</span><br><span class=\"line\">    &#125; catch (WriterException e) &#123;</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">    &#125; catch (IOException e) &#123;</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return null;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>UUID</p>\n<p>url<a href=\"https://ngrok.com/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RequestMapping(&quot;/pool&quot;)</span><br><span class=\"line\">@ResponseBody</span><br><span class=\"line\">String pool(String uuid) &#123;</span><br><span class=\"line\">    System.out.println(&quot;[&quot; + uuid + &quot;]&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    ScanPool pool = PoolCache.cacheMap.get(uuid);</span><br><span class=\"line\"></span><br><span class=\"line\">    if (pool == null) &#123;</span><br><span class=\"line\">        return &quot;timeout&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    //--</span><br><span class=\"line\">    new Thread(new ScanCounter(pool)).start();</span><br><span class=\"line\"></span><br><span class=\"line\">    boolean scanFlag = pool.getScanStatus();</span><br><span class=\"line\"></span><br><span class=\"line\">    if (scanFlag) &#123;</span><br><span class=\"line\">        return &quot;success&quot;;</span><br><span class=\"line\">    &#125; else &#123;</span><br><span class=\"line\">        return &quot;fail&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public synchronized boolean getScanStatus() &#123;</span><br><span class=\"line\">    try &#123;</span><br><span class=\"line\">        if (!isScan()) &#123; //</span><br><span class=\"line\">            this.wait();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if (isScan()) &#123;</span><br><span class=\"line\">            return true;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">        // TODO Auto-generated catch block</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return false;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">public synchronized void notifyPool() &#123;</span><br><span class=\"line\">    try &#123;</span><br><span class=\"line\">        this.notifyAll();</span><br><span class=\"line\">    &#125; catch (Exception e) &#123;</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class ScanCounter implements Runnable &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public Long timeout = 27000L;</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    private ScanPool scanPool;</span><br><span class=\"line\"></span><br><span class=\"line\">    public ScanCounter(ScanPool scanPool) &#123;</span><br><span class=\"line\">        this.scanPool = scanPool;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void run() &#123;</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            Thread.sleep(timeout);</span><br><span class=\"line\">        &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        notifyPool(scanPool);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public synchronized void notifyPool(ScanPool scanPool) &#123;</span><br><span class=\"line\">        scanPool.notifyPool();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://www.wailian.work/images/2018/03/05/code4c40c.png\" alt=\"verify\"></p>\n<h1 id=\"uuid\"><a href=\"#uuid\" class=\"headerlink\" title=\"uuid\"></a>uuid</h1><p>cacheMap</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class PoolCache &#123;</span><br><span class=\"line\">    // 80</span><br><span class=\"line\">    private static Long timeOutSecond = 80L;</span><br><span class=\"line\"></span><br><span class=\"line\">    //1</span><br><span class=\"line\">    private static Long cleanIntervalSecond = 60L;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static Map&lt;String, ScanPool&gt; cacheMap = new ConcurrentHashMap&lt;String, ScanPool&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    static &#123;</span><br><span class=\"line\">        new Thread(new Runnable() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            @Override</span><br><span class=\"line\">            public void run() &#123;</span><br><span class=\"line\">                while (true) &#123;</span><br><span class=\"line\">                    try &#123;</span><br><span class=\"line\">                        Thread.sleep(cleanIntervalSecond * 1000);</span><br><span class=\"line\">                    &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">                        e.printStackTrace();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    clean();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            public void clean() &#123;</span><br><span class=\"line\">                System.out.println(&quot;...&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">                if (cacheMap.keySet().size() &gt; 0) &#123;</span><br><span class=\"line\">                    Iterator&lt;String&gt; iterator = cacheMap.keySet().iterator();</span><br><span class=\"line\">                    while (iterator.hasNext()) &#123;</span><br><span class=\"line\">                        String key = iterator.next();</span><br><span class=\"line\">                        ScanPool pool = cacheMap.get(key);</span><br><span class=\"line\">                        if (System.currentTimeMillis() - pool.getCreateTime() &gt; timeOutSecond * 1000) &#123;</span><br><span class=\"line\">                            cacheMap.remove(key);</span><br><span class=\"line\">                            // pending</span><br><span class=\"line\">                            pool.notifyPool();</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RequestMapping(&quot;/login/&#123;uuid&#125;&quot;)</span><br><span class=\"line\">@ResponseBody</span><br><span class=\"line\">String login(@PathVariable String uuid) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    ScanPool pool = PoolCache.cacheMap.get(uuid);</span><br><span class=\"line\"></span><br><span class=\"line\">    if (pool == null) &#123;</span><br><span class=\"line\">        return &quot;timeout,scan fail&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    // </span><br><span class=\"line\">    pool.scanSuccess();</span><br><span class=\"line\"></span><br><span class=\"line\">    return &quot;&quot;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public synchronized void scanSuccess() &#123;</span><br><span class=\"line\">    try &#123;</span><br><span class=\"line\">        setScan(true);</span><br><span class=\"line\">        this.notifyAll();</span><br><span class=\"line\">    &#125; catch (Exception e) &#123;</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://www.wailian.work/images/2018/03/05/ok.png\" alt=\"\"></p>\n<p></p>\n<p><img src=\"http://www.wailian.work/images/2018/03/05/mobile.jpg\" alt=\"\"></p>\n<p><a href=\"https://github.com/wangweiye01/scan_login\" target=\"_blank\" rel=\"noopener\"></a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/03/05/1211.jpg\" alt=\"\"></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p></p>\n<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"http://www.wailian.work/images/2018/03/05/pending.png\" alt=\"pengding\"></p>\n<p></p>\n<p><img src=\"http://www.wailian.work/images/2018/03/05/408.png\" alt=\"408\"></p>\n<p>408pending</p>\n<p></p>\n<ol>\n<li>-(UUID)</li>\n<li>UUID</li>\n<li></li>\n<li>(wait)</li>\n<li>(notify)</li>\n<li></li>\n</ol>\n<p>3408timeout</p>\n<h1 id=\"UUID\"><a href=\"#UUID\" class=\"headerlink\" title=\"UUID\"></a>UUID</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public static Map&lt;String, ScanPool&gt; cacheMap = new ConcurrentHashMap&lt;String, ScanPool&gt;();</span><br></pre></td></tr></table></figure>\n<p>ConcurrentHashMapConcurrentModificationException</p>\n<p></p>\n<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RequestMapping(&quot;/qrcode/&#123;uuid&#125;&quot;)</span><br><span class=\"line\">@ResponseBody</span><br><span class=\"line\">String createQRCode(@PathVariable String uuid, HttpServletResponse response) &#123;</span><br><span class=\"line\">    System.out.println(&quot;&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    String text = &quot;http://2b082e46.ngrok.io/login/&quot; + uuid;</span><br><span class=\"line\">    int width = 300;</span><br><span class=\"line\">    int height = 300;</span><br><span class=\"line\">    String format = &quot;png&quot;;</span><br><span class=\"line\">    //UUID</span><br><span class=\"line\">    ScanPool pool = new ScanPool();</span><br><span class=\"line\">    PoolCache.cacheMap.put(uuid, pool);</span><br><span class=\"line\">    try &#123;</span><br><span class=\"line\">        Map&lt;EncodeHintType, Object&gt; hints = new HashMap&lt;EncodeHintType, Object&gt;();</span><br><span class=\"line\">        hints.put(EncodeHintType.CHARACTER_SET, &quot;utf-8&quot;);</span><br><span class=\"line\">        hints.put(EncodeHintType.ERROR_CORRECTION, ErrorCorrectionLevel.H); //</span><br><span class=\"line\">        BitMatrix bitMatrix = new MultiFormatWriter().encode(text, BarcodeFormat.QR_CODE, width, height, hints);</span><br><span class=\"line\">        MatrixToImageWriter.writeToStream(bitMatrix, format, response.getOutputStream());</span><br><span class=\"line\">    &#125; catch (WriterException e) &#123;</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">    &#125; catch (IOException e) &#123;</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return null;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>UUID</p>\n<p>url<a href=\"https://ngrok.com/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RequestMapping(&quot;/pool&quot;)</span><br><span class=\"line\">@ResponseBody</span><br><span class=\"line\">String pool(String uuid) &#123;</span><br><span class=\"line\">    System.out.println(&quot;[&quot; + uuid + &quot;]&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    ScanPool pool = PoolCache.cacheMap.get(uuid);</span><br><span class=\"line\"></span><br><span class=\"line\">    if (pool == null) &#123;</span><br><span class=\"line\">        return &quot;timeout&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    //--</span><br><span class=\"line\">    new Thread(new ScanCounter(pool)).start();</span><br><span class=\"line\"></span><br><span class=\"line\">    boolean scanFlag = pool.getScanStatus();</span><br><span class=\"line\"></span><br><span class=\"line\">    if (scanFlag) &#123;</span><br><span class=\"line\">        return &quot;success&quot;;</span><br><span class=\"line\">    &#125; else &#123;</span><br><span class=\"line\">        return &quot;fail&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public synchronized boolean getScanStatus() &#123;</span><br><span class=\"line\">    try &#123;</span><br><span class=\"line\">        if (!isScan()) &#123; //</span><br><span class=\"line\">            this.wait();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if (isScan()) &#123;</span><br><span class=\"line\">            return true;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">        // TODO Auto-generated catch block</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return false;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">public synchronized void notifyPool() &#123;</span><br><span class=\"line\">    try &#123;</span><br><span class=\"line\">        this.notifyAll();</span><br><span class=\"line\">    &#125; catch (Exception e) &#123;</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class ScanCounter implements Runnable &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public Long timeout = 27000L;</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    private ScanPool scanPool;</span><br><span class=\"line\"></span><br><span class=\"line\">    public ScanCounter(ScanPool scanPool) &#123;</span><br><span class=\"line\">        this.scanPool = scanPool;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void run() &#123;</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            Thread.sleep(timeout);</span><br><span class=\"line\">        &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        notifyPool(scanPool);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public synchronized void notifyPool(ScanPool scanPool) &#123;</span><br><span class=\"line\">        scanPool.notifyPool();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://www.wailian.work/images/2018/03/05/code4c40c.png\" alt=\"verify\"></p>\n<h1 id=\"uuid\"><a href=\"#uuid\" class=\"headerlink\" title=\"uuid\"></a>uuid</h1><p>cacheMap</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class PoolCache &#123;</span><br><span class=\"line\">    // 80</span><br><span class=\"line\">    private static Long timeOutSecond = 80L;</span><br><span class=\"line\"></span><br><span class=\"line\">    //1</span><br><span class=\"line\">    private static Long cleanIntervalSecond = 60L;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static Map&lt;String, ScanPool&gt; cacheMap = new ConcurrentHashMap&lt;String, ScanPool&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    static &#123;</span><br><span class=\"line\">        new Thread(new Runnable() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            @Override</span><br><span class=\"line\">            public void run() &#123;</span><br><span class=\"line\">                while (true) &#123;</span><br><span class=\"line\">                    try &#123;</span><br><span class=\"line\">                        Thread.sleep(cleanIntervalSecond * 1000);</span><br><span class=\"line\">                    &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">                        e.printStackTrace();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    clean();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            public void clean() &#123;</span><br><span class=\"line\">                System.out.println(&quot;...&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">                if (cacheMap.keySet().size() &gt; 0) &#123;</span><br><span class=\"line\">                    Iterator&lt;String&gt; iterator = cacheMap.keySet().iterator();</span><br><span class=\"line\">                    while (iterator.hasNext()) &#123;</span><br><span class=\"line\">                        String key = iterator.next();</span><br><span class=\"line\">                        ScanPool pool = cacheMap.get(key);</span><br><span class=\"line\">                        if (System.currentTimeMillis() - pool.getCreateTime() &gt; timeOutSecond * 1000) &#123;</span><br><span class=\"line\">                            cacheMap.remove(key);</span><br><span class=\"line\">                            // pending</span><br><span class=\"line\">                            pool.notifyPool();</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RequestMapping(&quot;/login/&#123;uuid&#125;&quot;)</span><br><span class=\"line\">@ResponseBody</span><br><span class=\"line\">String login(@PathVariable String uuid) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    ScanPool pool = PoolCache.cacheMap.get(uuid);</span><br><span class=\"line\"></span><br><span class=\"line\">    if (pool == null) &#123;</span><br><span class=\"line\">        return &quot;timeout,scan fail&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    // </span><br><span class=\"line\">    pool.scanSuccess();</span><br><span class=\"line\"></span><br><span class=\"line\">    return &quot;&quot;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public synchronized void scanSuccess() &#123;</span><br><span class=\"line\">    try &#123;</span><br><span class=\"line\">        setScan(true);</span><br><span class=\"line\">        this.notifyAll();</span><br><span class=\"line\">    &#125; catch (Exception e) &#123;</span><br><span class=\"line\">        e.printStackTrace();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://www.wailian.work/images/2018/03/05/ok.png\" alt=\"\"></p>\n<p></p>\n<p><img src=\"http://www.wailian.work/images/2018/03/05/mobile.jpg\" alt=\"\"></p>\n<p><a href=\"https://github.com/wangweiye01/scan_login\" target=\"_blank\" rel=\"noopener\"></a></p>\n"},{"title":"mysqlsequence","date":"2017-12-04T07:02:51.000Z","_content":"# sequence\n\nOracle(SEQUENCE)()\n\n# mysqlsequence\n\n## sequence\n\n```\n    CREATE TABLE sequence (\n            name VARCHAR(50) NOT NULL,\n            current_value INT NOT NULL,\n            increment INT NOT NULL DEFAULT 1,\n            PRIMARY KEY (name)\n            )\n```\n\n## \n\n```\nCREATE FUNCTION currval (seq_name VARCHAR(50))\n    RETURNS INTEGER\n    LANGUAGE SQL\n    DETERMINISTIC\n    CONTAINS SQL\n    SQL SECURITY DEFINER\n    COMMENT ''\n    BEGIN\n    DECLARE value INTEGER;\n    SET value = 0;\n    SELECT current_value INTO value\n    FROM sequence\n    WHERE name = seq_name;\n    RETURN value;\n    END\n```\n\n## \n\n```\nCREATE FUNCTION nextval (seq_name VARCHAR(50))\n    RETURNS INTEGER\n    LANGUAGE SQL\n    DETERMINISTIC\n    CONTAINS SQL\n    SQL SECURITY DEFINER\n    COMMENT ''\n    BEGIN\n    UPDATE sequence\n    SET current_value = current_value + increment\n    WHERE name = seq_name;\n    RETURN currval(seq_name);\n    END\n```\n\n## \n\n```\nCREATE FUNCTION setval (seq_name VARCHAR(50), value INTEGER)\n    RETURNS INTEGER\n    LANGUAGE SQL\n    DETERMINISTIC\n    CONTAINS SQL\n    SQL SECURITY DEFINER\n    COMMENT ''\n    BEGIN\n    UPDATE sequence\n    SET current_value = value\n    WHERE name = seq_name;\n    RETURN currval(seq_name);\n    END\n```\n\n## \n\n```\n    // \n    INSERT INTO sequence VALUES ('TestSeq', 0, 1);\n    // \n    SELECT SETVAL('TestSeq', 10);\n    SELECT CURRVAL('TestSeq');\n    // \n    SELECT NEXTVAL('TestSeq');\n```\n\n","source":"_posts/sequence.md","raw":"---\ntitle: mysqlsequence\ndate: 2017-12-04 15:02:51\ntags:\n---\n# sequence\n\nOracle(SEQUENCE)()\n\n# mysqlsequence\n\n## sequence\n\n```\n    CREATE TABLE sequence (\n            name VARCHAR(50) NOT NULL,\n            current_value INT NOT NULL,\n            increment INT NOT NULL DEFAULT 1,\n            PRIMARY KEY (name)\n            )\n```\n\n## \n\n```\nCREATE FUNCTION currval (seq_name VARCHAR(50))\n    RETURNS INTEGER\n    LANGUAGE SQL\n    DETERMINISTIC\n    CONTAINS SQL\n    SQL SECURITY DEFINER\n    COMMENT ''\n    BEGIN\n    DECLARE value INTEGER;\n    SET value = 0;\n    SELECT current_value INTO value\n    FROM sequence\n    WHERE name = seq_name;\n    RETURN value;\n    END\n```\n\n## \n\n```\nCREATE FUNCTION nextval (seq_name VARCHAR(50))\n    RETURNS INTEGER\n    LANGUAGE SQL\n    DETERMINISTIC\n    CONTAINS SQL\n    SQL SECURITY DEFINER\n    COMMENT ''\n    BEGIN\n    UPDATE sequence\n    SET current_value = current_value + increment\n    WHERE name = seq_name;\n    RETURN currval(seq_name);\n    END\n```\n\n## \n\n```\nCREATE FUNCTION setval (seq_name VARCHAR(50), value INTEGER)\n    RETURNS INTEGER\n    LANGUAGE SQL\n    DETERMINISTIC\n    CONTAINS SQL\n    SQL SECURITY DEFINER\n    COMMENT ''\n    BEGIN\n    UPDATE sequence\n    SET current_value = value\n    WHERE name = seq_name;\n    RETURN currval(seq_name);\n    END\n```\n\n## \n\n```\n    // \n    INSERT INTO sequence VALUES ('TestSeq', 0, 1);\n    // \n    SELECT SETVAL('TestSeq', 10);\n    SELECT CURRVAL('TestSeq');\n    // \n    SELECT NEXTVAL('TestSeq');\n```\n\n","slug":"sequence","published":1,"updated":"2019-12-24T02:00:57.450Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jwy000y0j9koz1d394g","content":"<h1 id=\"sequence\"><a href=\"#sequence\" class=\"headerlink\" title=\"sequence\"></a>sequence</h1><p>Oracle(SEQUENCE)()</p>\n<h1 id=\"mysqlsequence\"><a href=\"#mysqlsequence\" class=\"headerlink\" title=\"mysqlsequence\"></a>mysqlsequence</h1><h2 id=\"sequence\"><a href=\"#sequence\" class=\"headerlink\" title=\"sequence\"></a>sequence</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE TABLE sequence (</span><br><span class=\"line\">        name VARCHAR(50) NOT NULL,</span><br><span class=\"line\">        current_value INT NOT NULL,</span><br><span class=\"line\">        increment INT NOT NULL DEFAULT 1,</span><br><span class=\"line\">        PRIMARY KEY (name)</span><br><span class=\"line\">        )</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE FUNCTION currval (seq_name VARCHAR(50))</span><br><span class=\"line\">    RETURNS INTEGER</span><br><span class=\"line\">    LANGUAGE SQL</span><br><span class=\"line\">    DETERMINISTIC</span><br><span class=\"line\">    CONTAINS SQL</span><br><span class=\"line\">    SQL SECURITY DEFINER</span><br><span class=\"line\">    COMMENT &apos;&apos;</span><br><span class=\"line\">    BEGIN</span><br><span class=\"line\">    DECLARE value INTEGER;</span><br><span class=\"line\">    SET value = 0;</span><br><span class=\"line\">    SELECT current_value INTO value</span><br><span class=\"line\">    FROM sequence</span><br><span class=\"line\">    WHERE name = seq_name;</span><br><span class=\"line\">    RETURN value;</span><br><span class=\"line\">    END</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE FUNCTION nextval (seq_name VARCHAR(50))</span><br><span class=\"line\">    RETURNS INTEGER</span><br><span class=\"line\">    LANGUAGE SQL</span><br><span class=\"line\">    DETERMINISTIC</span><br><span class=\"line\">    CONTAINS SQL</span><br><span class=\"line\">    SQL SECURITY DEFINER</span><br><span class=\"line\">    COMMENT &apos;&apos;</span><br><span class=\"line\">    BEGIN</span><br><span class=\"line\">    UPDATE sequence</span><br><span class=\"line\">    SET current_value = current_value + increment</span><br><span class=\"line\">    WHERE name = seq_name;</span><br><span class=\"line\">    RETURN currval(seq_name);</span><br><span class=\"line\">    END</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE FUNCTION setval (seq_name VARCHAR(50), value INTEGER)</span><br><span class=\"line\">    RETURNS INTEGER</span><br><span class=\"line\">    LANGUAGE SQL</span><br><span class=\"line\">    DETERMINISTIC</span><br><span class=\"line\">    CONTAINS SQL</span><br><span class=\"line\">    SQL SECURITY DEFINER</span><br><span class=\"line\">    COMMENT &apos;&apos;</span><br><span class=\"line\">    BEGIN</span><br><span class=\"line\">    UPDATE sequence</span><br><span class=\"line\">    SET current_value = value</span><br><span class=\"line\">    WHERE name = seq_name;</span><br><span class=\"line\">    RETURN currval(seq_name);</span><br><span class=\"line\">    END</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// </span><br><span class=\"line\">INSERT INTO sequence VALUES (&apos;TestSeq&apos;, 0, 1);</span><br><span class=\"line\">// </span><br><span class=\"line\">SELECT SETVAL(&apos;TestSeq&apos;, 10);</span><br><span class=\"line\">SELECT CURRVAL(&apos;TestSeq&apos;);</span><br><span class=\"line\">// </span><br><span class=\"line\">SELECT NEXTVAL(&apos;TestSeq&apos;);</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"sequence\"><a href=\"#sequence\" class=\"headerlink\" title=\"sequence\"></a>sequence</h1><p>Oracle(SEQUENCE)()</p>\n<h1 id=\"mysqlsequence\"><a href=\"#mysqlsequence\" class=\"headerlink\" title=\"mysqlsequence\"></a>mysqlsequence</h1><h2 id=\"sequence\"><a href=\"#sequence\" class=\"headerlink\" title=\"sequence\"></a>sequence</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE TABLE sequence (</span><br><span class=\"line\">        name VARCHAR(50) NOT NULL,</span><br><span class=\"line\">        current_value INT NOT NULL,</span><br><span class=\"line\">        increment INT NOT NULL DEFAULT 1,</span><br><span class=\"line\">        PRIMARY KEY (name)</span><br><span class=\"line\">        )</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE FUNCTION currval (seq_name VARCHAR(50))</span><br><span class=\"line\">    RETURNS INTEGER</span><br><span class=\"line\">    LANGUAGE SQL</span><br><span class=\"line\">    DETERMINISTIC</span><br><span class=\"line\">    CONTAINS SQL</span><br><span class=\"line\">    SQL SECURITY DEFINER</span><br><span class=\"line\">    COMMENT &apos;&apos;</span><br><span class=\"line\">    BEGIN</span><br><span class=\"line\">    DECLARE value INTEGER;</span><br><span class=\"line\">    SET value = 0;</span><br><span class=\"line\">    SELECT current_value INTO value</span><br><span class=\"line\">    FROM sequence</span><br><span class=\"line\">    WHERE name = seq_name;</span><br><span class=\"line\">    RETURN value;</span><br><span class=\"line\">    END</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE FUNCTION nextval (seq_name VARCHAR(50))</span><br><span class=\"line\">    RETURNS INTEGER</span><br><span class=\"line\">    LANGUAGE SQL</span><br><span class=\"line\">    DETERMINISTIC</span><br><span class=\"line\">    CONTAINS SQL</span><br><span class=\"line\">    SQL SECURITY DEFINER</span><br><span class=\"line\">    COMMENT &apos;&apos;</span><br><span class=\"line\">    BEGIN</span><br><span class=\"line\">    UPDATE sequence</span><br><span class=\"line\">    SET current_value = current_value + increment</span><br><span class=\"line\">    WHERE name = seq_name;</span><br><span class=\"line\">    RETURN currval(seq_name);</span><br><span class=\"line\">    END</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE FUNCTION setval (seq_name VARCHAR(50), value INTEGER)</span><br><span class=\"line\">    RETURNS INTEGER</span><br><span class=\"line\">    LANGUAGE SQL</span><br><span class=\"line\">    DETERMINISTIC</span><br><span class=\"line\">    CONTAINS SQL</span><br><span class=\"line\">    SQL SECURITY DEFINER</span><br><span class=\"line\">    COMMENT &apos;&apos;</span><br><span class=\"line\">    BEGIN</span><br><span class=\"line\">    UPDATE sequence</span><br><span class=\"line\">    SET current_value = value</span><br><span class=\"line\">    WHERE name = seq_name;</span><br><span class=\"line\">    RETURN currval(seq_name);</span><br><span class=\"line\">    END</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// </span><br><span class=\"line\">INSERT INTO sequence VALUES (&apos;TestSeq&apos;, 0, 1);</span><br><span class=\"line\">// </span><br><span class=\"line\">SELECT SETVAL(&apos;TestSeq&apos;, 10);</span><br><span class=\"line\">SELECT CURRVAL(&apos;TestSeq&apos;);</span><br><span class=\"line\">// </span><br><span class=\"line\">SELECT NEXTVAL(&apos;TestSeq&apos;);</span><br></pre></td></tr></table></figure>\n"},{"title":"vpsshadowsocks","date":"2017-11-28T02:18:55.000Z","_content":"![pic](http://s1.wailian.download/2018/01/18/3bf44e943f8d77713982edd8c8e0fa478c6bbf622633d-zCwRVd_fw658.jpg)\n# vultr\n\nvultr,(Tokyo,CentOS,),\n\n# shadowsocks\n\n> CentOS7\n\n## \n\n## \n\n``` bash\nwget no-check-certificate https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh\nchmod +x shadowsocks.sh\n./shadowsocks.sh 2>&1 | tee shadowsocks.log\n```\n\n## ,shadowsocks\n\n![ss](http://img.blog.csdn.net/20171110091659947?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n## ,\n\n![](http://img.blog.csdn.net/20171110091341666?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n# Shadowsocks\n\n## \n\n/etc/shadowsock.json\n\n```\n{\n    \"server\":\"my_server_ip\"\n        \"local_address\": \"127.0.0.1\",\n        \"local_port\":1080,\n        \"port_password\": {\n            \"8381\": \"foobar1\",\n            \"8382\": \"foobar2\",\n            \"8383\": \"foobar3\",\n            \"8384\": \"foobar4\"\n        },\n        \"timeout\":300,\n        \"method\":\"aes-256-cfb\",\n        \"fast_open\": false\n}\n```\n\nport_password\n\n```\nsystemctl start shadowsocks.service\nsystemctl stop shadowsocks.service\nsystemctl restart shadowsocks.service\nsystemctl status shadowsocks.service\n```\n\ncentostcpudpcentoscentos7centos6centos7filewalliptables\nfirewalledetc/firewalled/zonespublic.xml.\n\n```\n<port protocol=\"tcp\" port=\"449\"/>   \n<portprotocol=\"udp\" port=\"443\"/>\n```\n\ntcpudp.systemctl restart firewalld.service \n\n# (Shadowsocks)\n\n## macwindows\n\n\n\n```\nhttps://github.com/shadowsocks\n```\n\n![client](http://img.blog.csdn.net/20171110093052673?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n*Shadowsocks-windowswindows*\n*ShadowsocksX-NGmac*\n\n## iphone\nsuper wingy\n![super_wingy](http://img.blog.csdn.net/20171110092642061?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n# KCPTun\n\nShadowsocksKCPTun\n\nKCPTunUDPTCP\n\nKCP  TCP10%-20% 30%-40%\n\n## KCPTun\n\n```\n// \nwget https://raw.githubusercontent.com/kuoruan/kcptun_installer/master/kcptun.sh\n// \nchmod +x ./kcptun.sh\n// \n./kcptun.sh\n```\n\n# vultr\n\n```\nhttps://www.vultr.com/?ref=7259520\n```\n","source":"_posts/shadowsocks.md","raw":"---\ntitle: vpsshadowsocks\ndate: 2017-11-28 10:18:55\ntags:\n---\n![pic](http://s1.wailian.download/2018/01/18/3bf44e943f8d77713982edd8c8e0fa478c6bbf622633d-zCwRVd_fw658.jpg)\n# vultr\n\nvultr,(Tokyo,CentOS,),\n\n# shadowsocks\n\n> CentOS7\n\n## \n\n## \n\n``` bash\nwget no-check-certificate https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh\nchmod +x shadowsocks.sh\n./shadowsocks.sh 2>&1 | tee shadowsocks.log\n```\n\n## ,shadowsocks\n\n![ss](http://img.blog.csdn.net/20171110091659947?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n## ,\n\n![](http://img.blog.csdn.net/20171110091341666?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n# Shadowsocks\n\n## \n\n/etc/shadowsock.json\n\n```\n{\n    \"server\":\"my_server_ip\"\n        \"local_address\": \"127.0.0.1\",\n        \"local_port\":1080,\n        \"port_password\": {\n            \"8381\": \"foobar1\",\n            \"8382\": \"foobar2\",\n            \"8383\": \"foobar3\",\n            \"8384\": \"foobar4\"\n        },\n        \"timeout\":300,\n        \"method\":\"aes-256-cfb\",\n        \"fast_open\": false\n}\n```\n\nport_password\n\n```\nsystemctl start shadowsocks.service\nsystemctl stop shadowsocks.service\nsystemctl restart shadowsocks.service\nsystemctl status shadowsocks.service\n```\n\ncentostcpudpcentoscentos7centos6centos7filewalliptables\nfirewalledetc/firewalled/zonespublic.xml.\n\n```\n<port protocol=\"tcp\" port=\"449\"/>   \n<portprotocol=\"udp\" port=\"443\"/>\n```\n\ntcpudp.systemctl restart firewalld.service \n\n# (Shadowsocks)\n\n## macwindows\n\n\n\n```\nhttps://github.com/shadowsocks\n```\n\n![client](http://img.blog.csdn.net/20171110093052673?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n*Shadowsocks-windowswindows*\n*ShadowsocksX-NGmac*\n\n## iphone\nsuper wingy\n![super_wingy](http://img.blog.csdn.net/20171110092642061?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)\n\n# KCPTun\n\nShadowsocksKCPTun\n\nKCPTunUDPTCP\n\nKCP  TCP10%-20% 30%-40%\n\n## KCPTun\n\n```\n// \nwget https://raw.githubusercontent.com/kuoruan/kcptun_installer/master/kcptun.sh\n// \nchmod +x ./kcptun.sh\n// \n./kcptun.sh\n```\n\n# vultr\n\n```\nhttps://www.vultr.com/?ref=7259520\n```\n","slug":"shadowsocks","published":1,"updated":"2019-12-24T02:00:57.460Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jx000100j9kabeeklb6","content":"<p><img src=\"http://s1.wailian.download/2018/01/18/3bf44e943f8d77713982edd8c8e0fa478c6bbf622633d-zCwRVd_fw658.jpg\" alt=\"pic\"></p>\n<h1 id=\"vultr\"><a href=\"#vultr\" class=\"headerlink\" title=\"vultr\"></a>vultr</h1><p>vultr,(Tokyo,CentOS,),</p>\n<h1 id=\"shadowsocks\"><a href=\"#shadowsocks\" class=\"headerlink\" title=\"shadowsocks\"></a>shadowsocks</h1><blockquote>\n<p>CentOS7</p>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget no-check-certificate https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh</span><br><span class=\"line\">chmod +x shadowsocks.sh</span><br><span class=\"line\">./shadowsocks.sh 2&gt;&amp;1 | tee shadowsocks.log</span><br></pre></td></tr></table></figure>\n<h2 id=\"-shadowsocks\"><a href=\"#-shadowsocks\" class=\"headerlink\" title=\",shadowsocks\"></a>,shadowsocks</h2><p><img src=\"http://img.blog.csdn.net/20171110091659947?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"ss\"></p>\n<h2 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\",\"></a>,</h2><p><img src=\"http://img.blog.csdn.net/20171110091341666?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"\"></p>\n<h1 id=\"Shadowsocks\"><a href=\"#Shadowsocks\" class=\"headerlink\" title=\"Shadowsocks\"></a>Shadowsocks</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>/etc/shadowsock.json</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;server&quot;:&quot;my_server_ip&quot;</span><br><span class=\"line\">        &quot;local_address&quot;: &quot;127.0.0.1&quot;,</span><br><span class=\"line\">        &quot;local_port&quot;:1080,</span><br><span class=\"line\">        &quot;port_password&quot;: &#123;</span><br><span class=\"line\">            &quot;8381&quot;: &quot;foobar1&quot;,</span><br><span class=\"line\">            &quot;8382&quot;: &quot;foobar2&quot;,</span><br><span class=\"line\">            &quot;8383&quot;: &quot;foobar3&quot;,</span><br><span class=\"line\">            &quot;8384&quot;: &quot;foobar4&quot;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &quot;timeout&quot;:300,</span><br><span class=\"line\">        &quot;method&quot;:&quot;aes-256-cfb&quot;,</span><br><span class=\"line\">        &quot;fast_open&quot;: false</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>port_password</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start shadowsocks.service</span><br><span class=\"line\">systemctl stop shadowsocks.service</span><br><span class=\"line\">systemctl restart shadowsocks.service</span><br><span class=\"line\">systemctl status shadowsocks.service</span><br></pre></td></tr></table></figure>\n<p>centostcpudpcentoscentos7centos6centos7filewalliptables<br>firewalledetc/firewalled/zonespublic.xml.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;port protocol=&quot;tcp&quot; port=&quot;449&quot;/&gt;   </span><br><span class=\"line\">&lt;portprotocol=&quot;udp&quot; port=&quot;443&quot;/&gt;</span><br></pre></td></tr></table></figure>\n<p>tcpudp.systemctl restart firewalld.service </p>\n<h1 id=\"-Shadowsocks\"><a href=\"#-Shadowsocks\" class=\"headerlink\" title=\"(Shadowsocks)\"></a>(Shadowsocks)</h1><h2 id=\"macwindows\"><a href=\"#macwindows\" class=\"headerlink\" title=\"macwindows\"></a>macwindows</h2><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://github.com/shadowsocks</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://img.blog.csdn.net/20171110093052673?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"client\"><br><em>Shadowsocks-windowswindows</em><br><em>ShadowsocksX-NGmac</em></p>\n<h2 id=\"iphone\"><a href=\"#iphone\" class=\"headerlink\" title=\"iphone\"></a>iphone</h2><p>super wingy<br><img src=\"http://img.blog.csdn.net/20171110092642061?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"super_wingy\"></p>\n<h1 id=\"KCPTun\"><a href=\"#KCPTun\" class=\"headerlink\" title=\"KCPTun\"></a>KCPTun</h1><p>ShadowsocksKCPTun</p>\n<p>KCPTunUDPTCP</p>\n<p>KCP  TCP10%-20% 30%-40%</p>\n<h2 id=\"KCPTun\"><a href=\"#KCPTun\" class=\"headerlink\" title=\"KCPTun\"></a>KCPTun</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// </span><br><span class=\"line\">wget https://raw.githubusercontent.com/kuoruan/kcptun_installer/master/kcptun.sh</span><br><span class=\"line\">// </span><br><span class=\"line\">chmod +x ./kcptun.sh</span><br><span class=\"line\">// </span><br><span class=\"line\">./kcptun.sh</span><br></pre></td></tr></table></figure>\n<h1 id=\"vultr\"><a href=\"#vultr\" class=\"headerlink\" title=\"vultr\"></a>vultr</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://www.vultr.com/?ref=7259520</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://s1.wailian.download/2018/01/18/3bf44e943f8d77713982edd8c8e0fa478c6bbf622633d-zCwRVd_fw658.jpg\" alt=\"pic\"></p>\n<h1 id=\"vultr\"><a href=\"#vultr\" class=\"headerlink\" title=\"vultr\"></a>vultr</h1><p>vultr,(Tokyo,CentOS,),</p>\n<h1 id=\"shadowsocks\"><a href=\"#shadowsocks\" class=\"headerlink\" title=\"shadowsocks\"></a>shadowsocks</h1><blockquote>\n<p>CentOS7</p>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget no-check-certificate https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh</span><br><span class=\"line\">chmod +x shadowsocks.sh</span><br><span class=\"line\">./shadowsocks.sh 2&gt;&amp;1 | tee shadowsocks.log</span><br></pre></td></tr></table></figure>\n<h2 id=\"-shadowsocks\"><a href=\"#-shadowsocks\" class=\"headerlink\" title=\",shadowsocks\"></a>,shadowsocks</h2><p><img src=\"http://img.blog.csdn.net/20171110091659947?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"ss\"></p>\n<h2 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\",\"></a>,</h2><p><img src=\"http://img.blog.csdn.net/20171110091341666?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"\"></p>\n<h1 id=\"Shadowsocks\"><a href=\"#Shadowsocks\" class=\"headerlink\" title=\"Shadowsocks\"></a>Shadowsocks</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>/etc/shadowsock.json</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;server&quot;:&quot;my_server_ip&quot;</span><br><span class=\"line\">        &quot;local_address&quot;: &quot;127.0.0.1&quot;,</span><br><span class=\"line\">        &quot;local_port&quot;:1080,</span><br><span class=\"line\">        &quot;port_password&quot;: &#123;</span><br><span class=\"line\">            &quot;8381&quot;: &quot;foobar1&quot;,</span><br><span class=\"line\">            &quot;8382&quot;: &quot;foobar2&quot;,</span><br><span class=\"line\">            &quot;8383&quot;: &quot;foobar3&quot;,</span><br><span class=\"line\">            &quot;8384&quot;: &quot;foobar4&quot;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &quot;timeout&quot;:300,</span><br><span class=\"line\">        &quot;method&quot;:&quot;aes-256-cfb&quot;,</span><br><span class=\"line\">        &quot;fast_open&quot;: false</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>port_password</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start shadowsocks.service</span><br><span class=\"line\">systemctl stop shadowsocks.service</span><br><span class=\"line\">systemctl restart shadowsocks.service</span><br><span class=\"line\">systemctl status shadowsocks.service</span><br></pre></td></tr></table></figure>\n<p>centostcpudpcentoscentos7centos6centos7filewalliptables<br>firewalledetc/firewalled/zonespublic.xml.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;port protocol=&quot;tcp&quot; port=&quot;449&quot;/&gt;   </span><br><span class=\"line\">&lt;portprotocol=&quot;udp&quot; port=&quot;443&quot;/&gt;</span><br></pre></td></tr></table></figure>\n<p>tcpudp.systemctl restart firewalld.service </p>\n<h1 id=\"-Shadowsocks\"><a href=\"#-Shadowsocks\" class=\"headerlink\" title=\"(Shadowsocks)\"></a>(Shadowsocks)</h1><h2 id=\"macwindows\"><a href=\"#macwindows\" class=\"headerlink\" title=\"macwindows\"></a>macwindows</h2><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://github.com/shadowsocks</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://img.blog.csdn.net/20171110093052673?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"client\"><br><em>Shadowsocks-windowswindows</em><br><em>ShadowsocksX-NGmac</em></p>\n<h2 id=\"iphone\"><a href=\"#iphone\" class=\"headerlink\" title=\"iphone\"></a>iphone</h2><p>super wingy<br><img src=\"http://img.blog.csdn.net/20171110092642061?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2luYXRfMTY3MTI2NzE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" alt=\"super_wingy\"></p>\n<h1 id=\"KCPTun\"><a href=\"#KCPTun\" class=\"headerlink\" title=\"KCPTun\"></a>KCPTun</h1><p>ShadowsocksKCPTun</p>\n<p>KCPTunUDPTCP</p>\n<p>KCP  TCP10%-20% 30%-40%</p>\n<h2 id=\"KCPTun\"><a href=\"#KCPTun\" class=\"headerlink\" title=\"KCPTun\"></a>KCPTun</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// </span><br><span class=\"line\">wget https://raw.githubusercontent.com/kuoruan/kcptun_installer/master/kcptun.sh</span><br><span class=\"line\">// </span><br><span class=\"line\">chmod +x ./kcptun.sh</span><br><span class=\"line\">// </span><br><span class=\"line\">./kcptun.sh</span><br></pre></td></tr></table></figure>\n<h1 id=\"vultr\"><a href=\"#vultr\" class=\"headerlink\" title=\"vultr\"></a>vultr</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://www.vultr.com/?ref=7259520</span><br></pre></td></tr></table></figure>\n"},{"title":"-","date":"2018-06-11T01:36:33.000Z","_content":"\n# \n\n\n\n# \n\n\n\n\n\n\n\n# \n\n\n\n```\npublic class Singleton {\n    private static Singleton singleton;\n\n    private Singleton() {}\n\n    public static Singleton getInstance() {\n        if (singleton == null) {\n            singleton = new Singleton();\n        }\n\n        return singleton;\n    }\n}\n```\n\n\n\n1. static\n\n2. \n\n3. \n\n\n## \n\n-\n\n\n\n```\npublic class BadSynchronizedSingleton {\n\n    //\n    private static BadSynchronizedSingleton synchronizedSingleton;\n    //\n    private BadSynchronizedSingleton(){}\n    //\n    public synchronized static BadSynchronizedSingleton getInstance(){\n        if (synchronizedSingleton == null) {\n            synchronizedSingleton = new BadSynchronizedSingleton();\n        }\n        return synchronizedSingleton;\n    }\n}\n```\n\n\n\n\n\n```\npublic class SynchronizedSingleton {\n\n    //\n    private static SynchronizedSingleton synchronizedSingleton;\n    //\n    private SynchronizedSingleton(){}\n    //\n    public static SynchronizedSingleton getInstance(){\n        if (synchronizedSingleton == null) {\n            synchronized (SynchronizedSingleton.class) {\n                if (synchronizedSingleton == null) {\n                    synchronizedSingleton = new SynchronizedSingleton();\n                }\n            }\n        }\n        return synchronizedSingleton;\n    }\n}\n```\n\nnullsynchronizedSingletonnull\n\nnullABsynchronizedSingletonnullAAsynchronizedSingletonABABnullB\n\n\n# \n\n```\npublic class SingletonDemo {\n    private static SingletonDemo instance = new SingletonDemo();\n\n    private SingletonDemo () {}\n\n    public static SingletonDemo getInstance() {\n        return instance;\n    }\n}\n```\n\n\n","source":"_posts/singleton.md","raw":"---\ntitle: -\ndate: 2018-06-11 09:36:33\ntags:\ncategories: \n---\n\n# \n\n\n\n# \n\n\n\n\n\n\n\n# \n\n\n\n```\npublic class Singleton {\n    private static Singleton singleton;\n\n    private Singleton() {}\n\n    public static Singleton getInstance() {\n        if (singleton == null) {\n            singleton = new Singleton();\n        }\n\n        return singleton;\n    }\n}\n```\n\n\n\n1. static\n\n2. \n\n3. \n\n\n## \n\n-\n\n\n\n```\npublic class BadSynchronizedSingleton {\n\n    //\n    private static BadSynchronizedSingleton synchronizedSingleton;\n    //\n    private BadSynchronizedSingleton(){}\n    //\n    public synchronized static BadSynchronizedSingleton getInstance(){\n        if (synchronizedSingleton == null) {\n            synchronizedSingleton = new BadSynchronizedSingleton();\n        }\n        return synchronizedSingleton;\n    }\n}\n```\n\n\n\n\n\n```\npublic class SynchronizedSingleton {\n\n    //\n    private static SynchronizedSingleton synchronizedSingleton;\n    //\n    private SynchronizedSingleton(){}\n    //\n    public static SynchronizedSingleton getInstance(){\n        if (synchronizedSingleton == null) {\n            synchronized (SynchronizedSingleton.class) {\n                if (synchronizedSingleton == null) {\n                    synchronizedSingleton = new SynchronizedSingleton();\n                }\n            }\n        }\n        return synchronizedSingleton;\n    }\n}\n```\n\nnullsynchronizedSingletonnull\n\nnullABsynchronizedSingletonnullAAsynchronizedSingletonABABnullB\n\n\n# \n\n```\npublic class SingletonDemo {\n    private static SingletonDemo instance = new SingletonDemo();\n\n    private SingletonDemo () {}\n\n    public static SingletonDemo getInstance() {\n        return instance;\n    }\n}\n```\n\n\n","slug":"singleton","published":1,"updated":"2019-12-24T02:00:57.460Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jx100120j9kkglfh2f6","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Singleton &#123;</span><br><span class=\"line\">    private static Singleton singleton;</span><br><span class=\"line\"></span><br><span class=\"line\">    private Singleton() &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static Singleton getInstance() &#123;</span><br><span class=\"line\">        if (singleton == null) &#123;</span><br><span class=\"line\">            singleton = new Singleton();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        return singleton;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ol>\n<li><p>static</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>-</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class BadSynchronizedSingleton &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    private static BadSynchronizedSingleton synchronizedSingleton;</span><br><span class=\"line\">    //</span><br><span class=\"line\">    private BadSynchronizedSingleton()&#123;&#125;</span><br><span class=\"line\">    //</span><br><span class=\"line\">    public synchronized static BadSynchronizedSingleton getInstance()&#123;</span><br><span class=\"line\">        if (synchronizedSingleton == null) &#123;</span><br><span class=\"line\">            synchronizedSingleton = new BadSynchronizedSingleton();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        return synchronizedSingleton;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class SynchronizedSingleton &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    private static SynchronizedSingleton synchronizedSingleton;</span><br><span class=\"line\">    //</span><br><span class=\"line\">    private SynchronizedSingleton()&#123;&#125;</span><br><span class=\"line\">    //</span><br><span class=\"line\">    public static SynchronizedSingleton getInstance()&#123;</span><br><span class=\"line\">        if (synchronizedSingleton == null) &#123;</span><br><span class=\"line\">            synchronized (SynchronizedSingleton.class) &#123;</span><br><span class=\"line\">                if (synchronizedSingleton == null) &#123;</span><br><span class=\"line\">                    synchronizedSingleton = new SynchronizedSingleton();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        return synchronizedSingleton;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>nullsynchronizedSingletonnull</p>\n<p>nullABsynchronizedSingletonnullAAsynchronizedSingletonABABnullB</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class SingletonDemo &#123;</span><br><span class=\"line\">    private static SingletonDemo instance = new SingletonDemo();</span><br><span class=\"line\"></span><br><span class=\"line\">    private SingletonDemo () &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static SingletonDemo getInstance() &#123;</span><br><span class=\"line\">        return instance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Singleton &#123;</span><br><span class=\"line\">    private static Singleton singleton;</span><br><span class=\"line\"></span><br><span class=\"line\">    private Singleton() &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static Singleton getInstance() &#123;</span><br><span class=\"line\">        if (singleton == null) &#123;</span><br><span class=\"line\">            singleton = new Singleton();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        return singleton;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ol>\n<li><p>static</p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>-</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class BadSynchronizedSingleton &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    private static BadSynchronizedSingleton synchronizedSingleton;</span><br><span class=\"line\">    //</span><br><span class=\"line\">    private BadSynchronizedSingleton()&#123;&#125;</span><br><span class=\"line\">    //</span><br><span class=\"line\">    public synchronized static BadSynchronizedSingleton getInstance()&#123;</span><br><span class=\"line\">        if (synchronizedSingleton == null) &#123;</span><br><span class=\"line\">            synchronizedSingleton = new BadSynchronizedSingleton();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        return synchronizedSingleton;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class SynchronizedSingleton &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    private static SynchronizedSingleton synchronizedSingleton;</span><br><span class=\"line\">    //</span><br><span class=\"line\">    private SynchronizedSingleton()&#123;&#125;</span><br><span class=\"line\">    //</span><br><span class=\"line\">    public static SynchronizedSingleton getInstance()&#123;</span><br><span class=\"line\">        if (synchronizedSingleton == null) &#123;</span><br><span class=\"line\">            synchronized (SynchronizedSingleton.class) &#123;</span><br><span class=\"line\">                if (synchronizedSingleton == null) &#123;</span><br><span class=\"line\">                    synchronizedSingleton = new SynchronizedSingleton();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        return synchronizedSingleton;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>nullsynchronizedSingletonnull</p>\n<p>nullABsynchronizedSingletonnullAAsynchronizedSingletonABABnullB</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class SingletonDemo &#123;</span><br><span class=\"line\">    private static SingletonDemo instance = new SingletonDemo();</span><br><span class=\"line\"></span><br><span class=\"line\">    private SingletonDemo () &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static SingletonDemo getInstance() &#123;</span><br><span class=\"line\">        return instance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n"},{"title":"twitter","date":"2018-01-30T00:38:03.000Z","_content":"![](http://www.wailian.work/images/2018/01/30/f0cada473c10b0fcfae9784875af64050052c1d2195d47-eEEC79_fw658.jpg)\n\n# \n\nSnowFlakeTwitterIDTwitterIDID\n\nSnowFlakeIDID\n\n# \n\nSnowFlakeID64-\n\n![](http://www.wailian.work/images/2018/01/30/WX20180130-084624.png)\n\n## 1\n\njavalong01ID0\n\n## 41\n\n-ID4169(1L << 41) / (1000L * 60 * 60 * 24 * 365) = 69\n\n## 10\n\nTwitter551024\n\n## 12\n\n4096ID\n\nSnowFlakeIDID551037\n\n# \n\n```\npackage com.wang.snow;\n\npublic class SnowFlake {\n    /**\n     * \n     */\n    private final static long START_STMP = 1480166465631L;\n\n    /**\n     * \n     */\n    private final static long SEQUENCE_BIT = 12; //\n    private final static long MACHINE_BIT = 5;  //\n    private final static long DATACENTER_BIT = 5;//\n\n    /**\n     * \n     */\n    private final static long MAX_DATACENTER_NUM = -1L ^ (-1L << DATACENTER_BIT);\n    private final static long MAX_MACHINE_NUM = -1L ^ (-1L << MACHINE_BIT);\n    private final static long MAX_SEQUENCE = -1L ^ (-1L << SEQUENCE_BIT);\n\n    /**\n     * \n     */\n    private final static long MACHINE_LEFT = SEQUENCE_BIT;\n    private final static long DATACENTER_LEFT = SEQUENCE_BIT + MACHINE_BIT;\n    private final static long TIMESTMP_LEFT = DATACENTER_LEFT + DATACENTER_BIT;\n\n    private long datacenterId;  //\n    private long machineId;    //\n    private long sequence = 0L; //\n    private long lastStmp = -1L;//\n\n    public SnowFlake(long datacenterId, long machineId) {\n        if (datacenterId > MAX_DATACENTER_NUM || datacenterId < 0) {\n            throw new IllegalArgumentException(\"datacenterId can't be greater than MAX_DATACENTER_NUM or less than 0\");\n        }\n        if (machineId > MAX_MACHINE_NUM || machineId < 0) {\n            throw new IllegalArgumentException(\"machineId can't be greater than MAX_MACHINE_NUM or less than 0\");\n        }\n        this.datacenterId = datacenterId;\n        this.machineId = machineId;\n    }\n\n    /**\n     * ID\n     *\n     * @return\n     */\n    public synchronized long nextId() {\n        long currStmp = getNewstmp();\n        if (currStmp < lastStmp) {\n            throw new RuntimeException(\"Clock moved backwards.  Refusing to generate id\");\n        }\n\n        if (currStmp == lastStmp) {\n            //\n            sequence = (sequence + 1) & MAX_SEQUENCE;\n            //\n            if (sequence == 0L) {\n                currStmp = getNextMill();\n            }\n        } else {\n            //0\n            sequence = 0L;\n        }\n\n        lastStmp = currStmp;\n\n        return (currStmp - START_STMP) << TIMESTMP_LEFT //\n                | datacenterId << DATACENTER_LEFT      //\n                | machineId << MACHINE_LEFT            //\n                | sequence;                            //\n    }\n\n    private long getNextMill() {\n        long mill = getNewstmp();\n        while (mill <= lastStmp) {\n            mill = getNewstmp();\n        }\n        return mill;\n    }\n\n    private long getNewstmp() {\n        return System.currentTimeMillis();\n    }\n}\n\n```\n\n# \n\n```\n@Test\npublic void snow() {\n    SnowFlake snowFlake = new SnowFlake(2, 3);\n    for (int i = 0; i < (1 << 12); i++) {\n        System.out.println(snowFlake.nextId());\n    }\n}\n```\n\n# \n\n```\n155632577921953792\n155632577921953793\n155632577921953794\n155632577921953795\n155632577921953796\n155632577921953797\n155632577921953798\n155632577921953799\n155632577921953800\n155632577921953801\n155632577921953802\n155632577921953803\n155632577921953804\n...\n```\n","source":"_posts/snow-flake.md","raw":"---\ntitle: twitter\ndate: 2018-01-30 08:38:03\ntags:\n---\n![](http://www.wailian.work/images/2018/01/30/f0cada473c10b0fcfae9784875af64050052c1d2195d47-eEEC79_fw658.jpg)\n\n# \n\nSnowFlakeTwitterIDTwitterIDID\n\nSnowFlakeIDID\n\n# \n\nSnowFlakeID64-\n\n![](http://www.wailian.work/images/2018/01/30/WX20180130-084624.png)\n\n## 1\n\njavalong01ID0\n\n## 41\n\n-ID4169(1L << 41) / (1000L * 60 * 60 * 24 * 365) = 69\n\n## 10\n\nTwitter551024\n\n## 12\n\n4096ID\n\nSnowFlakeIDID551037\n\n# \n\n```\npackage com.wang.snow;\n\npublic class SnowFlake {\n    /**\n     * \n     */\n    private final static long START_STMP = 1480166465631L;\n\n    /**\n     * \n     */\n    private final static long SEQUENCE_BIT = 12; //\n    private final static long MACHINE_BIT = 5;  //\n    private final static long DATACENTER_BIT = 5;//\n\n    /**\n     * \n     */\n    private final static long MAX_DATACENTER_NUM = -1L ^ (-1L << DATACENTER_BIT);\n    private final static long MAX_MACHINE_NUM = -1L ^ (-1L << MACHINE_BIT);\n    private final static long MAX_SEQUENCE = -1L ^ (-1L << SEQUENCE_BIT);\n\n    /**\n     * \n     */\n    private final static long MACHINE_LEFT = SEQUENCE_BIT;\n    private final static long DATACENTER_LEFT = SEQUENCE_BIT + MACHINE_BIT;\n    private final static long TIMESTMP_LEFT = DATACENTER_LEFT + DATACENTER_BIT;\n\n    private long datacenterId;  //\n    private long machineId;    //\n    private long sequence = 0L; //\n    private long lastStmp = -1L;//\n\n    public SnowFlake(long datacenterId, long machineId) {\n        if (datacenterId > MAX_DATACENTER_NUM || datacenterId < 0) {\n            throw new IllegalArgumentException(\"datacenterId can't be greater than MAX_DATACENTER_NUM or less than 0\");\n        }\n        if (machineId > MAX_MACHINE_NUM || machineId < 0) {\n            throw new IllegalArgumentException(\"machineId can't be greater than MAX_MACHINE_NUM or less than 0\");\n        }\n        this.datacenterId = datacenterId;\n        this.machineId = machineId;\n    }\n\n    /**\n     * ID\n     *\n     * @return\n     */\n    public synchronized long nextId() {\n        long currStmp = getNewstmp();\n        if (currStmp < lastStmp) {\n            throw new RuntimeException(\"Clock moved backwards.  Refusing to generate id\");\n        }\n\n        if (currStmp == lastStmp) {\n            //\n            sequence = (sequence + 1) & MAX_SEQUENCE;\n            //\n            if (sequence == 0L) {\n                currStmp = getNextMill();\n            }\n        } else {\n            //0\n            sequence = 0L;\n        }\n\n        lastStmp = currStmp;\n\n        return (currStmp - START_STMP) << TIMESTMP_LEFT //\n                | datacenterId << DATACENTER_LEFT      //\n                | machineId << MACHINE_LEFT            //\n                | sequence;                            //\n    }\n\n    private long getNextMill() {\n        long mill = getNewstmp();\n        while (mill <= lastStmp) {\n            mill = getNewstmp();\n        }\n        return mill;\n    }\n\n    private long getNewstmp() {\n        return System.currentTimeMillis();\n    }\n}\n\n```\n\n# \n\n```\n@Test\npublic void snow() {\n    SnowFlake snowFlake = new SnowFlake(2, 3);\n    for (int i = 0; i < (1 << 12); i++) {\n        System.out.println(snowFlake.nextId());\n    }\n}\n```\n\n# \n\n```\n155632577921953792\n155632577921953793\n155632577921953794\n155632577921953795\n155632577921953796\n155632577921953797\n155632577921953798\n155632577921953799\n155632577921953800\n155632577921953801\n155632577921953802\n155632577921953803\n155632577921953804\n...\n```\n","slug":"snow-flake","published":1,"updated":"2019-12-24T02:00:57.460Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jx300130j9k8uzggrpo","content":"<p><img src=\"http://www.wailian.work/images/2018/01/30/f0cada473c10b0fcfae9784875af64050052c1d2195d47-eEEC79_fw658.jpg\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SnowFlakeTwitterIDTwitterIDID</p>\n<p>SnowFlakeIDID</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SnowFlakeID64-</p>\n<p><img src=\"http://www.wailian.work/images/2018/01/30/WX20180130-084624.png\" alt=\"\"></p>\n<h2 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h2><p>javalong01ID0</p>\n<h2 id=\"41\"><a href=\"#41\" class=\"headerlink\" title=\"41\"></a>41</h2><p>-ID4169(1L &lt;&lt; 41) / (1000L <em> 60 </em> 60 <em> 24 </em> 365) = 69</p>\n<h2 id=\"10\"><a href=\"#10\" class=\"headerlink\" title=\"10\"></a>10</h2><p>Twitter551024</p>\n<h2 id=\"12\"><a href=\"#12\" class=\"headerlink\" title=\"12\"></a>12</h2><p>4096ID</p>\n<p>SnowFlakeIDID551037</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package com.wang.snow;</span><br><span class=\"line\"></span><br><span class=\"line\">public class SnowFlake &#123;</span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * </span><br><span class=\"line\">     */</span><br><span class=\"line\">    private final static long START_STMP = 1480166465631L;</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * </span><br><span class=\"line\">     */</span><br><span class=\"line\">    private final static long SEQUENCE_BIT = 12; //</span><br><span class=\"line\">    private final static long MACHINE_BIT = 5;  //</span><br><span class=\"line\">    private final static long DATACENTER_BIT = 5;//</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * </span><br><span class=\"line\">     */</span><br><span class=\"line\">    private final static long MAX_DATACENTER_NUM = -1L ^ (-1L &lt;&lt; DATACENTER_BIT);</span><br><span class=\"line\">    private final static long MAX_MACHINE_NUM = -1L ^ (-1L &lt;&lt; MACHINE_BIT);</span><br><span class=\"line\">    private final static long MAX_SEQUENCE = -1L ^ (-1L &lt;&lt; SEQUENCE_BIT);</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * </span><br><span class=\"line\">     */</span><br><span class=\"line\">    private final static long MACHINE_LEFT = SEQUENCE_BIT;</span><br><span class=\"line\">    private final static long DATACENTER_LEFT = SEQUENCE_BIT + MACHINE_BIT;</span><br><span class=\"line\">    private final static long TIMESTMP_LEFT = DATACENTER_LEFT + DATACENTER_BIT;</span><br><span class=\"line\"></span><br><span class=\"line\">    private long datacenterId;  //</span><br><span class=\"line\">    private long machineId;    //</span><br><span class=\"line\">    private long sequence = 0L; //</span><br><span class=\"line\">    private long lastStmp = -1L;//</span><br><span class=\"line\"></span><br><span class=\"line\">    public SnowFlake(long datacenterId, long machineId) &#123;</span><br><span class=\"line\">        if (datacenterId &gt; MAX_DATACENTER_NUM || datacenterId &lt; 0) &#123;</span><br><span class=\"line\">            throw new IllegalArgumentException(&quot;datacenterId can&apos;t be greater than MAX_DATACENTER_NUM or less than 0&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if (machineId &gt; MAX_MACHINE_NUM || machineId &lt; 0) &#123;</span><br><span class=\"line\">            throw new IllegalArgumentException(&quot;machineId can&apos;t be greater than MAX_MACHINE_NUM or less than 0&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        this.datacenterId = datacenterId;</span><br><span class=\"line\">        this.machineId = machineId;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * ID</span><br><span class=\"line\">     *</span><br><span class=\"line\">     * @return</span><br><span class=\"line\">     */</span><br><span class=\"line\">    public synchronized long nextId() &#123;</span><br><span class=\"line\">        long currStmp = getNewstmp();</span><br><span class=\"line\">        if (currStmp &lt; lastStmp) &#123;</span><br><span class=\"line\">            throw new RuntimeException(&quot;Clock moved backwards.  Refusing to generate id&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        if (currStmp == lastStmp) &#123;</span><br><span class=\"line\">            //</span><br><span class=\"line\">            sequence = (sequence + 1) &amp; MAX_SEQUENCE;</span><br><span class=\"line\">            //</span><br><span class=\"line\">            if (sequence == 0L) &#123;</span><br><span class=\"line\">                currStmp = getNextMill();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            //0</span><br><span class=\"line\">            sequence = 0L;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        lastStmp = currStmp;</span><br><span class=\"line\"></span><br><span class=\"line\">        return (currStmp - START_STMP) &lt;&lt; TIMESTMP_LEFT //</span><br><span class=\"line\">                | datacenterId &lt;&lt; DATACENTER_LEFT      //</span><br><span class=\"line\">                | machineId &lt;&lt; MACHINE_LEFT            //</span><br><span class=\"line\">                | sequence;                            //</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private long getNextMill() &#123;</span><br><span class=\"line\">        long mill = getNewstmp();</span><br><span class=\"line\">        while (mill &lt;= lastStmp) &#123;</span><br><span class=\"line\">            mill = getNewstmp();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        return mill;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private long getNewstmp() &#123;</span><br><span class=\"line\">        return System.currentTimeMillis();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Test</span><br><span class=\"line\">public void snow() &#123;</span><br><span class=\"line\">    SnowFlake snowFlake = new SnowFlake(2, 3);</span><br><span class=\"line\">    for (int i = 0; i &lt; (1 &lt;&lt; 12); i++) &#123;</span><br><span class=\"line\">        System.out.println(snowFlake.nextId());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">155632577921953792</span><br><span class=\"line\">155632577921953793</span><br><span class=\"line\">155632577921953794</span><br><span class=\"line\">155632577921953795</span><br><span class=\"line\">155632577921953796</span><br><span class=\"line\">155632577921953797</span><br><span class=\"line\">155632577921953798</span><br><span class=\"line\">155632577921953799</span><br><span class=\"line\">155632577921953800</span><br><span class=\"line\">155632577921953801</span><br><span class=\"line\">155632577921953802</span><br><span class=\"line\">155632577921953803</span><br><span class=\"line\">155632577921953804</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/01/30/f0cada473c10b0fcfae9784875af64050052c1d2195d47-eEEC79_fw658.jpg\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SnowFlakeTwitterIDTwitterIDID</p>\n<p>SnowFlakeIDID</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>SnowFlakeID64-</p>\n<p><img src=\"http://www.wailian.work/images/2018/01/30/WX20180130-084624.png\" alt=\"\"></p>\n<h2 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a>1</h2><p>javalong01ID0</p>\n<h2 id=\"41\"><a href=\"#41\" class=\"headerlink\" title=\"41\"></a>41</h2><p>-ID4169(1L &lt;&lt; 41) / (1000L <em> 60 </em> 60 <em> 24 </em> 365) = 69</p>\n<h2 id=\"10\"><a href=\"#10\" class=\"headerlink\" title=\"10\"></a>10</h2><p>Twitter551024</p>\n<h2 id=\"12\"><a href=\"#12\" class=\"headerlink\" title=\"12\"></a>12</h2><p>4096ID</p>\n<p>SnowFlakeIDID551037</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package com.wang.snow;</span><br><span class=\"line\"></span><br><span class=\"line\">public class SnowFlake &#123;</span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * </span><br><span class=\"line\">     */</span><br><span class=\"line\">    private final static long START_STMP = 1480166465631L;</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * </span><br><span class=\"line\">     */</span><br><span class=\"line\">    private final static long SEQUENCE_BIT = 12; //</span><br><span class=\"line\">    private final static long MACHINE_BIT = 5;  //</span><br><span class=\"line\">    private final static long DATACENTER_BIT = 5;//</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * </span><br><span class=\"line\">     */</span><br><span class=\"line\">    private final static long MAX_DATACENTER_NUM = -1L ^ (-1L &lt;&lt; DATACENTER_BIT);</span><br><span class=\"line\">    private final static long MAX_MACHINE_NUM = -1L ^ (-1L &lt;&lt; MACHINE_BIT);</span><br><span class=\"line\">    private final static long MAX_SEQUENCE = -1L ^ (-1L &lt;&lt; SEQUENCE_BIT);</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * </span><br><span class=\"line\">     */</span><br><span class=\"line\">    private final static long MACHINE_LEFT = SEQUENCE_BIT;</span><br><span class=\"line\">    private final static long DATACENTER_LEFT = SEQUENCE_BIT + MACHINE_BIT;</span><br><span class=\"line\">    private final static long TIMESTMP_LEFT = DATACENTER_LEFT + DATACENTER_BIT;</span><br><span class=\"line\"></span><br><span class=\"line\">    private long datacenterId;  //</span><br><span class=\"line\">    private long machineId;    //</span><br><span class=\"line\">    private long sequence = 0L; //</span><br><span class=\"line\">    private long lastStmp = -1L;//</span><br><span class=\"line\"></span><br><span class=\"line\">    public SnowFlake(long datacenterId, long machineId) &#123;</span><br><span class=\"line\">        if (datacenterId &gt; MAX_DATACENTER_NUM || datacenterId &lt; 0) &#123;</span><br><span class=\"line\">            throw new IllegalArgumentException(&quot;datacenterId can&apos;t be greater than MAX_DATACENTER_NUM or less than 0&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if (machineId &gt; MAX_MACHINE_NUM || machineId &lt; 0) &#123;</span><br><span class=\"line\">            throw new IllegalArgumentException(&quot;machineId can&apos;t be greater than MAX_MACHINE_NUM or less than 0&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        this.datacenterId = datacenterId;</span><br><span class=\"line\">        this.machineId = machineId;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * ID</span><br><span class=\"line\">     *</span><br><span class=\"line\">     * @return</span><br><span class=\"line\">     */</span><br><span class=\"line\">    public synchronized long nextId() &#123;</span><br><span class=\"line\">        long currStmp = getNewstmp();</span><br><span class=\"line\">        if (currStmp &lt; lastStmp) &#123;</span><br><span class=\"line\">            throw new RuntimeException(&quot;Clock moved backwards.  Refusing to generate id&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        if (currStmp == lastStmp) &#123;</span><br><span class=\"line\">            //</span><br><span class=\"line\">            sequence = (sequence + 1) &amp; MAX_SEQUENCE;</span><br><span class=\"line\">            //</span><br><span class=\"line\">            if (sequence == 0L) &#123;</span><br><span class=\"line\">                currStmp = getNextMill();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            //0</span><br><span class=\"line\">            sequence = 0L;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        lastStmp = currStmp;</span><br><span class=\"line\"></span><br><span class=\"line\">        return (currStmp - START_STMP) &lt;&lt; TIMESTMP_LEFT //</span><br><span class=\"line\">                | datacenterId &lt;&lt; DATACENTER_LEFT      //</span><br><span class=\"line\">                | machineId &lt;&lt; MACHINE_LEFT            //</span><br><span class=\"line\">                | sequence;                            //</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private long getNextMill() &#123;</span><br><span class=\"line\">        long mill = getNewstmp();</span><br><span class=\"line\">        while (mill &lt;= lastStmp) &#123;</span><br><span class=\"line\">            mill = getNewstmp();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        return mill;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private long getNewstmp() &#123;</span><br><span class=\"line\">        return System.currentTimeMillis();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Test</span><br><span class=\"line\">public void snow() &#123;</span><br><span class=\"line\">    SnowFlake snowFlake = new SnowFlake(2, 3);</span><br><span class=\"line\">    for (int i = 0; i &lt; (1 &lt;&lt; 12); i++) &#123;</span><br><span class=\"line\">        System.out.println(snowFlake.nextId());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">155632577921953792</span><br><span class=\"line\">155632577921953793</span><br><span class=\"line\">155632577921953794</span><br><span class=\"line\">155632577921953795</span><br><span class=\"line\">155632577921953796</span><br><span class=\"line\">155632577921953797</span><br><span class=\"line\">155632577921953798</span><br><span class=\"line\">155632577921953799</span><br><span class=\"line\">155632577921953800</span><br><span class=\"line\">155632577921953801</span><br><span class=\"line\">155632577921953802</span><br><span class=\"line\">155632577921953803</span><br><span class=\"line\">155632577921953804</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n"},{"title":"Spring BootTomcat","date":"2018-04-12T09:22:59.000Z","top":10,"_content":"\n> \n\n# \n\n`java.io.IOException: The temporary upload location [/tmp/tomcat.948083514929465118.8889/work/Tomcat/localhost/ROOT] is not valid`\n\n![](http://www.wailian.work/images/2018/04/12/21.png)\n\n# \n\n https://github.com/spring-projects/spring-boot/issues/5009\n\n`tmpwatch`  removes  files  which havent been accessed for a period of time\n\n/tmp\n\ntomcat`tmpwatch``class`\n\n# \n\n## 1.\n\n```\n-Djava.io.tmpdir=/var/tmp\n```\n\n## 2.\n\n```\nserver:\n    tomcat:\n       basedir: /var/tmp/\n```\n\n## 3.tomcat \n\n```\n@Configuration\npublic class MultipartConfig {\n    @Bean\n    MultipartConfigElement multipartConfigElement() {\n        MultipartConfigFactory factory = new MultipartConfigFactory();\n        String location = System.getProperty(\"user.dir\") + \"/data/tmp\";\n        File tmpFile = new File(location);\n        if (!tmpFile.exists()) {\n            tmpFile.mkdirs();\n        }\n        factory.setLocation(location);\n        return factory.createMultipartConfig();\n    }\n}\n```\n\n[](http://www.wtnull.com/v/SPRING/Spring%20boot%20%E5%86%85%E5%B5%8Ctomcat%E4%B8%B4%E6%97%B6%E7%9B%AE%E5%BD%95%E4%B8%8D%E5%AD%98%E5%9C%A8%20%E9%94%99%E8%AF%AF.html)\n","source":"_posts/spring-boot-tomcat.md","raw":"---\ntitle: Spring BootTomcat \ndate: 2018-04-12 17:22:59\ntags:\ntop: 10\n---\n\n> \n\n# \n\n`java.io.IOException: The temporary upload location [/tmp/tomcat.948083514929465118.8889/work/Tomcat/localhost/ROOT] is not valid`\n\n![](http://www.wailian.work/images/2018/04/12/21.png)\n\n# \n\n https://github.com/spring-projects/spring-boot/issues/5009\n\n`tmpwatch`  removes  files  which havent been accessed for a period of time\n\n/tmp\n\ntomcat`tmpwatch``class`\n\n# \n\n## 1.\n\n```\n-Djava.io.tmpdir=/var/tmp\n```\n\n## 2.\n\n```\nserver:\n    tomcat:\n       basedir: /var/tmp/\n```\n\n## 3.tomcat \n\n```\n@Configuration\npublic class MultipartConfig {\n    @Bean\n    MultipartConfigElement multipartConfigElement() {\n        MultipartConfigFactory factory = new MultipartConfigFactory();\n        String location = System.getProperty(\"user.dir\") + \"/data/tmp\";\n        File tmpFile = new File(location);\n        if (!tmpFile.exists()) {\n            tmpFile.mkdirs();\n        }\n        factory.setLocation(location);\n        return factory.createMultipartConfig();\n    }\n}\n```\n\n[](http://www.wtnull.com/v/SPRING/Spring%20boot%20%E5%86%85%E5%B5%8Ctomcat%E4%B8%B4%E6%97%B6%E7%9B%AE%E5%BD%95%E4%B8%8D%E5%AD%98%E5%9C%A8%20%E9%94%99%E8%AF%AF.html)\n","slug":"spring-boot-tomcat","published":1,"updated":"2019-12-24T02:00:57.460Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jx400140j9kobbqyj3t","content":"<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>java.io.IOException: The temporary upload location [/tmp/tomcat.948083514929465118.8889/work/Tomcat/localhost/ROOT] is not valid</code></p>\n<p><img src=\"http://www.wailian.work/images/2018/04/12/21.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <a href=\"https://github.com/spring-projects/spring-boot/issues/5009\" target=\"_blank\" rel=\"noopener\">https://github.com/spring-projects/spring-boot/issues/5009</a></p>\n<p><code>tmpwatch</code>  removes  files  which havent been accessed for a period of time</p>\n<p>/tmp</p>\n<p>tomcat<code>tmpwatch</code><code>class</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-Djava.io.tmpdir=/var/tmp</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server:</span><br><span class=\"line\">    tomcat:</span><br><span class=\"line\">       basedir: /var/tmp/</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-tomcat-\"><a href=\"#3-tomcat-\" class=\"headerlink\" title=\"3.tomcat \"></a>3.tomcat </h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Configuration</span><br><span class=\"line\">public class MultipartConfig &#123;</span><br><span class=\"line\">    @Bean</span><br><span class=\"line\">    MultipartConfigElement multipartConfigElement() &#123;</span><br><span class=\"line\">        MultipartConfigFactory factory = new MultipartConfigFactory();</span><br><span class=\"line\">        String location = System.getProperty(&quot;user.dir&quot;) + &quot;/data/tmp&quot;;</span><br><span class=\"line\">        File tmpFile = new File(location);</span><br><span class=\"line\">        if (!tmpFile.exists()) &#123;</span><br><span class=\"line\">            tmpFile.mkdirs();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        factory.setLocation(location);</span><br><span class=\"line\">        return factory.createMultipartConfig();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><a href=\"http://www.wtnull.com/v/SPRING/Spring%20boot%20%E5%86%85%E5%B5%8Ctomcat%E4%B8%B4%E6%97%B6%E7%9B%AE%E5%BD%95%E4%B8%8D%E5%AD%98%E5%9C%A8%20%E9%94%99%E8%AF%AF.html\" target=\"_blank\" rel=\"noopener\"></a></p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>java.io.IOException: The temporary upload location [/tmp/tomcat.948083514929465118.8889/work/Tomcat/localhost/ROOT] is not valid</code></p>\n<p><img src=\"http://www.wailian.work/images/2018/04/12/21.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> <a href=\"https://github.com/spring-projects/spring-boot/issues/5009\" target=\"_blank\" rel=\"noopener\">https://github.com/spring-projects/spring-boot/issues/5009</a></p>\n<p><code>tmpwatch</code>  removes  files  which havent been accessed for a period of time</p>\n<p>/tmp</p>\n<p>tomcat<code>tmpwatch</code><code>class</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-Djava.io.tmpdir=/var/tmp</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server:</span><br><span class=\"line\">    tomcat:</span><br><span class=\"line\">       basedir: /var/tmp/</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-tomcat-\"><a href=\"#3-tomcat-\" class=\"headerlink\" title=\"3.tomcat \"></a>3.tomcat </h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Configuration</span><br><span class=\"line\">public class MultipartConfig &#123;</span><br><span class=\"line\">    @Bean</span><br><span class=\"line\">    MultipartConfigElement multipartConfigElement() &#123;</span><br><span class=\"line\">        MultipartConfigFactory factory = new MultipartConfigFactory();</span><br><span class=\"line\">        String location = System.getProperty(&quot;user.dir&quot;) + &quot;/data/tmp&quot;;</span><br><span class=\"line\">        File tmpFile = new File(location);</span><br><span class=\"line\">        if (!tmpFile.exists()) &#123;</span><br><span class=\"line\">            tmpFile.mkdirs();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        factory.setLocation(location);</span><br><span class=\"line\">        return factory.createMultipartConfig();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><a href=\"http://www.wtnull.com/v/SPRING/Spring%20boot%20%E5%86%85%E5%B5%8Ctomcat%E4%B8%B4%E6%97%B6%E7%9B%AE%E5%BD%95%E4%B8%8D%E5%AD%98%E5%9C%A8%20%E9%94%99%E8%AF%AF.html\" target=\"_blank\" rel=\"noopener\"></a></p>\n"},{"title":"1.Spring Cloud","date":"2017-12-14T06:39:51.000Z","top":1,"_content":"\n![](http://www.wailian.work/images/2018/04/11/7e5ab258cc355acd50eb3c588de61078be3bb9bd4c432-iZMM5y_fw658.jpg)\n\n# \n\nRESTful API\n\n# \n\nSpring CloudSpring Cloud\n\nSpring CloudSpring CloudNetflix EurekaConsulZookeeperSpring Cloud\n\nSpring Cloud\n\n# Spring Cloud Eureka\n\nSpring Cloud Eureka\n\nSpring Cloud EurekaSpring Cloud NetflixSpring Cloud NetflixSpring CloudNetflixSpring BootNetflix OSSEurekaHystrixZuulRibbon\n\nSpring Cloud Eureka\n\n# \n\nSpring Booteureka-serverpom.xml\n\n```\n<parent>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-parent</artifactId>\n    <version>1.5.4.RELEASE</version>\n    <relativePath/>\n</parent>\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-starter-eureka-server</artifactId>\n    </dependency>\n</dependencies>\n<dependencyManagement>\n    <dependencies>\n        <dependency>\n           <groupId>org.springframework.cloud</groupId>\n           <artifactId>spring-cloud-dependencies</artifactId>\n           <version>Dalston.SR1</version>\n           <type>pom</type>\n           <scope>import</scope>\n        </dependency>\n    </dependencies>\n</dependencyManagement>\n```\n@EnableEurekaServerSpring Boot\n```\n@EnableEurekaServer\n@SpringBootApplication\npublic class Application {\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(Application.class).web(true).run(args);\n    }\n}\n```\napplication.properties\n```\nspring.application.name=eureka-server\nserver.port=1001\neureka.instance.hostname=localhost\neureka.client.register-with-eureka=false\neureka.client.fetch-registry=false\n```\nserver.port1001http://localhost:1001/ \n\n# \n\n\n\nSpring Booteureka-clientpom.xml\n\n```\n<parent>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-parent</artifactId>\n    <version>1.5.4.RELEASE</version>\n    <relativePath/> <!-- lookup parent from repository -->\n</parent>\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-starter-eureka</artifactId>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n    </dependency>\n</dependencies>\n<dependencyManagement>\n    <dependencies>\n        <dependency>\n           <groupId>org.springframework.cloud</groupId>\n           <artifactId>spring-cloud-dependencies</artifactId>\n           <version>Dalston.SR1</version>\n           <type>pom</type>\n           <scope>import</scope>\n        </dependency>\n    </dependencies>\n</dependencyManagement>\n```\n/dcDiscoveryClient\n```\n@RestController\npublic class DcController {\n    @Autowired\n    DiscoveryClient discoveryClient;\n    @GetMapping(\"/dc\")\n    public String dc() {\n        String services = \"Services: \" + discoveryClient.getServices();\n        System.out.println(services);\n        return services;\n    }\n}\n```\n@EnableDiscoveryClientEurekaDiscoveryClientController\n```\n@EnableDiscoveryClient\n@SpringBootApplication\npublic class Application {\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(ComputeServiceApplication.class).web(true).run(args);\n    }\n}\n```\napplication.properties\n```\nspring.application.name=eureka-client\nserver.port=2001\neureka.client.serviceUrl.defaultZone=http://localhost:1001/eureka/\n```\nspring.application.nameeureka.client.serviceUrl.defaultZoneserver.port\n\nhttp://localhost:1001/ \n\neureka-client/dchttp://localhost:2001/dc \n```\nServices: [eureka-client]\n```\neureka-clientSpring CloudDiscoveryClienteurekaSpring Cloudeurekaconsul\n\n> [DD-](http://blog.didispace.com/)\n","source":"_posts/spring-cloud-eureka.md","raw":"---\ntitle: 1.Spring Cloud\ndate: 2017-12-14 14:39:51\ntop: 1\ncategories: \n---\n\n![](http://www.wailian.work/images/2018/04/11/7e5ab258cc355acd50eb3c588de61078be3bb9bd4c432-iZMM5y_fw658.jpg)\n\n# \n\nRESTful API\n\n# \n\nSpring CloudSpring Cloud\n\nSpring CloudSpring CloudNetflix EurekaConsulZookeeperSpring Cloud\n\nSpring Cloud\n\n# Spring Cloud Eureka\n\nSpring Cloud Eureka\n\nSpring Cloud EurekaSpring Cloud NetflixSpring Cloud NetflixSpring CloudNetflixSpring BootNetflix OSSEurekaHystrixZuulRibbon\n\nSpring Cloud Eureka\n\n# \n\nSpring Booteureka-serverpom.xml\n\n```\n<parent>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-parent</artifactId>\n    <version>1.5.4.RELEASE</version>\n    <relativePath/>\n</parent>\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-starter-eureka-server</artifactId>\n    </dependency>\n</dependencies>\n<dependencyManagement>\n    <dependencies>\n        <dependency>\n           <groupId>org.springframework.cloud</groupId>\n           <artifactId>spring-cloud-dependencies</artifactId>\n           <version>Dalston.SR1</version>\n           <type>pom</type>\n           <scope>import</scope>\n        </dependency>\n    </dependencies>\n</dependencyManagement>\n```\n@EnableEurekaServerSpring Boot\n```\n@EnableEurekaServer\n@SpringBootApplication\npublic class Application {\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(Application.class).web(true).run(args);\n    }\n}\n```\napplication.properties\n```\nspring.application.name=eureka-server\nserver.port=1001\neureka.instance.hostname=localhost\neureka.client.register-with-eureka=false\neureka.client.fetch-registry=false\n```\nserver.port1001http://localhost:1001/ \n\n# \n\n\n\nSpring Booteureka-clientpom.xml\n\n```\n<parent>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-parent</artifactId>\n    <version>1.5.4.RELEASE</version>\n    <relativePath/> <!-- lookup parent from repository -->\n</parent>\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-starter-eureka</artifactId>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n    </dependency>\n</dependencies>\n<dependencyManagement>\n    <dependencies>\n        <dependency>\n           <groupId>org.springframework.cloud</groupId>\n           <artifactId>spring-cloud-dependencies</artifactId>\n           <version>Dalston.SR1</version>\n           <type>pom</type>\n           <scope>import</scope>\n        </dependency>\n    </dependencies>\n</dependencyManagement>\n```\n/dcDiscoveryClient\n```\n@RestController\npublic class DcController {\n    @Autowired\n    DiscoveryClient discoveryClient;\n    @GetMapping(\"/dc\")\n    public String dc() {\n        String services = \"Services: \" + discoveryClient.getServices();\n        System.out.println(services);\n        return services;\n    }\n}\n```\n@EnableDiscoveryClientEurekaDiscoveryClientController\n```\n@EnableDiscoveryClient\n@SpringBootApplication\npublic class Application {\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(ComputeServiceApplication.class).web(true).run(args);\n    }\n}\n```\napplication.properties\n```\nspring.application.name=eureka-client\nserver.port=2001\neureka.client.serviceUrl.defaultZone=http://localhost:1001/eureka/\n```\nspring.application.nameeureka.client.serviceUrl.defaultZoneserver.port\n\nhttp://localhost:1001/ \n\neureka-client/dchttp://localhost:2001/dc \n```\nServices: [eureka-client]\n```\neureka-clientSpring CloudDiscoveryClienteurekaSpring Cloudeurekaconsul\n\n> [DD-](http://blog.didispace.com/)\n","slug":"spring-cloud-eureka","published":1,"updated":"2019-12-24T02:00:57.460Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jx500150j9kjt6zlfdg","content":"<p><img src=\"http://www.wailian.work/images/2018/04/11/7e5ab258cc355acd50eb3c588de61078be3bb9bd4c432-iZMM5y_fw658.jpg\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>RESTful API</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring CloudSpring Cloud</p>\n<p>Spring CloudSpring CloudNetflix EurekaConsulZookeeperSpring Cloud</p>\n<p>Spring Cloud</p>\n<h1 id=\"Spring-Cloud-Eureka\"><a href=\"#Spring-Cloud-Eureka\" class=\"headerlink\" title=\"Spring Cloud Eureka\"></a>Spring Cloud Eureka</h1><p>Spring Cloud Eureka</p>\n<p>Spring Cloud EurekaSpring Cloud NetflixSpring Cloud NetflixSpring CloudNetflixSpring BootNetflix OSSEurekaHystrixZuulRibbon</p>\n<p>Spring Cloud Eureka</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring Booteureka-serverpom.xml</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;parent&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;1.5.4.RELEASE&lt;/version&gt;</span><br><span class=\"line\">    &lt;relativePath/&gt;</span><br><span class=\"line\">&lt;/parent&gt;</span><br><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-starter-eureka-server&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br><span class=\"line\">&lt;dependencyManagement&gt;</span><br><span class=\"line\">    &lt;dependencies&gt;</span><br><span class=\"line\">        &lt;dependency&gt;</span><br><span class=\"line\">           &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">           &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;</span><br><span class=\"line\">           &lt;version&gt;Dalston.SR1&lt;/version&gt;</span><br><span class=\"line\">           &lt;type&gt;pom&lt;/type&gt;</span><br><span class=\"line\">           &lt;scope&gt;import&lt;/scope&gt;</span><br><span class=\"line\">        &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;/dependencies&gt;</span><br><span class=\"line\">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>\n<p>@EnableEurekaServerSpring Boot<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableEurekaServer</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>application.properties<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.application.name=eureka-server</span><br><span class=\"line\">server.port=1001</span><br><span class=\"line\">eureka.instance.hostname=localhost</span><br><span class=\"line\">eureka.client.register-with-eureka=false</span><br><span class=\"line\">eureka.client.fetch-registry=false</span><br></pre></td></tr></table></figure></p>\n<p>server.port1001<a href=\"http://localhost:1001/\" target=\"_blank\" rel=\"noopener\">http://localhost:1001/</a> </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>Spring Booteureka-clientpom.xml</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;parent&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;1.5.4.RELEASE&lt;/version&gt;</span><br><span class=\"line\">    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class=\"line\">&lt;/parent&gt;</span><br><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br><span class=\"line\">&lt;dependencyManagement&gt;</span><br><span class=\"line\">    &lt;dependencies&gt;</span><br><span class=\"line\">        &lt;dependency&gt;</span><br><span class=\"line\">           &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">           &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;</span><br><span class=\"line\">           &lt;version&gt;Dalston.SR1&lt;/version&gt;</span><br><span class=\"line\">           &lt;type&gt;pom&lt;/type&gt;</span><br><span class=\"line\">           &lt;scope&gt;import&lt;/scope&gt;</span><br><span class=\"line\">        &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;/dependencies&gt;</span><br><span class=\"line\">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>\n<p>/dcDiscoveryClient<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RestController</span><br><span class=\"line\">public class DcController &#123;</span><br><span class=\"line\">    @Autowired</span><br><span class=\"line\">    DiscoveryClient discoveryClient;</span><br><span class=\"line\">    @GetMapping(&quot;/dc&quot;)</span><br><span class=\"line\">    public String dc() &#123;</span><br><span class=\"line\">        String services = &quot;Services: &quot; + discoveryClient.getServices();</span><br><span class=\"line\">        System.out.println(services);</span><br><span class=\"line\">        return services;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>@EnableDiscoveryClientEurekaDiscoveryClientController<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableDiscoveryClient</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new SpringApplicationBuilder(ComputeServiceApplication.class).web(true).run(args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>application.properties<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.application.name=eureka-client</span><br><span class=\"line\">server.port=2001</span><br><span class=\"line\">eureka.client.serviceUrl.defaultZone=http://localhost:1001/eureka/</span><br></pre></td></tr></table></figure></p>\n<p>spring.application.nameeureka.client.serviceUrl.defaultZoneserver.port</p>\n<p><a href=\"http://localhost:1001/\" target=\"_blank\" rel=\"noopener\">http://localhost:1001/</a> </p>\n<p>eureka-client/dc<a href=\"http://localhost:2001/dc\" target=\"_blank\" rel=\"noopener\">http://localhost:2001/dc</a> <br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Services: [eureka-client]</span><br></pre></td></tr></table></figure></p>\n<p>eureka-clientSpring CloudDiscoveryClienteurekaSpring Cloudeurekaconsul</p>\n<blockquote>\n<p><a href=\"http://blog.didispace.com/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/04/11/7e5ab258cc355acd50eb3c588de61078be3bb9bd4c432-iZMM5y_fw658.jpg\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>RESTful API</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring CloudSpring Cloud</p>\n<p>Spring CloudSpring CloudNetflix EurekaConsulZookeeperSpring Cloud</p>\n<p>Spring Cloud</p>\n<h1 id=\"Spring-Cloud-Eureka\"><a href=\"#Spring-Cloud-Eureka\" class=\"headerlink\" title=\"Spring Cloud Eureka\"></a>Spring Cloud Eureka</h1><p>Spring Cloud Eureka</p>\n<p>Spring Cloud EurekaSpring Cloud NetflixSpring Cloud NetflixSpring CloudNetflixSpring BootNetflix OSSEurekaHystrixZuulRibbon</p>\n<p>Spring Cloud Eureka</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring Booteureka-serverpom.xml</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;parent&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;1.5.4.RELEASE&lt;/version&gt;</span><br><span class=\"line\">    &lt;relativePath/&gt;</span><br><span class=\"line\">&lt;/parent&gt;</span><br><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-starter-eureka-server&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br><span class=\"line\">&lt;dependencyManagement&gt;</span><br><span class=\"line\">    &lt;dependencies&gt;</span><br><span class=\"line\">        &lt;dependency&gt;</span><br><span class=\"line\">           &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">           &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;</span><br><span class=\"line\">           &lt;version&gt;Dalston.SR1&lt;/version&gt;</span><br><span class=\"line\">           &lt;type&gt;pom&lt;/type&gt;</span><br><span class=\"line\">           &lt;scope&gt;import&lt;/scope&gt;</span><br><span class=\"line\">        &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;/dependencies&gt;</span><br><span class=\"line\">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>\n<p>@EnableEurekaServerSpring Boot<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableEurekaServer</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>application.properties<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.application.name=eureka-server</span><br><span class=\"line\">server.port=1001</span><br><span class=\"line\">eureka.instance.hostname=localhost</span><br><span class=\"line\">eureka.client.register-with-eureka=false</span><br><span class=\"line\">eureka.client.fetch-registry=false</span><br></pre></td></tr></table></figure></p>\n<p>server.port1001<a href=\"http://localhost:1001/\" target=\"_blank\" rel=\"noopener\">http://localhost:1001/</a> </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>Spring Booteureka-clientpom.xml</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;parent&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;1.5.4.RELEASE&lt;/version&gt;</span><br><span class=\"line\">    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class=\"line\">&lt;/parent&gt;</span><br><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br><span class=\"line\">&lt;dependencyManagement&gt;</span><br><span class=\"line\">    &lt;dependencies&gt;</span><br><span class=\"line\">        &lt;dependency&gt;</span><br><span class=\"line\">           &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">           &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;</span><br><span class=\"line\">           &lt;version&gt;Dalston.SR1&lt;/version&gt;</span><br><span class=\"line\">           &lt;type&gt;pom&lt;/type&gt;</span><br><span class=\"line\">           &lt;scope&gt;import&lt;/scope&gt;</span><br><span class=\"line\">        &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;/dependencies&gt;</span><br><span class=\"line\">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>\n<p>/dcDiscoveryClient<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RestController</span><br><span class=\"line\">public class DcController &#123;</span><br><span class=\"line\">    @Autowired</span><br><span class=\"line\">    DiscoveryClient discoveryClient;</span><br><span class=\"line\">    @GetMapping(&quot;/dc&quot;)</span><br><span class=\"line\">    public String dc() &#123;</span><br><span class=\"line\">        String services = &quot;Services: &quot; + discoveryClient.getServices();</span><br><span class=\"line\">        System.out.println(services);</span><br><span class=\"line\">        return services;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>@EnableDiscoveryClientEurekaDiscoveryClientController<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableDiscoveryClient</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new SpringApplicationBuilder(ComputeServiceApplication.class).web(true).run(args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>application.properties<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.application.name=eureka-client</span><br><span class=\"line\">server.port=2001</span><br><span class=\"line\">eureka.client.serviceUrl.defaultZone=http://localhost:1001/eureka/</span><br></pre></td></tr></table></figure></p>\n<p>spring.application.nameeureka.client.serviceUrl.defaultZoneserver.port</p>\n<p><a href=\"http://localhost:1001/\" target=\"_blank\" rel=\"noopener\">http://localhost:1001/</a> </p>\n<p>eureka-client/dc<a href=\"http://localhost:2001/dc\" target=\"_blank\" rel=\"noopener\">http://localhost:2001/dc</a> <br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Services: [eureka-client]</span><br></pre></td></tr></table></figure></p>\n<p>eureka-clientSpring CloudDiscoveryClienteurekaSpring Cloudeurekaconsul</p>\n<blockquote>\n<p><a href=\"http://blog.didispace.com/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n</blockquote>\n"},{"title":"10.Spring CloudDalston","date":"2018-04-11T08:18:49.000Z","_content":"\n![](http://www.wailian.work/images/2018/04/11/824a22acf6f0148cdd9cb70c66800ebaace0dcd92d5b7-QI248r_fw658.jpg)\n\nSpring Cloud ZuulSpring Cloud Zuul\n\n# \n\nAPI\n\n\n\nAPISpring Cloud Zuul\n\nZuulAPIZuulFilter\n\n# \n\nZuulHttpServletRequestaccessToken401 Unauthorized\n\n```\npublic class AccessFilter extends ZuulFilter  {\n\n    private static Logger log = LoggerFactory.getLogger(AccessFilter.class);\n\n    @Override\n    public String filterType() {\n        return \"pre\";\n    }\n\n    @Override\n    public int filterOrder() {\n        return 0;\n    }\n\n    @Override\n    public boolean shouldFilter() {\n        return true;\n    }\n\n    @Override\n    public Object run() {\n        RequestContext ctx = RequestContext.getCurrentContext();\n        HttpServletRequest request = ctx.getRequest();\n\n      \tlog.info(\"send {} request to {}\", request.getMethod(), request.getRequestURL().toString());\n\n        Object accessToken = request.getParameter(\"accessToken\");\n        if(accessToken == null) {\n            log.warn(\"access token is empty\");\n            ctx.setSendZuulResponse(false);\n            ctx.setResponseStatusCode(401);\n            return null;\n        }\n        log.info(\"access token ok\");\n        return null;\n    }\n\n}\n```\n\n`ZuulFilter`\n\n- `filterType`pre\n- `filterOrder`\n- `shouldFilter``true`\n- `run``ctx.setSendZuulResponse(false)`zuul`ctx.setResponseStatusCode(401)``ctx.setResponseBody(body)`body\n\nBean\n\n```\n@EnableZuulProxy\n@SpringCloudApplication\npublic class Application {\n\n\tpublic static void main(String[] args) {\n\t\tnew SpringApplicationBuilder(Application.class).web(true).run(args);\n\t}\n\n\t@Bean\n\tpublic AccessFilter accessFilter() {\n\t\treturn new AccessFilter();\n\t}\n}\n```\n\n`api-gateway`\n\n- `http://localhost:1101/api-a/hello`401\n- `http://localhost:1101/api-a/hello&accessToken=token``hello-service``/hello``Hello World`\n\nSpring Cloud Zuul\n","source":"_posts/spring-cloud10.md","raw":"---\ntitle: 10.Spring CloudDalston \ndate: 2018-04-11 16:18:49\ntags:\ncategories: \n---\n\n![](http://www.wailian.work/images/2018/04/11/824a22acf6f0148cdd9cb70c66800ebaace0dcd92d5b7-QI248r_fw658.jpg)\n\nSpring Cloud ZuulSpring Cloud Zuul\n\n# \n\nAPI\n\n\n\nAPISpring Cloud Zuul\n\nZuulAPIZuulFilter\n\n# \n\nZuulHttpServletRequestaccessToken401 Unauthorized\n\n```\npublic class AccessFilter extends ZuulFilter  {\n\n    private static Logger log = LoggerFactory.getLogger(AccessFilter.class);\n\n    @Override\n    public String filterType() {\n        return \"pre\";\n    }\n\n    @Override\n    public int filterOrder() {\n        return 0;\n    }\n\n    @Override\n    public boolean shouldFilter() {\n        return true;\n    }\n\n    @Override\n    public Object run() {\n        RequestContext ctx = RequestContext.getCurrentContext();\n        HttpServletRequest request = ctx.getRequest();\n\n      \tlog.info(\"send {} request to {}\", request.getMethod(), request.getRequestURL().toString());\n\n        Object accessToken = request.getParameter(\"accessToken\");\n        if(accessToken == null) {\n            log.warn(\"access token is empty\");\n            ctx.setSendZuulResponse(false);\n            ctx.setResponseStatusCode(401);\n            return null;\n        }\n        log.info(\"access token ok\");\n        return null;\n    }\n\n}\n```\n\n`ZuulFilter`\n\n- `filterType`pre\n- `filterOrder`\n- `shouldFilter``true`\n- `run``ctx.setSendZuulResponse(false)`zuul`ctx.setResponseStatusCode(401)``ctx.setResponseBody(body)`body\n\nBean\n\n```\n@EnableZuulProxy\n@SpringCloudApplication\npublic class Application {\n\n\tpublic static void main(String[] args) {\n\t\tnew SpringApplicationBuilder(Application.class).web(true).run(args);\n\t}\n\n\t@Bean\n\tpublic AccessFilter accessFilter() {\n\t\treturn new AccessFilter();\n\t}\n}\n```\n\n`api-gateway`\n\n- `http://localhost:1101/api-a/hello`401\n- `http://localhost:1101/api-a/hello&accessToken=token``hello-service``/hello``Hello World`\n\nSpring Cloud Zuul\n","slug":"spring-cloud10","published":1,"updated":"2019-12-24T02:00:57.460Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jx600170j9kruzoezp8","content":"<p><img src=\"http://www.wailian.work/images/2018/04/11/824a22acf6f0148cdd9cb70c66800ebaace0dcd92d5b7-QI248r_fw658.jpg\" alt=\"\"></p>\n<p>Spring Cloud ZuulSpring Cloud Zuul</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>API</p>\n<p></p>\n<p>APISpring Cloud Zuul</p>\n<p>ZuulAPIZuulFilter</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>ZuulHttpServletRequestaccessToken401 Unauthorized</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class AccessFilter extends ZuulFilter  &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    private static Logger log = LoggerFactory.getLogger(AccessFilter.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public String filterType() &#123;</span><br><span class=\"line\">        return &quot;pre&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public int filterOrder() &#123;</span><br><span class=\"line\">        return 0;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public boolean shouldFilter() &#123;</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public Object run() &#123;</span><br><span class=\"line\">        RequestContext ctx = RequestContext.getCurrentContext();</span><br><span class=\"line\">        HttpServletRequest request = ctx.getRequest();</span><br><span class=\"line\"></span><br><span class=\"line\">      \tlog.info(&quot;send &#123;&#125; request to &#123;&#125;&quot;, request.getMethod(), request.getRequestURL().toString());</span><br><span class=\"line\"></span><br><span class=\"line\">        Object accessToken = request.getParameter(&quot;accessToken&quot;);</span><br><span class=\"line\">        if(accessToken == null) &#123;</span><br><span class=\"line\">            log.warn(&quot;access token is empty&quot;);</span><br><span class=\"line\">            ctx.setSendZuulResponse(false);</span><br><span class=\"line\">            ctx.setResponseStatusCode(401);</span><br><span class=\"line\">            return null;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        log.info(&quot;access token ok&quot;);</span><br><span class=\"line\">        return null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>ZuulFilter</code></p>\n<ul>\n<li><code>filterType</code>pre</li>\n<li><code>filterOrder</code></li>\n<li><code>shouldFilter</code><code>true</code></li>\n<li><code>run</code><code>ctx.setSendZuulResponse(false)</code>zuul<code>ctx.setResponseStatusCode(401)</code><code>ctx.setResponseBody(body)</code>body</li>\n</ul>\n<p>Bean</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableZuulProxy</span><br><span class=\"line\">@SpringCloudApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic static void main(String[] args) &#123;</span><br><span class=\"line\">\t\tnew SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@Bean</span><br><span class=\"line\">\tpublic AccessFilter accessFilter() &#123;</span><br><span class=\"line\">\t\treturn new AccessFilter();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>api-gateway</code></p>\n<ul>\n<li><code>http://localhost:1101/api-a/hello</code>401</li>\n<li><code>http://localhost:1101/api-a/hello&amp;accessToken=token</code><code>hello-service</code><code>/hello</code><code>Hello World</code></li>\n</ul>\n<p>Spring Cloud Zuul</p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/04/11/824a22acf6f0148cdd9cb70c66800ebaace0dcd92d5b7-QI248r_fw658.jpg\" alt=\"\"></p>\n<p>Spring Cloud ZuulSpring Cloud Zuul</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>API</p>\n<p></p>\n<p>APISpring Cloud Zuul</p>\n<p>ZuulAPIZuulFilter</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>ZuulHttpServletRequestaccessToken401 Unauthorized</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class AccessFilter extends ZuulFilter  &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    private static Logger log = LoggerFactory.getLogger(AccessFilter.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public String filterType() &#123;</span><br><span class=\"line\">        return &quot;pre&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public int filterOrder() &#123;</span><br><span class=\"line\">        return 0;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public boolean shouldFilter() &#123;</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public Object run() &#123;</span><br><span class=\"line\">        RequestContext ctx = RequestContext.getCurrentContext();</span><br><span class=\"line\">        HttpServletRequest request = ctx.getRequest();</span><br><span class=\"line\"></span><br><span class=\"line\">      \tlog.info(&quot;send &#123;&#125; request to &#123;&#125;&quot;, request.getMethod(), request.getRequestURL().toString());</span><br><span class=\"line\"></span><br><span class=\"line\">        Object accessToken = request.getParameter(&quot;accessToken&quot;);</span><br><span class=\"line\">        if(accessToken == null) &#123;</span><br><span class=\"line\">            log.warn(&quot;access token is empty&quot;);</span><br><span class=\"line\">            ctx.setSendZuulResponse(false);</span><br><span class=\"line\">            ctx.setResponseStatusCode(401);</span><br><span class=\"line\">            return null;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        log.info(&quot;access token ok&quot;);</span><br><span class=\"line\">        return null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>ZuulFilter</code></p>\n<ul>\n<li><code>filterType</code>pre</li>\n<li><code>filterOrder</code></li>\n<li><code>shouldFilter</code><code>true</code></li>\n<li><code>run</code><code>ctx.setSendZuulResponse(false)</code>zuul<code>ctx.setResponseStatusCode(401)</code><code>ctx.setResponseBody(body)</code>body</li>\n</ul>\n<p>Bean</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableZuulProxy</span><br><span class=\"line\">@SpringCloudApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic static void main(String[] args) &#123;</span><br><span class=\"line\">\t\tnew SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@Bean</span><br><span class=\"line\">\tpublic AccessFilter accessFilter() &#123;</span><br><span class=\"line\">\t\treturn new AccessFilter();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>api-gateway</code></p>\n<ul>\n<li><code>http://localhost:1101/api-a/hello</code>401</li>\n<li><code>http://localhost:1101/api-a/hello&amp;accessToken=token</code><code>hello-service</code><code>/hello</code><code>Hello World</code></li>\n</ul>\n<p>Spring Cloud Zuul</p>\n"},{"title":"2.Spring CloudDalston","date":"2018-01-08T08:38:41.000Z","top":1,"_content":"\n![](http://www.wailian.work/images/2018/04/11/b175ccda74ff9615e7c170c40cccdef16a8c1a9c92ef3-tdFa3C_fw658.jpg)\n\n> Spring Cloudeureka-clientEurekaDiscoveryClientgetServices\n\n# LoadBalancerClient\n\nSpring Cloud CommonsDiscoveryClientLoadBalancerClientSpring Cloud\n\nLoadBalancerClientSpring Cloud\n\neureka-servereureka-client\n\neureka-consumerpom.xmlparentdependencyManagement\n\n```\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-starter-eureka</artifactId>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-actuator</artifactId>\n    </dependency>\n</dependencies>\n```\n\napplication.propertieseureka\n\n```\nspring.application.name=eureka-consumer\nserver.port=2101\neureka.client.serviceUrl.defaultZone=http://localhost:1001/eureka/\n```\n\nRestTemplateREST@EnableDiscoveryClient\n\n```\n@EnableDiscoveryClient\n@SpringBootApplication\npublic class Application {\n    @Bean\n    public RestTemplate restTemplate() {\n        return new RestTemplate();\n    }\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(Application.class).web(true).run(args);\n    }\n}\n```\n\neureka-client\n\n```\n@RestController\npublic class DcController {\n    @Autowired\n    LoadBalancerClient loadBalancerClient;\n    @Autowired\n    RestTemplate restTemplate;\n    @GetMapping(\"/consumer\")\n    public String dc() {\n        ServiceInstance serviceInstance = loadBalancerClient.choose(\"eureka-client\");\n        String url = \"http://\" + serviceInstance.getHost() + \":\" + serviceInstance.getPort() + \"/dc\";\n        System.out.println(url);\n        return restTemplate.getForObject(url, String.class);\n    }\n}\n```\n\nLoadBalancerClientRestTemplate/consumerloadBalancerClientchooseeureka-clientServiceInstance/dcRestTemplate\n\neureka-servereureka-clienteureka-consumerhttp://localhost:2101/consumer eureka-consumereureka-client/dc\n\n> [DD-](http://blog.didispace.com/)\n","source":"_posts/spring-cloud2.md","raw":"---\ntitle: 2.Spring CloudDalston\ndate: 2018-01-08 16:38:41\ntop: 1\ncategories: \n---\n\n![](http://www.wailian.work/images/2018/04/11/b175ccda74ff9615e7c170c40cccdef16a8c1a9c92ef3-tdFa3C_fw658.jpg)\n\n> Spring Cloudeureka-clientEurekaDiscoveryClientgetServices\n\n# LoadBalancerClient\n\nSpring Cloud CommonsDiscoveryClientLoadBalancerClientSpring Cloud\n\nLoadBalancerClientSpring Cloud\n\neureka-servereureka-client\n\neureka-consumerpom.xmlparentdependencyManagement\n\n```\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-starter-eureka</artifactId>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-actuator</artifactId>\n    </dependency>\n</dependencies>\n```\n\napplication.propertieseureka\n\n```\nspring.application.name=eureka-consumer\nserver.port=2101\neureka.client.serviceUrl.defaultZone=http://localhost:1001/eureka/\n```\n\nRestTemplateREST@EnableDiscoveryClient\n\n```\n@EnableDiscoveryClient\n@SpringBootApplication\npublic class Application {\n    @Bean\n    public RestTemplate restTemplate() {\n        return new RestTemplate();\n    }\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(Application.class).web(true).run(args);\n    }\n}\n```\n\neureka-client\n\n```\n@RestController\npublic class DcController {\n    @Autowired\n    LoadBalancerClient loadBalancerClient;\n    @Autowired\n    RestTemplate restTemplate;\n    @GetMapping(\"/consumer\")\n    public String dc() {\n        ServiceInstance serviceInstance = loadBalancerClient.choose(\"eureka-client\");\n        String url = \"http://\" + serviceInstance.getHost() + \":\" + serviceInstance.getPort() + \"/dc\";\n        System.out.println(url);\n        return restTemplate.getForObject(url, String.class);\n    }\n}\n```\n\nLoadBalancerClientRestTemplate/consumerloadBalancerClientchooseeureka-clientServiceInstance/dcRestTemplate\n\neureka-servereureka-clienteureka-consumerhttp://localhost:2101/consumer eureka-consumereureka-client/dc\n\n> [DD-](http://blog.didispace.com/)\n","slug":"spring-cloud2","published":1,"updated":"2019-12-24T02:00:57.460Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jx800190j9k2gx8afze","content":"<p><img src=\"http://www.wailian.work/images/2018/04/11/b175ccda74ff9615e7c170c40cccdef16a8c1a9c92ef3-tdFa3C_fw658.jpg\" alt=\"\"></p>\n<blockquote>\n<p>Spring Cloudeureka-clientEurekaDiscoveryClientgetServices</p>\n</blockquote>\n<h1 id=\"LoadBalancerClient\"><a href=\"#LoadBalancerClient\" class=\"headerlink\" title=\"LoadBalancerClient\"></a>LoadBalancerClient</h1><p>Spring Cloud CommonsDiscoveryClientLoadBalancerClientSpring Cloud</p>\n<p>LoadBalancerClientSpring Cloud</p>\n<p>eureka-servereureka-client</p>\n<p>eureka-consumerpom.xmlparentdependencyManagement</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>\n<p>application.propertieseureka</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.application.name=eureka-consumer</span><br><span class=\"line\">server.port=2101</span><br><span class=\"line\">eureka.client.serviceUrl.defaultZone=http://localhost:1001/eureka/</span><br></pre></td></tr></table></figure>\n<p>RestTemplateREST@EnableDiscoveryClient</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableDiscoveryClient</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\">    @Bean</span><br><span class=\"line\">    public RestTemplate restTemplate() &#123;</span><br><span class=\"line\">        return new RestTemplate();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>eureka-client</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RestController</span><br><span class=\"line\">public class DcController &#123;</span><br><span class=\"line\">    @Autowired</span><br><span class=\"line\">    LoadBalancerClient loadBalancerClient;</span><br><span class=\"line\">    @Autowired</span><br><span class=\"line\">    RestTemplate restTemplate;</span><br><span class=\"line\">    @GetMapping(&quot;/consumer&quot;)</span><br><span class=\"line\">    public String dc() &#123;</span><br><span class=\"line\">        ServiceInstance serviceInstance = loadBalancerClient.choose(&quot;eureka-client&quot;);</span><br><span class=\"line\">        String url = &quot;http://&quot; + serviceInstance.getHost() + &quot;:&quot; + serviceInstance.getPort() + &quot;/dc&quot;;</span><br><span class=\"line\">        System.out.println(url);</span><br><span class=\"line\">        return restTemplate.getForObject(url, String.class);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>LoadBalancerClientRestTemplate/consumerloadBalancerClientchooseeureka-clientServiceInstance/dcRestTemplate</p>\n<p>eureka-servereureka-clienteureka-consumer<a href=\"http://localhost:2101/consumer\" target=\"_blank\" rel=\"noopener\">http://localhost:2101/consumer</a> eureka-consumereureka-client/dc</p>\n<blockquote>\n<p><a href=\"http://blog.didispace.com/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/04/11/b175ccda74ff9615e7c170c40cccdef16a8c1a9c92ef3-tdFa3C_fw658.jpg\" alt=\"\"></p>\n<blockquote>\n<p>Spring Cloudeureka-clientEurekaDiscoveryClientgetServices</p>\n</blockquote>\n<h1 id=\"LoadBalancerClient\"><a href=\"#LoadBalancerClient\" class=\"headerlink\" title=\"LoadBalancerClient\"></a>LoadBalancerClient</h1><p>Spring Cloud CommonsDiscoveryClientLoadBalancerClientSpring Cloud</p>\n<p>LoadBalancerClientSpring Cloud</p>\n<p>eureka-servereureka-client</p>\n<p>eureka-consumerpom.xmlparentdependencyManagement</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>\n<p>application.propertieseureka</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.application.name=eureka-consumer</span><br><span class=\"line\">server.port=2101</span><br><span class=\"line\">eureka.client.serviceUrl.defaultZone=http://localhost:1001/eureka/</span><br></pre></td></tr></table></figure>\n<p>RestTemplateREST@EnableDiscoveryClient</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableDiscoveryClient</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\">    @Bean</span><br><span class=\"line\">    public RestTemplate restTemplate() &#123;</span><br><span class=\"line\">        return new RestTemplate();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>eureka-client</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RestController</span><br><span class=\"line\">public class DcController &#123;</span><br><span class=\"line\">    @Autowired</span><br><span class=\"line\">    LoadBalancerClient loadBalancerClient;</span><br><span class=\"line\">    @Autowired</span><br><span class=\"line\">    RestTemplate restTemplate;</span><br><span class=\"line\">    @GetMapping(&quot;/consumer&quot;)</span><br><span class=\"line\">    public String dc() &#123;</span><br><span class=\"line\">        ServiceInstance serviceInstance = loadBalancerClient.choose(&quot;eureka-client&quot;);</span><br><span class=\"line\">        String url = &quot;http://&quot; + serviceInstance.getHost() + &quot;:&quot; + serviceInstance.getPort() + &quot;/dc&quot;;</span><br><span class=\"line\">        System.out.println(url);</span><br><span class=\"line\">        return restTemplate.getForObject(url, String.class);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>LoadBalancerClientRestTemplate/consumerloadBalancerClientchooseeureka-clientServiceInstance/dcRestTemplate</p>\n<p>eureka-servereureka-clienteureka-consumer<a href=\"http://localhost:2101/consumer\" target=\"_blank\" rel=\"noopener\">http://localhost:2101/consumer</a> eureka-consumereureka-client/dc</p>\n<blockquote>\n<p><a href=\"http://blog.didispace.com/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n</blockquote>\n"},{"title":"3.Spring CloudRibbonDalston","date":"2018-01-08T08:56:06.000Z","top":1,"_content":"\n![](http://www.wailian.work/images/2018/04/11/c823eb1967ed6f4573223516337156c2323dc33f1ce08-d4m6uZ_fw658.jpg)\n\n> Spring CloudLoadBalancerClientSpring CloudSpring Cloud Ribbon\n\n# \n\neureka-servereureka-clientSpring Cloud Ribboneureka-consumer\n\n- eureka-consumereureka-consumer-ribbonpom.xml\n\n```\n<dependencies>\n    ...\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-starter-ribbon</artifactId>\n    </dependency>\n</dependencies>\n```\n\n- RestTemplate@LoadBalanced\n\n```\n@EnableDiscoveryClient\n@SpringBootApplication\npublic class Application {\n    @Bean\n    @LoadBalanced\n    public RestTemplate restTemplate() {\n        return new RestTemplate();\n    }\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(Application.class).web(true).run(args);\n    }\n}\n```\n\n- ControllerLoadBalancerClientURLRestTemplate\n\n```\n@RestController\npublic class DcController {\n    @Autowired\n    RestTemplate restTemplate;\n    @GetMapping(\"/consumer\")\n    public String dc() {\n        return restTemplate.getForObject(\"http://eureka-client/dc\", String.class);\n    }\n}\n```\n\nLoadBalancerClientRestTemplateurlhostIPSpring Cloud RibbonIP\n\neureka-servereureka-clienteureka-consumer-ribbonhttp://localhost:2101/consumer eureka-consumer-ribboneureka-client/dceureka-client\n\n> [DD-](http://blog.didispace.com/)\n","source":"_posts/spring-cloud3.md","raw":"---\ntitle: 3.Spring CloudRibbonDalston\ndate: 2018-01-08 16:56:06\ntop: 1\ncategories: \n---\n\n![](http://www.wailian.work/images/2018/04/11/c823eb1967ed6f4573223516337156c2323dc33f1ce08-d4m6uZ_fw658.jpg)\n\n> Spring CloudLoadBalancerClientSpring CloudSpring Cloud Ribbon\n\n# \n\neureka-servereureka-clientSpring Cloud Ribboneureka-consumer\n\n- eureka-consumereureka-consumer-ribbonpom.xml\n\n```\n<dependencies>\n    ...\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-starter-ribbon</artifactId>\n    </dependency>\n</dependencies>\n```\n\n- RestTemplate@LoadBalanced\n\n```\n@EnableDiscoveryClient\n@SpringBootApplication\npublic class Application {\n    @Bean\n    @LoadBalanced\n    public RestTemplate restTemplate() {\n        return new RestTemplate();\n    }\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(Application.class).web(true).run(args);\n    }\n}\n```\n\n- ControllerLoadBalancerClientURLRestTemplate\n\n```\n@RestController\npublic class DcController {\n    @Autowired\n    RestTemplate restTemplate;\n    @GetMapping(\"/consumer\")\n    public String dc() {\n        return restTemplate.getForObject(\"http://eureka-client/dc\", String.class);\n    }\n}\n```\n\nLoadBalancerClientRestTemplateurlhostIPSpring Cloud RibbonIP\n\neureka-servereureka-clienteureka-consumer-ribbonhttp://localhost:2101/consumer eureka-consumer-ribboneureka-client/dceureka-client\n\n> [DD-](http://blog.didispace.com/)\n","slug":"spring-cloud3","published":1,"updated":"2019-12-24T02:00:57.460Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jx9001a0j9khwlhnghl","content":"<p><img src=\"http://www.wailian.work/images/2018/04/11/c823eb1967ed6f4573223516337156c2323dc33f1ce08-d4m6uZ_fw658.jpg\" alt=\"\"></p>\n<blockquote>\n<p>Spring CloudLoadBalancerClientSpring CloudSpring Cloud Ribbon</p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>eureka-servereureka-clientSpring Cloud Ribboneureka-consumer</p>\n<ul>\n<li>eureka-consumereureka-consumer-ribbonpom.xml</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-starter-ribbon&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>RestTemplate@LoadBalanced</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableDiscoveryClient</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\">    @Bean</span><br><span class=\"line\">    @LoadBalanced</span><br><span class=\"line\">    public RestTemplate restTemplate() &#123;</span><br><span class=\"line\">        return new RestTemplate();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>ControllerLoadBalancerClientURLRestTemplate</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RestController</span><br><span class=\"line\">public class DcController &#123;</span><br><span class=\"line\">    @Autowired</span><br><span class=\"line\">    RestTemplate restTemplate;</span><br><span class=\"line\">    @GetMapping(&quot;/consumer&quot;)</span><br><span class=\"line\">    public String dc() &#123;</span><br><span class=\"line\">        return restTemplate.getForObject(&quot;http://eureka-client/dc&quot;, String.class);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>LoadBalancerClientRestTemplateurlhostIPSpring Cloud RibbonIP</p>\n<p>eureka-servereureka-clienteureka-consumer-ribbon<a href=\"http://localhost:2101/consumer\" target=\"_blank\" rel=\"noopener\">http://localhost:2101/consumer</a> eureka-consumer-ribboneureka-client/dceureka-client</p>\n<blockquote>\n<p><a href=\"http://blog.didispace.com/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/04/11/c823eb1967ed6f4573223516337156c2323dc33f1ce08-d4m6uZ_fw658.jpg\" alt=\"\"></p>\n<blockquote>\n<p>Spring CloudLoadBalancerClientSpring CloudSpring Cloud Ribbon</p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>eureka-servereureka-clientSpring Cloud Ribboneureka-consumer</p>\n<ul>\n<li>eureka-consumereureka-consumer-ribbonpom.xml</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-starter-ribbon&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>RestTemplate@LoadBalanced</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableDiscoveryClient</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\">    @Bean</span><br><span class=\"line\">    @LoadBalanced</span><br><span class=\"line\">    public RestTemplate restTemplate() &#123;</span><br><span class=\"line\">        return new RestTemplate();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>ControllerLoadBalancerClientURLRestTemplate</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RestController</span><br><span class=\"line\">public class DcController &#123;</span><br><span class=\"line\">    @Autowired</span><br><span class=\"line\">    RestTemplate restTemplate;</span><br><span class=\"line\">    @GetMapping(&quot;/consumer&quot;)</span><br><span class=\"line\">    public String dc() &#123;</span><br><span class=\"line\">        return restTemplate.getForObject(&quot;http://eureka-client/dc&quot;, String.class);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>LoadBalancerClientRestTemplateurlhostIPSpring Cloud RibbonIP</p>\n<p>eureka-servereureka-clienteureka-consumer-ribbon<a href=\"http://localhost:2101/consumer\" target=\"_blank\" rel=\"noopener\">http://localhost:2101/consumer</a> eureka-consumer-ribboneureka-client/dceureka-client</p>\n<blockquote>\n<p><a href=\"http://blog.didispace.com/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n</blockquote>\n"},{"title":"Spring Boot","date":"2017-12-01T00:49:43.000Z","_content":"![](http://s1.wailian.download/2018/01/18/30861ad3a953b85edb424fe6dcf4e3198bdeaf28884b8-7xLVBN_fw658.jpg)\nSpring Boot\n\n\nSpring Boot\n\n\nSpring Boot `application-{profile}.properties``{profile}`\n\n```\napplication-dev.properties \napplication-test.properties \napplication-prod.properties\n```\n\n`application.properties``spring.profiles.active``{profile}`\n\n`spring.profiles.active=test``application-test.properties`\n\n\n\n`application-dev.properties``application-test.properties``application-prod.properties`\n\n: \n```java -jar xxx.jar --spring.profiles.active=prod````(prod)`\n\n**`application.properties``spring.profiles.active=dev`**\n**`application-{profile}.properties`**\n****\n\n[DD-](http://blog.didispace.com/springbootproperties/)\n","source":"_posts/spring-boot-active.md","raw":"---\ntitle: Spring Boot\ndate: 2017-12-01 08:49:43\ntags:\n---\n![](http://s1.wailian.download/2018/01/18/30861ad3a953b85edb424fe6dcf4e3198bdeaf28884b8-7xLVBN_fw658.jpg)\nSpring Boot\n\n\nSpring Boot\n\n\nSpring Boot `application-{profile}.properties``{profile}`\n\n```\napplication-dev.properties \napplication-test.properties \napplication-prod.properties\n```\n\n`application.properties``spring.profiles.active``{profile}`\n\n`spring.profiles.active=test``application-test.properties`\n\n\n\n`application-dev.properties``application-test.properties``application-prod.properties`\n\n: \n```java -jar xxx.jar --spring.profiles.active=prod````(prod)`\n\n**`application.properties``spring.profiles.active=dev`**\n**`application-{profile}.properties`**\n****\n\n[DD-](http://blog.didispace.com/springbootproperties/)\n","slug":"spring-boot-active","published":1,"updated":"2019-12-24T02:00:57.460Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jxa001b0j9ktnbz3zkx","content":"<p><img src=\"http://s1.wailian.download/2018/01/18/30861ad3a953b85edb424fe6dcf4e3198bdeaf28884b8-7xLVBN_fw658.jpg\" alt=\"\"><br>Spring Boot</p>\n<p>Spring Boot</p>\n<p>Spring Boot <code>application-{profile}.properties</code><code>{profile}</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">application-dev.properties </span><br><span class=\"line\">application-test.properties </span><br><span class=\"line\">application-prod.properties</span><br></pre></td></tr></table></figure>\n<p><code>application.properties</code><code>spring.profiles.active</code><code>{profile}</code></p>\n<p><code>spring.profiles.active=test</code><code>application-test.properties</code></p>\n<p></p>\n<p><code>application-dev.properties</code><code>application-test.properties</code><code>application-prod.properties</code></p>\n<p>:<br><code>java -jar xxx.jar --spring.profiles.active=prod</code><code>(prod)</code></p>\n<p><strong><code>application.properties</code><code>spring.profiles.active=dev</code></strong><br><strong><code>application-{profile}.properties</code></strong><br><strong></strong></p>\n<p><a href=\"http://blog.didispace.com/springbootproperties/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://s1.wailian.download/2018/01/18/30861ad3a953b85edb424fe6dcf4e3198bdeaf28884b8-7xLVBN_fw658.jpg\" alt=\"\"><br>Spring Boot</p>\n<p>Spring Boot</p>\n<p>Spring Boot <code>application-{profile}.properties</code><code>{profile}</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">application-dev.properties </span><br><span class=\"line\">application-test.properties </span><br><span class=\"line\">application-prod.properties</span><br></pre></td></tr></table></figure>\n<p><code>application.properties</code><code>spring.profiles.active</code><code>{profile}</code></p>\n<p><code>spring.profiles.active=test</code><code>application-test.properties</code></p>\n<p></p>\n<p><code>application-dev.properties</code><code>application-test.properties</code><code>application-prod.properties</code></p>\n<p>:<br><code>java -jar xxx.jar --spring.profiles.active=prod</code><code>(prod)</code></p>\n<p><strong><code>application.properties</code><code>spring.profiles.active=dev</code></strong><br><strong><code>application-{profile}.properties</code></strong><br><strong></strong></p>\n<p><a href=\"http://blog.didispace.com/springbootproperties/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n"},{"title":"4.Spring CloudFeignDalston","date":"2018-01-08T09:02:08.000Z","top":1,"_content":"\n![](http://www.wailian.work/images/2018/04/11/82e28073c162d7fdb959807c8037c57b201707ba130dfa-J5nIN0_fw658.jpg)\n\n> Spring CloudSpring CloudRibbonSpring CloudSpring CloudSpring Cloud Feign\n\n# Spring Cloud Feign\n\nSpring Cloud FeignNetflix FeignWebWebFeignJAX-RSSpring Cloud FeignSpring MVCRibbonEurekaHTTP\n\nFeigneureka-client\n\n# \n\neureka-servereureka-clientSpring Cloud Ribboneureka-consumer\n\n- eureka-consumereureka-consumer-feignpom.xml\n\n```\n<dependencies>\n    ...\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-starter-feign</artifactId>\n    </dependency>\n</dependencies>\n```\n\n- @EnableFeignClientsSpring Cloud Feign\n\n```\n@EnableFeignClients\n@EnableDiscoveryClient\n@SpringBootApplication\npublic class Application {\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(Application.class).web(true).run(args);\n    }\n}\n```\n\n- Feign@FeignClientSpring MVCRESTeureka-client/dc\n\n```\n@FeignClient(\"eureka-client\")\npublic interface DcClient {\n    @GetMapping(\"/dc\")\n    String consumer();\n}\n```\n\n- Controllerfeign\n\n```\n@RestController\npublic class DcController {\n    @Autowired\n    DcClient dcClient;\n    @GetMapping(\"/consumer\")\n    public String dc() {\n        return dcClient.consumer();\n    }\n}\n```\n\nSpring Cloud Feign@FeignClientFeignRibbonRibbonIRuleFeignHystrixDalstonFeignHystrixHystrixFeignHystrix\n\neureka-servereureka-clienteureka-consumer-feignhttp://localhost:2101/consumer eureka-consumer-feigneureka-client/dceureka-client\n\n> [DD-](http://blog.didispace.com/)\n","source":"_posts/spring-cloud4.md","raw":"---\ntitle: 4.Spring CloudFeignDalston\ndate: 2018-01-08 17:02:08\ntop: 1\ncategories: \n---\n\n![](http://www.wailian.work/images/2018/04/11/82e28073c162d7fdb959807c8037c57b201707ba130dfa-J5nIN0_fw658.jpg)\n\n> Spring CloudSpring CloudRibbonSpring CloudSpring CloudSpring Cloud Feign\n\n# Spring Cloud Feign\n\nSpring Cloud FeignNetflix FeignWebWebFeignJAX-RSSpring Cloud FeignSpring MVCRibbonEurekaHTTP\n\nFeigneureka-client\n\n# \n\neureka-servereureka-clientSpring Cloud Ribboneureka-consumer\n\n- eureka-consumereureka-consumer-feignpom.xml\n\n```\n<dependencies>\n    ...\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-starter-feign</artifactId>\n    </dependency>\n</dependencies>\n```\n\n- @EnableFeignClientsSpring Cloud Feign\n\n```\n@EnableFeignClients\n@EnableDiscoveryClient\n@SpringBootApplication\npublic class Application {\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(Application.class).web(true).run(args);\n    }\n}\n```\n\n- Feign@FeignClientSpring MVCRESTeureka-client/dc\n\n```\n@FeignClient(\"eureka-client\")\npublic interface DcClient {\n    @GetMapping(\"/dc\")\n    String consumer();\n}\n```\n\n- Controllerfeign\n\n```\n@RestController\npublic class DcController {\n    @Autowired\n    DcClient dcClient;\n    @GetMapping(\"/consumer\")\n    public String dc() {\n        return dcClient.consumer();\n    }\n}\n```\n\nSpring Cloud Feign@FeignClientFeignRibbonRibbonIRuleFeignHystrixDalstonFeignHystrixHystrixFeignHystrix\n\neureka-servereureka-clienteureka-consumer-feignhttp://localhost:2101/consumer eureka-consumer-feigneureka-client/dceureka-client\n\n> [DD-](http://blog.didispace.com/)\n","slug":"spring-cloud4","published":1,"updated":"2019-12-24T02:00:57.460Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jxd001d0j9k48viaaln","content":"<p><img src=\"http://www.wailian.work/images/2018/04/11/82e28073c162d7fdb959807c8037c57b201707ba130dfa-J5nIN0_fw658.jpg\" alt=\"\"></p>\n<blockquote>\n<p>Spring CloudSpring CloudRibbonSpring CloudSpring CloudSpring Cloud Feign</p>\n</blockquote>\n<h1 id=\"Spring-Cloud-Feign\"><a href=\"#Spring-Cloud-Feign\" class=\"headerlink\" title=\"Spring Cloud Feign\"></a>Spring Cloud Feign</h1><p>Spring Cloud FeignNetflix FeignWebWebFeignJAX-RSSpring Cloud FeignSpring MVCRibbonEurekaHTTP</p>\n<p>Feigneureka-client</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>eureka-servereureka-clientSpring Cloud Ribboneureka-consumer</p>\n<ul>\n<li>eureka-consumereureka-consumer-feignpom.xml</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-starter-feign&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>@EnableFeignClientsSpring Cloud Feign</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableFeignClients</span><br><span class=\"line\">@EnableDiscoveryClient</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Feign@FeignClientSpring MVCRESTeureka-client/dc</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@FeignClient(&quot;eureka-client&quot;)</span><br><span class=\"line\">public interface DcClient &#123;</span><br><span class=\"line\">    @GetMapping(&quot;/dc&quot;)</span><br><span class=\"line\">    String consumer();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Controllerfeign</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RestController</span><br><span class=\"line\">public class DcController &#123;</span><br><span class=\"line\">    @Autowired</span><br><span class=\"line\">    DcClient dcClient;</span><br><span class=\"line\">    @GetMapping(&quot;/consumer&quot;)</span><br><span class=\"line\">    public String dc() &#123;</span><br><span class=\"line\">        return dcClient.consumer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Spring Cloud Feign@FeignClientFeignRibbonRibbonIRuleFeignHystrixDalstonFeignHystrixHystrixFeignHystrix</p>\n<p>eureka-servereureka-clienteureka-consumer-feign<a href=\"http://localhost:2101/consumer\" target=\"_blank\" rel=\"noopener\">http://localhost:2101/consumer</a> eureka-consumer-feigneureka-client/dceureka-client</p>\n<blockquote>\n<p><a href=\"http://blog.didispace.com/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/04/11/82e28073c162d7fdb959807c8037c57b201707ba130dfa-J5nIN0_fw658.jpg\" alt=\"\"></p>\n<blockquote>\n<p>Spring CloudSpring CloudRibbonSpring CloudSpring CloudSpring Cloud Feign</p>\n</blockquote>\n<h1 id=\"Spring-Cloud-Feign\"><a href=\"#Spring-Cloud-Feign\" class=\"headerlink\" title=\"Spring Cloud Feign\"></a>Spring Cloud Feign</h1><p>Spring Cloud FeignNetflix FeignWebWebFeignJAX-RSSpring Cloud FeignSpring MVCRibbonEurekaHTTP</p>\n<p>Feigneureka-client</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>eureka-servereureka-clientSpring Cloud Ribboneureka-consumer</p>\n<ul>\n<li>eureka-consumereureka-consumer-feignpom.xml</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-starter-feign&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>@EnableFeignClientsSpring Cloud Feign</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableFeignClients</span><br><span class=\"line\">@EnableDiscoveryClient</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Feign@FeignClientSpring MVCRESTeureka-client/dc</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@FeignClient(&quot;eureka-client&quot;)</span><br><span class=\"line\">public interface DcClient &#123;</span><br><span class=\"line\">    @GetMapping(&quot;/dc&quot;)</span><br><span class=\"line\">    String consumer();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Controllerfeign</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RestController</span><br><span class=\"line\">public class DcController &#123;</span><br><span class=\"line\">    @Autowired</span><br><span class=\"line\">    DcClient dcClient;</span><br><span class=\"line\">    @GetMapping(&quot;/consumer&quot;)</span><br><span class=\"line\">    public String dc() &#123;</span><br><span class=\"line\">        return dcClient.consumer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Spring Cloud Feign@FeignClientFeignRibbonRibbonIRuleFeignHystrixDalstonFeignHystrixHystrixFeignHystrix</p>\n<p>eureka-servereureka-clienteureka-consumer-feign<a href=\"http://localhost:2101/consumer\" target=\"_blank\" rel=\"noopener\">http://localhost:2101/consumer</a> eureka-consumer-feigneureka-client/dceureka-client</p>\n<blockquote>\n<p><a href=\"http://blog.didispace.com/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n</blockquote>\n"},{"title":"5.Spring CloudDalston","date":"2018-01-09T01:28:55.000Z","top":1,"_content":"\n![](http://www.wailian.work/images/2018/04/11/3c33ce7eff9b6b50e038fa70e85b0e6a2b30d4c84a688-Rrw85Z_fw658.jpg)\n\nSpring Cloud ConfigSpring Cloud/Spring Cloud ConfigSpringSpring Cloud ConfigGitSpring Cloud ConfigGitSVN\n\nGit\n\n# \n\n- gitGithub\nhttp://git.oschina.net/didispace/config-repo-demo\n\n- config-clientgitconfig-client.yml\n\n```\ninfo:\n  profile: default\n```\n\n- gitdevconfig-client-dev.yml\n\n```\ninfo:\n  profile: dev\n```\n\n# \n\n- Spring Bootconfig-server-gitpom.xmlparentdependencyManagement\n\n```\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-config-server</artifactId>\n    </dependency>\n</dependencies>\n```\n\n- Spring Boot@EnableConfigServerSpring Cloud Config\n\n```\n@EnableConfigServer\n@SpringBootApplication\npublic class Application {\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(Application.class).web(true).run(args);\n    }\n}\n```\n\n- application.ymlGit\n\n```\nspring\n  application:\n    name: config-server\n  cloud:\n    config:\n      server:\n        git:\n          uri: http://git.oschina.net/didispace/config-repo-demo/\nserver:\n  port: 1201\n```\n\nSpring Cloud ConfigGit\n\n> Git\nspring.cloud.config.server.git.usernameGit\nspring.cloud.config.server.git.passwordGit\n\nPOSTMANCURLURL\n\n- /{application}/{profile}[/{label}]\n- /{application}-{profile}.yml\n- /{label}/{application}-{profile}.yml\n- /{application}-{profile}.properties\n- /{label}/{application}-{profile}.properties\n\nurl{application}-{profile}.properties{label}Gitmasterurlmasterconfig-clientdevurlhttp://localhost:1201/config-client/dev/master\n\n```\n{\n    \"name\": \"config-client\",\n    \"profiles\": [\n        \"dev\"\n    ],\n    \"label\": \"master\",\n    \"version\": null,\n    \"state\": null,\n    \"propertySources\": [\n        {\n            \"name\": \"http://git.oschina.net/didispace/config-repo-demo/config-client-dev.yml\",\n            \"source\": {\n                \"info.profile\": \"dev\"\n            }\n        },\n        {\n            \"name\": \"http://git.oschina.net/didispace/config-repo-demo/config-client.yml\",\n            \"source\": {\n                \"info.profile\": \"default\"\n            }\n        }\n    ]\n}\n```\n\nJsonconfig-clientdevmasterdefaultdev\n\n# \n\n\n\n- Spring Bootconfig-clientpom.xml\n\n```\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-starter-config</artifactId>\n    </dependency>\n</dependencies>\n```\n\n- Spring Boot\n\n```\n@SpringBootApplication\npublic class Application {\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(Application.class).web(true).run(args);\n    }\n}\n```\n\n- bootstrap.ymlconfig-server-git\n\n```\nspring:\n  application:\n    name: config-client\n  cloud:\n    config:\n      uri: http://localhost:1201/\n      profile: default\n      label: master\nserver:\n  port: 2001\n```\n\nGit\n- spring.application.name{application}\n- spring.cloud.config.profile{profile}\n- spring.cloud.config.label{label}\n- spring.cloud.config.uriconfig-server\n\n* bootstrap.propertiesconfig-server *\n\nconfig-server-gitconfig-clienthttp://localhost:2001/info git\n\n```\n{\n    \"profile\": \"default\"\n}\n```\nconfig-clientprofiledev\n\n# \n\ngit git Config Server(config-client)/refresh\n\n`@RefreshScope``/refresh`\n\ngit/refresh gitrefresh gitgithookpushJenkinsgithook/refresh\n","source":"_posts/spring-cloud5.md","raw":"---\ntitle: 5.Spring CloudDalston\ndate: 2018-01-09 09:28:55\ntop: 1\ncategories: \n---\n\n![](http://www.wailian.work/images/2018/04/11/3c33ce7eff9b6b50e038fa70e85b0e6a2b30d4c84a688-Rrw85Z_fw658.jpg)\n\nSpring Cloud ConfigSpring Cloud/Spring Cloud ConfigSpringSpring Cloud ConfigGitSpring Cloud ConfigGitSVN\n\nGit\n\n# \n\n- gitGithub\nhttp://git.oschina.net/didispace/config-repo-demo\n\n- config-clientgitconfig-client.yml\n\n```\ninfo:\n  profile: default\n```\n\n- gitdevconfig-client-dev.yml\n\n```\ninfo:\n  profile: dev\n```\n\n# \n\n- Spring Bootconfig-server-gitpom.xmlparentdependencyManagement\n\n```\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-config-server</artifactId>\n    </dependency>\n</dependencies>\n```\n\n- Spring Boot@EnableConfigServerSpring Cloud Config\n\n```\n@EnableConfigServer\n@SpringBootApplication\npublic class Application {\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(Application.class).web(true).run(args);\n    }\n}\n```\n\n- application.ymlGit\n\n```\nspring\n  application:\n    name: config-server\n  cloud:\n    config:\n      server:\n        git:\n          uri: http://git.oschina.net/didispace/config-repo-demo/\nserver:\n  port: 1201\n```\n\nSpring Cloud ConfigGit\n\n> Git\nspring.cloud.config.server.git.usernameGit\nspring.cloud.config.server.git.passwordGit\n\nPOSTMANCURLURL\n\n- /{application}/{profile}[/{label}]\n- /{application}-{profile}.yml\n- /{label}/{application}-{profile}.yml\n- /{application}-{profile}.properties\n- /{label}/{application}-{profile}.properties\n\nurl{application}-{profile}.properties{label}Gitmasterurlmasterconfig-clientdevurlhttp://localhost:1201/config-client/dev/master\n\n```\n{\n    \"name\": \"config-client\",\n    \"profiles\": [\n        \"dev\"\n    ],\n    \"label\": \"master\",\n    \"version\": null,\n    \"state\": null,\n    \"propertySources\": [\n        {\n            \"name\": \"http://git.oschina.net/didispace/config-repo-demo/config-client-dev.yml\",\n            \"source\": {\n                \"info.profile\": \"dev\"\n            }\n        },\n        {\n            \"name\": \"http://git.oschina.net/didispace/config-repo-demo/config-client.yml\",\n            \"source\": {\n                \"info.profile\": \"default\"\n            }\n        }\n    ]\n}\n```\n\nJsonconfig-clientdevmasterdefaultdev\n\n# \n\n\n\n- Spring Bootconfig-clientpom.xml\n\n```\n<dependencies>\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-starter-config</artifactId>\n    </dependency>\n</dependencies>\n```\n\n- Spring Boot\n\n```\n@SpringBootApplication\npublic class Application {\n    public static void main(String[] args) {\n        new SpringApplicationBuilder(Application.class).web(true).run(args);\n    }\n}\n```\n\n- bootstrap.ymlconfig-server-git\n\n```\nspring:\n  application:\n    name: config-client\n  cloud:\n    config:\n      uri: http://localhost:1201/\n      profile: default\n      label: master\nserver:\n  port: 2001\n```\n\nGit\n- spring.application.name{application}\n- spring.cloud.config.profile{profile}\n- spring.cloud.config.label{label}\n- spring.cloud.config.uriconfig-server\n\n* bootstrap.propertiesconfig-server *\n\nconfig-server-gitconfig-clienthttp://localhost:2001/info git\n\n```\n{\n    \"profile\": \"default\"\n}\n```\nconfig-clientprofiledev\n\n# \n\ngit git Config Server(config-client)/refresh\n\n`@RefreshScope``/refresh`\n\ngit/refresh gitrefresh gitgithookpushJenkinsgithook/refresh\n","slug":"spring-cloud5","published":1,"updated":"2019-12-24T02:00:57.460Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jxe001e0j9kljzzs8gk","content":"<p><img src=\"http://www.wailian.work/images/2018/04/11/3c33ce7eff9b6b50e038fa70e85b0e6a2b30d4c84a688-Rrw85Z_fw658.jpg\" alt=\"\"></p>\n<p>Spring Cloud ConfigSpring Cloud/Spring Cloud ConfigSpringSpring Cloud ConfigGitSpring Cloud ConfigGitSVN</p>\n<p>Git</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><p>gitGithub<br><a href=\"http://git.oschina.net/didispace/config-repo-demo\" target=\"_blank\" rel=\"noopener\">http://git.oschina.net/didispace/config-repo-demo</a></p>\n</li>\n<li><p>config-clientgitconfig-client.yml</p>\n</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">info:</span><br><span class=\"line\">  profile: default</span><br></pre></td></tr></table></figure>\n<ul>\n<li>gitdevconfig-client-dev.yml</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">info:</span><br><span class=\"line\">  profile: dev</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>Spring Bootconfig-server-gitpom.xmlparentdependencyManagement</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Spring Boot@EnableConfigServerSpring Cloud Config</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableConfigServer</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>application.ymlGit</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring</span><br><span class=\"line\">  application:</span><br><span class=\"line\">    name: config-server</span><br><span class=\"line\">  cloud:</span><br><span class=\"line\">    config:</span><br><span class=\"line\">      server:</span><br><span class=\"line\">        git:</span><br><span class=\"line\">          uri: http://git.oschina.net/didispace/config-repo-demo/</span><br><span class=\"line\">server:</span><br><span class=\"line\">  port: 1201</span><br></pre></td></tr></table></figure>\n<p>Spring Cloud ConfigGit</p>\n<blockquote>\n<p>Git<br>spring.cloud.config.server.git.usernameGit<br>spring.cloud.config.server.git.passwordGit</p>\n</blockquote>\n<p>POSTMANCURLURL</p>\n<ul>\n<li>/{application}/{profile}[/{label}]</li>\n<li>/{application}-{profile}.yml</li>\n<li>/{label}/{application}-{profile}.yml</li>\n<li>/{application}-{profile}.properties</li>\n<li>/{label}/{application}-{profile}.properties</li>\n</ul>\n<p>url{application}-{profile}.properties{label}Gitmasterurlmasterconfig-clientdevurl<a href=\"http://localhost:1201/config-client/dev/master\" target=\"_blank\" rel=\"noopener\">http://localhost:1201/config-client/dev/master</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;name&quot;: &quot;config-client&quot;,</span><br><span class=\"line\">    &quot;profiles&quot;: [</span><br><span class=\"line\">        &quot;dev&quot;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &quot;label&quot;: &quot;master&quot;,</span><br><span class=\"line\">    &quot;version&quot;: null,</span><br><span class=\"line\">    &quot;state&quot;: null,</span><br><span class=\"line\">    &quot;propertySources&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            &quot;name&quot;: &quot;http://git.oschina.net/didispace/config-repo-demo/config-client-dev.yml&quot;,</span><br><span class=\"line\">            &quot;source&quot;: &#123;</span><br><span class=\"line\">                &quot;info.profile&quot;: &quot;dev&quot;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            &quot;name&quot;: &quot;http://git.oschina.net/didispace/config-repo-demo/config-client.yml&quot;,</span><br><span class=\"line\">            &quot;source&quot;: &#123;</span><br><span class=\"line\">                &quot;info.profile&quot;: &quot;default&quot;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Jsonconfig-clientdevmasterdefaultdev</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li>Spring Bootconfig-clientpom.xml</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Spring Boot</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>bootstrap.ymlconfig-server-git</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring:</span><br><span class=\"line\">  application:</span><br><span class=\"line\">    name: config-client</span><br><span class=\"line\">  cloud:</span><br><span class=\"line\">    config:</span><br><span class=\"line\">      uri: http://localhost:1201/</span><br><span class=\"line\">      profile: default</span><br><span class=\"line\">      label: master</span><br><span class=\"line\">server:</span><br><span class=\"line\">  port: 2001</span><br></pre></td></tr></table></figure>\n<p>Git</p>\n<ul>\n<li>spring.application.name{application}</li>\n<li>spring.cloud.config.profile{profile}</li>\n<li>spring.cloud.config.label{label}</li>\n<li>spring.cloud.config.uriconfig-server</li>\n</ul>\n<ul>\n<li>bootstrap.propertiesconfig-server *</li>\n</ul>\n<p>config-server-gitconfig-client<a href=\"http://localhost:2001/info\" target=\"_blank\" rel=\"noopener\">http://localhost:2001/info</a> git</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;profile&quot;: &quot;default&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>config-clientprofiledev</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>git git Config Server(config-client)/refresh</p>\n<p><code>@RefreshScope</code><code>/refresh</code></p>\n<p>git/refresh gitrefresh gitgithookpushJenkinsgithook/refresh</p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/04/11/3c33ce7eff9b6b50e038fa70e85b0e6a2b30d4c84a688-Rrw85Z_fw658.jpg\" alt=\"\"></p>\n<p>Spring Cloud ConfigSpring Cloud/Spring Cloud ConfigSpringSpring Cloud ConfigGitSpring Cloud ConfigGitSVN</p>\n<p>Git</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><p>gitGithub<br><a href=\"http://git.oschina.net/didispace/config-repo-demo\" target=\"_blank\" rel=\"noopener\">http://git.oschina.net/didispace/config-repo-demo</a></p>\n</li>\n<li><p>config-clientgitconfig-client.yml</p>\n</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">info:</span><br><span class=\"line\">  profile: default</span><br></pre></td></tr></table></figure>\n<ul>\n<li>gitdevconfig-client-dev.yml</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">info:</span><br><span class=\"line\">  profile: dev</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>Spring Bootconfig-server-gitpom.xmlparentdependencyManagement</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Spring Boot@EnableConfigServerSpring Cloud Config</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableConfigServer</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>application.ymlGit</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring</span><br><span class=\"line\">  application:</span><br><span class=\"line\">    name: config-server</span><br><span class=\"line\">  cloud:</span><br><span class=\"line\">    config:</span><br><span class=\"line\">      server:</span><br><span class=\"line\">        git:</span><br><span class=\"line\">          uri: http://git.oschina.net/didispace/config-repo-demo/</span><br><span class=\"line\">server:</span><br><span class=\"line\">  port: 1201</span><br></pre></td></tr></table></figure>\n<p>Spring Cloud ConfigGit</p>\n<blockquote>\n<p>Git<br>spring.cloud.config.server.git.usernameGit<br>spring.cloud.config.server.git.passwordGit</p>\n</blockquote>\n<p>POSTMANCURLURL</p>\n<ul>\n<li>/{application}/{profile}[/{label}]</li>\n<li>/{application}-{profile}.yml</li>\n<li>/{label}/{application}-{profile}.yml</li>\n<li>/{application}-{profile}.properties</li>\n<li>/{label}/{application}-{profile}.properties</li>\n</ul>\n<p>url{application}-{profile}.properties{label}Gitmasterurlmasterconfig-clientdevurl<a href=\"http://localhost:1201/config-client/dev/master\" target=\"_blank\" rel=\"noopener\">http://localhost:1201/config-client/dev/master</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;name&quot;: &quot;config-client&quot;,</span><br><span class=\"line\">    &quot;profiles&quot;: [</span><br><span class=\"line\">        &quot;dev&quot;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &quot;label&quot;: &quot;master&quot;,</span><br><span class=\"line\">    &quot;version&quot;: null,</span><br><span class=\"line\">    &quot;state&quot;: null,</span><br><span class=\"line\">    &quot;propertySources&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            &quot;name&quot;: &quot;http://git.oschina.net/didispace/config-repo-demo/config-client-dev.yml&quot;,</span><br><span class=\"line\">            &quot;source&quot;: &#123;</span><br><span class=\"line\">                &quot;info.profile&quot;: &quot;dev&quot;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            &quot;name&quot;: &quot;http://git.oschina.net/didispace/config-repo-demo/config-client.yml&quot;,</span><br><span class=\"line\">            &quot;source&quot;: &#123;</span><br><span class=\"line\">                &quot;info.profile&quot;: &quot;default&quot;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Jsonconfig-clientdevmasterdefaultdev</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li>Spring Bootconfig-clientpom.xml</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Spring Boot</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>bootstrap.ymlconfig-server-git</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring:</span><br><span class=\"line\">  application:</span><br><span class=\"line\">    name: config-client</span><br><span class=\"line\">  cloud:</span><br><span class=\"line\">    config:</span><br><span class=\"line\">      uri: http://localhost:1201/</span><br><span class=\"line\">      profile: default</span><br><span class=\"line\">      label: master</span><br><span class=\"line\">server:</span><br><span class=\"line\">  port: 2001</span><br></pre></td></tr></table></figure>\n<p>Git</p>\n<ul>\n<li>spring.application.name{application}</li>\n<li>spring.cloud.config.profile{profile}</li>\n<li>spring.cloud.config.label{label}</li>\n<li>spring.cloud.config.uriconfig-server</li>\n</ul>\n<ul>\n<li>bootstrap.propertiesconfig-server *</li>\n</ul>\n<p>config-server-gitconfig-client<a href=\"http://localhost:2001/info\" target=\"_blank\" rel=\"noopener\">http://localhost:2001/info</a> git</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;profile&quot;: &quot;default&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>config-clientprofiledev</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>git git Config Server(config-client)/refresh</p>\n<p><code>@RefreshScope</code><code>/refresh</code></p>\n<p>git/refresh gitrefresh gitgithookpushJenkinsgithook/refresh</p>\n"},{"title":"6.Spring CloudHystrixDalston","date":"2018-01-10T02:23:15.000Z","top":1,"_content":"# \n\n\n\nSpring Cloud HystrixNetflix HystrixHystrix\n\nSpring Cloud Hystrix\n\n# \n\nSpring Cloud Hystrix\n\n- eureka-server1001\n- eureka-client2001\n\n`eureka-consumer-ribbon``eureka-consumer-ribbon-hystrix`\n\n`pom.xml`dependencies`spring-cloud-starter-hystrix`\n\n```\n<dependency>\n\t<groupId>org.springframework.cloud</groupId>\n\t<artifactId>spring-cloud-starter-hystrix</artifactId>\n</dependency>\n```\n\n`@EnableCircuitBreaker``@EnableHystrix`Hystrix\n\n```\n@EnableCircuitBreaker\n@EnableDiscoveryClient\n@SpringBootApplication\npublic class Application {\n\n\t@Bean\n\t@LoadBalanced\n\tpublic RestTemplate restTemplate() {\n\t\treturn new RestTemplate();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew SpringApplicationBuilder(Application.class).web(true).run(args);\n\t}\n\n}\n```\n\n*Spring Cloud`@SpringCloudApplication`Spring Cloud*\n\n```\n@Target({ElementType.TYPE})\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Inherited\n@SpringBootApplication\n@EnableDiscoveryClient\n@EnableCircuitBreaker\npublic @interface SpringCloudApplication {\n}\n```\n\n`ConsumerService`,`Controller``@HystrixCommand`\n\n```\n@RestController\npublic class DcController {\n\n    @Autowired\n    ConsumerService consumerService;\n\n    @GetMapping(\"/consumer\")\n    public String dc() {\n        return consumerService.consumer();\n    }\n\n    class ConsumerService {\n\n        @Autowired\n        RestTemplate restTemplate;\n\n        @HystrixCommand(fallbackMethod = \"fallback\")\n        public String consumer() {\n            return restTemplate.getForObject(\"http://eureka-client/dc\", String.class);\n        }\n\n        public String fallback() {\n            return \"fallback\";\n        }\n\n    }\n\n}\n```\n\nHystrix`localhost:2101/consumer``Services: [eureka-consumer-ribbon-hystrix, eureka-client]`\n\n`eureka-client`\n\n```\n@GetMapping(\"/dc\")\npublic String dc() throws InterruptedException {\n    Thread.sleep(5000L);\n    String services = \"Services: \" + discoveryClient.getServices();\n    System.out.println(services);\n    return services;\n}\n```\n\n`eureka-client``localhost:2101/consumer`,`fallback``eureka-client`5HystrixCommand`fallback`\n\n\n\n- eurekaeureka-server\n- eurekaeureka-client\n- eurekaeureka-consumer-ribbon-hystrix\n","source":"_posts/spring-cloud6.md","raw":"---\ntitle: 6.Spring CloudHystrixDalston\ndate: 2018-01-10 10:23:15\ntop: 1\ncategories: \n---\n# \n\n\n\nSpring Cloud HystrixNetflix HystrixHystrix\n\nSpring Cloud Hystrix\n\n# \n\nSpring Cloud Hystrix\n\n- eureka-server1001\n- eureka-client2001\n\n`eureka-consumer-ribbon``eureka-consumer-ribbon-hystrix`\n\n`pom.xml`dependencies`spring-cloud-starter-hystrix`\n\n```\n<dependency>\n\t<groupId>org.springframework.cloud</groupId>\n\t<artifactId>spring-cloud-starter-hystrix</artifactId>\n</dependency>\n```\n\n`@EnableCircuitBreaker``@EnableHystrix`Hystrix\n\n```\n@EnableCircuitBreaker\n@EnableDiscoveryClient\n@SpringBootApplication\npublic class Application {\n\n\t@Bean\n\t@LoadBalanced\n\tpublic RestTemplate restTemplate() {\n\t\treturn new RestTemplate();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew SpringApplicationBuilder(Application.class).web(true).run(args);\n\t}\n\n}\n```\n\n*Spring Cloud`@SpringCloudApplication`Spring Cloud*\n\n```\n@Target({ElementType.TYPE})\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Inherited\n@SpringBootApplication\n@EnableDiscoveryClient\n@EnableCircuitBreaker\npublic @interface SpringCloudApplication {\n}\n```\n\n`ConsumerService`,`Controller``@HystrixCommand`\n\n```\n@RestController\npublic class DcController {\n\n    @Autowired\n    ConsumerService consumerService;\n\n    @GetMapping(\"/consumer\")\n    public String dc() {\n        return consumerService.consumer();\n    }\n\n    class ConsumerService {\n\n        @Autowired\n        RestTemplate restTemplate;\n\n        @HystrixCommand(fallbackMethod = \"fallback\")\n        public String consumer() {\n            return restTemplate.getForObject(\"http://eureka-client/dc\", String.class);\n        }\n\n        public String fallback() {\n            return \"fallback\";\n        }\n\n    }\n\n}\n```\n\nHystrix`localhost:2101/consumer``Services: [eureka-consumer-ribbon-hystrix, eureka-client]`\n\n`eureka-client`\n\n```\n@GetMapping(\"/dc\")\npublic String dc() throws InterruptedException {\n    Thread.sleep(5000L);\n    String services = \"Services: \" + discoveryClient.getServices();\n    System.out.println(services);\n    return services;\n}\n```\n\n`eureka-client``localhost:2101/consumer`,`fallback``eureka-client`5HystrixCommand`fallback`\n\n\n\n- eurekaeureka-server\n- eurekaeureka-client\n- eurekaeureka-consumer-ribbon-hystrix\n","slug":"spring-cloud6","published":1,"updated":"2019-12-24T02:00:57.470Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jxf001h0j9k55ebuvqd","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>Spring Cloud HystrixNetflix HystrixHystrix</p>\n<p>Spring Cloud Hystrix</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring Cloud Hystrix</p>\n<ul>\n<li>eureka-server1001</li>\n<li>eureka-client2001</li>\n</ul>\n<p><code>eureka-consumer-ribbon</code><code>eureka-consumer-ribbon-hystrix</code></p>\n<p><code>pom.xml</code>dependencies<code>spring-cloud-starter-hystrix</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">\t&lt;artifactId&gt;spring-cloud-starter-hystrix&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n<p><code>@EnableCircuitBreaker</code><code>@EnableHystrix</code>Hystrix</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableCircuitBreaker</span><br><span class=\"line\">@EnableDiscoveryClient</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@Bean</span><br><span class=\"line\">\t@LoadBalanced</span><br><span class=\"line\">\tpublic RestTemplate restTemplate() &#123;</span><br><span class=\"line\">\t\treturn new RestTemplate();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic static void main(String[] args) &#123;</span><br><span class=\"line\">\t\tnew SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em>Spring Cloud<code>@SpringCloudApplication</code>Spring Cloud</em></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Target(&#123;ElementType.TYPE&#125;)</span><br><span class=\"line\">@Retention(RetentionPolicy.RUNTIME)</span><br><span class=\"line\">@Documented</span><br><span class=\"line\">@Inherited</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">@EnableDiscoveryClient</span><br><span class=\"line\">@EnableCircuitBreaker</span><br><span class=\"line\">public @interface SpringCloudApplication &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>ConsumerService</code>,<code>Controller</code><code>@HystrixCommand</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RestController</span><br><span class=\"line\">public class DcController &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Autowired</span><br><span class=\"line\">    ConsumerService consumerService;</span><br><span class=\"line\"></span><br><span class=\"line\">    @GetMapping(&quot;/consumer&quot;)</span><br><span class=\"line\">    public String dc() &#123;</span><br><span class=\"line\">        return consumerService.consumer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    class ConsumerService &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Autowired</span><br><span class=\"line\">        RestTemplate restTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">        @HystrixCommand(fallbackMethod = &quot;fallback&quot;)</span><br><span class=\"line\">        public String consumer() &#123;</span><br><span class=\"line\">            return restTemplate.getForObject(&quot;http://eureka-client/dc&quot;, String.class);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        public String fallback() &#123;</span><br><span class=\"line\">            return &quot;fallback&quot;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Hystrix<code>localhost:2101/consumer</code><code>Services: [eureka-consumer-ribbon-hystrix, eureka-client]</code></p>\n<p><code>eureka-client</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@GetMapping(&quot;/dc&quot;)</span><br><span class=\"line\">public String dc() throws InterruptedException &#123;</span><br><span class=\"line\">    Thread.sleep(5000L);</span><br><span class=\"line\">    String services = &quot;Services: &quot; + discoveryClient.getServices();</span><br><span class=\"line\">    System.out.println(services);</span><br><span class=\"line\">    return services;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>eureka-client</code><code>localhost:2101/consumer</code>,<code>fallback</code><code>eureka-client</code>5HystrixCommand<code>fallback</code></p>\n<p></p>\n<ul>\n<li>eurekaeureka-server</li>\n<li>eurekaeureka-client</li>\n<li>eurekaeureka-consumer-ribbon-hystrix</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>Spring Cloud HystrixNetflix HystrixHystrix</p>\n<p>Spring Cloud Hystrix</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring Cloud Hystrix</p>\n<ul>\n<li>eureka-server1001</li>\n<li>eureka-client2001</li>\n</ul>\n<p><code>eureka-consumer-ribbon</code><code>eureka-consumer-ribbon-hystrix</code></p>\n<p><code>pom.xml</code>dependencies<code>spring-cloud-starter-hystrix</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">\t&lt;artifactId&gt;spring-cloud-starter-hystrix&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n<p><code>@EnableCircuitBreaker</code><code>@EnableHystrix</code>Hystrix</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableCircuitBreaker</span><br><span class=\"line\">@EnableDiscoveryClient</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@Bean</span><br><span class=\"line\">\t@LoadBalanced</span><br><span class=\"line\">\tpublic RestTemplate restTemplate() &#123;</span><br><span class=\"line\">\t\treturn new RestTemplate();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic static void main(String[] args) &#123;</span><br><span class=\"line\">\t\tnew SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><em>Spring Cloud<code>@SpringCloudApplication</code>Spring Cloud</em></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Target(&#123;ElementType.TYPE&#125;)</span><br><span class=\"line\">@Retention(RetentionPolicy.RUNTIME)</span><br><span class=\"line\">@Documented</span><br><span class=\"line\">@Inherited</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">@EnableDiscoveryClient</span><br><span class=\"line\">@EnableCircuitBreaker</span><br><span class=\"line\">public @interface SpringCloudApplication &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>ConsumerService</code>,<code>Controller</code><code>@HystrixCommand</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@RestController</span><br><span class=\"line\">public class DcController &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Autowired</span><br><span class=\"line\">    ConsumerService consumerService;</span><br><span class=\"line\"></span><br><span class=\"line\">    @GetMapping(&quot;/consumer&quot;)</span><br><span class=\"line\">    public String dc() &#123;</span><br><span class=\"line\">        return consumerService.consumer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    class ConsumerService &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Autowired</span><br><span class=\"line\">        RestTemplate restTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">        @HystrixCommand(fallbackMethod = &quot;fallback&quot;)</span><br><span class=\"line\">        public String consumer() &#123;</span><br><span class=\"line\">            return restTemplate.getForObject(&quot;http://eureka-client/dc&quot;, String.class);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        public String fallback() &#123;</span><br><span class=\"line\">            return &quot;fallback&quot;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Hystrix<code>localhost:2101/consumer</code><code>Services: [eureka-consumer-ribbon-hystrix, eureka-client]</code></p>\n<p><code>eureka-client</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@GetMapping(&quot;/dc&quot;)</span><br><span class=\"line\">public String dc() throws InterruptedException &#123;</span><br><span class=\"line\">    Thread.sleep(5000L);</span><br><span class=\"line\">    String services = &quot;Services: &quot; + discoveryClient.getServices();</span><br><span class=\"line\">    System.out.println(services);</span><br><span class=\"line\">    return services;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>eureka-client</code><code>localhost:2101/consumer</code>,<code>fallback</code><code>eureka-client</code>5HystrixCommand<code>fallback</code></p>\n<p></p>\n<ul>\n<li>eurekaeureka-server</li>\n<li>eurekaeureka-client</li>\n<li>eurekaeureka-consumer-ribbon-hystrix</li>\n</ul>\n"},{"title":"7.Spring CloudHystrixDalston","date":"2018-04-11T01:16:17.000Z","_content":"\n> hystrixHystrixCommandHystrixObservableCommandHystrixHystrix Dashboard\n\nHystrix DashboardHystrix\n\n- eureka-server\n- eureka-client\n- eureka-consumer-ribbon-hystrixribbonhystrix\n\neureka-consumer-ribbon-hystrix/consumer@HystrixCommandHystrixHystrix DashboardHystrix Dashboard\n\n# \n\nSpring CloudHystrix Dashboard\n\n- Spring Boothystrix-dashboard\n- pom.xml\n\n```\n<parent>\n\t<groupId>org.springframework.cloud</groupId>\n\t<artifactId>spring-cloud-starter-parent</artifactId>\n\t<version>Dalston.SR1</version>\n\t<relativePath />\n</parent>\n<dependencies>\n\t<dependency>\n\t\t<groupId>org.springframework.cloud</groupId>\n\t\t<artifactId>spring-cloud-starter-hystrix</artifactId>\n\t</dependency>\n\t<dependency>\n\t\t<groupId>org.springframework.cloud</groupId>\n\t\t<artifactId>spring-cloud-starter-hystrix-dashboard</artifactId>\n\t</dependency>\n\t<dependency>\n\t\t<groupId>org.springframework.boot</groupId>\n\t\t<artifactId>spring-boot-starter-actuator</artifactId>\n\t</dependency>\n</dependencies>\n```\n\n- `@EnableHystrixDashboard`Hystrix Dashboard\n\n```\n@EnableHystrixDashboard\n@SpringCloudApplication\npublic class HystrixDashboardApplication {\n\tpublic static void main(String[] args) {\n\t\tSpringApplication.run(HystrixDashboardApplication.class, args);\n\t}\n}\n```\n\n- `application.properties`\n\n```\nspring.application.name=hystrix-dashboard\nserver.port=1301\n```\n\n`http://localhost:1301/hystrix`\n\n![hystrix](http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-1.png)\n\nHystrix DashboardHystrix Dashboard\n\n- URL`http://turbine-hostname:port/turbine.stream`\n- URL`http://turbine-hostname:port/turbine.stream?cluster=[clusterName]`clusterName\n- URLhttp://hystrix-app:port/hystrix.stream\n\nTurbine\n\nHystrix Dashboard`/hystrix.stream`\n\n- `pom.xml``dependencies``spring-boot-starter-actuator``spring-cloud-starter-hystrix`:\n\n```\n<dependency>\n\t<groupId>org.springframework.cloud</groupId>\n\t<artifactId>spring-cloud-starter-hystrix</artifactId>\n</dependency>\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-actuator</artifactId>\n</dependency>\n```\n\n- `@EnableCircuitBreaker``@EnableHystrix`\n\nHystrix Dashboard`http://localhost:2101/hystrix.stream`,eureka-consumer-ribbon-hystrixMonitor Stream\n\n![pirc](http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-2.png)\n\n\n\n\n- `Delay`:2000CPU\n- `Title`:Hystrix StreamURL\n\n\n\n- \n\n![](http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-3.png)\n\n- 2,\n\n![](http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-4.png)\n\n> [DD-](http://blog.didispace.com/)\n","source":"_posts/spring-cloud7.md","raw":"---\ntitle: 7.Spring CloudHystrixDalston\ndate: 2018-04-11 09:16:17\ntags:\ncategories: \n---\n\n> hystrixHystrixCommandHystrixObservableCommandHystrixHystrix Dashboard\n\nHystrix DashboardHystrix\n\n- eureka-server\n- eureka-client\n- eureka-consumer-ribbon-hystrixribbonhystrix\n\neureka-consumer-ribbon-hystrix/consumer@HystrixCommandHystrixHystrix DashboardHystrix Dashboard\n\n# \n\nSpring CloudHystrix Dashboard\n\n- Spring Boothystrix-dashboard\n- pom.xml\n\n```\n<parent>\n\t<groupId>org.springframework.cloud</groupId>\n\t<artifactId>spring-cloud-starter-parent</artifactId>\n\t<version>Dalston.SR1</version>\n\t<relativePath />\n</parent>\n<dependencies>\n\t<dependency>\n\t\t<groupId>org.springframework.cloud</groupId>\n\t\t<artifactId>spring-cloud-starter-hystrix</artifactId>\n\t</dependency>\n\t<dependency>\n\t\t<groupId>org.springframework.cloud</groupId>\n\t\t<artifactId>spring-cloud-starter-hystrix-dashboard</artifactId>\n\t</dependency>\n\t<dependency>\n\t\t<groupId>org.springframework.boot</groupId>\n\t\t<artifactId>spring-boot-starter-actuator</artifactId>\n\t</dependency>\n</dependencies>\n```\n\n- `@EnableHystrixDashboard`Hystrix Dashboard\n\n```\n@EnableHystrixDashboard\n@SpringCloudApplication\npublic class HystrixDashboardApplication {\n\tpublic static void main(String[] args) {\n\t\tSpringApplication.run(HystrixDashboardApplication.class, args);\n\t}\n}\n```\n\n- `application.properties`\n\n```\nspring.application.name=hystrix-dashboard\nserver.port=1301\n```\n\n`http://localhost:1301/hystrix`\n\n![hystrix](http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-1.png)\n\nHystrix DashboardHystrix Dashboard\n\n- URL`http://turbine-hostname:port/turbine.stream`\n- URL`http://turbine-hostname:port/turbine.stream?cluster=[clusterName]`clusterName\n- URLhttp://hystrix-app:port/hystrix.stream\n\nTurbine\n\nHystrix Dashboard`/hystrix.stream`\n\n- `pom.xml``dependencies``spring-boot-starter-actuator``spring-cloud-starter-hystrix`:\n\n```\n<dependency>\n\t<groupId>org.springframework.cloud</groupId>\n\t<artifactId>spring-cloud-starter-hystrix</artifactId>\n</dependency>\n<dependency>\n\t<groupId>org.springframework.boot</groupId>\n\t<artifactId>spring-boot-starter-actuator</artifactId>\n</dependency>\n```\n\n- `@EnableCircuitBreaker``@EnableHystrix`\n\nHystrix Dashboard`http://localhost:2101/hystrix.stream`,eureka-consumer-ribbon-hystrixMonitor Stream\n\n![pirc](http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-2.png)\n\n\n\n\n- `Delay`:2000CPU\n- `Title`:Hystrix StreamURL\n\n\n\n- \n\n![](http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-3.png)\n\n- 2,\n\n![](http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-4.png)\n\n> [DD-](http://blog.didispace.com/)\n","slug":"spring-cloud7","published":1,"updated":"2019-12-24T02:00:57.470Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jxh001j0j9kx3hqse6m","content":"<blockquote>\n<p>hystrixHystrixCommandHystrixObservableCommandHystrixHystrix Dashboard</p>\n</blockquote>\n<p>Hystrix DashboardHystrix</p>\n<ul>\n<li>eureka-server</li>\n<li>eureka-client</li>\n<li>eureka-consumer-ribbon-hystrixribbonhystrix</li>\n</ul>\n<p>eureka-consumer-ribbon-hystrix/consumer@HystrixCommandHystrixHystrix DashboardHystrix Dashboard</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring CloudHystrix Dashboard</p>\n<ul>\n<li>Spring Boothystrix-dashboard</li>\n<li>pom.xml</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;parent&gt;</span><br><span class=\"line\">\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">\t&lt;artifactId&gt;spring-cloud-starter-parent&lt;/artifactId&gt;</span><br><span class=\"line\">\t&lt;version&gt;Dalston.SR1&lt;/version&gt;</span><br><span class=\"line\">\t&lt;relativePath /&gt;</span><br><span class=\"line\">&lt;/parent&gt;</span><br><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">\t&lt;dependency&gt;</span><br><span class=\"line\">\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">\t\t&lt;artifactId&gt;spring-cloud-starter-hystrix&lt;/artifactId&gt;</span><br><span class=\"line\">\t&lt;/dependency&gt;</span><br><span class=\"line\">\t&lt;dependency&gt;</span><br><span class=\"line\">\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">\t\t&lt;artifactId&gt;spring-cloud-starter-hystrix-dashboard&lt;/artifactId&gt;</span><br><span class=\"line\">\t&lt;/dependency&gt;</span><br><span class=\"line\">\t&lt;dependency&gt;</span><br><span class=\"line\">\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">\t\t&lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;</span><br><span class=\"line\">\t&lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>@EnableHystrixDashboard</code>Hystrix Dashboard</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableHystrixDashboard</span><br><span class=\"line\">@SpringCloudApplication</span><br><span class=\"line\">public class HystrixDashboardApplication &#123;</span><br><span class=\"line\">\tpublic static void main(String[] args) &#123;</span><br><span class=\"line\">\t\tSpringApplication.run(HystrixDashboardApplication.class, args);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>application.properties</code></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.application.name=hystrix-dashboard</span><br><span class=\"line\">server.port=1301</span><br></pre></td></tr></table></figure>\n<p><code>http://localhost:1301/hystrix</code></p>\n<p><img src=\"http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-1.png\" alt=\"hystrix\"></p>\n<p>Hystrix DashboardHystrix Dashboard</p>\n<ul>\n<li>URL<code>http://turbine-hostname:port/turbine.stream</code></li>\n<li>URL<code>http://turbine-hostname:port/turbine.stream?cluster=[clusterName]</code>clusterName</li>\n<li>URL<a href=\"http://hystrix-app:port/hystrix.stream\" target=\"_blank\" rel=\"noopener\">http://hystrix-app:port/hystrix.stream</a></li>\n</ul>\n<p>Turbine</p>\n<p>Hystrix Dashboard<code>/hystrix.stream</code></p>\n<ul>\n<li><code>pom.xml</code><code>dependencies</code><code>spring-boot-starter-actuator</code><code>spring-cloud-starter-hystrix</code>:</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">\t&lt;artifactId&gt;spring-cloud-starter-hystrix&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">\t&lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>@EnableCircuitBreaker</code><code>@EnableHystrix</code></li>\n</ul>\n<p>Hystrix Dashboard<code>http://localhost:2101/hystrix.stream</code>,eureka-consumer-ribbon-hystrixMonitor Stream</p>\n<p><img src=\"http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-2.png\" alt=\"pirc\"></p>\n<p></p>\n<ul>\n<li><code>Delay</code>:2000CPU</li>\n<li><code>Title</code>:Hystrix StreamURL</li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n</ul>\n<p><img src=\"http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-3.png\" alt=\"\"></p>\n<ul>\n<li>2,</li>\n</ul>\n<p><img src=\"http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-4.png\" alt=\"\"></p>\n<blockquote>\n<p><a href=\"http://blog.didispace.com/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>hystrixHystrixCommandHystrixObservableCommandHystrixHystrix Dashboard</p>\n</blockquote>\n<p>Hystrix DashboardHystrix</p>\n<ul>\n<li>eureka-server</li>\n<li>eureka-client</li>\n<li>eureka-consumer-ribbon-hystrixribbonhystrix</li>\n</ul>\n<p>eureka-consumer-ribbon-hystrix/consumer@HystrixCommandHystrixHystrix DashboardHystrix Dashboard</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring CloudHystrix Dashboard</p>\n<ul>\n<li>Spring Boothystrix-dashboard</li>\n<li>pom.xml</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;parent&gt;</span><br><span class=\"line\">\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">\t&lt;artifactId&gt;spring-cloud-starter-parent&lt;/artifactId&gt;</span><br><span class=\"line\">\t&lt;version&gt;Dalston.SR1&lt;/version&gt;</span><br><span class=\"line\">\t&lt;relativePath /&gt;</span><br><span class=\"line\">&lt;/parent&gt;</span><br><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">\t&lt;dependency&gt;</span><br><span class=\"line\">\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">\t\t&lt;artifactId&gt;spring-cloud-starter-hystrix&lt;/artifactId&gt;</span><br><span class=\"line\">\t&lt;/dependency&gt;</span><br><span class=\"line\">\t&lt;dependency&gt;</span><br><span class=\"line\">\t\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">\t\t&lt;artifactId&gt;spring-cloud-starter-hystrix-dashboard&lt;/artifactId&gt;</span><br><span class=\"line\">\t&lt;/dependency&gt;</span><br><span class=\"line\">\t&lt;dependency&gt;</span><br><span class=\"line\">\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">\t\t&lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;</span><br><span class=\"line\">\t&lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>@EnableHystrixDashboard</code>Hystrix Dashboard</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableHystrixDashboard</span><br><span class=\"line\">@SpringCloudApplication</span><br><span class=\"line\">public class HystrixDashboardApplication &#123;</span><br><span class=\"line\">\tpublic static void main(String[] args) &#123;</span><br><span class=\"line\">\t\tSpringApplication.run(HystrixDashboardApplication.class, args);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>application.properties</code></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.application.name=hystrix-dashboard</span><br><span class=\"line\">server.port=1301</span><br></pre></td></tr></table></figure>\n<p><code>http://localhost:1301/hystrix</code></p>\n<p><img src=\"http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-1.png\" alt=\"hystrix\"></p>\n<p>Hystrix DashboardHystrix Dashboard</p>\n<ul>\n<li>URL<code>http://turbine-hostname:port/turbine.stream</code></li>\n<li>URL<code>http://turbine-hostname:port/turbine.stream?cluster=[clusterName]</code>clusterName</li>\n<li>URL<a href=\"http://hystrix-app:port/hystrix.stream\" target=\"_blank\" rel=\"noopener\">http://hystrix-app:port/hystrix.stream</a></li>\n</ul>\n<p>Turbine</p>\n<p>Hystrix Dashboard<code>/hystrix.stream</code></p>\n<ul>\n<li><code>pom.xml</code><code>dependencies</code><code>spring-boot-starter-actuator</code><code>spring-cloud-starter-hystrix</code>:</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">\t&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">\t&lt;artifactId&gt;spring-cloud-starter-hystrix&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">\t&lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>@EnableCircuitBreaker</code><code>@EnableHystrix</code></li>\n</ul>\n<p>Hystrix Dashboard<code>http://localhost:2101/hystrix.stream</code>,eureka-consumer-ribbon-hystrixMonitor Stream</p>\n<p><img src=\"http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-2.png\" alt=\"pirc\"></p>\n<p></p>\n<ul>\n<li><code>Delay</code>:2000CPU</li>\n<li><code>Title</code>:Hystrix StreamURL</li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n</ul>\n<p><img src=\"http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-3.png\" alt=\"\"></p>\n<ul>\n<li>2,</li>\n</ul>\n<p><img src=\"http://www.wailian.work/images/2018/04/11/spring-cloud-starter-dalston-5-1-4.png\" alt=\"\"></p>\n<blockquote>\n<p><a href=\"http://blog.didispace.com/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n</blockquote>\n"},{"title":"8.Spring CloudDalston","date":"2018-04-11T06:11:45.000Z","_content":"\nSpring Cloud\n\n![](http://www.wailian.work/images/2018/04/11/-----.png)\n\nSpring Cloud NetflixEurekaRibbonFeignSpring Cloud ConfigHystrix\n\nService AService BEureka ServerOpen Service\n\n\n\n- REST API\n\n- \n\n\n\n\n\nREST APISpring Cloud NetflixZuul\n\nZuul\n\n# \n\n- eureka-client\n- eureka-consumer\n\n# \n\nSpring Cloud Zuul\n\n- Spring Boot`api-gateway``pom.xml`\n\n```\n<parent>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-parent</artifactId>\n  <version>1.5.4.RELEASE</version>\n  <relativePath/>\n</parent>\n\n<dependencies>\n  <dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-zuul</artifactId>\n  </dependency>\n  <dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-eureka</artifactId>\n  </dependency>\n</dependencies>\n\n<dependencyManagement>\n  <dependencies>\n    <dependency>\n      <groupId>org.springframework.cloud</groupId>\n      <artifactId>spring-cloud-dependencies</artifactId>\n      <version>Dalston.SR1</version>\n      <type>pom</type>\n      <scope>import</scope>\n    </dependency>\n  </dependencies>\n</dependencyManagement>\n```\n\n- `@EnableZuulProxy`Zuul\n\n```\n@EnableZuulProxy\n@SpringCloudApplication\npublic class Application {\n\n  public static void main(String[] args) {\n    new SpringApplicationBuilder(Application.class).web(true).run(args);\n  }\n\n}\n```\n\n- `application.yaml`eureka\n\n```\nspring:\n  application:\n    name: api-gateway\n\nserver:\n  port: 1101\n\neureka:\n  client:\n    serviceUrl:\n      defaultZone: http://eureka.didispace.com/eureka/\n```\n\nSpring Cloud ZuulSpring Cloud ZuulEureka`api-gateway`eureka`eureka-client``eureka-consumer`ZuulIDZuul\n\n- `eureka-client``/eureka-client/**`\n- `eureka-consumer``/eureka-consumer/**`\n\n`1101`\n\n- `http://localhost:1101/eureka-client/dc ``eureka-client``/dc`\n\n# \n\n\n\n> [DD-](http://blog.didispace.com/)\n","source":"_posts/spring-cloud8.md","raw":"---\ntitle: 8.Spring CloudDalston \ndate: 2018-04-11 14:11:45\ntags:\ncategories: \n---\n\nSpring Cloud\n\n![](http://www.wailian.work/images/2018/04/11/-----.png)\n\nSpring Cloud NetflixEurekaRibbonFeignSpring Cloud ConfigHystrix\n\nService AService BEureka ServerOpen Service\n\n\n\n- REST API\n\n- \n\n\n\n\n\nREST APISpring Cloud NetflixZuul\n\nZuul\n\n# \n\n- eureka-client\n- eureka-consumer\n\n# \n\nSpring Cloud Zuul\n\n- Spring Boot`api-gateway``pom.xml`\n\n```\n<parent>\n  <groupId>org.springframework.boot</groupId>\n  <artifactId>spring-boot-starter-parent</artifactId>\n  <version>1.5.4.RELEASE</version>\n  <relativePath/>\n</parent>\n\n<dependencies>\n  <dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-zuul</artifactId>\n  </dependency>\n  <dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-eureka</artifactId>\n  </dependency>\n</dependencies>\n\n<dependencyManagement>\n  <dependencies>\n    <dependency>\n      <groupId>org.springframework.cloud</groupId>\n      <artifactId>spring-cloud-dependencies</artifactId>\n      <version>Dalston.SR1</version>\n      <type>pom</type>\n      <scope>import</scope>\n    </dependency>\n  </dependencies>\n</dependencyManagement>\n```\n\n- `@EnableZuulProxy`Zuul\n\n```\n@EnableZuulProxy\n@SpringCloudApplication\npublic class Application {\n\n  public static void main(String[] args) {\n    new SpringApplicationBuilder(Application.class).web(true).run(args);\n  }\n\n}\n```\n\n- `application.yaml`eureka\n\n```\nspring:\n  application:\n    name: api-gateway\n\nserver:\n  port: 1101\n\neureka:\n  client:\n    serviceUrl:\n      defaultZone: http://eureka.didispace.com/eureka/\n```\n\nSpring Cloud ZuulSpring Cloud ZuulEureka`api-gateway`eureka`eureka-client``eureka-consumer`ZuulIDZuul\n\n- `eureka-client``/eureka-client/**`\n- `eureka-consumer``/eureka-consumer/**`\n\n`1101`\n\n- `http://localhost:1101/eureka-client/dc ``eureka-client``/dc`\n\n# \n\n\n\n> [DD-](http://blog.didispace.com/)\n","slug":"spring-cloud8","published":1,"updated":"2019-12-24T02:00:57.470Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jxi001l0j9kht4vk5xw","content":"<p>Spring Cloud</p>\n<p><img src=\"http://www.wailian.work/images/2018/04/11/-----.png\" alt=\"\"></p>\n<p>Spring Cloud NetflixEurekaRibbonFeignSpring Cloud ConfigHystrix</p>\n<p>Service AService BEureka ServerOpen Service</p>\n<p></p>\n<ul>\n<li><p>REST API</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<p></p>\n<p></p>\n<p>REST APISpring Cloud NetflixZuul</p>\n<p>Zuul</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>eureka-client</li>\n<li>eureka-consumer</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring Cloud Zuul</p>\n<ul>\n<li>Spring Boot<code>api-gateway</code><code>pom.xml</code></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;parent&gt;</span><br><span class=\"line\">  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">  &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class=\"line\">  &lt;version&gt;1.5.4.RELEASE&lt;/version&gt;</span><br><span class=\"line\">  &lt;relativePath/&gt;</span><br><span class=\"line\">&lt;/parent&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">  &lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-cloud-starter-zuul&lt;/artifactId&gt;</span><br><span class=\"line\">  &lt;/dependency&gt;</span><br><span class=\"line\">  &lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;</span><br><span class=\"line\">  &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependencyManagement&gt;</span><br><span class=\"line\">  &lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">      &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">      &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;</span><br><span class=\"line\">      &lt;version&gt;Dalston.SR1&lt;/version&gt;</span><br><span class=\"line\">      &lt;type&gt;pom&lt;/type&gt;</span><br><span class=\"line\">      &lt;scope&gt;import&lt;/scope&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">  &lt;/dependencies&gt;</span><br><span class=\"line\">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>@EnableZuulProxy</code>Zuul</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableZuulProxy</span><br><span class=\"line\">@SpringCloudApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  public static void main(String[] args) &#123;</span><br><span class=\"line\">    new SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>application.yaml</code>eureka</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring:</span><br><span class=\"line\">  application:</span><br><span class=\"line\">    name: api-gateway</span><br><span class=\"line\"></span><br><span class=\"line\">server:</span><br><span class=\"line\">  port: 1101</span><br><span class=\"line\"></span><br><span class=\"line\">eureka:</span><br><span class=\"line\">  client:</span><br><span class=\"line\">    serviceUrl:</span><br><span class=\"line\">      defaultZone: http://eureka.didispace.com/eureka/</span><br></pre></td></tr></table></figure>\n<p>Spring Cloud ZuulSpring Cloud ZuulEureka<code>api-gateway</code>eureka<code>eureka-client</code><code>eureka-consumer</code>ZuulIDZuul</p>\n<ul>\n<li><code>eureka-client</code><code>/eureka-client/**</code></li>\n<li><code>eureka-consumer</code><code>/eureka-consumer/**</code></li>\n</ul>\n<p><code>1101</code></p>\n<ul>\n<li><code>http://localhost:1101/eureka-client/dc</code><code>eureka-client</code><code>/dc</code></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<blockquote>\n<p><a href=\"http://blog.didispace.com/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<p>Spring Cloud</p>\n<p><img src=\"http://www.wailian.work/images/2018/04/11/-----.png\" alt=\"\"></p>\n<p>Spring Cloud NetflixEurekaRibbonFeignSpring Cloud ConfigHystrix</p>\n<p>Service AService BEureka ServerOpen Service</p>\n<p></p>\n<ul>\n<li><p>REST API</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<p></p>\n<p></p>\n<p>REST APISpring Cloud NetflixZuul</p>\n<p>Zuul</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>eureka-client</li>\n<li>eureka-consumer</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring Cloud Zuul</p>\n<ul>\n<li>Spring Boot<code>api-gateway</code><code>pom.xml</code></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;parent&gt;</span><br><span class=\"line\">  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">  &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class=\"line\">  &lt;version&gt;1.5.4.RELEASE&lt;/version&gt;</span><br><span class=\"line\">  &lt;relativePath/&gt;</span><br><span class=\"line\">&lt;/parent&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">  &lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-cloud-starter-zuul&lt;/artifactId&gt;</span><br><span class=\"line\">  &lt;/dependency&gt;</span><br><span class=\"line\">  &lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;</span><br><span class=\"line\">  &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependencyManagement&gt;</span><br><span class=\"line\">  &lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">      &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">      &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;</span><br><span class=\"line\">      &lt;version&gt;Dalston.SR1&lt;/version&gt;</span><br><span class=\"line\">      &lt;type&gt;pom&lt;/type&gt;</span><br><span class=\"line\">      &lt;scope&gt;import&lt;/scope&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">  &lt;/dependencies&gt;</span><br><span class=\"line\">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>@EnableZuulProxy</code>Zuul</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@EnableZuulProxy</span><br><span class=\"line\">@SpringCloudApplication</span><br><span class=\"line\">public class Application &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  public static void main(String[] args) &#123;</span><br><span class=\"line\">    new SpringApplicationBuilder(Application.class).web(true).run(args);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>application.yaml</code>eureka</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring:</span><br><span class=\"line\">  application:</span><br><span class=\"line\">    name: api-gateway</span><br><span class=\"line\"></span><br><span class=\"line\">server:</span><br><span class=\"line\">  port: 1101</span><br><span class=\"line\"></span><br><span class=\"line\">eureka:</span><br><span class=\"line\">  client:</span><br><span class=\"line\">    serviceUrl:</span><br><span class=\"line\">      defaultZone: http://eureka.didispace.com/eureka/</span><br></pre></td></tr></table></figure>\n<p>Spring Cloud ZuulSpring Cloud ZuulEureka<code>api-gateway</code>eureka<code>eureka-client</code><code>eureka-consumer</code>ZuulIDZuul</p>\n<ul>\n<li><code>eureka-client</code><code>/eureka-client/**</code></li>\n<li><code>eureka-consumer</code><code>/eureka-consumer/**</code></li>\n</ul>\n<p><code>1101</code></p>\n<ul>\n<li><code>http://localhost:1101/eureka-client/dc</code><code>eureka-client</code><code>/dc</code></li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<blockquote>\n<p><a href=\"http://blog.didispace.com/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n</blockquote>\n"},{"title":"9.Spring CloudDalston","date":"2018-04-11T06:37:58.000Z","_content":"\nSpring CloudSpring Cloud ZuulAPISpring Cloud ZuulSpring Cloud Zuul\n\n# \n\nAPI\n\nEurekaConsul\n\n- `zuul.routes.<route>.path``zuul.routes.<route>.url`\n\n```\nzuul.routes.user-service.path=/user-service/**\nzuul.routes.user-service.url=http://localhost:8080/\n```\n\n`/user-service/**``http://localhost:8080/``http://localhost:1101/user-service/hello`API`/user-service/hello``path`API`http://localhost:8080/hello`\n\n- `zuul.routes.<route>.path``zuul.routes.<route>.serviceId`\n\n```\nzuul.routes.user-service.path=/user-service/**\nzuul.routes.user-service.serviceId=user-service\n\nribbon.eureka.enabled=false\nuser-service.ribbon.listOfServers=http://localhost:8080/,http://localhost:8081/\n```\n\n`/user-service/**``http://localhost:8080/``http://localhost:8081/``zuul.routes.<route>.path``zuul.routes.<route>.serviceId``serviceId``<serviceId>.ribbon.listOfServers`APISpring Cloud RibbonSpring Cloud ZuulRibbonRibbon\n\n- `ribbon.eureka.enabled`:`zuul.routes.<route>.serviceId`RibbonEurekafalse`serviceId`\n\n- `user-service.ribbon.listOfServers`:`zuul.routes.<route>.serviceId``user-service``serviceId`\n\n`<route>``<route>``path``url``serviceId`\n\n# \n\nSpring Cloud ZuulSpring Cloud Eureka`serviceId``zuul.routes.<route>.path``zuul.routes.<route>.serviceId`\n\n`/user-service/**``user-service``<route>`\n\n```\nzuul.routes.user-service.path=/user-service/**\nzuul.routes.user-service.serviceId=user-service\n```\n\n`path``serviceId``zuul.routes.<serviceId>=<path>``<serviceId>``<path>``path``serviceId`\n\n```\nzuul.routes.user-service=/user-service/**\n```\n\nAPIURL`path``url``serviceId``path``serviceId`API\n\nSpring Cloud NetflixZuulEurekaAPIEurekaEurekaEurekaAPIserviceIdAPIURL`path`API`serviceId`API`serviceId`Ribbon\n\n> [DD-](http://blog.didispace.com/)\n","source":"_posts/spring-cloud9.md","raw":"---\ntitle: 9.Spring CloudDalston\ndate: 2018-04-11 14:37:58\ntags:\ncategories: \n---\n\nSpring CloudSpring Cloud ZuulAPISpring Cloud ZuulSpring Cloud Zuul\n\n# \n\nAPI\n\nEurekaConsul\n\n- `zuul.routes.<route>.path``zuul.routes.<route>.url`\n\n```\nzuul.routes.user-service.path=/user-service/**\nzuul.routes.user-service.url=http://localhost:8080/\n```\n\n`/user-service/**``http://localhost:8080/``http://localhost:1101/user-service/hello`API`/user-service/hello``path`API`http://localhost:8080/hello`\n\n- `zuul.routes.<route>.path``zuul.routes.<route>.serviceId`\n\n```\nzuul.routes.user-service.path=/user-service/**\nzuul.routes.user-service.serviceId=user-service\n\nribbon.eureka.enabled=false\nuser-service.ribbon.listOfServers=http://localhost:8080/,http://localhost:8081/\n```\n\n`/user-service/**``http://localhost:8080/``http://localhost:8081/``zuul.routes.<route>.path``zuul.routes.<route>.serviceId``serviceId``<serviceId>.ribbon.listOfServers`APISpring Cloud RibbonSpring Cloud ZuulRibbonRibbon\n\n- `ribbon.eureka.enabled`:`zuul.routes.<route>.serviceId`RibbonEurekafalse`serviceId`\n\n- `user-service.ribbon.listOfServers`:`zuul.routes.<route>.serviceId``user-service``serviceId`\n\n`<route>``<route>``path``url``serviceId`\n\n# \n\nSpring Cloud ZuulSpring Cloud Eureka`serviceId``zuul.routes.<route>.path``zuul.routes.<route>.serviceId`\n\n`/user-service/**``user-service``<route>`\n\n```\nzuul.routes.user-service.path=/user-service/**\nzuul.routes.user-service.serviceId=user-service\n```\n\n`path``serviceId``zuul.routes.<serviceId>=<path>``<serviceId>``<path>``path``serviceId`\n\n```\nzuul.routes.user-service=/user-service/**\n```\n\nAPIURL`path``url``serviceId``path``serviceId`API\n\nSpring Cloud NetflixZuulEurekaAPIEurekaEurekaEurekaAPIserviceIdAPIURL`path`API`serviceId`API`serviceId`Ribbon\n\n> [DD-](http://blog.didispace.com/)\n","slug":"spring-cloud9","published":1,"updated":"2019-12-24T02:00:57.470Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jxj001n0j9ksxhhwnxt","content":"<p>Spring CloudSpring Cloud ZuulAPISpring Cloud ZuulSpring Cloud Zuul</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>API</p>\n<p>EurekaConsul</p>\n<ul>\n<li><code>zuul.routes.&lt;route&gt;.path</code><code>zuul.routes.&lt;route&gt;.url</code></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zuul.routes.user-service.path=/user-service/**</span><br><span class=\"line\">zuul.routes.user-service.url=http://localhost:8080/</span><br></pre></td></tr></table></figure>\n<p><code>/user-service/**</code><code>http://localhost:8080/</code><code>http://localhost:1101/user-service/hello</code>API<code>/user-service/hello</code><code>path</code>API<code>http://localhost:8080/hello</code></p>\n<ul>\n<li><code>zuul.routes.&lt;route&gt;.path</code><code>zuul.routes.&lt;route&gt;.serviceId</code></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zuul.routes.user-service.path=/user-service/**</span><br><span class=\"line\">zuul.routes.user-service.serviceId=user-service</span><br><span class=\"line\"></span><br><span class=\"line\">ribbon.eureka.enabled=false</span><br><span class=\"line\">user-service.ribbon.listOfServers=http://localhost:8080/,http://localhost:8081/</span><br></pre></td></tr></table></figure>\n<p><code>/user-service/**</code><code>http://localhost:8080/</code><code>http://localhost:8081/</code><code>zuul.routes.&lt;route&gt;.path</code><code>zuul.routes.&lt;route&gt;.serviceId</code><code>serviceId</code><code>&lt;serviceId&gt;.ribbon.listOfServers</code>APISpring Cloud RibbonSpring Cloud ZuulRibbonRibbon</p>\n<ul>\n<li><p><code>ribbon.eureka.enabled</code>:<code>zuul.routes.&lt;route&gt;.serviceId</code>RibbonEurekafalse<code>serviceId</code></p>\n</li>\n<li><p><code>user-service.ribbon.listOfServers</code>:<code>zuul.routes.&lt;route&gt;.serviceId</code><code>user-service</code><code>serviceId</code></p>\n</li>\n</ul>\n<p><code>&lt;route&gt;</code><code>&lt;route&gt;</code><code>path</code><code>url</code><code>serviceId</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring Cloud ZuulSpring Cloud Eureka<code>serviceId</code><code>zuul.routes.&lt;route&gt;.path</code><code>zuul.routes.&lt;route&gt;.serviceId</code></p>\n<p><code>/user-service/**</code><code>user-service</code><code>&lt;route&gt;</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zuul.routes.user-service.path=/user-service/**</span><br><span class=\"line\">zuul.routes.user-service.serviceId=user-service</span><br></pre></td></tr></table></figure>\n<p><code>path</code><code>serviceId</code><code>zuul.routes.&lt;serviceId&gt;=&lt;path&gt;</code><code>&lt;serviceId&gt;</code><code>&lt;path&gt;</code><code>path</code><code>serviceId</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zuul.routes.user-service=/user-service/**</span><br></pre></td></tr></table></figure>\n<p>APIURL<code>path</code><code>url</code><code>serviceId</code><code>path</code><code>serviceId</code>API</p>\n<p>Spring Cloud NetflixZuulEurekaAPIEurekaEurekaEurekaAPIserviceIdAPIURL<code>path</code>API<code>serviceId</code>API<code>serviceId</code>Ribbon</p>\n<blockquote>\n<p><a href=\"http://blog.didispace.com/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<p>Spring CloudSpring Cloud ZuulAPISpring Cloud ZuulSpring Cloud Zuul</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>API</p>\n<p>EurekaConsul</p>\n<ul>\n<li><code>zuul.routes.&lt;route&gt;.path</code><code>zuul.routes.&lt;route&gt;.url</code></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zuul.routes.user-service.path=/user-service/**</span><br><span class=\"line\">zuul.routes.user-service.url=http://localhost:8080/</span><br></pre></td></tr></table></figure>\n<p><code>/user-service/**</code><code>http://localhost:8080/</code><code>http://localhost:1101/user-service/hello</code>API<code>/user-service/hello</code><code>path</code>API<code>http://localhost:8080/hello</code></p>\n<ul>\n<li><code>zuul.routes.&lt;route&gt;.path</code><code>zuul.routes.&lt;route&gt;.serviceId</code></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zuul.routes.user-service.path=/user-service/**</span><br><span class=\"line\">zuul.routes.user-service.serviceId=user-service</span><br><span class=\"line\"></span><br><span class=\"line\">ribbon.eureka.enabled=false</span><br><span class=\"line\">user-service.ribbon.listOfServers=http://localhost:8080/,http://localhost:8081/</span><br></pre></td></tr></table></figure>\n<p><code>/user-service/**</code><code>http://localhost:8080/</code><code>http://localhost:8081/</code><code>zuul.routes.&lt;route&gt;.path</code><code>zuul.routes.&lt;route&gt;.serviceId</code><code>serviceId</code><code>&lt;serviceId&gt;.ribbon.listOfServers</code>APISpring Cloud RibbonSpring Cloud ZuulRibbonRibbon</p>\n<ul>\n<li><p><code>ribbon.eureka.enabled</code>:<code>zuul.routes.&lt;route&gt;.serviceId</code>RibbonEurekafalse<code>serviceId</code></p>\n</li>\n<li><p><code>user-service.ribbon.listOfServers</code>:<code>zuul.routes.&lt;route&gt;.serviceId</code><code>user-service</code><code>serviceId</code></p>\n</li>\n</ul>\n<p><code>&lt;route&gt;</code><code>&lt;route&gt;</code><code>path</code><code>url</code><code>serviceId</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Spring Cloud ZuulSpring Cloud Eureka<code>serviceId</code><code>zuul.routes.&lt;route&gt;.path</code><code>zuul.routes.&lt;route&gt;.serviceId</code></p>\n<p><code>/user-service/**</code><code>user-service</code><code>&lt;route&gt;</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zuul.routes.user-service.path=/user-service/**</span><br><span class=\"line\">zuul.routes.user-service.serviceId=user-service</span><br></pre></td></tr></table></figure>\n<p><code>path</code><code>serviceId</code><code>zuul.routes.&lt;serviceId&gt;=&lt;path&gt;</code><code>&lt;serviceId&gt;</code><code>&lt;path&gt;</code><code>path</code><code>serviceId</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zuul.routes.user-service=/user-service/**</span><br></pre></td></tr></table></figure>\n<p>APIURL<code>path</code><code>url</code><code>serviceId</code><code>path</code><code>serviceId</code>API</p>\n<p>Spring Cloud NetflixZuulEurekaAPIEurekaEurekaEurekaAPIserviceIdAPIURL<code>path</code>API<code>serviceId</code>API<code>serviceId</code>Ribbon</p>\n<blockquote>\n<p><a href=\"http://blog.didispace.com/\" target=\"_blank\" rel=\"noopener\">DD-</a></p>\n</blockquote>\n"},{"title":"ssh","date":"2017-12-20T01:24:21.000Z","_content":"![pic](http://s1.wailian.download/2018/01/18/714c395dedd696f341be46b38326674137170a2a1cb62-mzzZiS_fw658.jpg)\nssh\n> Write failed: Broken pipe\n\n# :\n\n`/etc/ssh/ssh_config`\n```\nServerAliveInterval 60\n```\nssh60sKeepAlive\n\n# \n\n`/etc/ssh/sshd_config`\n```\nClientAliveInterval 60\n```\n\n\n","source":"_posts/ssh-broken.md","raw":"---\ntitle: ssh\ndate: 2017-12-20 09:24:21\ntags:\n---\n![pic](http://s1.wailian.download/2018/01/18/714c395dedd696f341be46b38326674137170a2a1cb62-mzzZiS_fw658.jpg)\nssh\n> Write failed: Broken pipe\n\n# :\n\n`/etc/ssh/ssh_config`\n```\nServerAliveInterval 60\n```\nssh60sKeepAlive\n\n# \n\n`/etc/ssh/sshd_config`\n```\nClientAliveInterval 60\n```\n\n\n","slug":"ssh-broken","published":1,"updated":"2019-12-24T02:00:57.470Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jxk001p0j9kre8xfiwn","content":"<p><img src=\"http://s1.wailian.download/2018/01/18/714c395dedd696f341be46b38326674137170a2a1cb62-mzzZiS_fw658.jpg\" alt=\"pic\"><br>ssh</p>\n<blockquote>\n<p>Write failed: Broken pipe</p>\n</blockquote>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\":\"></a>:</h1><p><code>/etc/ssh/ssh_config</code><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ServerAliveInterval 60</span><br></pre></td></tr></table></figure></p>\n<p>ssh60sKeepAlive</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>/etc/ssh/sshd_config</code><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ClientAliveInterval 60</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://s1.wailian.download/2018/01/18/714c395dedd696f341be46b38326674137170a2a1cb62-mzzZiS_fw658.jpg\" alt=\"pic\"><br>ssh</p>\n<blockquote>\n<p>Write failed: Broken pipe</p>\n</blockquote>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\":\"></a>:</h1><p><code>/etc/ssh/ssh_config</code><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ServerAliveInterval 60</span><br></pre></td></tr></table></figure></p>\n<p>ssh60sKeepAlive</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code>/etc/ssh/sshd_config</code><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ClientAliveInterval 60</span><br></pre></td></tr></table></figure></p>\n<p><br></p>\n"},{"title":"ssh","date":"2017-12-18T12:45:29.000Z","_content":"![pic](http://s1.wailian.download/2018/01/18/77e75ad8e3c3226b53206731154ac0f7a0c27a97a99c5-2wKmIY_fw658.jpg)\n# \n\nAB\n\n# A\n\n## SSH KEY\n\n```\nssh-keygen -t rsa -C \"your_email@example.com\"\n```\n\n## \n\n```\ncat ~/.ssh/id_rsa.pub\n```\n\n# B\n\n## SSH KEY\n\n```\nssh-keygen -t rsa -C \"your_email@example.com\"\n```\n\n## A-B\n\nAB\n```\n~/.ssh/authorized_keys\n```\n\n# \n","source":"_posts/ssh-no-pass.md","raw":"---\ntitle: ssh\ndate: 2017-12-18 20:45:29\ntags:\n---\n![pic](http://s1.wailian.download/2018/01/18/77e75ad8e3c3226b53206731154ac0f7a0c27a97a99c5-2wKmIY_fw658.jpg)\n# \n\nAB\n\n# A\n\n## SSH KEY\n\n```\nssh-keygen -t rsa -C \"your_email@example.com\"\n```\n\n## \n\n```\ncat ~/.ssh/id_rsa.pub\n```\n\n# B\n\n## SSH KEY\n\n```\nssh-keygen -t rsa -C \"your_email@example.com\"\n```\n\n## A-B\n\nAB\n```\n~/.ssh/authorized_keys\n```\n\n# \n","slug":"ssh-no-pass","published":1,"updated":"2019-12-24T02:00:57.470Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jxl001r0j9kbnoowm1m","content":"<p><img src=\"http://s1.wailian.download/2018/01/18/77e75ad8e3c3226b53206731154ac0f7a0c27a97a99c5-2wKmIY_fw658.jpg\" alt=\"pic\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>AB</p>\n<h1 id=\"A\"><a href=\"#A\" class=\"headerlink\" title=\"A\"></a>A</h1><h2 id=\"SSH-KEY\"><a href=\"#SSH-KEY\" class=\"headerlink\" title=\"SSH KEY\"></a>SSH KEY</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &quot;your_email@example.com&quot;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>\n<h1 id=\"B\"><a href=\"#B\" class=\"headerlink\" title=\"B\"></a>B</h1><h2 id=\"SSH-KEY-1\"><a href=\"#SSH-KEY-1\" class=\"headerlink\" title=\"SSH KEY\"></a>SSH KEY</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &quot;your_email@example.com&quot;</span><br></pre></td></tr></table></figure>\n<h2 id=\"A-B\"><a href=\"#A-B\" class=\"headerlink\" title=\"A-B\"></a>A-B</h2><p>AB<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://s1.wailian.download/2018/01/18/77e75ad8e3c3226b53206731154ac0f7a0c27a97a99c5-2wKmIY_fw658.jpg\" alt=\"pic\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>AB</p>\n<h1 id=\"A\"><a href=\"#A\" class=\"headerlink\" title=\"A\"></a>A</h1><h2 id=\"SSH-KEY\"><a href=\"#SSH-KEY\" class=\"headerlink\" title=\"SSH KEY\"></a>SSH KEY</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &quot;your_email@example.com&quot;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>\n<h1 id=\"B\"><a href=\"#B\" class=\"headerlink\" title=\"B\"></a>B</h1><h2 id=\"SSH-KEY-1\"><a href=\"#SSH-KEY-1\" class=\"headerlink\" title=\"SSH KEY\"></a>SSH KEY</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &quot;your_email@example.com&quot;</span><br></pre></td></tr></table></figure>\n<h2 id=\"A-B\"><a href=\"#A-B\" class=\"headerlink\" title=\"A-B\"></a>A-B</h2><p>AB<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1>"},{"title":"CentOS7ssh,","date":"2017-11-27T02:37:06.000Z","_content":"> vps,,ssh\n\n# \n\n```\nvim /etc/ssh/sshd_config\n```\n\n**#Port 22****Port 10001**,22(,)\n\nSSH22,22,,\n\n1000110000~6553510000\n\n# SELinux\n\n## SELinux\n\n```\n    sestatus -v\n```\n\n,\n\n## SELinuxssh\n\n``` bash\n    semanage port -l|grep ssh\n```\n\n**ssh_port_t         tcp      22**\n\n## SELinux10001ssh\n\n```\n    semanage port -a -t ssh_port_t -p tcp 10001\n```\n\n\n\n```\n    semanage port -l|grep ssh\n```\n\n**ssh_port_t         tcp      2210001**\n\n# 10001\n\n## \n\n```\nvim /etc/firewalld/zones/public.xml\n```\n\n100001\n\n```\n<port protocol=\"tcp\" port=\"10001\"/>\n```\n\n# \n\n``` bash\n    systemctl restart sshd   ssh\n    systemctl restart firewalld.service    \n    shutdown -r now  \n```\n\n# \n\n``` bash\n    ssh root@localhost -p 10001\n```\n\n# 22\n\n\n","source":"_posts/ssh.md","raw":"---\ntitle: CentOS7ssh,\ndate: 2017-11-27 10:37:06\ntags:\n---\n> vps,,ssh\n\n# \n\n```\nvim /etc/ssh/sshd_config\n```\n\n**#Port 22****Port 10001**,22(,)\n\nSSH22,22,,\n\n1000110000~6553510000\n\n# SELinux\n\n## SELinux\n\n```\n    sestatus -v\n```\n\n,\n\n## SELinuxssh\n\n``` bash\n    semanage port -l|grep ssh\n```\n\n**ssh_port_t         tcp      22**\n\n## SELinux10001ssh\n\n```\n    semanage port -a -t ssh_port_t -p tcp 10001\n```\n\n\n\n```\n    semanage port -l|grep ssh\n```\n\n**ssh_port_t         tcp      2210001**\n\n# 10001\n\n## \n\n```\nvim /etc/firewalld/zones/public.xml\n```\n\n100001\n\n```\n<port protocol=\"tcp\" port=\"10001\"/>\n```\n\n# \n\n``` bash\n    systemctl restart sshd   ssh\n    systemctl restart firewalld.service    \n    shutdown -r now  \n```\n\n# \n\n``` bash\n    ssh root@localhost -p 10001\n```\n\n# 22\n\n\n","slug":"ssh","published":1,"updated":"2019-12-24T02:00:57.470Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jxn001t0j9k5x70vg0q","content":"<blockquote>\n<p>vps,,ssh</p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure>\n<p><strong>#Port 22</strong><strong>Port 10001</strong>,22(,)</p>\n<p>SSH22,22,,</p>\n<p>1000110000~6553510000</p>\n<h1 id=\"SELinux\"><a href=\"#SELinux\" class=\"headerlink\" title=\"SELinux\"></a>SELinux</h1><h2 id=\"SELinux\"><a href=\"#SELinux\" class=\"headerlink\" title=\"SELinux\"></a>SELinux</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sestatus -v</span><br></pre></td></tr></table></figure>\n<p>,</p>\n<h2 id=\"SELinuxssh\"><a href=\"#SELinuxssh\" class=\"headerlink\" title=\"SELinuxssh\"></a>SELinuxssh</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">semanage port -l|grep ssh</span><br></pre></td></tr></table></figure>\n<p><strong>ssh_port_t         tcp      22</strong></p>\n<h2 id=\"SELinux10001ssh\"><a href=\"#SELinux10001ssh\" class=\"headerlink\" title=\"SELinux10001ssh\"></a>SELinux10001ssh</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">semanage port -a -t ssh_port_t -p tcp 10001</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">semanage port -l|grep ssh</span><br></pre></td></tr></table></figure>\n<p><strong>ssh_port_t         tcp      2210001</strong></p>\n<h1 id=\"10001\"><a href=\"#10001\" class=\"headerlink\" title=\"10001\"></a>10001</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/firewalld/zones/public.xml</span><br></pre></td></tr></table></figure>\n<p>100001</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;port protocol=&quot;tcp&quot; port=&quot;10001&quot;/&gt;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart sshd   ssh</span><br><span class=\"line\">systemctl restart firewalld.service    </span><br><span class=\"line\">shutdown -r now  </span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh root@localhost -p 10001</span><br></pre></td></tr></table></figure>\n<h1 id=\"22\"><a href=\"#22\" class=\"headerlink\" title=\"22\"></a>22</h1><p></p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>vps,,ssh</p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure>\n<p><strong>#Port 22</strong><strong>Port 10001</strong>,22(,)</p>\n<p>SSH22,22,,</p>\n<p>1000110000~6553510000</p>\n<h1 id=\"SELinux\"><a href=\"#SELinux\" class=\"headerlink\" title=\"SELinux\"></a>SELinux</h1><h2 id=\"SELinux\"><a href=\"#SELinux\" class=\"headerlink\" title=\"SELinux\"></a>SELinux</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sestatus -v</span><br></pre></td></tr></table></figure>\n<p>,</p>\n<h2 id=\"SELinuxssh\"><a href=\"#SELinuxssh\" class=\"headerlink\" title=\"SELinuxssh\"></a>SELinuxssh</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">semanage port -l|grep ssh</span><br></pre></td></tr></table></figure>\n<p><strong>ssh_port_t         tcp      22</strong></p>\n<h2 id=\"SELinux10001ssh\"><a href=\"#SELinux10001ssh\" class=\"headerlink\" title=\"SELinux10001ssh\"></a>SELinux10001ssh</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">semanage port -a -t ssh_port_t -p tcp 10001</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">semanage port -l|grep ssh</span><br></pre></td></tr></table></figure>\n<p><strong>ssh_port_t         tcp      2210001</strong></p>\n<h1 id=\"10001\"><a href=\"#10001\" class=\"headerlink\" title=\"10001\"></a>10001</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/firewalld/zones/public.xml</span><br></pre></td></tr></table></figure>\n<p>100001</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;port protocol=&quot;tcp&quot; port=&quot;10001&quot;/&gt;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart sshd   ssh</span><br><span class=\"line\">systemctl restart firewalld.service    </span><br><span class=\"line\">shutdown -r now  </span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh root@localhost -p 10001</span><br></pre></td></tr></table></figure>\n<h1 id=\"22\"><a href=\"#22\" class=\"headerlink\" title=\"22\"></a>22</h1><p></p>\n"},{"title":"","date":"2019-10-19T01:24:21.000Z","_content":"\n# \n\n## \n\n DOM resizescrollmousemove\n\nDOM UI \n\n## \n\n``` html\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <title>or</title>\n</head>\n\n<body>\n    <div>JavaScript<br />\n        input\n        <br />\n        <h1>1</h1>\n        <img src=\"a.gif\" />\n        <br />\n        <h1>2</h1>\n        <img src=\"b.gif\" />\n    </div>\n    <hr />\n    <div id=\"demo\"></div>\n    <script>\n        var COUNT = 0;\n        var demo = document.getElementById('demo');\n\n        function testFn() {\n            demo.innerHTML += 'testFn  ' + ++COUNT + '<br>';\n        }\n\n        // version0: JavaScriptID\n        /*\n        function throttle(method, context) {\n            clearTimeout(method.tid);\n            method.tid = setTimeout(function () {\n                method.call(context);\n            }, 100);\n        }\n\n        window.onresize = function () {\n            throttle(testFn);\n        }\n        */\n\n        // version1: ->  timerresizetimer\n        /*\n        window.onresize = function () {\n            var timer = null;\n            clearTimeout(timer);\n\n            timer = setTimeout(function () {\n                testFn();\n            }, 100);\n        };\n        */\n\n        // version2: ->  \n        /*\n        var timer = null;\n        window.onresize = function () {\n            clearTimeout(timer);\n            timer = setTimeout(function() {\n                testFn();\n            }, 100);\n        };\n        */\n\n        // version3: -> resizefn\n        /**\n         * \n         * @param Function fn \n         * @param Number delay \n         * @return Function \n         */\n\n        /*\n        var throttle = function (fn, delay) {\n            var timer = null;\n\n            return function () {\n                clearTimeout(timer);\n                timer = setTimeout(function () {\n                    fn();\n                }, delay);\n            }\n        };\n        */\n\n        // \n        /*\n        var f = throttle(testFn, 200);\n        window.onresize = function () {\n            f();\n        };\n        */\n\n        // \n        /* window.onresize = throttle(testFn, 200);*/\n\n        // versin4\n        var throttle = function (fn, delay, atleast) {\n            var timer = null;\n            var previous = null;\n\n            return function () {\n                var now = +new Date();\n\n                if (!previous) previous = now;\n\n                if (atleast && now - previous > atleast) {\n                    fn();\n                    // \n                    previous = now;\n                    clearTimeout(timer);\n                } else {\n                    clearTimeout(timer);\n                    timer = setTimeout(function () {\n                        fn();\n                        previous = null;\n                    }, delay);\n                }\n            }\n        };\n\n        // atleast\n        window.onresize = throttle(testFn, 200, 1000);\n        // window.onresize = throttle(testFn, 200);\n    </script>\n</body>\n\n</html>\n```\n\ntestcase2\n\n``` html\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <title>or</title>\n</head>\n\n<body>\n    <div style=\"height:5000px\">\n        <div id=\"demo\" style=\"position:fixed;\"></div>\n    </div>\n    <script>\n        var COUNT = 0,\n            demo = document.getElementById('demo');\n\n        function testFn() {\n            demo.innerHTML += 'testFn  ' + ++COUNT + '<br>';\n        }\n\n        var throttle = function (fn, delay, atleast) {\n            var timer = null;\n            var previous = null;\n\n            return function () {\n                var now = +new Date();\n\n                if (!previous) previous = now;\n                if (atleast && now - previous > atleast) {\n                    fn();\n                    // \n                    previous = now;\n                    clearTimeout(timer);\n                } else {\n                    clearTimeout(timer);\n                    timer = setTimeout(function () {\n                        fn();\n                        previous = null;\n                    }, delay);\n                }\n            }\n        };\n\n        // testCase1\n        window.onscroll = throttle(testFn, 200);\n\n        // testCase2\n        // window.onscroll = throttle(testFn, 500, 1000);\n    </script>\n</body>\n\n</html>\n```\n\n[](https://github.com/wangweiye01/throttle)","source":"_posts/throttle.md","raw":"---\ntitle: \ndate: 2019-10-19 09:24:21\ntags:\n---\n\n# \n\n## \n\n DOM resizescrollmousemove\n\nDOM UI \n\n## \n\n``` html\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <title>or</title>\n</head>\n\n<body>\n    <div>JavaScript<br />\n        input\n        <br />\n        <h1>1</h1>\n        <img src=\"a.gif\" />\n        <br />\n        <h1>2</h1>\n        <img src=\"b.gif\" />\n    </div>\n    <hr />\n    <div id=\"demo\"></div>\n    <script>\n        var COUNT = 0;\n        var demo = document.getElementById('demo');\n\n        function testFn() {\n            demo.innerHTML += 'testFn  ' + ++COUNT + '<br>';\n        }\n\n        // version0: JavaScriptID\n        /*\n        function throttle(method, context) {\n            clearTimeout(method.tid);\n            method.tid = setTimeout(function () {\n                method.call(context);\n            }, 100);\n        }\n\n        window.onresize = function () {\n            throttle(testFn);\n        }\n        */\n\n        // version1: ->  timerresizetimer\n        /*\n        window.onresize = function () {\n            var timer = null;\n            clearTimeout(timer);\n\n            timer = setTimeout(function () {\n                testFn();\n            }, 100);\n        };\n        */\n\n        // version2: ->  \n        /*\n        var timer = null;\n        window.onresize = function () {\n            clearTimeout(timer);\n            timer = setTimeout(function() {\n                testFn();\n            }, 100);\n        };\n        */\n\n        // version3: -> resizefn\n        /**\n         * \n         * @param Function fn \n         * @param Number delay \n         * @return Function \n         */\n\n        /*\n        var throttle = function (fn, delay) {\n            var timer = null;\n\n            return function () {\n                clearTimeout(timer);\n                timer = setTimeout(function () {\n                    fn();\n                }, delay);\n            }\n        };\n        */\n\n        // \n        /*\n        var f = throttle(testFn, 200);\n        window.onresize = function () {\n            f();\n        };\n        */\n\n        // \n        /* window.onresize = throttle(testFn, 200);*/\n\n        // versin4\n        var throttle = function (fn, delay, atleast) {\n            var timer = null;\n            var previous = null;\n\n            return function () {\n                var now = +new Date();\n\n                if (!previous) previous = now;\n\n                if (atleast && now - previous > atleast) {\n                    fn();\n                    // \n                    previous = now;\n                    clearTimeout(timer);\n                } else {\n                    clearTimeout(timer);\n                    timer = setTimeout(function () {\n                        fn();\n                        previous = null;\n                    }, delay);\n                }\n            }\n        };\n\n        // atleast\n        window.onresize = throttle(testFn, 200, 1000);\n        // window.onresize = throttle(testFn, 200);\n    </script>\n</body>\n\n</html>\n```\n\ntestcase2\n\n``` html\n<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <title>or</title>\n</head>\n\n<body>\n    <div style=\"height:5000px\">\n        <div id=\"demo\" style=\"position:fixed;\"></div>\n    </div>\n    <script>\n        var COUNT = 0,\n            demo = document.getElementById('demo');\n\n        function testFn() {\n            demo.innerHTML += 'testFn  ' + ++COUNT + '<br>';\n        }\n\n        var throttle = function (fn, delay, atleast) {\n            var timer = null;\n            var previous = null;\n\n            return function () {\n                var now = +new Date();\n\n                if (!previous) previous = now;\n                if (atleast && now - previous > atleast) {\n                    fn();\n                    // \n                    previous = now;\n                    clearTimeout(timer);\n                } else {\n                    clearTimeout(timer);\n                    timer = setTimeout(function () {\n                        fn();\n                        previous = null;\n                    }, delay);\n                }\n            }\n        };\n\n        // testCase1\n        window.onscroll = throttle(testFn, 200);\n\n        // testCase2\n        // window.onscroll = throttle(testFn, 500, 1000);\n    </script>\n</body>\n\n</html>\n```\n\n[](https://github.com/wangweiye01/throttle)","slug":"throttle","published":1,"updated":"2019-12-24T02:00:57.470Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jxo001v0j9ksqb470h1","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> DOM resizescrollmousemove</p>\n<p>DOM UI </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>or<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>JavaScript<span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span><br><span class=\"line\">        input</span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"a.gif\"</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>2<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"b.gif\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">hr</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"demo\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> COUNT = <span class=\"number\">0</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> demo = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'demo'</span>);</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">testFn</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            demo.innerHTML += <span class=\"string\">'testFn  '</span> + ++COUNT + <span class=\"string\">'&lt;br&gt;'</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// version0: JavaScriptID</span></span></span><br><span class=\"line\"><span class=\"undefined\">        /*</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">throttle</span>(<span class=\"params\">method, context</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            clearTimeout(method.tid);</span></span><br><span class=\"line\"><span class=\"javascript\">            method.tid = setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                method.call(context);</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;, 100);</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.onresize = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            throttle(testFn);</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">        */</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// version1: -&gt;  timerresizetimer</span></span></span><br><span class=\"line\"><span class=\"undefined\">        /*</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.onresize = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">var</span> timer = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">            clearTimeout(timer);</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">            timer = setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                testFn();</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;, 100);</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\">        */</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// version2: -&gt;  </span></span></span><br><span class=\"line\"><span class=\"undefined\">        /*</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> timer = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.onresize = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            clearTimeout(timer);</span></span><br><span class=\"line\"><span class=\"javascript\">            timer = setTimeout(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                testFn();</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;, 100);</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\">        */</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// version3: -&gt; resizefn</span></span></span><br><span class=\"line\"><span class=\"undefined\">        /**</span></span><br><span class=\"line\"><span class=\"undefined\">         * </span></span><br><span class=\"line\"><span class=\"javascript\">         * @param <span class=\"built_in\">Function</span> fn </span></span><br><span class=\"line\"><span class=\"javascript\">         * @param <span class=\"built_in\">Number</span> delay </span></span><br><span class=\"line\"><span class=\"javascript\">         * @<span class=\"keyword\">return</span> <span class=\"built_in\">Function</span> </span></span><br><span class=\"line\"><span class=\"undefined\">         */</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"undefined\">        /*</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> throttle = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">fn, delay</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">var</span> timer = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                clearTimeout(timer);</span></span><br><span class=\"line\"><span class=\"javascript\">                timer = setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                    fn();</span></span><br><span class=\"line\"><span class=\"undefined\">                &#125;, delay);</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\">        */</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// </span></span></span><br><span class=\"line\"><span class=\"undefined\">        /*</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> f = throttle(testFn, <span class=\"number\">200</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.onresize = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            f();</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\">        */</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// </span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">/* window.onresize = throttle(testFn, 200);*/</span></span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// versin4</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> throttle = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">fn, delay, atleast</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">var</span> timer = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">var</span> previous = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                <span class=\"keyword\">var</span> now = +<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">                <span class=\"keyword\">if</span> (!previous) previous = now;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">                <span class=\"keyword\">if</span> (atleast &amp;&amp; now - previous &gt; atleast) &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                    fn();</span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"comment\">// </span></span></span><br><span class=\"line\"><span class=\"undefined\">                    previous = now;</span></span><br><span class=\"line\"><span class=\"undefined\">                    clearTimeout(timer);</span></span><br><span class=\"line\"><span class=\"javascript\">                &#125; <span class=\"keyword\">else</span> &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                    clearTimeout(timer);</span></span><br><span class=\"line\"><span class=\"javascript\">                    timer = setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                        fn();</span></span><br><span class=\"line\"><span class=\"javascript\">                        previous = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">                    &#125;, delay);</span></span><br><span class=\"line\"><span class=\"undefined\">                &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// atleast</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.onresize = throttle(testFn, <span class=\"number\">200</span>, <span class=\"number\">1000</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// window.onresize = throttle(testFn, 200);</span></span></span><br><span class=\"line\"><span class=\"undefined\">    </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>testcase2</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>or<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"height:5000px\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"demo\"</span> <span class=\"attr\">style</span>=<span class=\"string\">\"position:fixed;\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> COUNT = <span class=\"number\">0</span>,</span></span><br><span class=\"line\"><span class=\"javascript\">            demo = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'demo'</span>);</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">testFn</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            demo.innerHTML += <span class=\"string\">'testFn  '</span> + ++COUNT + <span class=\"string\">'&lt;br&gt;'</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> throttle = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">fn, delay, atleast</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">var</span> timer = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">var</span> previous = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                <span class=\"keyword\">var</span> now = +<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">                <span class=\"keyword\">if</span> (!previous) previous = now;</span></span><br><span class=\"line\"><span class=\"javascript\">                <span class=\"keyword\">if</span> (atleast &amp;&amp; now - previous &gt; atleast) &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                    fn();</span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"comment\">// </span></span></span><br><span class=\"line\"><span class=\"undefined\">                    previous = now;</span></span><br><span class=\"line\"><span class=\"undefined\">                    clearTimeout(timer);</span></span><br><span class=\"line\"><span class=\"javascript\">                &#125; <span class=\"keyword\">else</span> &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                    clearTimeout(timer);</span></span><br><span class=\"line\"><span class=\"javascript\">                    timer = setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                        fn();</span></span><br><span class=\"line\"><span class=\"javascript\">                        previous = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">                    &#125;, delay);</span></span><br><span class=\"line\"><span class=\"undefined\">                &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// testCase1</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.onscroll = throttle(testFn, <span class=\"number\">200</span>);</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// testCase2</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// window.onscroll = throttle(testFn, 500, 1000);</span></span></span><br><span class=\"line\"><span class=\"undefined\">    </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><a href=\"https://github.com/wangweiye01/throttle\" target=\"_blank\" rel=\"noopener\"></a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> DOM resizescrollmousemove</p>\n<p>DOM UI </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>or<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>JavaScript<span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span><br><span class=\"line\">        input</span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"a.gif\"</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">br</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>2<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"b.gif\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">hr</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"demo\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> COUNT = <span class=\"number\">0</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> demo = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'demo'</span>);</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">testFn</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            demo.innerHTML += <span class=\"string\">'testFn  '</span> + ++COUNT + <span class=\"string\">'&lt;br&gt;'</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// version0: JavaScriptID</span></span></span><br><span class=\"line\"><span class=\"undefined\">        /*</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">throttle</span>(<span class=\"params\">method, context</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            clearTimeout(method.tid);</span></span><br><span class=\"line\"><span class=\"javascript\">            method.tid = setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                method.call(context);</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;, 100);</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.onresize = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            throttle(testFn);</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">        */</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// version1: -&gt;  timerresizetimer</span></span></span><br><span class=\"line\"><span class=\"undefined\">        /*</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.onresize = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">var</span> timer = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">            clearTimeout(timer);</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">            timer = setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                testFn();</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;, 100);</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\">        */</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// version2: -&gt;  </span></span></span><br><span class=\"line\"><span class=\"undefined\">        /*</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> timer = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.onresize = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            clearTimeout(timer);</span></span><br><span class=\"line\"><span class=\"javascript\">            timer = setTimeout(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                testFn();</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;, 100);</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\">        */</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// version3: -&gt; resizefn</span></span></span><br><span class=\"line\"><span class=\"undefined\">        /**</span></span><br><span class=\"line\"><span class=\"undefined\">         * </span></span><br><span class=\"line\"><span class=\"javascript\">         * @param <span class=\"built_in\">Function</span> fn </span></span><br><span class=\"line\"><span class=\"javascript\">         * @param <span class=\"built_in\">Number</span> delay </span></span><br><span class=\"line\"><span class=\"javascript\">         * @<span class=\"keyword\">return</span> <span class=\"built_in\">Function</span> </span></span><br><span class=\"line\"><span class=\"undefined\">         */</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"undefined\">        /*</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> throttle = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">fn, delay</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">var</span> timer = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                clearTimeout(timer);</span></span><br><span class=\"line\"><span class=\"javascript\">                timer = setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                    fn();</span></span><br><span class=\"line\"><span class=\"undefined\">                &#125;, delay);</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\">        */</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// </span></span></span><br><span class=\"line\"><span class=\"undefined\">        /*</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> f = throttle(testFn, <span class=\"number\">200</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.onresize = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">            f();</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\">        */</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// </span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">/* window.onresize = throttle(testFn, 200);*/</span></span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// versin4</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> throttle = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">fn, delay, atleast</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">var</span> timer = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">var</span> previous = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                <span class=\"keyword\">var</span> now = +<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">                <span class=\"keyword\">if</span> (!previous) previous = now;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">                <span class=\"keyword\">if</span> (atleast &amp;&amp; now - previous &gt; atleast) &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                    fn();</span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"comment\">// </span></span></span><br><span class=\"line\"><span class=\"undefined\">                    previous = now;</span></span><br><span class=\"line\"><span class=\"undefined\">                    clearTimeout(timer);</span></span><br><span class=\"line\"><span class=\"javascript\">                &#125; <span class=\"keyword\">else</span> &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                    clearTimeout(timer);</span></span><br><span class=\"line\"><span class=\"javascript\">                    timer = setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                        fn();</span></span><br><span class=\"line\"><span class=\"javascript\">                        previous = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">                    &#125;, delay);</span></span><br><span class=\"line\"><span class=\"undefined\">                &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// atleast</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.onresize = throttle(testFn, <span class=\"number\">200</span>, <span class=\"number\">1000</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// window.onresize = throttle(testFn, 200);</span></span></span><br><span class=\"line\"><span class=\"undefined\">    </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>testcase2</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"en\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"UTF-8\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>or<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"height:5000px\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"demo\"</span> <span class=\"attr\">style</span>=<span class=\"string\">\"position:fixed;\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> COUNT = <span class=\"number\">0</span>,</span></span><br><span class=\"line\"><span class=\"javascript\">            demo = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'demo'</span>);</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">testFn</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            demo.innerHTML += <span class=\"string\">'testFn  '</span> + ++COUNT + <span class=\"string\">'&lt;br&gt;'</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"keyword\">var</span> throttle = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">fn, delay, atleast</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">var</span> timer = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">var</span> previous = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                <span class=\"keyword\">var</span> now = +<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">                <span class=\"keyword\">if</span> (!previous) previous = now;</span></span><br><span class=\"line\"><span class=\"javascript\">                <span class=\"keyword\">if</span> (atleast &amp;&amp; now - previous &gt; atleast) &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                    fn();</span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"comment\">// </span></span></span><br><span class=\"line\"><span class=\"undefined\">                    previous = now;</span></span><br><span class=\"line\"><span class=\"undefined\">                    clearTimeout(timer);</span></span><br><span class=\"line\"><span class=\"javascript\">                &#125; <span class=\"keyword\">else</span> &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                    clearTimeout(timer);</span></span><br><span class=\"line\"><span class=\"javascript\">                    timer = setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                        fn();</span></span><br><span class=\"line\"><span class=\"javascript\">                        previous = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">                    &#125;, delay);</span></span><br><span class=\"line\"><span class=\"undefined\">                &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">        &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// testCase1</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"built_in\">window</span>.onscroll = throttle(testFn, <span class=\"number\">200</span>);</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// testCase2</span></span></span><br><span class=\"line\"><span class=\"javascript\">        <span class=\"comment\">// window.onscroll = throttle(testFn, 500, 1000);</span></span></span><br><span class=\"line\"><span class=\"undefined\">    </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><a href=\"https://github.com/wangweiye01/throttle\" target=\"_blank\" rel=\"noopener\"></a></p>\n"},{"title":"ubuntu","date":"2017-11-28T07:49:48.000Z","_content":"# \n\n```\nsudo apt-get remove firefox\n```\n\n# \n\n```\nhttp://www.firefox.com.cn/download/\n```\n\n\n# /opt\n\n```\nsudo mv firefox /opt\n```\n\n# \n\n/usr/share/applicationsfirefox.desktop\n```\nsudo touch firefox.desktop\n```\n\n```\n[Desktop Entry]\nName=Firefox\nName[zh_CN]=\nComment=this is firefox\nExec=/opt/firefox/firefox\nIcon=/opt/firefox/icons/fox.png\nTerminal=false\nType=Application\nCategories=Application;Network;\n```\n","source":"_posts/ubuntu_firefox.md","raw":"---\ntitle: ubuntu\ndate: 2017-11-28 15:49:48\ntags:\n---\n# \n\n```\nsudo apt-get remove firefox\n```\n\n# \n\n```\nhttp://www.firefox.com.cn/download/\n```\n\n\n# /opt\n\n```\nsudo mv firefox /opt\n```\n\n# \n\n/usr/share/applicationsfirefox.desktop\n```\nsudo touch firefox.desktop\n```\n\n```\n[Desktop Entry]\nName=Firefox\nName[zh_CN]=\nComment=this is firefox\nExec=/opt/firefox/firefox\nIcon=/opt/firefox/icons/fox.png\nTerminal=false\nType=Application\nCategories=Application;Network;\n```\n","slug":"ubuntu_firefox","published":1,"updated":"2019-12-24T02:00:57.470Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jxq001x0j9kw6wqsk27","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get remove firefox</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.firefox.com.cn/download/</span><br></pre></td></tr></table></figure>\n<p></p>\n<h1 id=\"-opt\"><a href=\"#-opt\" class=\"headerlink\" title=\"/opt\"></a>/opt</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo mv firefox /opt</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>/usr/share/applicationsfirefox.desktop<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo touch firefox.desktop</span><br></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[Desktop Entry]</span><br><span class=\"line\">Name=Firefox</span><br><span class=\"line\">Name[zh_CN]=</span><br><span class=\"line\">Comment=this is firefox</span><br><span class=\"line\">Exec=/opt/firefox/firefox</span><br><span class=\"line\">Icon=/opt/firefox/icons/fox.png</span><br><span class=\"line\">Terminal=false</span><br><span class=\"line\">Type=Application</span><br><span class=\"line\">Categories=Application;Network;</span><br></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get remove firefox</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.firefox.com.cn/download/</span><br></pre></td></tr></table></figure>\n<p></p>\n<h1 id=\"-opt\"><a href=\"#-opt\" class=\"headerlink\" title=\"/opt\"></a>/opt</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo mv firefox /opt</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>/usr/share/applicationsfirefox.desktop<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo touch firefox.desktop</span><br></pre></td></tr></table></figure></p>\n<p><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[Desktop Entry]</span><br><span class=\"line\">Name=Firefox</span><br><span class=\"line\">Name[zh_CN]=</span><br><span class=\"line\">Comment=this is firefox</span><br><span class=\"line\">Exec=/opt/firefox/firefox</span><br><span class=\"line\">Icon=/opt/firefox/icons/fox.png</span><br><span class=\"line\">Terminal=false</span><br><span class=\"line\">Type=Application</span><br><span class=\"line\">Categories=Application;Network;</span><br></pre></td></tr></table></figure></p>\n"},{"title":"Spring BootWebSocket","date":"2018-03-01T09:05:06.000Z","_content":"\n![pic](http://www.wailian.work/images/2018/03/02/3b41bb4144a7478ef7d1937c3a0ec56975e163f61a9ba-n8Syo1_fw658.jpg)\n\n# WebSocket\n\nWebSocketTCP(full-duplex)\n\n# \n\n```\n@Configuration\n@EnableWebSocketMessageBroker\npublic class WebSocketConfig extends AbstractWebSocketMessageBrokerConfigurer {\n\n\t@Override\n\tpublic void configureMessageBroker(MessageBrokerRegistry config) {\n\t\tconfig.enableSimpleBroker(\"/topic\");\n\t\tconfig.setApplicationDestinationPrefixes(\"/app\");\n\t}\n\n\t@Override\n\tpublic void registerStompEndpoints(StompEndpointRegistry registry) {\n\t\tregistry.addEndpoint(\"/my-websocket\").withSockJS();\n\t}\n}\n```\n\n\"/app\"websocketurl\"my-websocket\"endpoint\n\n1. @EnableWebSocketMessageBrokerSTOMP\n2. registerStompEndpointsSTOMPURL\n3. `registry.addEndpoint(\"/my-websocket\").withSockJS()`STOMPSockJS\n4. configureMessageBroker/topic\n\n# \n\n```\npublic class SocketMessage {\n\n\tpublic String message;\n\n\tpublic String date;\n\n}\n```\n\n\n# \n\n```\n@Controller\n@EnableScheduling\n@SpringBootApplication\npublic class App {\n\n\tpublic static void main(String[] args) {\n\t\tSpringApplication.run(App.class, args);\n\t}\n\n\t@Autowired\n\tprivate SimpMessagingTemplate messagingTemplate;\n\n\t@GetMapping(\"/\")\n\tpublic String index() {\n\t\treturn \"index\";\n\t}\n\n\t@MessageMapping(\"/send\")\n\t@SendTo(\"/topic/send\")\n\tpublic SocketMessage send(SocketMessage message) throws Exception {\n\t\tDateFormat df = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\n\t\tmessage.date = df.format(new Date());\n\t\treturn message;\n\t}\n\n\t@Scheduled(fixedRate = 1000)\n\t@SendTo(\"/topic/callback\")\n\tpublic Object callback() throws Exception {\n\t\t// \n\t\tDateFormat df = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\n\t\tmessagingTemplate.convertAndSend(\"/topic/callback\", df.format(new Date()));\n\t\treturn \"callback\";\n\t}\n}\n```\n\n`@MessageMapping``@RequestMapping`\n\n`@SendTo``@SendTo`\n\n# \n\njsSTOMPstomp.jsSockJSsock.jsjQuery\n\n# \n\n```\n<!DOCTYPE html>\n<html>\n<head>\n<title>websocket</title>\n<script src=\"//cdn.bootcss.com/angular.js/1.5.6/angular.min.js\"></script>\n<script src=\"https://cdn.bootcss.com/sockjs-client/1.1.4/sockjs.min.js\"></script>\n<script src=\"https://cdn.bootcss.com/stomp.js/2.3.3/stomp.min.js\"></script>\n<script type=\"text/javascript\">\n\n\tvar stompClient = null;\n\n\tvar app = angular.module('app', []);\n\tapp.controller('MainController', function($rootScope, $scope, $http) {\n\n\t\t$scope.data = {\n\t\t\t//\n\t\t\tconnected : false,\n\t\t\t//\n\t\t\tmessage : '',\n\t\t\trows : []\n\t\t};\n\n\t\t//\n\t\t$scope.connect = function() {\n\t\t\tvar socket = new SockJS('/my-websocket');\n\t\t\tstompClient = Stomp.over(socket);\n\t\t\tstompClient.connect({}, function(frame) {\n\t\t\t\t// \n\t\t\t\tstompClient.subscribe('/topic/send', function(msg) {\n\t\t\t\t\t$scope.data.rows.push(JSON.parse(msg.body));\n\t\t\t\t\t$scope.data.connected = true;\n\t\t\t\t\t$scope.$apply();\n\t\t\t\t});\n\t\t\t\t// \n\t\t\t\tstompClient.subscribe('/topic/callback', function(r) {\n\t\t\t\t\t$scope.data.time = '' + r.body;\n\t\t\t\t\t$scope.data.connected = true;\n\t\t\t\t\t$scope.$apply();\n\t\t\t\t});\n\n\t\t\t\t$scope.data.connected = true;\n\t\t\t\t$scope.$apply();\n\t\t\t});\n\t\t};\n\n\t\t$scope.disconnect = function() {\n\t\t\tif (stompClient != null) {\n\t\t\t\tstompClient.disconnect();\n\t\t\t}\n\t\t\t$scope.data.connected = false;\n\t\t}\n\n\t\t$scope.send = function() {\n\t\t\tstompClient.send(\"/app/send\", {}, JSON.stringify({\n\t\t\t\t'message' : $scope.data.message\n\t\t\t}));\n\t\t}\n\t});\n</script>\n</head>\n<body ng-app=\"app\" ng-controller=\"MainController\">\n\t<label>WebSocket:</label>\n\t<button type=\"button\" ng-disabled=\"data.connected\" ng-click=\"connect()\"></button>\n\t<button type=\"button\" ng-click=\"disconnect()\"\n\t\tng-disabled=\"!data.connected\"></button>\n\t<br />\n\t<br />\n\t<div ng-show=\"data.connected\">\n\t\t<label>{{data.time}}</label> <br /> <br /> <input type=\"text\"\n\t\t\tng-model=\"data.message\" placeholder=\"...\" />\n\t\t<button ng-click=\"send()\" type=\"button\"></button>\n\t\t<br /> <br />  <br />\n\t\t<table>\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th></th>\n\t\t\t\t\t<th></th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t<tr ng-repeat=\"row in data.rows\">\n\t\t\t\t\t<td>{{row.message}}</td>\n\t\t\t\t\t<td>{{row.date}}</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t</div>\n</body>\n</html>\n```\n![](http://www.wailian.work/images/2018/03/02/WX20180302-094543.png)\n\n\n[](https://github.com/wangweiye01/websocket)\n","source":"_posts/websocket.md","raw":"---\ntitle: Spring BootWebSocket\ndate: 2018-03-01 17:05:06\ntags:\n---\n\n![pic](http://www.wailian.work/images/2018/03/02/3b41bb4144a7478ef7d1937c3a0ec56975e163f61a9ba-n8Syo1_fw658.jpg)\n\n# WebSocket\n\nWebSocketTCP(full-duplex)\n\n# \n\n```\n@Configuration\n@EnableWebSocketMessageBroker\npublic class WebSocketConfig extends AbstractWebSocketMessageBrokerConfigurer {\n\n\t@Override\n\tpublic void configureMessageBroker(MessageBrokerRegistry config) {\n\t\tconfig.enableSimpleBroker(\"/topic\");\n\t\tconfig.setApplicationDestinationPrefixes(\"/app\");\n\t}\n\n\t@Override\n\tpublic void registerStompEndpoints(StompEndpointRegistry registry) {\n\t\tregistry.addEndpoint(\"/my-websocket\").withSockJS();\n\t}\n}\n```\n\n\"/app\"websocketurl\"my-websocket\"endpoint\n\n1. @EnableWebSocketMessageBrokerSTOMP\n2. registerStompEndpointsSTOMPURL\n3. `registry.addEndpoint(\"/my-websocket\").withSockJS()`STOMPSockJS\n4. configureMessageBroker/topic\n\n# \n\n```\npublic class SocketMessage {\n\n\tpublic String message;\n\n\tpublic String date;\n\n}\n```\n\n\n# \n\n```\n@Controller\n@EnableScheduling\n@SpringBootApplication\npublic class App {\n\n\tpublic static void main(String[] args) {\n\t\tSpringApplication.run(App.class, args);\n\t}\n\n\t@Autowired\n\tprivate SimpMessagingTemplate messagingTemplate;\n\n\t@GetMapping(\"/\")\n\tpublic String index() {\n\t\treturn \"index\";\n\t}\n\n\t@MessageMapping(\"/send\")\n\t@SendTo(\"/topic/send\")\n\tpublic SocketMessage send(SocketMessage message) throws Exception {\n\t\tDateFormat df = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\n\t\tmessage.date = df.format(new Date());\n\t\treturn message;\n\t}\n\n\t@Scheduled(fixedRate = 1000)\n\t@SendTo(\"/topic/callback\")\n\tpublic Object callback() throws Exception {\n\t\t// \n\t\tDateFormat df = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\n\t\tmessagingTemplate.convertAndSend(\"/topic/callback\", df.format(new Date()));\n\t\treturn \"callback\";\n\t}\n}\n```\n\n`@MessageMapping``@RequestMapping`\n\n`@SendTo``@SendTo`\n\n# \n\njsSTOMPstomp.jsSockJSsock.jsjQuery\n\n# \n\n```\n<!DOCTYPE html>\n<html>\n<head>\n<title>websocket</title>\n<script src=\"//cdn.bootcss.com/angular.js/1.5.6/angular.min.js\"></script>\n<script src=\"https://cdn.bootcss.com/sockjs-client/1.1.4/sockjs.min.js\"></script>\n<script src=\"https://cdn.bootcss.com/stomp.js/2.3.3/stomp.min.js\"></script>\n<script type=\"text/javascript\">\n\n\tvar stompClient = null;\n\n\tvar app = angular.module('app', []);\n\tapp.controller('MainController', function($rootScope, $scope, $http) {\n\n\t\t$scope.data = {\n\t\t\t//\n\t\t\tconnected : false,\n\t\t\t//\n\t\t\tmessage : '',\n\t\t\trows : []\n\t\t};\n\n\t\t//\n\t\t$scope.connect = function() {\n\t\t\tvar socket = new SockJS('/my-websocket');\n\t\t\tstompClient = Stomp.over(socket);\n\t\t\tstompClient.connect({}, function(frame) {\n\t\t\t\t// \n\t\t\t\tstompClient.subscribe('/topic/send', function(msg) {\n\t\t\t\t\t$scope.data.rows.push(JSON.parse(msg.body));\n\t\t\t\t\t$scope.data.connected = true;\n\t\t\t\t\t$scope.$apply();\n\t\t\t\t});\n\t\t\t\t// \n\t\t\t\tstompClient.subscribe('/topic/callback', function(r) {\n\t\t\t\t\t$scope.data.time = '' + r.body;\n\t\t\t\t\t$scope.data.connected = true;\n\t\t\t\t\t$scope.$apply();\n\t\t\t\t});\n\n\t\t\t\t$scope.data.connected = true;\n\t\t\t\t$scope.$apply();\n\t\t\t});\n\t\t};\n\n\t\t$scope.disconnect = function() {\n\t\t\tif (stompClient != null) {\n\t\t\t\tstompClient.disconnect();\n\t\t\t}\n\t\t\t$scope.data.connected = false;\n\t\t}\n\n\t\t$scope.send = function() {\n\t\t\tstompClient.send(\"/app/send\", {}, JSON.stringify({\n\t\t\t\t'message' : $scope.data.message\n\t\t\t}));\n\t\t}\n\t});\n</script>\n</head>\n<body ng-app=\"app\" ng-controller=\"MainController\">\n\t<label>WebSocket:</label>\n\t<button type=\"button\" ng-disabled=\"data.connected\" ng-click=\"connect()\"></button>\n\t<button type=\"button\" ng-click=\"disconnect()\"\n\t\tng-disabled=\"!data.connected\"></button>\n\t<br />\n\t<br />\n\t<div ng-show=\"data.connected\">\n\t\t<label>{{data.time}}</label> <br /> <br /> <input type=\"text\"\n\t\t\tng-model=\"data.message\" placeholder=\"...\" />\n\t\t<button ng-click=\"send()\" type=\"button\"></button>\n\t\t<br /> <br />  <br />\n\t\t<table>\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th></th>\n\t\t\t\t\t<th></th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t<tr ng-repeat=\"row in data.rows\">\n\t\t\t\t\t<td>{{row.message}}</td>\n\t\t\t\t\t<td>{{row.date}}</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t</div>\n</body>\n</html>\n```\n![](http://www.wailian.work/images/2018/03/02/WX20180302-094543.png)\n\n\n[](https://github.com/wangweiye01/websocket)\n","slug":"websocket","published":1,"updated":"2019-12-24T02:00:57.480Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3jxr001z0j9kzzexex99","content":"<p><img src=\"http://www.wailian.work/images/2018/03/02/3b41bb4144a7478ef7d1937c3a0ec56975e163f61a9ba-n8Syo1_fw658.jpg\" alt=\"pic\"></p>\n<h1 id=\"WebSocket\"><a href=\"#WebSocket\" class=\"headerlink\" title=\"WebSocket\"></a>WebSocket</h1><p>WebSocketTCP(full-duplex)</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Configuration</span><br><span class=\"line\">@EnableWebSocketMessageBroker</span><br><span class=\"line\">public class WebSocketConfig extends AbstractWebSocketMessageBrokerConfigurer &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@Override</span><br><span class=\"line\">\tpublic void configureMessageBroker(MessageBrokerRegistry config) &#123;</span><br><span class=\"line\">\t\tconfig.enableSimpleBroker(&quot;/topic&quot;);</span><br><span class=\"line\">\t\tconfig.setApplicationDestinationPrefixes(&quot;/app&quot;);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@Override</span><br><span class=\"line\">\tpublic void registerStompEndpoints(StompEndpointRegistry registry) &#123;</span><br><span class=\"line\">\t\tregistry.addEndpoint(&quot;/my-websocket&quot;).withSockJS();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>/appwebsocketurlmy-websocketendpoint</p>\n<ol>\n<li>@EnableWebSocketMessageBrokerSTOMP</li>\n<li>registerStompEndpointsSTOMPURL</li>\n<li><code>registry.addEndpoint(&quot;/my-websocket&quot;).withSockJS()</code>STOMPSockJS</li>\n<li>configureMessageBroker/topic</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class SocketMessage &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic String message;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic String date;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Controller</span><br><span class=\"line\">@EnableScheduling</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class App &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic static void main(String[] args) &#123;</span><br><span class=\"line\">\t\tSpringApplication.run(App.class, args);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@Autowired</span><br><span class=\"line\">\tprivate SimpMessagingTemplate messagingTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@GetMapping(&quot;/&quot;)</span><br><span class=\"line\">\tpublic String index() &#123;</span><br><span class=\"line\">\t\treturn &quot;index&quot;;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@MessageMapping(&quot;/send&quot;)</span><br><span class=\"line\">\t@SendTo(&quot;/topic/send&quot;)</span><br><span class=\"line\">\tpublic SocketMessage send(SocketMessage message) throws Exception &#123;</span><br><span class=\"line\">\t\tDateFormat df = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);</span><br><span class=\"line\">\t\tmessage.date = df.format(new Date());</span><br><span class=\"line\">\t\treturn message;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@Scheduled(fixedRate = 1000)</span><br><span class=\"line\">\t@SendTo(&quot;/topic/callback&quot;)</span><br><span class=\"line\">\tpublic Object callback() throws Exception &#123;</span><br><span class=\"line\">\t\t// </span><br><span class=\"line\">\t\tDateFormat df = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);</span><br><span class=\"line\">\t\tmessagingTemplate.convertAndSend(&quot;/topic/callback&quot;, df.format(new Date()));</span><br><span class=\"line\">\t\treturn &quot;callback&quot;;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>@MessageMapping</code><code>@RequestMapping</code></p>\n<p><code>@SendTo</code><code>@SendTo</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>jsSTOMPstomp.jsSockJSsock.jsjQuery</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">&lt;head&gt;</span><br><span class=\"line\">&lt;title&gt;websocket&lt;/title&gt;</span><br><span class=\"line\">&lt;script src=&quot;//cdn.bootcss.com/angular.js/1.5.6/angular.min.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;script src=&quot;https://cdn.bootcss.com/sockjs-client/1.1.4/sockjs.min.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;script src=&quot;https://cdn.bootcss.com/stomp.js/2.3.3/stomp.min.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">\tvar stompClient = null;</span><br><span class=\"line\"></span><br><span class=\"line\">\tvar app = angular.module(&apos;app&apos;, []);</span><br><span class=\"line\">\tapp.controller(&apos;MainController&apos;, function($rootScope, $scope, $http) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t$scope.data = &#123;</span><br><span class=\"line\">\t\t\t//</span><br><span class=\"line\">\t\t\tconnected : false,</span><br><span class=\"line\">\t\t\t//</span><br><span class=\"line\">\t\t\tmessage : &apos;&apos;,</span><br><span class=\"line\">\t\t\trows : []</span><br><span class=\"line\">\t\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t//</span><br><span class=\"line\">\t\t$scope.connect = function() &#123;</span><br><span class=\"line\">\t\t\tvar socket = new SockJS(&apos;/my-websocket&apos;);</span><br><span class=\"line\">\t\t\tstompClient = Stomp.over(socket);</span><br><span class=\"line\">\t\t\tstompClient.connect(&#123;&#125;, function(frame) &#123;</span><br><span class=\"line\">\t\t\t\t// </span><br><span class=\"line\">\t\t\t\tstompClient.subscribe(&apos;/topic/send&apos;, function(msg) &#123;</span><br><span class=\"line\">\t\t\t\t\t$scope.data.rows.push(JSON.parse(msg.body));</span><br><span class=\"line\">\t\t\t\t\t$scope.data.connected = true;</span><br><span class=\"line\">\t\t\t\t\t$scope.$apply();</span><br><span class=\"line\">\t\t\t\t&#125;);</span><br><span class=\"line\">\t\t\t\t// </span><br><span class=\"line\">\t\t\t\tstompClient.subscribe(&apos;/topic/callback&apos;, function(r) &#123;</span><br><span class=\"line\">\t\t\t\t\t$scope.data.time = &apos;&apos; + r.body;</span><br><span class=\"line\">\t\t\t\t\t$scope.data.connected = true;</span><br><span class=\"line\">\t\t\t\t\t$scope.$apply();</span><br><span class=\"line\">\t\t\t\t&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t\t$scope.data.connected = true;</span><br><span class=\"line\">\t\t\t\t$scope.$apply();</span><br><span class=\"line\">\t\t\t&#125;);</span><br><span class=\"line\">\t\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t$scope.disconnect = function() &#123;</span><br><span class=\"line\">\t\t\tif (stompClient != null) &#123;</span><br><span class=\"line\">\t\t\t\tstompClient.disconnect();</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t$scope.data.connected = false;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t$scope.send = function() &#123;</span><br><span class=\"line\">\t\t\tstompClient.send(&quot;/app/send&quot;, &#123;&#125;, JSON.stringify(&#123;</span><br><span class=\"line\">\t\t\t\t&apos;message&apos; : $scope.data.message</span><br><span class=\"line\">\t\t\t&#125;));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\">&lt;/head&gt;</span><br><span class=\"line\">&lt;body ng-app=&quot;app&quot; ng-controller=&quot;MainController&quot;&gt;</span><br><span class=\"line\">\t&lt;label&gt;WebSocket:&lt;/label&gt;</span><br><span class=\"line\">\t&lt;button type=&quot;button&quot; ng-disabled=&quot;data.connected&quot; ng-click=&quot;connect()&quot;&gt;&lt;/button&gt;</span><br><span class=\"line\">\t&lt;button type=&quot;button&quot; ng-click=&quot;disconnect()&quot;</span><br><span class=\"line\">\t\tng-disabled=&quot;!data.connected&quot;&gt;&lt;/button&gt;</span><br><span class=\"line\">\t&lt;br /&gt;</span><br><span class=\"line\">\t&lt;br /&gt;</span><br><span class=\"line\">\t&lt;div ng-show=&quot;data.connected&quot;&gt;</span><br><span class=\"line\">\t\t&lt;label&gt;&#123;&#123;data.time&#125;&#125;&lt;/label&gt; &lt;br /&gt; &lt;br /&gt; &lt;input type=&quot;text&quot;</span><br><span class=\"line\">\t\t\tng-model=&quot;data.message&quot; placeholder=&quot;...&quot; /&gt;</span><br><span class=\"line\">\t\t&lt;button ng-click=&quot;send()&quot; type=&quot;button&quot;&gt;&lt;/button&gt;</span><br><span class=\"line\">\t\t&lt;br /&gt; &lt;br /&gt;  &lt;br /&gt;</span><br><span class=\"line\">\t\t&lt;table&gt;</span><br><span class=\"line\">\t\t\t&lt;thead&gt;</span><br><span class=\"line\">\t\t\t\t&lt;tr&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;th&gt;&lt;/th&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;th&gt;&lt;/th&gt;</span><br><span class=\"line\">\t\t\t\t&lt;/tr&gt;</span><br><span class=\"line\">\t\t\t&lt;/thead&gt;</span><br><span class=\"line\">\t\t\t&lt;tbody&gt;</span><br><span class=\"line\">\t\t\t\t&lt;tr ng-repeat=&quot;row in data.rows&quot;&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;td&gt;&#123;&#123;row.message&#125;&#125;&lt;/td&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;td&gt;&#123;&#123;row.date&#125;&#125;&lt;/td&gt;</span><br><span class=\"line\">\t\t\t\t&lt;/tr&gt;</span><br><span class=\"line\">\t\t\t&lt;/tbody&gt;</span><br><span class=\"line\">\t\t&lt;/table&gt;</span><br><span class=\"line\">\t&lt;/div&gt;</span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://www.wailian.work/images/2018/03/02/WX20180302-094543.png\" alt=\"\"></p>\n<p><a href=\"https://github.com/wangweiye01/websocket\" target=\"_blank\" rel=\"noopener\"></a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/03/02/3b41bb4144a7478ef7d1937c3a0ec56975e163f61a9ba-n8Syo1_fw658.jpg\" alt=\"pic\"></p>\n<h1 id=\"WebSocket\"><a href=\"#WebSocket\" class=\"headerlink\" title=\"WebSocket\"></a>WebSocket</h1><p>WebSocketTCP(full-duplex)</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Configuration</span><br><span class=\"line\">@EnableWebSocketMessageBroker</span><br><span class=\"line\">public class WebSocketConfig extends AbstractWebSocketMessageBrokerConfigurer &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@Override</span><br><span class=\"line\">\tpublic void configureMessageBroker(MessageBrokerRegistry config) &#123;</span><br><span class=\"line\">\t\tconfig.enableSimpleBroker(&quot;/topic&quot;);</span><br><span class=\"line\">\t\tconfig.setApplicationDestinationPrefixes(&quot;/app&quot;);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@Override</span><br><span class=\"line\">\tpublic void registerStompEndpoints(StompEndpointRegistry registry) &#123;</span><br><span class=\"line\">\t\tregistry.addEndpoint(&quot;/my-websocket&quot;).withSockJS();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>/appwebsocketurlmy-websocketendpoint</p>\n<ol>\n<li>@EnableWebSocketMessageBrokerSTOMP</li>\n<li>registerStompEndpointsSTOMPURL</li>\n<li><code>registry.addEndpoint(&quot;/my-websocket&quot;).withSockJS()</code>STOMPSockJS</li>\n<li>configureMessageBroker/topic</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class SocketMessage &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic String message;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic String date;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Controller</span><br><span class=\"line\">@EnableScheduling</span><br><span class=\"line\">@SpringBootApplication</span><br><span class=\"line\">public class App &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic static void main(String[] args) &#123;</span><br><span class=\"line\">\t\tSpringApplication.run(App.class, args);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@Autowired</span><br><span class=\"line\">\tprivate SimpMessagingTemplate messagingTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@GetMapping(&quot;/&quot;)</span><br><span class=\"line\">\tpublic String index() &#123;</span><br><span class=\"line\">\t\treturn &quot;index&quot;;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@MessageMapping(&quot;/send&quot;)</span><br><span class=\"line\">\t@SendTo(&quot;/topic/send&quot;)</span><br><span class=\"line\">\tpublic SocketMessage send(SocketMessage message) throws Exception &#123;</span><br><span class=\"line\">\t\tDateFormat df = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);</span><br><span class=\"line\">\t\tmessage.date = df.format(new Date());</span><br><span class=\"line\">\t\treturn message;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t@Scheduled(fixedRate = 1000)</span><br><span class=\"line\">\t@SendTo(&quot;/topic/callback&quot;)</span><br><span class=\"line\">\tpublic Object callback() throws Exception &#123;</span><br><span class=\"line\">\t\t// </span><br><span class=\"line\">\t\tDateFormat df = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);</span><br><span class=\"line\">\t\tmessagingTemplate.convertAndSend(&quot;/topic/callback&quot;, df.format(new Date()));</span><br><span class=\"line\">\t\treturn &quot;callback&quot;;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>@MessageMapping</code><code>@RequestMapping</code></p>\n<p><code>@SendTo</code><code>@SendTo</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>jsSTOMPstomp.jsSockJSsock.jsjQuery</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">&lt;head&gt;</span><br><span class=\"line\">&lt;title&gt;websocket&lt;/title&gt;</span><br><span class=\"line\">&lt;script src=&quot;//cdn.bootcss.com/angular.js/1.5.6/angular.min.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;script src=&quot;https://cdn.bootcss.com/sockjs-client/1.1.4/sockjs.min.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;script src=&quot;https://cdn.bootcss.com/stomp.js/2.3.3/stomp.min.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">\tvar stompClient = null;</span><br><span class=\"line\"></span><br><span class=\"line\">\tvar app = angular.module(&apos;app&apos;, []);</span><br><span class=\"line\">\tapp.controller(&apos;MainController&apos;, function($rootScope, $scope, $http) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t$scope.data = &#123;</span><br><span class=\"line\">\t\t\t//</span><br><span class=\"line\">\t\t\tconnected : false,</span><br><span class=\"line\">\t\t\t//</span><br><span class=\"line\">\t\t\tmessage : &apos;&apos;,</span><br><span class=\"line\">\t\t\trows : []</span><br><span class=\"line\">\t\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t//</span><br><span class=\"line\">\t\t$scope.connect = function() &#123;</span><br><span class=\"line\">\t\t\tvar socket = new SockJS(&apos;/my-websocket&apos;);</span><br><span class=\"line\">\t\t\tstompClient = Stomp.over(socket);</span><br><span class=\"line\">\t\t\tstompClient.connect(&#123;&#125;, function(frame) &#123;</span><br><span class=\"line\">\t\t\t\t// </span><br><span class=\"line\">\t\t\t\tstompClient.subscribe(&apos;/topic/send&apos;, function(msg) &#123;</span><br><span class=\"line\">\t\t\t\t\t$scope.data.rows.push(JSON.parse(msg.body));</span><br><span class=\"line\">\t\t\t\t\t$scope.data.connected = true;</span><br><span class=\"line\">\t\t\t\t\t$scope.$apply();</span><br><span class=\"line\">\t\t\t\t&#125;);</span><br><span class=\"line\">\t\t\t\t// </span><br><span class=\"line\">\t\t\t\tstompClient.subscribe(&apos;/topic/callback&apos;, function(r) &#123;</span><br><span class=\"line\">\t\t\t\t\t$scope.data.time = &apos;&apos; + r.body;</span><br><span class=\"line\">\t\t\t\t\t$scope.data.connected = true;</span><br><span class=\"line\">\t\t\t\t\t$scope.$apply();</span><br><span class=\"line\">\t\t\t\t&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t\t$scope.data.connected = true;</span><br><span class=\"line\">\t\t\t\t$scope.$apply();</span><br><span class=\"line\">\t\t\t&#125;);</span><br><span class=\"line\">\t\t&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t$scope.disconnect = function() &#123;</span><br><span class=\"line\">\t\t\tif (stompClient != null) &#123;</span><br><span class=\"line\">\t\t\t\tstompClient.disconnect();</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t$scope.data.connected = false;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t$scope.send = function() &#123;</span><br><span class=\"line\">\t\t\tstompClient.send(&quot;/app/send&quot;, &#123;&#125;, JSON.stringify(&#123;</span><br><span class=\"line\">\t\t\t\t&apos;message&apos; : $scope.data.message</span><br><span class=\"line\">\t\t\t&#125;));</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\">&lt;/head&gt;</span><br><span class=\"line\">&lt;body ng-app=&quot;app&quot; ng-controller=&quot;MainController&quot;&gt;</span><br><span class=\"line\">\t&lt;label&gt;WebSocket:&lt;/label&gt;</span><br><span class=\"line\">\t&lt;button type=&quot;button&quot; ng-disabled=&quot;data.connected&quot; ng-click=&quot;connect()&quot;&gt;&lt;/button&gt;</span><br><span class=\"line\">\t&lt;button type=&quot;button&quot; ng-click=&quot;disconnect()&quot;</span><br><span class=\"line\">\t\tng-disabled=&quot;!data.connected&quot;&gt;&lt;/button&gt;</span><br><span class=\"line\">\t&lt;br /&gt;</span><br><span class=\"line\">\t&lt;br /&gt;</span><br><span class=\"line\">\t&lt;div ng-show=&quot;data.connected&quot;&gt;</span><br><span class=\"line\">\t\t&lt;label&gt;&#123;&#123;data.time&#125;&#125;&lt;/label&gt; &lt;br /&gt; &lt;br /&gt; &lt;input type=&quot;text&quot;</span><br><span class=\"line\">\t\t\tng-model=&quot;data.message&quot; placeholder=&quot;...&quot; /&gt;</span><br><span class=\"line\">\t\t&lt;button ng-click=&quot;send()&quot; type=&quot;button&quot;&gt;&lt;/button&gt;</span><br><span class=\"line\">\t\t&lt;br /&gt; &lt;br /&gt;  &lt;br /&gt;</span><br><span class=\"line\">\t\t&lt;table&gt;</span><br><span class=\"line\">\t\t\t&lt;thead&gt;</span><br><span class=\"line\">\t\t\t\t&lt;tr&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;th&gt;&lt;/th&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;th&gt;&lt;/th&gt;</span><br><span class=\"line\">\t\t\t\t&lt;/tr&gt;</span><br><span class=\"line\">\t\t\t&lt;/thead&gt;</span><br><span class=\"line\">\t\t\t&lt;tbody&gt;</span><br><span class=\"line\">\t\t\t\t&lt;tr ng-repeat=&quot;row in data.rows&quot;&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;td&gt;&#123;&#123;row.message&#125;&#125;&lt;/td&gt;</span><br><span class=\"line\">\t\t\t\t\t&lt;td&gt;&#123;&#123;row.date&#125;&#125;&lt;/td&gt;</span><br><span class=\"line\">\t\t\t\t&lt;/tr&gt;</span><br><span class=\"line\">\t\t\t&lt;/tbody&gt;</span><br><span class=\"line\">\t\t&lt;/table&gt;</span><br><span class=\"line\">\t&lt;/div&gt;</span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://www.wailian.work/images/2018/03/02/WX20180302-094543.png\" alt=\"\"></p>\n<p><a href=\"https://github.com/wangweiye01/websocket\" target=\"_blank\" rel=\"noopener\"></a></p>\n"},{"title":"","date":"2018-01-19T01:49:44.000Z","_content":"![pic](http://s1.wailian.download/2018/01/19/f7a1eb169a2ac8556d241cd7173ca9a5d9ede3cb161fa5-eeMK3M_fw658.jpg)\n> \n\n# \n\n\n\n\n\n/\n\n# \n\n\n\n\n\n\n\n\n\n# \n\nblock\n\n![blockchain](http://s1.wailian.download/2018/01/19/bg2017122703.png)\n\n\n\n- Head\n- Body\n\n\n\n- \n- Hash\n- Hash\n- ...\n\n Hash\n\n![hash](http://s1.wailian.download/2018/01/19/bg2017122704.png)\n\n Hash  Hash 256256 Hash \n\n123 Hash a8fdc205a9f19cc1c7507a60c4f01b13d11d7fd0256123 Hash\n\n\n\n-  Hash  Hash \n-  Hash \n\n# Hash \n\n Hash  Hash \"\"Head\n\n> Hash = SHA256()\n\n Hash Hash SHA256 Hash \n\n Hash\"\" Hash Hash Hash  Hash \n\n Hash Hash 51%\n\n\n\n![](http://s1.wailian.download/2018/01/19/bg2017122705.png)\n\"\"\n\n# \n\n\n\n10\n\n Hash\n\nmining Hash  Hash \n\n# \n Hash \n\n Hash  Hash  Hash \n\ndifficulty Hash 100000 14484.16236122\n\n![](http://s1.wailian.download/2018/01/19/bg2017122707.png)\ntarget\n\n![](http://s1.wailian.download/2018/01/19/bg2017122708.png)\n\nHash  Hash  Hash Hash 10\n\n Nonce  Hash  100000  Nonce 274148111 2.74  Hash\n\n# \n\n\n\n2016910%10%1110%10%\n\n\n\n# \n\n\n\n![](http://s1.wailian.download/2018/01/19/bg2017122709.png)\n\n6\"\"10\n\n![](http://s1.wailian.download/2018/01/19/bg2017122710.png)\n\n\n\n# \n\n20098\n\n\n\n\n\n- \n- \n- \n\n\n\n> [](http://www.ruanyifeng.com/blog/2017/12/blockchain-tutorial.html)\n","source":"_posts/blockchain.md","raw":"---\ntitle: \ndate: 2018-01-19 09:49:44\ntags:\n---\n![pic](http://s1.wailian.download/2018/01/19/f7a1eb169a2ac8556d241cd7173ca9a5d9ede3cb161fa5-eeMK3M_fw658.jpg)\n> \n\n# \n\n\n\n\n\n/\n\n# \n\n\n\n\n\n\n\n\n\n# \n\nblock\n\n![blockchain](http://s1.wailian.download/2018/01/19/bg2017122703.png)\n\n\n\n- Head\n- Body\n\n\n\n- \n- Hash\n- Hash\n- ...\n\n Hash\n\n![hash](http://s1.wailian.download/2018/01/19/bg2017122704.png)\n\n Hash  Hash 256256 Hash \n\n123 Hash a8fdc205a9f19cc1c7507a60c4f01b13d11d7fd0256123 Hash\n\n\n\n-  Hash  Hash \n-  Hash \n\n# Hash \n\n Hash  Hash \"\"Head\n\n> Hash = SHA256()\n\n Hash Hash SHA256 Hash \n\n Hash\"\" Hash Hash Hash  Hash \n\n Hash Hash 51%\n\n\n\n![](http://s1.wailian.download/2018/01/19/bg2017122705.png)\n\"\"\n\n# \n\n\n\n10\n\n Hash\n\nmining Hash  Hash \n\n# \n Hash \n\n Hash  Hash  Hash \n\ndifficulty Hash 100000 14484.16236122\n\n![](http://s1.wailian.download/2018/01/19/bg2017122707.png)\ntarget\n\n![](http://s1.wailian.download/2018/01/19/bg2017122708.png)\n\nHash  Hash  Hash Hash 10\n\n Nonce  Hash  100000  Nonce 274148111 2.74  Hash\n\n# \n\n\n\n2016910%10%1110%10%\n\n\n\n# \n\n\n\n![](http://s1.wailian.download/2018/01/19/bg2017122709.png)\n\n6\"\"10\n\n![](http://s1.wailian.download/2018/01/19/bg2017122710.png)\n\n\n\n# \n\n20098\n\n\n\n\n\n- \n- \n- \n\n\n\n> [](http://www.ruanyifeng.com/blog/2017/12/blockchain-tutorial.html)\n","slug":"blockchain","published":1,"updated":"2019-12-24T02:00:57.340Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3k3c00200j9k0juva076","content":"<p><img src=\"http://s1.wailian.download/2018/01/19/f7a1eb169a2ac8556d241cd7173ca9a5d9ede3cb161fa5-eeMK3M_fw658.jpg\" alt=\"pic\"></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p>/</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>block</p>\n<p><img src=\"http://s1.wailian.download/2018/01/19/bg2017122703.png\" alt=\"blockchain\"></p>\n<p></p>\n<ul>\n<li>Head</li>\n<li>Body</li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n<li>Hash</li>\n<li>Hash</li>\n<li></li>\n</ul>\n<p> Hash</p>\n<p><img src=\"http://s1.wailian.download/2018/01/19/bg2017122704.png\" alt=\"hash\"></p>\n<p> Hash  Hash 256256 Hash </p>\n<p>123 Hash a8fdc205a9f19cc1c7507a60c4f01b13d11d7fd0256123 Hash</p>\n<p></p>\n<ul>\n<li> Hash  Hash </li>\n<li> Hash </li>\n</ul>\n<h1 id=\"Hash-\"><a href=\"#Hash-\" class=\"headerlink\" title=\"Hash \"></a>Hash </h1><p> Hash  Hash Head</p>\n<blockquote>\n<p>Hash = SHA256()</p>\n</blockquote>\n<p> Hash Hash SHA256 Hash </p>\n<p> Hash Hash Hash Hash  Hash </p>\n<p> Hash Hash 51%</p>\n<p></p>\n<p><img src=\"http://s1.wailian.download/2018/01/19/bg2017122705.png\" alt=\"\"><br></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>10</p>\n<p> Hash</p>\n<p>mining Hash  Hash </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Hash </p>\n<p> Hash  Hash  Hash </p>\n<p>difficulty Hash 100000 14484.16236122</p>\n<p><img src=\"http://s1.wailian.download/2018/01/19/bg2017122707.png\" alt=\"\"><br>target</p>\n<p><img src=\"http://s1.wailian.download/2018/01/19/bg2017122708.png\" alt=\"\"></p>\n<p>Hash  Hash  Hash Hash 10</p>\n<p> Nonce  Hash  100000  Nonce 274148111 2.74  Hash</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>2016910%10%1110%10%</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p><img src=\"http://s1.wailian.download/2018/01/19/bg2017122709.png\" alt=\"\"></p>\n<p>610</p>\n<p><img src=\"http://s1.wailian.download/2018/01/19/bg2017122710.png\" alt=\"\"></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>20098</p>\n<p></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<blockquote>\n<p><a href=\"http://www.ruanyifeng.com/blog/2017/12/blockchain-tutorial.html\" target=\"_blank\" rel=\"noopener\"></a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://s1.wailian.download/2018/01/19/f7a1eb169a2ac8556d241cd7173ca9a5d9ede3cb161fa5-eeMK3M_fw658.jpg\" alt=\"pic\"></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p>/</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>block</p>\n<p><img src=\"http://s1.wailian.download/2018/01/19/bg2017122703.png\" alt=\"blockchain\"></p>\n<p></p>\n<ul>\n<li>Head</li>\n<li>Body</li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n<li>Hash</li>\n<li>Hash</li>\n<li></li>\n</ul>\n<p> Hash</p>\n<p><img src=\"http://s1.wailian.download/2018/01/19/bg2017122704.png\" alt=\"hash\"></p>\n<p> Hash  Hash 256256 Hash </p>\n<p>123 Hash a8fdc205a9f19cc1c7507a60c4f01b13d11d7fd0256123 Hash</p>\n<p></p>\n<ul>\n<li> Hash  Hash </li>\n<li> Hash </li>\n</ul>\n<h1 id=\"Hash-\"><a href=\"#Hash-\" class=\"headerlink\" title=\"Hash \"></a>Hash </h1><p> Hash  Hash Head</p>\n<blockquote>\n<p>Hash = SHA256()</p>\n</blockquote>\n<p> Hash Hash SHA256 Hash </p>\n<p> Hash Hash Hash Hash  Hash </p>\n<p> Hash Hash 51%</p>\n<p></p>\n<p><img src=\"http://s1.wailian.download/2018/01/19/bg2017122705.png\" alt=\"\"><br></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>10</p>\n<p> Hash</p>\n<p>mining Hash  Hash </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> Hash </p>\n<p> Hash  Hash  Hash </p>\n<p>difficulty Hash 100000 14484.16236122</p>\n<p><img src=\"http://s1.wailian.download/2018/01/19/bg2017122707.png\" alt=\"\"><br>target</p>\n<p><img src=\"http://s1.wailian.download/2018/01/19/bg2017122708.png\" alt=\"\"></p>\n<p>Hash  Hash  Hash Hash 10</p>\n<p> Nonce  Hash  100000  Nonce 274148111 2.74  Hash</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>2016910%10%1110%10%</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p><img src=\"http://s1.wailian.download/2018/01/19/bg2017122709.png\" alt=\"\"></p>\n<p>610</p>\n<p><img src=\"http://s1.wailian.download/2018/01/19/bg2017122710.png\" alt=\"\"></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>20098</p>\n<p></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<blockquote>\n<p><a href=\"http://www.ruanyifeng.com/blog/2017/12/blockchain-tutorial.html\" target=\"_blank\" rel=\"noopener\"></a></p>\n</blockquote>\n"},{"title":"","date":"2018-02-02T02:40:03.000Z","_content":"![](http://www.wailian.work/images/2018/02/02/61b7aea823aaba020bbe85f9b2cc4deeae67d58f12106-3PVHe7_fw658.jpg)\n\n# DelayQueue\n\nDelayQueueBlockingQueueDelayednull\n\n# \n\n## \n\n\n\n### \n\nDelayQueueDelayed\n\n```\nclass Order implements Delayed {\n\tpublic static AtomicInteger genId = new AtomicInteger(1);\n\n\tprivate final long delay; // \n\tprivate final long expire; // \n\tprivate final long now; // \n\n\tprivate Integer id; // ID\n\tprivate Integer state; // \n\n\tpublic Integer getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(Integer id) {\n\t\tthis.id = id;\n\t}\n\n\tpublic Integer getState() {\n\t\treturn state;\n\t}\n\n\tpublic void setState(Integer state) {\n\t\tthis.state = state;\n\t}\n\n\tpublic Order(long delay, String msg) {\n\t\tthis.delay = delay;\n\t\texpire = System.currentTimeMillis() + delay; //  = +\n\t\tnow = System.currentTimeMillis();\n\n\t\tthis.state = 0;\n\t}\n\n\t/**\n\t *  -\n\t *\n\t * @param unit\n\t * @return\n\t */\n\t@Override\n\tpublic long getDelay(TimeUnit unit) {\n\t\treturn unit.convert(this.expire - System.currentTimeMillis(), TimeUnit.MILLISECONDS);\n\t}\n\n\t/**\n\t *   - \n\t *\n\t * @param o\n\t * @return\n\t */\n\t@Override\n\tpublic int compareTo(Delayed o) {\n\t\treturn (int) (this.getDelay(TimeUnit.MILLISECONDS) - o.getDelay(TimeUnit.MILLISECONDS));\n\t}\n}\n```\n\n### \n\n```\nprivate static void producer(final DelayQueue<Order> delayQueue) {\n    new Thread(new Runnable() {\n        @Override\n        public void run() {\n            while (true) {\n                try {\n                    TimeUnit.MILLISECONDS.sleep(100);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n\n                Order element = new Order(new Random().nextInt(1000) * 10, \"test\");\n\n                element.setId(Order.genId.getAndIncrement());\n\n                delayQueue.offer(element);\n            }\n        }\n    }).start();\n\n    /**\n     * \n     */\n    new Thread(new Runnable() {\n        @Override\n        public void run() {\n            while (true) {\n                try {\n                    TimeUnit.MILLISECONDS.sleep(1000);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                System.out.println(\"delayQueue size:\" + delayQueue.size());\n            }\n        }\n    }).start();\n}\n```\n\n### \n\n```\nprivate static void consumer(final DelayQueue<Order> delayQueue) {\n    new Thread(new Runnable() {\n        @Override\n        public void run() {\n            while (true) {\n                Order element = null;\n                try {\n                    element = delayQueue.take();\n\n                    if (element.getState().intValue() == 0) {\n                        // \n                        element.setState(1);\n\n                        System.out.println(\"\" + element.getId() + \"\");\n                    }\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }).start();\n}\n```\n\nDelayQueue Delayed  poll()  null take() take() \n\n### \n\n```\npublic static void main(String[] args) {\n    DelayQueue<Order> delayQueue = new DelayQueue<Order>();\n\n    // \n    producer(delayQueue);\n\n    // \n    consumer(delayQueue);\n\n    while (true) {\n        try {\n            TimeUnit.HOURS.sleep(1);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n}\n```\n\n![](http://www.wailian.work/images/2018/02/02/WX20180202-110453.png)\n\n## \n\n1. 102\n2. 2-10\n3. \n\nenum\n\n```\nenum Times {\n    SUMMIT_TIME(10), //\n    SUMBMIT_LIMIT(2), // \n    MAX_RAND_TIME(15); // \n\n    private final int value;\n\n    private Times(int value) {\n        this.value = value;\n    }\n\n    public int getValue() {\n        return value;\n    }\n}\n```\n\n### \n\n```\nclass Student implements Delayed {\n    private String name;\n    private long delay; // \n    private long expire; // \n\n    // \n    public Student(String name) {\n        this.name = name;\n        this.delay = TimeUnit.MILLISECONDS.convert(getRandomSeconds(), TimeUnit.SECONDS);\n        this.expire = System.currentTimeMillis() + this.delay;\n    }\n\n    //\n    public Student(String name, long delay, TimeUnit unit) {\n        this.name = name;\n        this.delay = TimeUnit.MILLISECONDS.convert(delay, unit);\n        this.expire = System.currentTimeMillis() + this.delay;\n    }\n\n    // ...\n\n    public int getRandomSeconds() {\n        // 2-10\n        return new Random().nextInt(Times.MAX_RAND_TIME.getValue() - Times.SUMBMIT_LIMIT.getValue())\n                    + Times.SUMBMIT_LIMIT.getValue();\n    }\n    \n    @Override\n    public int compareTo(Delayed o) {\n        // \n        long td = this.getDelay(TimeUnit.MILLISECONDS);\n        long od = o.getDelay(TimeUnit.MILLISECONDS);\n        return td > od ? 1 : td == od ? 0 : -1;\n    }\n\n    @Override\n    public long getDelay(TimeUnit unit) {\n        // 0take()\n        return unit.convert(this.expire - System.currentTimeMillis(), TimeUnit.MILLISECONDS);\n    }\n}\n```\n\n### \n\n1. \n\n```\nDelayQueue<Student> queue = new DelayQueue<>();\n```\n\n2. \n\n```\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"  \"));\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"  \"));\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"\"));\n```\n\n3. \n\n```\nqueue.add(new Student(\"submit\", Times.SUBMIT_TIME.getValue(),TimeUnit.SECONDS));\n```\n\n4. \n\n```\nwhile (true) {\n    Student s = queue.take(); // \n    if (s.getName().equals(\"submit\")) {\n        System.out.println(\"\");\n        // Java8 Stream\n        queue.parallelStream()\n             .filter(v -> v.getExpire() >= s.getExpire())\n             .map(Student::submit)\n             .forEach(System.out::println);\n        System.exit(0);\n    }\n    System.out.println(s);\n}\n```\n\n### \n\n![](http://www.wailian.work/images/2018/02/02/WX20180202-115504.png)\n\n### \n\n```\npackage cn.gss.juc;\n\nimport java.text.DateFormat;\nimport java.util.Date;\nimport java.util.Random;\nimport java.util.concurrent.DelayQueue;\nimport java.util.concurrent.Delayed;\nimport java.util.concurrent.TimeUnit;\n\nenum Times {\n    SUBMIT_TIME(10), SUMBMIT_LIMIT(2), MAX_RAND_TIME(15);\n    private final int value;\n\n    private Times(int value) {\n        this.value = value;\n    }\n\n    public int getValue() {\n        return value;\n    }\n}\n/**\n * DelayQueue\n * @author Gss\n */\npublic class TestDelayedQueue {\n\n    public static void main(String[] args) throws InterruptedException {\n        DelayQueue<Student> queue = new DelayQueue<>();\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"  \"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"  \"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"submit\", Times.SUBMIT_TIME.getValue(), TimeUnit.SECONDS));\n        while (true) {\n            Student s = queue.take(); // \n            if (s.getName().equals(\"submit\")) {\n                System.out.println(\"\");\n                // Java8 Stream\n                queue.parallelStream()\n                     .filter(v -> v.getExpire() >= s.getExpire())\n                     .map(Student::submit)\n                     .forEach(System.out::println);\n                System.exit(0);\n            }\n            System.out.println(s);\n        }\n    }\n\n}\n\nclass Student implements Delayed {\n    private String name;\n    private long delay; // \n    private long expire; // \n\n    // \n    public Student(String name) {\n        this.name = name;\n        this.delay = TimeUnit.MILLISECONDS.convert(getRandomSeconds(), TimeUnit.SECONDS); // \n        this.expire = System.currentTimeMillis() + this.delay;\n    }\n\n    // \n    public Student(String name, long delay, TimeUnit unit) {\n        this.name = name;\n        this.delay = TimeUnit.MILLISECONDS.convert(delay, unit);\n        this.expire = System.currentTimeMillis() + this.delay;\n    }\n\n    public int getRandomSeconds() { // \n        return new Random().nextInt(Times.MAX_RAND_TIME.getValue() - Times.SUMBMIT_LIMIT.getValue())\n                + Times.SUMBMIT_LIMIT.getValue();\n    }\n\n    public Student submit() { // \n        setDelay(Times.SUBMIT_TIME.getValue(), TimeUnit.SECONDS);\n        setExpire(System.currentTimeMillis());\n        return this;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public long getExpire() {\n        return expire;\n    }\n\n    public void setDelay(long delay, TimeUnit unit) {\n        this.delay = TimeUnit.MILLISECONDS.convert(delay, TimeUnit.SECONDS);\n    }\n\n    public void setExpire(long expire) {\n        this.expire = expire;\n    }\n\n    @Override\n    public int compareTo(Delayed o) { // \n        long td = this.getDelay(TimeUnit.MILLISECONDS);\n        long od = o.getDelay(TimeUnit.MILLISECONDS);\n        return td > od ? 1 : td == od ? 0 : -1;\n    }\n\n    @Override\n    public long getDelay(TimeUnit unit) { // 0take()\n        return unit.convert(this.expire - System.currentTimeMillis(), TimeUnit.MILLISECONDS);\n    }\n\n    @Override\n    public String toString() {\n        return \"\" + this.name + \",\" + TimeUnit.SECONDS.convert(delay, TimeUnit.MILLISECONDS) + \",\"\n                + DateFormat.getDateTimeInstance().format(new Date(this.expire));\n    }\n}\n```\n\n# \n\n[GitHub](https://github.com/wangweiye01/DelayQueueTest/tree/master)\n","source":"_posts/delay-queue.md","raw":"---\ntitle: \ndate: 2018-02-02 10:40:03\ntags:\n---\n![](http://www.wailian.work/images/2018/02/02/61b7aea823aaba020bbe85f9b2cc4deeae67d58f12106-3PVHe7_fw658.jpg)\n\n# DelayQueue\n\nDelayQueueBlockingQueueDelayednull\n\n# \n\n## \n\n\n\n### \n\nDelayQueueDelayed\n\n```\nclass Order implements Delayed {\n\tpublic static AtomicInteger genId = new AtomicInteger(1);\n\n\tprivate final long delay; // \n\tprivate final long expire; // \n\tprivate final long now; // \n\n\tprivate Integer id; // ID\n\tprivate Integer state; // \n\n\tpublic Integer getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(Integer id) {\n\t\tthis.id = id;\n\t}\n\n\tpublic Integer getState() {\n\t\treturn state;\n\t}\n\n\tpublic void setState(Integer state) {\n\t\tthis.state = state;\n\t}\n\n\tpublic Order(long delay, String msg) {\n\t\tthis.delay = delay;\n\t\texpire = System.currentTimeMillis() + delay; //  = +\n\t\tnow = System.currentTimeMillis();\n\n\t\tthis.state = 0;\n\t}\n\n\t/**\n\t *  -\n\t *\n\t * @param unit\n\t * @return\n\t */\n\t@Override\n\tpublic long getDelay(TimeUnit unit) {\n\t\treturn unit.convert(this.expire - System.currentTimeMillis(), TimeUnit.MILLISECONDS);\n\t}\n\n\t/**\n\t *   - \n\t *\n\t * @param o\n\t * @return\n\t */\n\t@Override\n\tpublic int compareTo(Delayed o) {\n\t\treturn (int) (this.getDelay(TimeUnit.MILLISECONDS) - o.getDelay(TimeUnit.MILLISECONDS));\n\t}\n}\n```\n\n### \n\n```\nprivate static void producer(final DelayQueue<Order> delayQueue) {\n    new Thread(new Runnable() {\n        @Override\n        public void run() {\n            while (true) {\n                try {\n                    TimeUnit.MILLISECONDS.sleep(100);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n\n                Order element = new Order(new Random().nextInt(1000) * 10, \"test\");\n\n                element.setId(Order.genId.getAndIncrement());\n\n                delayQueue.offer(element);\n            }\n        }\n    }).start();\n\n    /**\n     * \n     */\n    new Thread(new Runnable() {\n        @Override\n        public void run() {\n            while (true) {\n                try {\n                    TimeUnit.MILLISECONDS.sleep(1000);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                System.out.println(\"delayQueue size:\" + delayQueue.size());\n            }\n        }\n    }).start();\n}\n```\n\n### \n\n```\nprivate static void consumer(final DelayQueue<Order> delayQueue) {\n    new Thread(new Runnable() {\n        @Override\n        public void run() {\n            while (true) {\n                Order element = null;\n                try {\n                    element = delayQueue.take();\n\n                    if (element.getState().intValue() == 0) {\n                        // \n                        element.setState(1);\n\n                        System.out.println(\"\" + element.getId() + \"\");\n                    }\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }).start();\n}\n```\n\nDelayQueue Delayed  poll()  null take() take() \n\n### \n\n```\npublic static void main(String[] args) {\n    DelayQueue<Order> delayQueue = new DelayQueue<Order>();\n\n    // \n    producer(delayQueue);\n\n    // \n    consumer(delayQueue);\n\n    while (true) {\n        try {\n            TimeUnit.HOURS.sleep(1);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n}\n```\n\n![](http://www.wailian.work/images/2018/02/02/WX20180202-110453.png)\n\n## \n\n1. 102\n2. 2-10\n3. \n\nenum\n\n```\nenum Times {\n    SUMMIT_TIME(10), //\n    SUMBMIT_LIMIT(2), // \n    MAX_RAND_TIME(15); // \n\n    private final int value;\n\n    private Times(int value) {\n        this.value = value;\n    }\n\n    public int getValue() {\n        return value;\n    }\n}\n```\n\n### \n\n```\nclass Student implements Delayed {\n    private String name;\n    private long delay; // \n    private long expire; // \n\n    // \n    public Student(String name) {\n        this.name = name;\n        this.delay = TimeUnit.MILLISECONDS.convert(getRandomSeconds(), TimeUnit.SECONDS);\n        this.expire = System.currentTimeMillis() + this.delay;\n    }\n\n    //\n    public Student(String name, long delay, TimeUnit unit) {\n        this.name = name;\n        this.delay = TimeUnit.MILLISECONDS.convert(delay, unit);\n        this.expire = System.currentTimeMillis() + this.delay;\n    }\n\n    // ...\n\n    public int getRandomSeconds() {\n        // 2-10\n        return new Random().nextInt(Times.MAX_RAND_TIME.getValue() - Times.SUMBMIT_LIMIT.getValue())\n                    + Times.SUMBMIT_LIMIT.getValue();\n    }\n    \n    @Override\n    public int compareTo(Delayed o) {\n        // \n        long td = this.getDelay(TimeUnit.MILLISECONDS);\n        long od = o.getDelay(TimeUnit.MILLISECONDS);\n        return td > od ? 1 : td == od ? 0 : -1;\n    }\n\n    @Override\n    public long getDelay(TimeUnit unit) {\n        // 0take()\n        return unit.convert(this.expire - System.currentTimeMillis(), TimeUnit.MILLISECONDS);\n    }\n}\n```\n\n### \n\n1. \n\n```\nDelayQueue<Student> queue = new DelayQueue<>();\n```\n\n2. \n\n```\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"  \"));\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"  \"));\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"\"));\nqueue.add(new Student(\"\"));\n```\n\n3. \n\n```\nqueue.add(new Student(\"submit\", Times.SUBMIT_TIME.getValue(),TimeUnit.SECONDS));\n```\n\n4. \n\n```\nwhile (true) {\n    Student s = queue.take(); // \n    if (s.getName().equals(\"submit\")) {\n        System.out.println(\"\");\n        // Java8 Stream\n        queue.parallelStream()\n             .filter(v -> v.getExpire() >= s.getExpire())\n             .map(Student::submit)\n             .forEach(System.out::println);\n        System.exit(0);\n    }\n    System.out.println(s);\n}\n```\n\n### \n\n![](http://www.wailian.work/images/2018/02/02/WX20180202-115504.png)\n\n### \n\n```\npackage cn.gss.juc;\n\nimport java.text.DateFormat;\nimport java.util.Date;\nimport java.util.Random;\nimport java.util.concurrent.DelayQueue;\nimport java.util.concurrent.Delayed;\nimport java.util.concurrent.TimeUnit;\n\nenum Times {\n    SUBMIT_TIME(10), SUMBMIT_LIMIT(2), MAX_RAND_TIME(15);\n    private final int value;\n\n    private Times(int value) {\n        this.value = value;\n    }\n\n    public int getValue() {\n        return value;\n    }\n}\n/**\n * DelayQueue\n * @author Gss\n */\npublic class TestDelayedQueue {\n\n    public static void main(String[] args) throws InterruptedException {\n        DelayQueue<Student> queue = new DelayQueue<>();\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"  \"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"  \"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"\"));\n        queue.add(new Student(\"submit\", Times.SUBMIT_TIME.getValue(), TimeUnit.SECONDS));\n        while (true) {\n            Student s = queue.take(); // \n            if (s.getName().equals(\"submit\")) {\n                System.out.println(\"\");\n                // Java8 Stream\n                queue.parallelStream()\n                     .filter(v -> v.getExpire() >= s.getExpire())\n                     .map(Student::submit)\n                     .forEach(System.out::println);\n                System.exit(0);\n            }\n            System.out.println(s);\n        }\n    }\n\n}\n\nclass Student implements Delayed {\n    private String name;\n    private long delay; // \n    private long expire; // \n\n    // \n    public Student(String name) {\n        this.name = name;\n        this.delay = TimeUnit.MILLISECONDS.convert(getRandomSeconds(), TimeUnit.SECONDS); // \n        this.expire = System.currentTimeMillis() + this.delay;\n    }\n\n    // \n    public Student(String name, long delay, TimeUnit unit) {\n        this.name = name;\n        this.delay = TimeUnit.MILLISECONDS.convert(delay, unit);\n        this.expire = System.currentTimeMillis() + this.delay;\n    }\n\n    public int getRandomSeconds() { // \n        return new Random().nextInt(Times.MAX_RAND_TIME.getValue() - Times.SUMBMIT_LIMIT.getValue())\n                + Times.SUMBMIT_LIMIT.getValue();\n    }\n\n    public Student submit() { // \n        setDelay(Times.SUBMIT_TIME.getValue(), TimeUnit.SECONDS);\n        setExpire(System.currentTimeMillis());\n        return this;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public long getExpire() {\n        return expire;\n    }\n\n    public void setDelay(long delay, TimeUnit unit) {\n        this.delay = TimeUnit.MILLISECONDS.convert(delay, TimeUnit.SECONDS);\n    }\n\n    public void setExpire(long expire) {\n        this.expire = expire;\n    }\n\n    @Override\n    public int compareTo(Delayed o) { // \n        long td = this.getDelay(TimeUnit.MILLISECONDS);\n        long od = o.getDelay(TimeUnit.MILLISECONDS);\n        return td > od ? 1 : td == od ? 0 : -1;\n    }\n\n    @Override\n    public long getDelay(TimeUnit unit) { // 0take()\n        return unit.convert(this.expire - System.currentTimeMillis(), TimeUnit.MILLISECONDS);\n    }\n\n    @Override\n    public String toString() {\n        return \"\" + this.name + \",\" + TimeUnit.SECONDS.convert(delay, TimeUnit.MILLISECONDS) + \",\"\n                + DateFormat.getDateTimeInstance().format(new Date(this.expire));\n    }\n}\n```\n\n# \n\n[GitHub](https://github.com/wangweiye01/DelayQueueTest/tree/master)\n","slug":"delay-queue","published":1,"updated":"2019-12-24T02:00:57.340Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3k3d00210j9ktzew57wm","content":"<p><img src=\"http://www.wailian.work/images/2018/02/02/61b7aea823aaba020bbe85f9b2cc4deeae67d58f12106-3PVHe7_fw658.jpg\" alt=\"\"></p>\n<h1 id=\"DelayQueue\"><a href=\"#DelayQueue\" class=\"headerlink\" title=\"DelayQueue\"></a>DelayQueue</h1><p>DelayQueueBlockingQueueDelayednull</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>DelayQueueDelayed</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class Order implements Delayed &#123;</span><br><span class=\"line\">\tpublic static AtomicInteger genId = new AtomicInteger(1);</span><br><span class=\"line\"></span><br><span class=\"line\">\tprivate final long delay; // </span><br><span class=\"line\">\tprivate final long expire; // </span><br><span class=\"line\">\tprivate final long now; // </span><br><span class=\"line\"></span><br><span class=\"line\">\tprivate Integer id; // ID</span><br><span class=\"line\">\tprivate Integer state; // </span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic Integer getId() &#123;</span><br><span class=\"line\">\t\treturn id;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic void setId(Integer id) &#123;</span><br><span class=\"line\">\t\tthis.id = id;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic Integer getState() &#123;</span><br><span class=\"line\">\t\treturn state;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic void setState(Integer state) &#123;</span><br><span class=\"line\">\t\tthis.state = state;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic Order(long delay, String msg) &#123;</span><br><span class=\"line\">\t\tthis.delay = delay;</span><br><span class=\"line\">\t\texpire = System.currentTimeMillis() + delay; //  = +</span><br><span class=\"line\">\t\tnow = System.currentTimeMillis();</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tthis.state = 0;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t/**</span><br><span class=\"line\">\t *  -</span><br><span class=\"line\">\t *</span><br><span class=\"line\">\t * @param unit</span><br><span class=\"line\">\t * @return</span><br><span class=\"line\">\t */</span><br><span class=\"line\">\t@Override</span><br><span class=\"line\">\tpublic long getDelay(TimeUnit unit) &#123;</span><br><span class=\"line\">\t\treturn unit.convert(this.expire - System.currentTimeMillis(), TimeUnit.MILLISECONDS);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t/**</span><br><span class=\"line\">\t *   - </span><br><span class=\"line\">\t *</span><br><span class=\"line\">\t * @param o</span><br><span class=\"line\">\t * @return</span><br><span class=\"line\">\t */</span><br><span class=\"line\">\t@Override</span><br><span class=\"line\">\tpublic int compareTo(Delayed o) &#123;</span><br><span class=\"line\">\t\treturn (int) (this.getDelay(TimeUnit.MILLISECONDS) - o.getDelay(TimeUnit.MILLISECONDS));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">private static void producer(final DelayQueue&lt;Order&gt; delayQueue) &#123;</span><br><span class=\"line\">    new Thread(new Runnable() &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void run() &#123;</span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    TimeUnit.MILLISECONDS.sleep(100);</span><br><span class=\"line\">                &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                Order element = new Order(new Random().nextInt(1000) * 10, &quot;test&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">                element.setId(Order.genId.getAndIncrement());</span><br><span class=\"line\"></span><br><span class=\"line\">                delayQueue.offer(element);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;).start();</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * </span><br><span class=\"line\">     */</span><br><span class=\"line\">    new Thread(new Runnable() &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void run() &#123;</span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    TimeUnit.MILLISECONDS.sleep(1000);</span><br><span class=\"line\">                &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(&quot;delayQueue size:&quot; + delayQueue.size());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">private static void consumer(final DelayQueue&lt;Order&gt; delayQueue) &#123;</span><br><span class=\"line\">    new Thread(new Runnable() &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void run() &#123;</span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                Order element = null;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    element = delayQueue.take();</span><br><span class=\"line\"></span><br><span class=\"line\">                    if (element.getState().intValue() == 0) &#123;</span><br><span class=\"line\">                        // </span><br><span class=\"line\">                        element.setState(1);</span><br><span class=\"line\"></span><br><span class=\"line\">                        System.out.println(&quot;&quot; + element.getId() + &quot;&quot;);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>DelayQueue Delayed  poll()  null take() take() </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public static void main(String[] args) &#123;</span><br><span class=\"line\">    DelayQueue&lt;Order&gt; delayQueue = new DelayQueue&lt;Order&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    producer(delayQueue);</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    consumer(delayQueue);</span><br><span class=\"line\"></span><br><span class=\"line\">    while (true) &#123;</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            TimeUnit.HOURS.sleep(1);</span><br><span class=\"line\">        &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://www.wailian.work/images/2018/02/02/WX20180202-110453.png\" alt=\"\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li>102</li>\n<li>2-10</li>\n<li></li>\n</ol>\n<p>enum</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">enum Times &#123;</span><br><span class=\"line\">    SUMMIT_TIME(10), //</span><br><span class=\"line\">    SUMBMIT_LIMIT(2), // </span><br><span class=\"line\">    MAX_RAND_TIME(15); // </span><br><span class=\"line\"></span><br><span class=\"line\">    private final int value;</span><br><span class=\"line\"></span><br><span class=\"line\">    private Times(int value) &#123;</span><br><span class=\"line\">        this.value = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public int getValue() &#123;</span><br><span class=\"line\">        return value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class Student implements Delayed &#123;</span><br><span class=\"line\">    private String name;</span><br><span class=\"line\">    private long delay; // </span><br><span class=\"line\">    private long expire; // </span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    public Student(String name) &#123;</span><br><span class=\"line\">        this.name = name;</span><br><span class=\"line\">        this.delay = TimeUnit.MILLISECONDS.convert(getRandomSeconds(), TimeUnit.SECONDS);</span><br><span class=\"line\">        this.expire = System.currentTimeMillis() + this.delay;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    public Student(String name, long delay, TimeUnit unit) &#123;</span><br><span class=\"line\">        this.name = name;</span><br><span class=\"line\">        this.delay = TimeUnit.MILLISECONDS.convert(delay, unit);</span><br><span class=\"line\">        this.expire = System.currentTimeMillis() + this.delay;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // ...</span><br><span class=\"line\"></span><br><span class=\"line\">    public int getRandomSeconds() &#123;</span><br><span class=\"line\">        // 2-10</span><br><span class=\"line\">        return new Random().nextInt(Times.MAX_RAND_TIME.getValue() - Times.SUMBMIT_LIMIT.getValue())</span><br><span class=\"line\">                    + Times.SUMBMIT_LIMIT.getValue();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public int compareTo(Delayed o) &#123;</span><br><span class=\"line\">        // </span><br><span class=\"line\">        long td = this.getDelay(TimeUnit.MILLISECONDS);</span><br><span class=\"line\">        long od = o.getDelay(TimeUnit.MILLISECONDS);</span><br><span class=\"line\">        return td &gt; od ? 1 : td == od ? 0 : -1;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public long getDelay(TimeUnit unit) &#123;</span><br><span class=\"line\">        // 0take()</span><br><span class=\"line\">        return unit.convert(this.expire - System.currentTimeMillis(), TimeUnit.MILLISECONDS);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DelayQueue&lt;Student&gt; queue = new DelayQueue&lt;&gt;();</span><br></pre></td></tr></table></figure>\n<ol>\n<li></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;  &quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;  &quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br></pre></td></tr></table></figure>\n<ol>\n<li></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">queue.add(new Student(&quot;submit&quot;, Times.SUBMIT_TIME.getValue(),TimeUnit.SECONDS));</span><br></pre></td></tr></table></figure>\n<ol>\n<li></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">while (true) &#123;</span><br><span class=\"line\">    Student s = queue.take(); // </span><br><span class=\"line\">    if (s.getName().equals(&quot;submit&quot;)) &#123;</span><br><span class=\"line\">        System.out.println(&quot;&quot;);</span><br><span class=\"line\">        // Java8 Stream</span><br><span class=\"line\">        queue.parallelStream()</span><br><span class=\"line\">             .filter(v -&gt; v.getExpire() &gt;= s.getExpire())</span><br><span class=\"line\">             .map(Student::submit)</span><br><span class=\"line\">             .forEach(System.out::println);</span><br><span class=\"line\">        System.exit(0);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.out.println(s);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"http://www.wailian.work/images/2018/02/02/WX20180202-115504.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package cn.gss.juc;</span><br><span class=\"line\"></span><br><span class=\"line\">import java.text.DateFormat;</span><br><span class=\"line\">import java.util.Date;</span><br><span class=\"line\">import java.util.Random;</span><br><span class=\"line\">import java.util.concurrent.DelayQueue;</span><br><span class=\"line\">import java.util.concurrent.Delayed;</span><br><span class=\"line\">import java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\">enum Times &#123;</span><br><span class=\"line\">    SUBMIT_TIME(10), SUMBMIT_LIMIT(2), MAX_RAND_TIME(15);</span><br><span class=\"line\">    private final int value;</span><br><span class=\"line\"></span><br><span class=\"line\">    private Times(int value) &#123;</span><br><span class=\"line\">        this.value = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public int getValue() &#123;</span><br><span class=\"line\">        return value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">/**</span><br><span class=\"line\"> * DelayQueue</span><br><span class=\"line\"> * @author Gss</span><br><span class=\"line\"> */</span><br><span class=\"line\">public class TestDelayedQueue &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) throws InterruptedException &#123;</span><br><span class=\"line\">        DelayQueue&lt;Student&gt; queue = new DelayQueue&lt;&gt;();</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;  &quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;  &quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;submit&quot;, Times.SUBMIT_TIME.getValue(), TimeUnit.SECONDS));</span><br><span class=\"line\">        while (true) &#123;</span><br><span class=\"line\">            Student s = queue.take(); // </span><br><span class=\"line\">            if (s.getName().equals(&quot;submit&quot;)) &#123;</span><br><span class=\"line\">                System.out.println(&quot;&quot;);</span><br><span class=\"line\">                // Java8 Stream</span><br><span class=\"line\">                queue.parallelStream()</span><br><span class=\"line\">                     .filter(v -&gt; v.getExpire() &gt;= s.getExpire())</span><br><span class=\"line\">                     .map(Student::submit)</span><br><span class=\"line\">                     .forEach(System.out::println);</span><br><span class=\"line\">                System.exit(0);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(s);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Student implements Delayed &#123;</span><br><span class=\"line\">    private String name;</span><br><span class=\"line\">    private long delay; // </span><br><span class=\"line\">    private long expire; // </span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    public Student(String name) &#123;</span><br><span class=\"line\">        this.name = name;</span><br><span class=\"line\">        this.delay = TimeUnit.MILLISECONDS.convert(getRandomSeconds(), TimeUnit.SECONDS); // </span><br><span class=\"line\">        this.expire = System.currentTimeMillis() + this.delay;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    public Student(String name, long delay, TimeUnit unit) &#123;</span><br><span class=\"line\">        this.name = name;</span><br><span class=\"line\">        this.delay = TimeUnit.MILLISECONDS.convert(delay, unit);</span><br><span class=\"line\">        this.expire = System.currentTimeMillis() + this.delay;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public int getRandomSeconds() &#123; // </span><br><span class=\"line\">        return new Random().nextInt(Times.MAX_RAND_TIME.getValue() - Times.SUMBMIT_LIMIT.getValue())</span><br><span class=\"line\">                + Times.SUMBMIT_LIMIT.getValue();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public Student submit() &#123; // </span><br><span class=\"line\">        setDelay(Times.SUBMIT_TIME.getValue(), TimeUnit.SECONDS);</span><br><span class=\"line\">        setExpire(System.currentTimeMillis());</span><br><span class=\"line\">        return this;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public String getName() &#123;</span><br><span class=\"line\">        return name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public long getExpire() &#123;</span><br><span class=\"line\">        return expire;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void setDelay(long delay, TimeUnit unit) &#123;</span><br><span class=\"line\">        this.delay = TimeUnit.MILLISECONDS.convert(delay, TimeUnit.SECONDS);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void setExpire(long expire) &#123;</span><br><span class=\"line\">        this.expire = expire;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public int compareTo(Delayed o) &#123; // </span><br><span class=\"line\">        long td = this.getDelay(TimeUnit.MILLISECONDS);</span><br><span class=\"line\">        long od = o.getDelay(TimeUnit.MILLISECONDS);</span><br><span class=\"line\">        return td &gt; od ? 1 : td == od ? 0 : -1;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public long getDelay(TimeUnit unit) &#123; // 0take()</span><br><span class=\"line\">        return unit.convert(this.expire - System.currentTimeMillis(), TimeUnit.MILLISECONDS);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public String toString() &#123;</span><br><span class=\"line\">        return &quot;&quot; + this.name + &quot;,&quot; + TimeUnit.SECONDS.convert(delay, TimeUnit.MILLISECONDS) + &quot;,&quot;</span><br><span class=\"line\">                + DateFormat.getDateTimeInstance().format(new Date(this.expire));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><a href=\"https://github.com/wangweiye01/DelayQueueTest/tree/master\" target=\"_blank\" rel=\"noopener\">GitHub</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/02/02/61b7aea823aaba020bbe85f9b2cc4deeae67d58f12106-3PVHe7_fw658.jpg\" alt=\"\"></p>\n<h1 id=\"DelayQueue\"><a href=\"#DelayQueue\" class=\"headerlink\" title=\"DelayQueue\"></a>DelayQueue</h1><p>DelayQueueBlockingQueueDelayednull</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>DelayQueueDelayed</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class Order implements Delayed &#123;</span><br><span class=\"line\">\tpublic static AtomicInteger genId = new AtomicInteger(1);</span><br><span class=\"line\"></span><br><span class=\"line\">\tprivate final long delay; // </span><br><span class=\"line\">\tprivate final long expire; // </span><br><span class=\"line\">\tprivate final long now; // </span><br><span class=\"line\"></span><br><span class=\"line\">\tprivate Integer id; // ID</span><br><span class=\"line\">\tprivate Integer state; // </span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic Integer getId() &#123;</span><br><span class=\"line\">\t\treturn id;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic void setId(Integer id) &#123;</span><br><span class=\"line\">\t\tthis.id = id;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic Integer getState() &#123;</span><br><span class=\"line\">\t\treturn state;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic void setState(Integer state) &#123;</span><br><span class=\"line\">\t\tthis.state = state;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpublic Order(long delay, String msg) &#123;</span><br><span class=\"line\">\t\tthis.delay = delay;</span><br><span class=\"line\">\t\texpire = System.currentTimeMillis() + delay; //  = +</span><br><span class=\"line\">\t\tnow = System.currentTimeMillis();</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tthis.state = 0;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t/**</span><br><span class=\"line\">\t *  -</span><br><span class=\"line\">\t *</span><br><span class=\"line\">\t * @param unit</span><br><span class=\"line\">\t * @return</span><br><span class=\"line\">\t */</span><br><span class=\"line\">\t@Override</span><br><span class=\"line\">\tpublic long getDelay(TimeUnit unit) &#123;</span><br><span class=\"line\">\t\treturn unit.convert(this.expire - System.currentTimeMillis(), TimeUnit.MILLISECONDS);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t/**</span><br><span class=\"line\">\t *   - </span><br><span class=\"line\">\t *</span><br><span class=\"line\">\t * @param o</span><br><span class=\"line\">\t * @return</span><br><span class=\"line\">\t */</span><br><span class=\"line\">\t@Override</span><br><span class=\"line\">\tpublic int compareTo(Delayed o) &#123;</span><br><span class=\"line\">\t\treturn (int) (this.getDelay(TimeUnit.MILLISECONDS) - o.getDelay(TimeUnit.MILLISECONDS));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">private static void producer(final DelayQueue&lt;Order&gt; delayQueue) &#123;</span><br><span class=\"line\">    new Thread(new Runnable() &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void run() &#123;</span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    TimeUnit.MILLISECONDS.sleep(100);</span><br><span class=\"line\">                &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                Order element = new Order(new Random().nextInt(1000) * 10, &quot;test&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">                element.setId(Order.genId.getAndIncrement());</span><br><span class=\"line\"></span><br><span class=\"line\">                delayQueue.offer(element);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;).start();</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * </span><br><span class=\"line\">     */</span><br><span class=\"line\">    new Thread(new Runnable() &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void run() &#123;</span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    TimeUnit.MILLISECONDS.sleep(1000);</span><br><span class=\"line\">                &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(&quot;delayQueue size:&quot; + delayQueue.size());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">private static void consumer(final DelayQueue&lt;Order&gt; delayQueue) &#123;</span><br><span class=\"line\">    new Thread(new Runnable() &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void run() &#123;</span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                Order element = null;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    element = delayQueue.take();</span><br><span class=\"line\"></span><br><span class=\"line\">                    if (element.getState().intValue() == 0) &#123;</span><br><span class=\"line\">                        // </span><br><span class=\"line\">                        element.setState(1);</span><br><span class=\"line\"></span><br><span class=\"line\">                        System.out.println(&quot;&quot; + element.getId() + &quot;&quot;);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>DelayQueue Delayed  poll()  null take() take() </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public static void main(String[] args) &#123;</span><br><span class=\"line\">    DelayQueue&lt;Order&gt; delayQueue = new DelayQueue&lt;Order&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    producer(delayQueue);</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    consumer(delayQueue);</span><br><span class=\"line\"></span><br><span class=\"line\">    while (true) &#123;</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            TimeUnit.HOURS.sleep(1);</span><br><span class=\"line\">        &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://www.wailian.work/images/2018/02/02/WX20180202-110453.png\" alt=\"\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li>102</li>\n<li>2-10</li>\n<li></li>\n</ol>\n<p>enum</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">enum Times &#123;</span><br><span class=\"line\">    SUMMIT_TIME(10), //</span><br><span class=\"line\">    SUMBMIT_LIMIT(2), // </span><br><span class=\"line\">    MAX_RAND_TIME(15); // </span><br><span class=\"line\"></span><br><span class=\"line\">    private final int value;</span><br><span class=\"line\"></span><br><span class=\"line\">    private Times(int value) &#123;</span><br><span class=\"line\">        this.value = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public int getValue() &#123;</span><br><span class=\"line\">        return value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class Student implements Delayed &#123;</span><br><span class=\"line\">    private String name;</span><br><span class=\"line\">    private long delay; // </span><br><span class=\"line\">    private long expire; // </span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    public Student(String name) &#123;</span><br><span class=\"line\">        this.name = name;</span><br><span class=\"line\">        this.delay = TimeUnit.MILLISECONDS.convert(getRandomSeconds(), TimeUnit.SECONDS);</span><br><span class=\"line\">        this.expire = System.currentTimeMillis() + this.delay;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    public Student(String name, long delay, TimeUnit unit) &#123;</span><br><span class=\"line\">        this.name = name;</span><br><span class=\"line\">        this.delay = TimeUnit.MILLISECONDS.convert(delay, unit);</span><br><span class=\"line\">        this.expire = System.currentTimeMillis() + this.delay;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // ...</span><br><span class=\"line\"></span><br><span class=\"line\">    public int getRandomSeconds() &#123;</span><br><span class=\"line\">        // 2-10</span><br><span class=\"line\">        return new Random().nextInt(Times.MAX_RAND_TIME.getValue() - Times.SUMBMIT_LIMIT.getValue())</span><br><span class=\"line\">                    + Times.SUMBMIT_LIMIT.getValue();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public int compareTo(Delayed o) &#123;</span><br><span class=\"line\">        // </span><br><span class=\"line\">        long td = this.getDelay(TimeUnit.MILLISECONDS);</span><br><span class=\"line\">        long od = o.getDelay(TimeUnit.MILLISECONDS);</span><br><span class=\"line\">        return td &gt; od ? 1 : td == od ? 0 : -1;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public long getDelay(TimeUnit unit) &#123;</span><br><span class=\"line\">        // 0take()</span><br><span class=\"line\">        return unit.convert(this.expire - System.currentTimeMillis(), TimeUnit.MILLISECONDS);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DelayQueue&lt;Student&gt; queue = new DelayQueue&lt;&gt;();</span><br></pre></td></tr></table></figure>\n<ol>\n<li></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;  &quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;  &quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">queue.add(new Student(&quot;&quot;));</span><br></pre></td></tr></table></figure>\n<ol>\n<li></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">queue.add(new Student(&quot;submit&quot;, Times.SUBMIT_TIME.getValue(),TimeUnit.SECONDS));</span><br></pre></td></tr></table></figure>\n<ol>\n<li></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">while (true) &#123;</span><br><span class=\"line\">    Student s = queue.take(); // </span><br><span class=\"line\">    if (s.getName().equals(&quot;submit&quot;)) &#123;</span><br><span class=\"line\">        System.out.println(&quot;&quot;);</span><br><span class=\"line\">        // Java8 Stream</span><br><span class=\"line\">        queue.parallelStream()</span><br><span class=\"line\">             .filter(v -&gt; v.getExpire() &gt;= s.getExpire())</span><br><span class=\"line\">             .map(Student::submit)</span><br><span class=\"line\">             .forEach(System.out::println);</span><br><span class=\"line\">        System.exit(0);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.out.println(s);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"http://www.wailian.work/images/2018/02/02/WX20180202-115504.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package cn.gss.juc;</span><br><span class=\"line\"></span><br><span class=\"line\">import java.text.DateFormat;</span><br><span class=\"line\">import java.util.Date;</span><br><span class=\"line\">import java.util.Random;</span><br><span class=\"line\">import java.util.concurrent.DelayQueue;</span><br><span class=\"line\">import java.util.concurrent.Delayed;</span><br><span class=\"line\">import java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\">enum Times &#123;</span><br><span class=\"line\">    SUBMIT_TIME(10), SUMBMIT_LIMIT(2), MAX_RAND_TIME(15);</span><br><span class=\"line\">    private final int value;</span><br><span class=\"line\"></span><br><span class=\"line\">    private Times(int value) &#123;</span><br><span class=\"line\">        this.value = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public int getValue() &#123;</span><br><span class=\"line\">        return value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">/**</span><br><span class=\"line\"> * DelayQueue</span><br><span class=\"line\"> * @author Gss</span><br><span class=\"line\"> */</span><br><span class=\"line\">public class TestDelayedQueue &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) throws InterruptedException &#123;</span><br><span class=\"line\">        DelayQueue&lt;Student&gt; queue = new DelayQueue&lt;&gt;();</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;  &quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;  &quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;&quot;));</span><br><span class=\"line\">        queue.add(new Student(&quot;submit&quot;, Times.SUBMIT_TIME.getValue(), TimeUnit.SECONDS));</span><br><span class=\"line\">        while (true) &#123;</span><br><span class=\"line\">            Student s = queue.take(); // </span><br><span class=\"line\">            if (s.getName().equals(&quot;submit&quot;)) &#123;</span><br><span class=\"line\">                System.out.println(&quot;&quot;);</span><br><span class=\"line\">                // Java8 Stream</span><br><span class=\"line\">                queue.parallelStream()</span><br><span class=\"line\">                     .filter(v -&gt; v.getExpire() &gt;= s.getExpire())</span><br><span class=\"line\">                     .map(Student::submit)</span><br><span class=\"line\">                     .forEach(System.out::println);</span><br><span class=\"line\">                System.exit(0);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(s);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Student implements Delayed &#123;</span><br><span class=\"line\">    private String name;</span><br><span class=\"line\">    private long delay; // </span><br><span class=\"line\">    private long expire; // </span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    public Student(String name) &#123;</span><br><span class=\"line\">        this.name = name;</span><br><span class=\"line\">        this.delay = TimeUnit.MILLISECONDS.convert(getRandomSeconds(), TimeUnit.SECONDS); // </span><br><span class=\"line\">        this.expire = System.currentTimeMillis() + this.delay;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    public Student(String name, long delay, TimeUnit unit) &#123;</span><br><span class=\"line\">        this.name = name;</span><br><span class=\"line\">        this.delay = TimeUnit.MILLISECONDS.convert(delay, unit);</span><br><span class=\"line\">        this.expire = System.currentTimeMillis() + this.delay;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public int getRandomSeconds() &#123; // </span><br><span class=\"line\">        return new Random().nextInt(Times.MAX_RAND_TIME.getValue() - Times.SUMBMIT_LIMIT.getValue())</span><br><span class=\"line\">                + Times.SUMBMIT_LIMIT.getValue();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public Student submit() &#123; // </span><br><span class=\"line\">        setDelay(Times.SUBMIT_TIME.getValue(), TimeUnit.SECONDS);</span><br><span class=\"line\">        setExpire(System.currentTimeMillis());</span><br><span class=\"line\">        return this;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public String getName() &#123;</span><br><span class=\"line\">        return name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public long getExpire() &#123;</span><br><span class=\"line\">        return expire;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void setDelay(long delay, TimeUnit unit) &#123;</span><br><span class=\"line\">        this.delay = TimeUnit.MILLISECONDS.convert(delay, TimeUnit.SECONDS);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void setExpire(long expire) &#123;</span><br><span class=\"line\">        this.expire = expire;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public int compareTo(Delayed o) &#123; // </span><br><span class=\"line\">        long td = this.getDelay(TimeUnit.MILLISECONDS);</span><br><span class=\"line\">        long od = o.getDelay(TimeUnit.MILLISECONDS);</span><br><span class=\"line\">        return td &gt; od ? 1 : td == od ? 0 : -1;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public long getDelay(TimeUnit unit) &#123; // 0take()</span><br><span class=\"line\">        return unit.convert(this.expire - System.currentTimeMillis(), TimeUnit.MILLISECONDS);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public String toString() &#123;</span><br><span class=\"line\">        return &quot;&quot; + this.name + &quot;,&quot; + TimeUnit.SECONDS.convert(delay, TimeUnit.MILLISECONDS) + &quot;,&quot;</span><br><span class=\"line\">                + DateFormat.getDateTimeInstance().format(new Date(this.expire));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><a href=\"https://github.com/wangweiye01/DelayQueueTest/tree/master\" target=\"_blank\" rel=\"noopener\">GitHub</a></p>\n"},{"title":"-","date":"2018-06-08T07:27:38.000Z","top":111,"_content":"\n# \n\n---\n\n\n\n\n\n# \n\n\n\n# \n\n![](http://www.wailian.work/images/2018/06/08/20130626145005968.jpg)\n\nObservableObservernotifyObserversObserverObserver\n\n\n\n# \n\nJAVA\n\n:\n\n```\n // \npublic interface Observer {\n    void update(Observable o);\n}\n```\n\n\n\n```\npublic class ConcreteObserver1 implements Observer {\n    @Override\n    public void update(Observable o) {\n        System.out.println(\"1\" + o.getClass().getSimpleName() + \"\");\n        System.out.println(\"1\");\n    }\n}\n```\n\n```\npublic class ConcreteObserver2 implements Observer {\n    @Override\n    public void update(Observable o) {\n        System.out.println(\"2\" + o.getClass().getSimpleName() + \"\");\n        System.out.println(\"2\");\n    }\n}\n```\n\nupdate\n\n```\npublic class Observable {\n    List<Observer> observers = new ArrayList<>();\n\n    public void addObserver(Observer o) {\n        observers.add(o);\n    }\n\n    public void changed() {\n        System.out.println(\"====\");\n\n        // \n        notifyObservers();\n    }\n\n    public void notifyObservers() {\n        for (Observer observer : observers) {\n            observer.update(this);\n        }\n    }\n}\n```\n\n\n\n\n\n```\npublic void testObserver() {\n    Observable observable = new Observable();\n    observable.addObserver(new ConcreteObserver1());\n    observable.addObserver(new ConcreteObserver2());\n\n    observable.changed();\n}\n```\n\n\n\n![](http://www.wailian.work/images/2018/06/08/WX20180608-154314.png)\n\nchanged\n\n\n\n\n\n```\nimport java.util.Observable;\nimport java.util.Observer;\n\npublic class Reader implements Observer {\n    private String name;\n\n    public Reader(String name) {\n        super();\n        this.name = name;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    // \n    @Override\n        public void update(Observable o, Object arg) {\n            if (o instanceof Writer) {\n                Writer writer = (Writer) o;\n                System.out.println(name + \"\" + writer.getName() + \"\" + writer.getLastNovel() + \"\");\n            }\n        }\n\n    //\n    public void subscribe(String writerName) {\n        WriterManager.getInstance().getWriter(writerName).addObserver(this);\n    }\n\n    //\n    public void unsubscribe(String writerName) {\n        WriterManager.getInstance().getWriter(writerName).deleteObserver(this);\n    }\n}\n```\n\n\n\n```\nimport java.util.Observable;\n\npublic class Writer extends Observable {\n    private String name; // \n\n    private String lastNovel; //\n\n    public String getName() {\n        return this.name;\n    }\n\n    public Writer(String name) {\n        super();\n        this.name = name;\n        WriterManager.getInstance().add(this);\n    }\n\n    // \n    public void addNovel(String novel) {\n        System.out.println(name + \"\" + novel + \"\");\n\n        lastNovel = novel;\n\n        setChanged();\n\n        notifyObservers();\n    }\n\n    public String getLastNovel() {\n        return this.lastNovel;\n    }\n}\n```\n\n\n\n```\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class WriterManager {\n    private static WriterManager writerManager;\n\n    private Map<String, Writer> writerMap = new HashMap<>();\n\n    // \n    public void add(Writer writer) {\n        writerMap.put(writer.getName(), writer);\n    }\n\n    // \n    public Writer getWriter(String name) {\n        return writerMap.get(name);\n    }\n\n    // ()\n    private WriterManager() {\n\n    }\n\n    public static WriterManager getInstance() {\n        if (writerManager == null) {\n            synchronized (WriterManager.class) {\n                if (writerManager == null) {\n                    writerManager = new WriterManager();\n                }\n            }\n        }\n\n        return writerManager;\n    }\n}\n```\n\n DEMO\n\n ```\n public void testJdkObserver() {\n     //\n     Reader r1 = new Reader(\"\");\n     Reader r2 = new Reader(\"\");\n     Reader r3 = new Reader(\"\");\n     Reader r4 = new Reader(\"\");\n     Writer w1 = new Writer(\"\");\n     Writer w2 = new Writer(\"\");\n     //\n     r1.subscribe(\"\");\n     r2.subscribe(\"\");\n     r3.subscribe(\"\");\n     r4.subscribe(\"\");\n     //\n     r3.subscribe(\"\");\n     r4.subscribe(\"\");\n\n     //\n     //\n     w1.addNovel(\"\");\n     //JAVA\n     w2.addNovel(\"JAVA\");\n     //\n     r1.unsubscribe(\"\");\n     //\n     w1.addNovel(\"\");\n }\n ```\n\n ![](http://www.wailian.work/images/2018/06/08/121313.png)\n\n\n\nNN\n\n\n\n***\n\nzuoxiaolong\n\n--http://www.cnblogs.com/zuoxiaolong\n\n\n\n\n","source":"_posts/observer.md","raw":"---\ntitle: -\ndate: 2018-06-08 15:27:38\ntags:\ntop: 111\ncategories: \n---\n\n# \n\n---\n\n\n\n\n\n# \n\n\n\n# \n\n![](http://www.wailian.work/images/2018/06/08/20130626145005968.jpg)\n\nObservableObservernotifyObserversObserverObserver\n\n\n\n# \n\nJAVA\n\n:\n\n```\n // \npublic interface Observer {\n    void update(Observable o);\n}\n```\n\n\n\n```\npublic class ConcreteObserver1 implements Observer {\n    @Override\n    public void update(Observable o) {\n        System.out.println(\"1\" + o.getClass().getSimpleName() + \"\");\n        System.out.println(\"1\");\n    }\n}\n```\n\n```\npublic class ConcreteObserver2 implements Observer {\n    @Override\n    public void update(Observable o) {\n        System.out.println(\"2\" + o.getClass().getSimpleName() + \"\");\n        System.out.println(\"2\");\n    }\n}\n```\n\nupdate\n\n```\npublic class Observable {\n    List<Observer> observers = new ArrayList<>();\n\n    public void addObserver(Observer o) {\n        observers.add(o);\n    }\n\n    public void changed() {\n        System.out.println(\"====\");\n\n        // \n        notifyObservers();\n    }\n\n    public void notifyObservers() {\n        for (Observer observer : observers) {\n            observer.update(this);\n        }\n    }\n}\n```\n\n\n\n\n\n```\npublic void testObserver() {\n    Observable observable = new Observable();\n    observable.addObserver(new ConcreteObserver1());\n    observable.addObserver(new ConcreteObserver2());\n\n    observable.changed();\n}\n```\n\n\n\n![](http://www.wailian.work/images/2018/06/08/WX20180608-154314.png)\n\nchanged\n\n\n\n\n\n```\nimport java.util.Observable;\nimport java.util.Observer;\n\npublic class Reader implements Observer {\n    private String name;\n\n    public Reader(String name) {\n        super();\n        this.name = name;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    // \n    @Override\n        public void update(Observable o, Object arg) {\n            if (o instanceof Writer) {\n                Writer writer = (Writer) o;\n                System.out.println(name + \"\" + writer.getName() + \"\" + writer.getLastNovel() + \"\");\n            }\n        }\n\n    //\n    public void subscribe(String writerName) {\n        WriterManager.getInstance().getWriter(writerName).addObserver(this);\n    }\n\n    //\n    public void unsubscribe(String writerName) {\n        WriterManager.getInstance().getWriter(writerName).deleteObserver(this);\n    }\n}\n```\n\n\n\n```\nimport java.util.Observable;\n\npublic class Writer extends Observable {\n    private String name; // \n\n    private String lastNovel; //\n\n    public String getName() {\n        return this.name;\n    }\n\n    public Writer(String name) {\n        super();\n        this.name = name;\n        WriterManager.getInstance().add(this);\n    }\n\n    // \n    public void addNovel(String novel) {\n        System.out.println(name + \"\" + novel + \"\");\n\n        lastNovel = novel;\n\n        setChanged();\n\n        notifyObservers();\n    }\n\n    public String getLastNovel() {\n        return this.lastNovel;\n    }\n}\n```\n\n\n\n```\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class WriterManager {\n    private static WriterManager writerManager;\n\n    private Map<String, Writer> writerMap = new HashMap<>();\n\n    // \n    public void add(Writer writer) {\n        writerMap.put(writer.getName(), writer);\n    }\n\n    // \n    public Writer getWriter(String name) {\n        return writerMap.get(name);\n    }\n\n    // ()\n    private WriterManager() {\n\n    }\n\n    public static WriterManager getInstance() {\n        if (writerManager == null) {\n            synchronized (WriterManager.class) {\n                if (writerManager == null) {\n                    writerManager = new WriterManager();\n                }\n            }\n        }\n\n        return writerManager;\n    }\n}\n```\n\n DEMO\n\n ```\n public void testJdkObserver() {\n     //\n     Reader r1 = new Reader(\"\");\n     Reader r2 = new Reader(\"\");\n     Reader r3 = new Reader(\"\");\n     Reader r4 = new Reader(\"\");\n     Writer w1 = new Writer(\"\");\n     Writer w2 = new Writer(\"\");\n     //\n     r1.subscribe(\"\");\n     r2.subscribe(\"\");\n     r3.subscribe(\"\");\n     r4.subscribe(\"\");\n     //\n     r3.subscribe(\"\");\n     r4.subscribe(\"\");\n\n     //\n     //\n     w1.addNovel(\"\");\n     //JAVA\n     w2.addNovel(\"JAVA\");\n     //\n     r1.unsubscribe(\"\");\n     //\n     w1.addNovel(\"\");\n }\n ```\n\n ![](http://www.wailian.work/images/2018/06/08/121313.png)\n\n\n\nNN\n\n\n\n***\n\nzuoxiaolong\n\n--http://www.cnblogs.com/zuoxiaolong\n\n\n\n\n","slug":"observer","published":1,"updated":"2019-12-24T02:00:57.450Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3k3f00220j9knsz833iq","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>---</p>\n<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"http://www.wailian.work/images/2018/06/08/20130626145005968.jpg\" alt=\"\"></p>\n<p>ObservableObservernotifyObserversObserverObserver</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>JAVA</p>\n<p>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> // </span><br><span class=\"line\">public interface Observer &#123;</span><br><span class=\"line\">    void update(Observable o);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class ConcreteObserver1 implements Observer &#123;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void update(Observable o) &#123;</span><br><span class=\"line\">        System.out.println(&quot;1&quot; + o.getClass().getSimpleName() + &quot;&quot;);</span><br><span class=\"line\">        System.out.println(&quot;1&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class ConcreteObserver2 implements Observer &#123;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void update(Observable o) &#123;</span><br><span class=\"line\">        System.out.println(&quot;2&quot; + o.getClass().getSimpleName() + &quot;&quot;);</span><br><span class=\"line\">        System.out.println(&quot;2&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>update</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Observable &#123;</span><br><span class=\"line\">    List&lt;Observer&gt; observers = new ArrayList&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    public void addObserver(Observer o) &#123;</span><br><span class=\"line\">        observers.add(o);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void changed() &#123;</span><br><span class=\"line\">        System.out.println(&quot;====&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">        // </span><br><span class=\"line\">        notifyObservers();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void notifyObservers() &#123;</span><br><span class=\"line\">        for (Observer observer : observers) &#123;</span><br><span class=\"line\">            observer.update(this);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public void testObserver() &#123;</span><br><span class=\"line\">    Observable observable = new Observable();</span><br><span class=\"line\">    observable.addObserver(new ConcreteObserver1());</span><br><span class=\"line\">    observable.addObserver(new ConcreteObserver2());</span><br><span class=\"line\"></span><br><span class=\"line\">    observable.changed();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"http://www.wailian.work/images/2018/06/08/WX20180608-154314.png\" alt=\"\"></p>\n<p>changed</p>\n<p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import java.util.Observable;</span><br><span class=\"line\">import java.util.Observer;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Reader implements Observer &#123;</span><br><span class=\"line\">    private String name;</span><br><span class=\"line\"></span><br><span class=\"line\">    public Reader(String name) &#123;</span><br><span class=\"line\">        super();</span><br><span class=\"line\">        this.name = name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public String getName() &#123;</span><br><span class=\"line\">        return name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    @Override</span><br><span class=\"line\">        public void update(Observable o, Object arg) &#123;</span><br><span class=\"line\">            if (o instanceof Writer) &#123;</span><br><span class=\"line\">                Writer writer = (Writer) o;</span><br><span class=\"line\">                System.out.println(name + &quot;&quot; + writer.getName() + &quot;&quot; + writer.getLastNovel() + &quot;&quot;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    public void subscribe(String writerName) &#123;</span><br><span class=\"line\">        WriterManager.getInstance().getWriter(writerName).addObserver(this);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    public void unsubscribe(String writerName) &#123;</span><br><span class=\"line\">        WriterManager.getInstance().getWriter(writerName).deleteObserver(this);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import java.util.Observable;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Writer extends Observable &#123;</span><br><span class=\"line\">    private String name; // </span><br><span class=\"line\"></span><br><span class=\"line\">    private String lastNovel; //</span><br><span class=\"line\"></span><br><span class=\"line\">    public String getName() &#123;</span><br><span class=\"line\">        return this.name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public Writer(String name) &#123;</span><br><span class=\"line\">        super();</span><br><span class=\"line\">        this.name = name;</span><br><span class=\"line\">        WriterManager.getInstance().add(this);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    public void addNovel(String novel) &#123;</span><br><span class=\"line\">        System.out.println(name + &quot;&quot; + novel + &quot;&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">        lastNovel = novel;</span><br><span class=\"line\"></span><br><span class=\"line\">        setChanged();</span><br><span class=\"line\"></span><br><span class=\"line\">        notifyObservers();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public String getLastNovel() &#123;</span><br><span class=\"line\">        return this.lastNovel;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import java.util.HashMap;</span><br><span class=\"line\">import java.util.Map;</span><br><span class=\"line\"></span><br><span class=\"line\">public class WriterManager &#123;</span><br><span class=\"line\">    private static WriterManager writerManager;</span><br><span class=\"line\"></span><br><span class=\"line\">    private Map&lt;String, Writer&gt; writerMap = new HashMap&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    public void add(Writer writer) &#123;</span><br><span class=\"line\">        writerMap.put(writer.getName(), writer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    public Writer getWriter(String name) &#123;</span><br><span class=\"line\">        return writerMap.get(name);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // ()</span><br><span class=\"line\">    private WriterManager() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static WriterManager getInstance() &#123;</span><br><span class=\"line\">        if (writerManager == null) &#123;</span><br><span class=\"line\">            synchronized (WriterManager.class) &#123;</span><br><span class=\"line\">                if (writerManager == null) &#123;</span><br><span class=\"line\">                    writerManager = new WriterManager();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        return writerManager;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> DEMO</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public void testJdkObserver() &#123;</span><br><span class=\"line\">    //</span><br><span class=\"line\">    Reader r1 = new Reader(&quot;&quot;);</span><br><span class=\"line\">    Reader r2 = new Reader(&quot;&quot;);</span><br><span class=\"line\">    Reader r3 = new Reader(&quot;&quot;);</span><br><span class=\"line\">    Reader r4 = new Reader(&quot;&quot;);</span><br><span class=\"line\">    Writer w1 = new Writer(&quot;&quot;);</span><br><span class=\"line\">    Writer w2 = new Writer(&quot;&quot;);</span><br><span class=\"line\">    //</span><br><span class=\"line\">    r1.subscribe(&quot;&quot;);</span><br><span class=\"line\">    r2.subscribe(&quot;&quot;);</span><br><span class=\"line\">    r3.subscribe(&quot;&quot;);</span><br><span class=\"line\">    r4.subscribe(&quot;&quot;);</span><br><span class=\"line\">    //</span><br><span class=\"line\">    r3.subscribe(&quot;&quot;);</span><br><span class=\"line\">    r4.subscribe(&quot;&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    //</span><br><span class=\"line\">    w1.addNovel(&quot;&quot;);</span><br><span class=\"line\">    //JAVA</span><br><span class=\"line\">    w2.addNovel(&quot;JAVA&quot;);</span><br><span class=\"line\">    //</span><br><span class=\"line\">    r1.unsubscribe(&quot;&quot;);</span><br><span class=\"line\">    //</span><br><span class=\"line\">    w1.addNovel(&quot;&quot;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> <img src=\"http://www.wailian.work/images/2018/06/08/121313.png\" alt=\"\"></p>\n<p></p>\n<p>NN</p>\n<p></p>\n<hr>\n<p>zuoxiaolong</p>\n<p><a href=\"http://www.cnblogs.com/zuoxiaolong\" target=\"_blank\" rel=\"noopener\">http://www.cnblogs.com/zuoxiaolong</a></p>\n<p></p>\n<p></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>---</p>\n<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"http://www.wailian.work/images/2018/06/08/20130626145005968.jpg\" alt=\"\"></p>\n<p>ObservableObservernotifyObserversObserverObserver</p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>JAVA</p>\n<p>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> // </span><br><span class=\"line\">public interface Observer &#123;</span><br><span class=\"line\">    void update(Observable o);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class ConcreteObserver1 implements Observer &#123;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void update(Observable o) &#123;</span><br><span class=\"line\">        System.out.println(&quot;1&quot; + o.getClass().getSimpleName() + &quot;&quot;);</span><br><span class=\"line\">        System.out.println(&quot;1&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class ConcreteObserver2 implements Observer &#123;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void update(Observable o) &#123;</span><br><span class=\"line\">        System.out.println(&quot;2&quot; + o.getClass().getSimpleName() + &quot;&quot;);</span><br><span class=\"line\">        System.out.println(&quot;2&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>update</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Observable &#123;</span><br><span class=\"line\">    List&lt;Observer&gt; observers = new ArrayList&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    public void addObserver(Observer o) &#123;</span><br><span class=\"line\">        observers.add(o);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void changed() &#123;</span><br><span class=\"line\">        System.out.println(&quot;====&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">        // </span><br><span class=\"line\">        notifyObservers();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void notifyObservers() &#123;</span><br><span class=\"line\">        for (Observer observer : observers) &#123;</span><br><span class=\"line\">            observer.update(this);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public void testObserver() &#123;</span><br><span class=\"line\">    Observable observable = new Observable();</span><br><span class=\"line\">    observable.addObserver(new ConcreteObserver1());</span><br><span class=\"line\">    observable.addObserver(new ConcreteObserver2());</span><br><span class=\"line\"></span><br><span class=\"line\">    observable.changed();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"http://www.wailian.work/images/2018/06/08/WX20180608-154314.png\" alt=\"\"></p>\n<p>changed</p>\n<p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import java.util.Observable;</span><br><span class=\"line\">import java.util.Observer;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Reader implements Observer &#123;</span><br><span class=\"line\">    private String name;</span><br><span class=\"line\"></span><br><span class=\"line\">    public Reader(String name) &#123;</span><br><span class=\"line\">        super();</span><br><span class=\"line\">        this.name = name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public String getName() &#123;</span><br><span class=\"line\">        return name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    @Override</span><br><span class=\"line\">        public void update(Observable o, Object arg) &#123;</span><br><span class=\"line\">            if (o instanceof Writer) &#123;</span><br><span class=\"line\">                Writer writer = (Writer) o;</span><br><span class=\"line\">                System.out.println(name + &quot;&quot; + writer.getName() + &quot;&quot; + writer.getLastNovel() + &quot;&quot;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    public void subscribe(String writerName) &#123;</span><br><span class=\"line\">        WriterManager.getInstance().getWriter(writerName).addObserver(this);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    public void unsubscribe(String writerName) &#123;</span><br><span class=\"line\">        WriterManager.getInstance().getWriter(writerName).deleteObserver(this);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import java.util.Observable;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Writer extends Observable &#123;</span><br><span class=\"line\">    private String name; // </span><br><span class=\"line\"></span><br><span class=\"line\">    private String lastNovel; //</span><br><span class=\"line\"></span><br><span class=\"line\">    public String getName() &#123;</span><br><span class=\"line\">        return this.name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public Writer(String name) &#123;</span><br><span class=\"line\">        super();</span><br><span class=\"line\">        this.name = name;</span><br><span class=\"line\">        WriterManager.getInstance().add(this);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    public void addNovel(String novel) &#123;</span><br><span class=\"line\">        System.out.println(name + &quot;&quot; + novel + &quot;&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">        lastNovel = novel;</span><br><span class=\"line\"></span><br><span class=\"line\">        setChanged();</span><br><span class=\"line\"></span><br><span class=\"line\">        notifyObservers();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public String getLastNovel() &#123;</span><br><span class=\"line\">        return this.lastNovel;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import java.util.HashMap;</span><br><span class=\"line\">import java.util.Map;</span><br><span class=\"line\"></span><br><span class=\"line\">public class WriterManager &#123;</span><br><span class=\"line\">    private static WriterManager writerManager;</span><br><span class=\"line\"></span><br><span class=\"line\">    private Map&lt;String, Writer&gt; writerMap = new HashMap&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    public void add(Writer writer) &#123;</span><br><span class=\"line\">        writerMap.put(writer.getName(), writer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // </span><br><span class=\"line\">    public Writer getWriter(String name) &#123;</span><br><span class=\"line\">        return writerMap.get(name);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // ()</span><br><span class=\"line\">    private WriterManager() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static WriterManager getInstance() &#123;</span><br><span class=\"line\">        if (writerManager == null) &#123;</span><br><span class=\"line\">            synchronized (WriterManager.class) &#123;</span><br><span class=\"line\">                if (writerManager == null) &#123;</span><br><span class=\"line\">                    writerManager = new WriterManager();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        return writerManager;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> DEMO</p>\n <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public void testJdkObserver() &#123;</span><br><span class=\"line\">    //</span><br><span class=\"line\">    Reader r1 = new Reader(&quot;&quot;);</span><br><span class=\"line\">    Reader r2 = new Reader(&quot;&quot;);</span><br><span class=\"line\">    Reader r3 = new Reader(&quot;&quot;);</span><br><span class=\"line\">    Reader r4 = new Reader(&quot;&quot;);</span><br><span class=\"line\">    Writer w1 = new Writer(&quot;&quot;);</span><br><span class=\"line\">    Writer w2 = new Writer(&quot;&quot;);</span><br><span class=\"line\">    //</span><br><span class=\"line\">    r1.subscribe(&quot;&quot;);</span><br><span class=\"line\">    r2.subscribe(&quot;&quot;);</span><br><span class=\"line\">    r3.subscribe(&quot;&quot;);</span><br><span class=\"line\">    r4.subscribe(&quot;&quot;);</span><br><span class=\"line\">    //</span><br><span class=\"line\">    r3.subscribe(&quot;&quot;);</span><br><span class=\"line\">    r4.subscribe(&quot;&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    //</span><br><span class=\"line\">    w1.addNovel(&quot;&quot;);</span><br><span class=\"line\">    //JAVA</span><br><span class=\"line\">    w2.addNovel(&quot;JAVA&quot;);</span><br><span class=\"line\">    //</span><br><span class=\"line\">    r1.unsubscribe(&quot;&quot;);</span><br><span class=\"line\">    //</span><br><span class=\"line\">    w1.addNovel(&quot;&quot;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> <img src=\"http://www.wailian.work/images/2018/06/08/121313.png\" alt=\"\"></p>\n<p></p>\n<p>NN</p>\n<p></p>\n<hr>\n<p>zuoxiaolong</p>\n<p><a href=\"http://www.cnblogs.com/zuoxiaolong\" target=\"_blank\" rel=\"noopener\">http://www.cnblogs.com/zuoxiaolong</a></p>\n<p></p>\n<p></p>\n"},{"title":"socket","date":"2017-12-03T05:00:29.000Z","_content":"# server\n\n## \n\n### \n### serverSocket\n### send\n\n## \n\n### \n\n## :\n\n```\n/**\n * \n * \n */\npackage com.yatai.web;\n\nimport java.awt.BorderLayout;\nimport java.awt.Container;\nimport java.awt.FlowLayout;\nimport java.awt.event.ActionEvent;\nimport java.awt.event.ActionListener;\nimport java.io.DataInputStream;\nimport java.io.DataOutputStream;\nimport java.io.IOException;\nimport java.net.ServerSocket;\nimport java.net.Socket;\nimport java.util.ArrayList;\n\nimport javax.swing.JButton;\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\nimport javax.swing.JScrollPane;\nimport javax.swing.JTextArea;\nimport javax.swing.JTextField;\n\n/**\n * @author  2014528\n */\npublic class ChatServer implements ActionListener, Runnable {\n    // \n    public static ArrayList<Socket> socketList = new ArrayList<Socket>();\n    // \n    private JTextArea showArea;\n    // \n    private JTextField msgText;\n    // \n    private JFrame mainJframe;\n    // \n    private JButton sentBtn;\n    // \n    private JScrollPane JSPane;\n    // \n    private JPanel pane;\n    // \n    private Container con;\n    // \n    private Thread thread = null;\n    private ServerSocket serverSocket;\n    private Socket connectToClient;\n    private DataInputStream inFromClient;\n    private DataOutputStream outToClient;\n\n    /**\n     * \n     */\n    public ChatServer() {\n        // TODO Auto-generated constructor stub\n        // \n        mainJframe = new JFrame(\"\");\n        // \n        con = mainJframe.getContentPane();\n        showArea = new JTextArea();\n        showArea.setEditable(false); // \n        showArea.setLineWrap(true); // \n        JSPane = new JScrollPane(showArea);\n        // \n        msgText = new JTextField();\n        msgText.setColumns(35);\n        // \n        msgText.addActionListener(this);\n        sentBtn = new JButton(\"Send\");\n        sentBtn.addActionListener(this);\n        // \n        pane = new JPanel();\n        pane.setLayout(new FlowLayout());\n        pane.add(msgText);\n        pane.add(sentBtn);\n\n        con.add(JSPane, BorderLayout.CENTER);\n        con.add(pane, BorderLayout.SOUTH);\n        mainJframe.setSize(500, 400);\n        mainJframe.setLocation(600, 200);\n        mainJframe.setVisible(true);\n        mainJframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n\n        try {\n            serverSocket = new ServerSocket(8888);\n            showArea.append(\"  \\n\");\n            // \n            connectToClient = serverSocket.accept();\n            inFromClient = new DataInputStream(connectToClient.getInputStream());\n            outToClient = new DataOutputStream(connectToClient.getOutputStream());\n            // \n            thread = new Thread(this);\n            thread.setPriority(Thread.MIN_PRIORITY);\n            thread.start();\n        } catch (IOException e) {\n            // TODO Auto-generated catch block\n            // \n            showArea.append(\"  \\n\");\n            // \n            msgText.setEditable(false);\n            // \n            sentBtn.setEnabled(false);\n        }\n\n    }\n\n    /*\n     * (non-Javadoc)\n     * \n     * @see java.lang.Runnable#run()\n     */\n    @Override\n        public void run() {\n            // TODO Auto-generated method stub\n            // \n            while (true) {\n                try {\n                    showArea.append(\"  \" + inFromClient.readUTF() + \"\\n\");\n                    Thread.sleep(1000);\n                } catch (IOException | InterruptedException e) {\n                    // TODO Auto-generated catch block\n                    e.printStackTrace();\n                }\n            }\n\n        }\n\n    /*\n     * (non-Javadoc)\n     * \n     * @see\n     * java.awt.event.ActionListener#actionPerformed(java.awt.event.ActionEvent)\n     */\n    @Override\n        public void actionPerformed(ActionEvent e) {\n            // TODO Auto-generated method stub\n            // \n            String s = msgText.getText();\n            // \n            if (s.length() > 0) {\n                try {\n                    // \n                    outToClient.writeUTF(s);\n                    outToClient.flush();\n                    // \n                    showArea.append(\"  \" + msgText.getText() + \"\\n\");\n                    // \n                    msgText.setText(null);\n                } catch (IOException e1) {\n                    // TODO Auto-generated catch block\n                    // \n                    showArea.append(\"  \" + \"\" + msgText.getText() + \"\" + \"\\n\");\n                }\n            }\n        }\n\n    public static void main(String[] args) {\n        // \n        new ChatServer();\n    }\n\n}\n```\n\n# client\n\n## \n\n### \n### serverSocket\n### send\n\n## \n\n### \n\n### \n```\n/**\n * \n */\npackage com.yatai.web;\n\nimport java.awt.BorderLayout;\nimport java.awt.Container;\nimport java.awt.FlowLayout;\nimport java.awt.event.ActionEvent;\nimport java.awt.event.ActionListener;\nimport java.io.DataInputStream;\nimport java.io.DataOutputStream;\nimport java.io.IOException;\nimport java.net.Socket;\n\nimport javax.swing.JButton;\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\nimport javax.swing.JScrollPane;\nimport javax.swing.JTextArea;\nimport javax.swing.JTextField;\n\n/**\n * @author  2014528\n */\npublic class ChatClient implements ActionListener, Runnable {\n    // \n    private JTextArea showArea;\n    private JTextField msgText;\n    private JFrame mainJframe;\n    private JButton sentBtn;\n    private JScrollPane JSPane;\n    private JPanel pane;\n    private Container con;\n    // \n    private Thread thread = null;\n    private Socket connectToServer;\n    private DataInputStream inFromServer;\n    private DataOutputStream outToServer;\n\n    /**\n     * \n     */\n    public ChatClient() {\n        // TODO Auto-generated constructor stub\n        // \n        mainJframe = new JFrame(\"\");\n        con = mainJframe.getContentPane();\n        showArea = new JTextArea();\n        showArea.setEditable(false);\n        showArea.setLineWrap(true);\n        showArea.setWrapStyleWord(true);\n        JSPane = new JScrollPane(showArea);\n        msgText = new JTextField();\n        msgText.setColumns(35);\n        msgText.addActionListener(this);\n        sentBtn = new JButton(\"Send\");\n        sentBtn.addActionListener(this);\n        pane = new JPanel();\n        pane.setLayout(new FlowLayout());\n        pane.add(msgText);\n        pane.add(sentBtn);\n        con.add(JSPane, BorderLayout.CENTER);\n        con.add(pane, BorderLayout.SOUTH);\n        mainJframe.setSize(500, 400);\n        mainJframe.setLocation(80, 200);\n        mainJframe.setVisible(true);\n        mainJframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n\n        try {\n            connectToServer = new Socket(\"localhost\", 8888);\n            inFromServer = new DataInputStream(connectToServer.getInputStream());\n            outToServer = new DataOutputStream(connectToServer.getOutputStream());\n            showArea.append(\"  \\n\");\n\n            // \n            thread = new Thread(this);\n            thread.setPriority(Thread.MIN_PRIORITY);\n            thread.start();\n        } catch (IOException e) {\n            // TODO Auto-generated catch block\n            // \n            // \n            showArea.append(\"  \\n\");\n            // \n            msgText.setEditable(false);\n            msgText.setEnabled(false);\n        }\n    }\n\n    /*\n     * (non-Javadoc)\n     * \n     * @see java.lang.Runnable#run()\n     */\n    @Override\n        public void run() {\n            // TODO Auto-generated method stub\n            // \n            while (true) {\n                try {\n                    showArea.append(\"  \" + inFromServer.readUTF() + \"\\n\");\n                    Thread.sleep(1000);\n                } catch (IOException | InterruptedException e) {\n                    // TODO Auto-generated catch block\n                    // \n                    e.printStackTrace();\n                }\n            }\n        }\n\n    /*\n     * (non-Javadoc)\n     * \n     * @see\n     * java.awt.event.ActionListener#actionPerformed(java.awt.event.ActionEvent)\n     */\n    @Override\n        public void actionPerformed(ActionEvent e) {\n            // TODO Auto-generated method stub\n            // \n            String s = msgText.getText();\n            // \n            if (s.length() > 0) {\n                try {\n                    // \n                    outToServer.writeUTF(s);\n                    outToServer.flush();\n                    // \n                    showArea.append(\"  \" + msgText.getText() + \"\\n\");\n                    // \n                    msgText.setText(null);\n                } catch (IOException e1) {\n                    // TODO Auto-generated catch block\n                    // \n                    showArea.append(\"  \" + \"\" + msgText.getText() + \"\" + \"\\n\");\n                }\n            }\n        }\n\n    public static void main(String[] args) {\n        new ChatClient();\n    }\n}\n```\n","source":"_posts/socket.md","raw":"---\ntitle: socket\ndate: 2017-12-03 13:00:29\ntags:\n---\n# server\n\n## \n\n### \n### serverSocket\n### send\n\n## \n\n### \n\n## :\n\n```\n/**\n * \n * \n */\npackage com.yatai.web;\n\nimport java.awt.BorderLayout;\nimport java.awt.Container;\nimport java.awt.FlowLayout;\nimport java.awt.event.ActionEvent;\nimport java.awt.event.ActionListener;\nimport java.io.DataInputStream;\nimport java.io.DataOutputStream;\nimport java.io.IOException;\nimport java.net.ServerSocket;\nimport java.net.Socket;\nimport java.util.ArrayList;\n\nimport javax.swing.JButton;\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\nimport javax.swing.JScrollPane;\nimport javax.swing.JTextArea;\nimport javax.swing.JTextField;\n\n/**\n * @author  2014528\n */\npublic class ChatServer implements ActionListener, Runnable {\n    // \n    public static ArrayList<Socket> socketList = new ArrayList<Socket>();\n    // \n    private JTextArea showArea;\n    // \n    private JTextField msgText;\n    // \n    private JFrame mainJframe;\n    // \n    private JButton sentBtn;\n    // \n    private JScrollPane JSPane;\n    // \n    private JPanel pane;\n    // \n    private Container con;\n    // \n    private Thread thread = null;\n    private ServerSocket serverSocket;\n    private Socket connectToClient;\n    private DataInputStream inFromClient;\n    private DataOutputStream outToClient;\n\n    /**\n     * \n     */\n    public ChatServer() {\n        // TODO Auto-generated constructor stub\n        // \n        mainJframe = new JFrame(\"\");\n        // \n        con = mainJframe.getContentPane();\n        showArea = new JTextArea();\n        showArea.setEditable(false); // \n        showArea.setLineWrap(true); // \n        JSPane = new JScrollPane(showArea);\n        // \n        msgText = new JTextField();\n        msgText.setColumns(35);\n        // \n        msgText.addActionListener(this);\n        sentBtn = new JButton(\"Send\");\n        sentBtn.addActionListener(this);\n        // \n        pane = new JPanel();\n        pane.setLayout(new FlowLayout());\n        pane.add(msgText);\n        pane.add(sentBtn);\n\n        con.add(JSPane, BorderLayout.CENTER);\n        con.add(pane, BorderLayout.SOUTH);\n        mainJframe.setSize(500, 400);\n        mainJframe.setLocation(600, 200);\n        mainJframe.setVisible(true);\n        mainJframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n\n        try {\n            serverSocket = new ServerSocket(8888);\n            showArea.append(\"  \\n\");\n            // \n            connectToClient = serverSocket.accept();\n            inFromClient = new DataInputStream(connectToClient.getInputStream());\n            outToClient = new DataOutputStream(connectToClient.getOutputStream());\n            // \n            thread = new Thread(this);\n            thread.setPriority(Thread.MIN_PRIORITY);\n            thread.start();\n        } catch (IOException e) {\n            // TODO Auto-generated catch block\n            // \n            showArea.append(\"  \\n\");\n            // \n            msgText.setEditable(false);\n            // \n            sentBtn.setEnabled(false);\n        }\n\n    }\n\n    /*\n     * (non-Javadoc)\n     * \n     * @see java.lang.Runnable#run()\n     */\n    @Override\n        public void run() {\n            // TODO Auto-generated method stub\n            // \n            while (true) {\n                try {\n                    showArea.append(\"  \" + inFromClient.readUTF() + \"\\n\");\n                    Thread.sleep(1000);\n                } catch (IOException | InterruptedException e) {\n                    // TODO Auto-generated catch block\n                    e.printStackTrace();\n                }\n            }\n\n        }\n\n    /*\n     * (non-Javadoc)\n     * \n     * @see\n     * java.awt.event.ActionListener#actionPerformed(java.awt.event.ActionEvent)\n     */\n    @Override\n        public void actionPerformed(ActionEvent e) {\n            // TODO Auto-generated method stub\n            // \n            String s = msgText.getText();\n            // \n            if (s.length() > 0) {\n                try {\n                    // \n                    outToClient.writeUTF(s);\n                    outToClient.flush();\n                    // \n                    showArea.append(\"  \" + msgText.getText() + \"\\n\");\n                    // \n                    msgText.setText(null);\n                } catch (IOException e1) {\n                    // TODO Auto-generated catch block\n                    // \n                    showArea.append(\"  \" + \"\" + msgText.getText() + \"\" + \"\\n\");\n                }\n            }\n        }\n\n    public static void main(String[] args) {\n        // \n        new ChatServer();\n    }\n\n}\n```\n\n# client\n\n## \n\n### \n### serverSocket\n### send\n\n## \n\n### \n\n### \n```\n/**\n * \n */\npackage com.yatai.web;\n\nimport java.awt.BorderLayout;\nimport java.awt.Container;\nimport java.awt.FlowLayout;\nimport java.awt.event.ActionEvent;\nimport java.awt.event.ActionListener;\nimport java.io.DataInputStream;\nimport java.io.DataOutputStream;\nimport java.io.IOException;\nimport java.net.Socket;\n\nimport javax.swing.JButton;\nimport javax.swing.JFrame;\nimport javax.swing.JPanel;\nimport javax.swing.JScrollPane;\nimport javax.swing.JTextArea;\nimport javax.swing.JTextField;\n\n/**\n * @author  2014528\n */\npublic class ChatClient implements ActionListener, Runnable {\n    // \n    private JTextArea showArea;\n    private JTextField msgText;\n    private JFrame mainJframe;\n    private JButton sentBtn;\n    private JScrollPane JSPane;\n    private JPanel pane;\n    private Container con;\n    // \n    private Thread thread = null;\n    private Socket connectToServer;\n    private DataInputStream inFromServer;\n    private DataOutputStream outToServer;\n\n    /**\n     * \n     */\n    public ChatClient() {\n        // TODO Auto-generated constructor stub\n        // \n        mainJframe = new JFrame(\"\");\n        con = mainJframe.getContentPane();\n        showArea = new JTextArea();\n        showArea.setEditable(false);\n        showArea.setLineWrap(true);\n        showArea.setWrapStyleWord(true);\n        JSPane = new JScrollPane(showArea);\n        msgText = new JTextField();\n        msgText.setColumns(35);\n        msgText.addActionListener(this);\n        sentBtn = new JButton(\"Send\");\n        sentBtn.addActionListener(this);\n        pane = new JPanel();\n        pane.setLayout(new FlowLayout());\n        pane.add(msgText);\n        pane.add(sentBtn);\n        con.add(JSPane, BorderLayout.CENTER);\n        con.add(pane, BorderLayout.SOUTH);\n        mainJframe.setSize(500, 400);\n        mainJframe.setLocation(80, 200);\n        mainJframe.setVisible(true);\n        mainJframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n\n        try {\n            connectToServer = new Socket(\"localhost\", 8888);\n            inFromServer = new DataInputStream(connectToServer.getInputStream());\n            outToServer = new DataOutputStream(connectToServer.getOutputStream());\n            showArea.append(\"  \\n\");\n\n            // \n            thread = new Thread(this);\n            thread.setPriority(Thread.MIN_PRIORITY);\n            thread.start();\n        } catch (IOException e) {\n            // TODO Auto-generated catch block\n            // \n            // \n            showArea.append(\"  \\n\");\n            // \n            msgText.setEditable(false);\n            msgText.setEnabled(false);\n        }\n    }\n\n    /*\n     * (non-Javadoc)\n     * \n     * @see java.lang.Runnable#run()\n     */\n    @Override\n        public void run() {\n            // TODO Auto-generated method stub\n            // \n            while (true) {\n                try {\n                    showArea.append(\"  \" + inFromServer.readUTF() + \"\\n\");\n                    Thread.sleep(1000);\n                } catch (IOException | InterruptedException e) {\n                    // TODO Auto-generated catch block\n                    // \n                    e.printStackTrace();\n                }\n            }\n        }\n\n    /*\n     * (non-Javadoc)\n     * \n     * @see\n     * java.awt.event.ActionListener#actionPerformed(java.awt.event.ActionEvent)\n     */\n    @Override\n        public void actionPerformed(ActionEvent e) {\n            // TODO Auto-generated method stub\n            // \n            String s = msgText.getText();\n            // \n            if (s.length() > 0) {\n                try {\n                    // \n                    outToServer.writeUTF(s);\n                    outToServer.flush();\n                    // \n                    showArea.append(\"  \" + msgText.getText() + \"\\n\");\n                    // \n                    msgText.setText(null);\n                } catch (IOException e1) {\n                    // TODO Auto-generated catch block\n                    // \n                    showArea.append(\"  \" + \"\" + msgText.getText() + \"\" + \"\\n\");\n                }\n            }\n        }\n\n    public static void main(String[] args) {\n        new ChatClient();\n    }\n}\n```\n","slug":"socket","published":1,"updated":"2019-12-24T02:00:57.460Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3k3g00230j9key8y43bz","content":"<h1 id=\"server\"><a href=\"#server\" class=\"headerlink\" title=\"server\"></a>server</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"serverSocket\"><a href=\"#serverSocket\" class=\"headerlink\" title=\"serverSocket\"></a>serverSocket</h3><h3 id=\"send\"><a href=\"#send\" class=\"headerlink\" title=\"send\"></a>send</h3><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\":\"></a>:</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/**</span><br><span class=\"line\"> * </span><br><span class=\"line\"> * </span><br><span class=\"line\"> */</span><br><span class=\"line\">package com.yatai.web;</span><br><span class=\"line\"></span><br><span class=\"line\">import java.awt.BorderLayout;</span><br><span class=\"line\">import java.awt.Container;</span><br><span class=\"line\">import java.awt.FlowLayout;</span><br><span class=\"line\">import java.awt.event.ActionEvent;</span><br><span class=\"line\">import java.awt.event.ActionListener;</span><br><span class=\"line\">import java.io.DataInputStream;</span><br><span class=\"line\">import java.io.DataOutputStream;</span><br><span class=\"line\">import java.io.IOException;</span><br><span class=\"line\">import java.net.ServerSocket;</span><br><span class=\"line\">import java.net.Socket;</span><br><span class=\"line\">import java.util.ArrayList;</span><br><span class=\"line\"></span><br><span class=\"line\">import javax.swing.JButton;</span><br><span class=\"line\">import javax.swing.JFrame;</span><br><span class=\"line\">import javax.swing.JPanel;</span><br><span class=\"line\">import javax.swing.JScrollPane;</span><br><span class=\"line\">import javax.swing.JTextArea;</span><br><span class=\"line\">import javax.swing.JTextField;</span><br><span class=\"line\"></span><br><span class=\"line\">/**</span><br><span class=\"line\"> * @author  2014528</span><br><span class=\"line\"> */</span><br><span class=\"line\">public class ChatServer implements ActionListener, Runnable &#123;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    public static ArrayList&lt;Socket&gt; socketList = new ArrayList&lt;Socket&gt;();</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private JTextArea showArea;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private JTextField msgText;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private JFrame mainJframe;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private JButton sentBtn;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private JScrollPane JSPane;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private JPanel pane;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private Container con;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private Thread thread = null;</span><br><span class=\"line\">    private ServerSocket serverSocket;</span><br><span class=\"line\">    private Socket connectToClient;</span><br><span class=\"line\">    private DataInputStream inFromClient;</span><br><span class=\"line\">    private DataOutputStream outToClient;</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * </span><br><span class=\"line\">     */</span><br><span class=\"line\">    public ChatServer() &#123;</span><br><span class=\"line\">        // TODO Auto-generated constructor stub</span><br><span class=\"line\">        // </span><br><span class=\"line\">        mainJframe = new JFrame(&quot;&quot;);</span><br><span class=\"line\">        // </span><br><span class=\"line\">        con = mainJframe.getContentPane();</span><br><span class=\"line\">        showArea = new JTextArea();</span><br><span class=\"line\">        showArea.setEditable(false); // </span><br><span class=\"line\">        showArea.setLineWrap(true); // </span><br><span class=\"line\">        JSPane = new JScrollPane(showArea);</span><br><span class=\"line\">        // </span><br><span class=\"line\">        msgText = new JTextField();</span><br><span class=\"line\">        msgText.setColumns(35);</span><br><span class=\"line\">        // </span><br><span class=\"line\">        msgText.addActionListener(this);</span><br><span class=\"line\">        sentBtn = new JButton(&quot;Send&quot;);</span><br><span class=\"line\">        sentBtn.addActionListener(this);</span><br><span class=\"line\">        // </span><br><span class=\"line\">        pane = new JPanel();</span><br><span class=\"line\">        pane.setLayout(new FlowLayout());</span><br><span class=\"line\">        pane.add(msgText);</span><br><span class=\"line\">        pane.add(sentBtn);</span><br><span class=\"line\"></span><br><span class=\"line\">        con.add(JSPane, BorderLayout.CENTER);</span><br><span class=\"line\">        con.add(pane, BorderLayout.SOUTH);</span><br><span class=\"line\">        mainJframe.setSize(500, 400);</span><br><span class=\"line\">        mainJframe.setLocation(600, 200);</span><br><span class=\"line\">        mainJframe.setVisible(true);</span><br><span class=\"line\">        mainJframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class=\"line\"></span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            serverSocket = new ServerSocket(8888);</span><br><span class=\"line\">            showArea.append(&quot;  \\n&quot;);</span><br><span class=\"line\">            // </span><br><span class=\"line\">            connectToClient = serverSocket.accept();</span><br><span class=\"line\">            inFromClient = new DataInputStream(connectToClient.getInputStream());</span><br><span class=\"line\">            outToClient = new DataOutputStream(connectToClient.getOutputStream());</span><br><span class=\"line\">            // </span><br><span class=\"line\">            thread = new Thread(this);</span><br><span class=\"line\">            thread.setPriority(Thread.MIN_PRIORITY);</span><br><span class=\"line\">            thread.start();</span><br><span class=\"line\">        &#125; catch (IOException e) &#123;</span><br><span class=\"line\">            // TODO Auto-generated catch block</span><br><span class=\"line\">            // </span><br><span class=\"line\">            showArea.append(&quot;  \\n&quot;);</span><br><span class=\"line\">            // </span><br><span class=\"line\">            msgText.setEditable(false);</span><br><span class=\"line\">            // </span><br><span class=\"line\">            sentBtn.setEnabled(false);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    /*</span><br><span class=\"line\">     * (non-Javadoc)</span><br><span class=\"line\">     * </span><br><span class=\"line\">     * @see java.lang.Runnable#run()</span><br><span class=\"line\">     */</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">        public void run() &#123;</span><br><span class=\"line\">            // TODO Auto-generated method stub</span><br><span class=\"line\">            // </span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    showArea.append(&quot;  &quot; + inFromClient.readUTF() + &quot;\\n&quot;);</span><br><span class=\"line\">                    Thread.sleep(1000);</span><br><span class=\"line\">                &#125; catch (IOException | InterruptedException e) &#123;</span><br><span class=\"line\">                    // TODO Auto-generated catch block</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    /*</span><br><span class=\"line\">     * (non-Javadoc)</span><br><span class=\"line\">     * </span><br><span class=\"line\">     * @see</span><br><span class=\"line\">     * java.awt.event.ActionListener#actionPerformed(java.awt.event.ActionEvent)</span><br><span class=\"line\">     */</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">        public void actionPerformed(ActionEvent e) &#123;</span><br><span class=\"line\">            // TODO Auto-generated method stub</span><br><span class=\"line\">            // </span><br><span class=\"line\">            String s = msgText.getText();</span><br><span class=\"line\">            // </span><br><span class=\"line\">            if (s.length() &gt; 0) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    outToClient.writeUTF(s);</span><br><span class=\"line\">                    outToClient.flush();</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    showArea.append(&quot;  &quot; + msgText.getText() + &quot;\\n&quot;);</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    msgText.setText(null);</span><br><span class=\"line\">                &#125; catch (IOException e1) &#123;</span><br><span class=\"line\">                    // TODO Auto-generated catch block</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    showArea.append(&quot;  &quot; + &quot;&quot; + msgText.getText() + &quot;&quot; + &quot;\\n&quot;);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        // </span><br><span class=\"line\">        new ChatServer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"client\"><a href=\"#client\" class=\"headerlink\" title=\"client\"></a>client</h1><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"serverSocket\"><a href=\"#serverSocket\" class=\"headerlink\" title=\"serverSocket\"></a>serverSocket</h3><h3 id=\"send\"><a href=\"#send\" class=\"headerlink\" title=\"send\"></a>send</h3><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/**</span><br><span class=\"line\"> * </span><br><span class=\"line\"> */</span><br><span class=\"line\">package com.yatai.web;</span><br><span class=\"line\"></span><br><span class=\"line\">import java.awt.BorderLayout;</span><br><span class=\"line\">import java.awt.Container;</span><br><span class=\"line\">import java.awt.FlowLayout;</span><br><span class=\"line\">import java.awt.event.ActionEvent;</span><br><span class=\"line\">import java.awt.event.ActionListener;</span><br><span class=\"line\">import java.io.DataInputStream;</span><br><span class=\"line\">import java.io.DataOutputStream;</span><br><span class=\"line\">import java.io.IOException;</span><br><span class=\"line\">import java.net.Socket;</span><br><span class=\"line\"></span><br><span class=\"line\">import javax.swing.JButton;</span><br><span class=\"line\">import javax.swing.JFrame;</span><br><span class=\"line\">import javax.swing.JPanel;</span><br><span class=\"line\">import javax.swing.JScrollPane;</span><br><span class=\"line\">import javax.swing.JTextArea;</span><br><span class=\"line\">import javax.swing.JTextField;</span><br><span class=\"line\"></span><br><span class=\"line\">/**</span><br><span class=\"line\"> * @author  2014528</span><br><span class=\"line\"> */</span><br><span class=\"line\">public class ChatClient implements ActionListener, Runnable &#123;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private JTextArea showArea;</span><br><span class=\"line\">    private JTextField msgText;</span><br><span class=\"line\">    private JFrame mainJframe;</span><br><span class=\"line\">    private JButton sentBtn;</span><br><span class=\"line\">    private JScrollPane JSPane;</span><br><span class=\"line\">    private JPanel pane;</span><br><span class=\"line\">    private Container con;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private Thread thread = null;</span><br><span class=\"line\">    private Socket connectToServer;</span><br><span class=\"line\">    private DataInputStream inFromServer;</span><br><span class=\"line\">    private DataOutputStream outToServer;</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * </span><br><span class=\"line\">     */</span><br><span class=\"line\">    public ChatClient() &#123;</span><br><span class=\"line\">        // TODO Auto-generated constructor stub</span><br><span class=\"line\">        // </span><br><span class=\"line\">        mainJframe = new JFrame(&quot;&quot;);</span><br><span class=\"line\">        con = mainJframe.getContentPane();</span><br><span class=\"line\">        showArea = new JTextArea();</span><br><span class=\"line\">        showArea.setEditable(false);</span><br><span class=\"line\">        showArea.setLineWrap(true);</span><br><span class=\"line\">        showArea.setWrapStyleWord(true);</span><br><span class=\"line\">        JSPane = new JScrollPane(showArea);</span><br><span class=\"line\">        msgText = new JTextField();</span><br><span class=\"line\">        msgText.setColumns(35);</span><br><span class=\"line\">        msgText.addActionListener(this);</span><br><span class=\"line\">        sentBtn = new JButton(&quot;Send&quot;);</span><br><span class=\"line\">        sentBtn.addActionListener(this);</span><br><span class=\"line\">        pane = new JPanel();</span><br><span class=\"line\">        pane.setLayout(new FlowLayout());</span><br><span class=\"line\">        pane.add(msgText);</span><br><span class=\"line\">        pane.add(sentBtn);</span><br><span class=\"line\">        con.add(JSPane, BorderLayout.CENTER);</span><br><span class=\"line\">        con.add(pane, BorderLayout.SOUTH);</span><br><span class=\"line\">        mainJframe.setSize(500, 400);</span><br><span class=\"line\">        mainJframe.setLocation(80, 200);</span><br><span class=\"line\">        mainJframe.setVisible(true);</span><br><span class=\"line\">        mainJframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class=\"line\"></span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            connectToServer = new Socket(&quot;localhost&quot;, 8888);</span><br><span class=\"line\">            inFromServer = new DataInputStream(connectToServer.getInputStream());</span><br><span class=\"line\">            outToServer = new DataOutputStream(connectToServer.getOutputStream());</span><br><span class=\"line\">            showArea.append(&quot;  \\n&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">            // </span><br><span class=\"line\">            thread = new Thread(this);</span><br><span class=\"line\">            thread.setPriority(Thread.MIN_PRIORITY);</span><br><span class=\"line\">            thread.start();</span><br><span class=\"line\">        &#125; catch (IOException e) &#123;</span><br><span class=\"line\">            // TODO Auto-generated catch block</span><br><span class=\"line\">            // </span><br><span class=\"line\">            // </span><br><span class=\"line\">            showArea.append(&quot;  \\n&quot;);</span><br><span class=\"line\">            // </span><br><span class=\"line\">            msgText.setEditable(false);</span><br><span class=\"line\">            msgText.setEnabled(false);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    /*</span><br><span class=\"line\">     * (non-Javadoc)</span><br><span class=\"line\">     * </span><br><span class=\"line\">     * @see java.lang.Runnable#run()</span><br><span class=\"line\">     */</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">        public void run() &#123;</span><br><span class=\"line\">            // TODO Auto-generated method stub</span><br><span class=\"line\">            // </span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    showArea.append(&quot;  &quot; + inFromServer.readUTF() + &quot;\\n&quot;);</span><br><span class=\"line\">                    Thread.sleep(1000);</span><br><span class=\"line\">                &#125; catch (IOException | InterruptedException e) &#123;</span><br><span class=\"line\">                    // TODO Auto-generated catch block</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    /*</span><br><span class=\"line\">     * (non-Javadoc)</span><br><span class=\"line\">     * </span><br><span class=\"line\">     * @see</span><br><span class=\"line\">     * java.awt.event.ActionListener#actionPerformed(java.awt.event.ActionEvent)</span><br><span class=\"line\">     */</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">        public void actionPerformed(ActionEvent e) &#123;</span><br><span class=\"line\">            // TODO Auto-generated method stub</span><br><span class=\"line\">            // </span><br><span class=\"line\">            String s = msgText.getText();</span><br><span class=\"line\">            // </span><br><span class=\"line\">            if (s.length() &gt; 0) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    outToServer.writeUTF(s);</span><br><span class=\"line\">                    outToServer.flush();</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    showArea.append(&quot;  &quot; + msgText.getText() + &quot;\\n&quot;);</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    msgText.setText(null);</span><br><span class=\"line\">                &#125; catch (IOException e1) &#123;</span><br><span class=\"line\">                    // TODO Auto-generated catch block</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    showArea.append(&quot;  &quot; + &quot;&quot; + msgText.getText() + &quot;&quot; + &quot;\\n&quot;);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new ChatClient();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"server\"><a href=\"#server\" class=\"headerlink\" title=\"server\"></a>server</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"serverSocket\"><a href=\"#serverSocket\" class=\"headerlink\" title=\"serverSocket\"></a>serverSocket</h3><h3 id=\"send\"><a href=\"#send\" class=\"headerlink\" title=\"send\"></a>send</h3><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\":\"></a>:</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/**</span><br><span class=\"line\"> * </span><br><span class=\"line\"> * </span><br><span class=\"line\"> */</span><br><span class=\"line\">package com.yatai.web;</span><br><span class=\"line\"></span><br><span class=\"line\">import java.awt.BorderLayout;</span><br><span class=\"line\">import java.awt.Container;</span><br><span class=\"line\">import java.awt.FlowLayout;</span><br><span class=\"line\">import java.awt.event.ActionEvent;</span><br><span class=\"line\">import java.awt.event.ActionListener;</span><br><span class=\"line\">import java.io.DataInputStream;</span><br><span class=\"line\">import java.io.DataOutputStream;</span><br><span class=\"line\">import java.io.IOException;</span><br><span class=\"line\">import java.net.ServerSocket;</span><br><span class=\"line\">import java.net.Socket;</span><br><span class=\"line\">import java.util.ArrayList;</span><br><span class=\"line\"></span><br><span class=\"line\">import javax.swing.JButton;</span><br><span class=\"line\">import javax.swing.JFrame;</span><br><span class=\"line\">import javax.swing.JPanel;</span><br><span class=\"line\">import javax.swing.JScrollPane;</span><br><span class=\"line\">import javax.swing.JTextArea;</span><br><span class=\"line\">import javax.swing.JTextField;</span><br><span class=\"line\"></span><br><span class=\"line\">/**</span><br><span class=\"line\"> * @author  2014528</span><br><span class=\"line\"> */</span><br><span class=\"line\">public class ChatServer implements ActionListener, Runnable &#123;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    public static ArrayList&lt;Socket&gt; socketList = new ArrayList&lt;Socket&gt;();</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private JTextArea showArea;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private JTextField msgText;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private JFrame mainJframe;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private JButton sentBtn;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private JScrollPane JSPane;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private JPanel pane;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private Container con;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private Thread thread = null;</span><br><span class=\"line\">    private ServerSocket serverSocket;</span><br><span class=\"line\">    private Socket connectToClient;</span><br><span class=\"line\">    private DataInputStream inFromClient;</span><br><span class=\"line\">    private DataOutputStream outToClient;</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * </span><br><span class=\"line\">     */</span><br><span class=\"line\">    public ChatServer() &#123;</span><br><span class=\"line\">        // TODO Auto-generated constructor stub</span><br><span class=\"line\">        // </span><br><span class=\"line\">        mainJframe = new JFrame(&quot;&quot;);</span><br><span class=\"line\">        // </span><br><span class=\"line\">        con = mainJframe.getContentPane();</span><br><span class=\"line\">        showArea = new JTextArea();</span><br><span class=\"line\">        showArea.setEditable(false); // </span><br><span class=\"line\">        showArea.setLineWrap(true); // </span><br><span class=\"line\">        JSPane = new JScrollPane(showArea);</span><br><span class=\"line\">        // </span><br><span class=\"line\">        msgText = new JTextField();</span><br><span class=\"line\">        msgText.setColumns(35);</span><br><span class=\"line\">        // </span><br><span class=\"line\">        msgText.addActionListener(this);</span><br><span class=\"line\">        sentBtn = new JButton(&quot;Send&quot;);</span><br><span class=\"line\">        sentBtn.addActionListener(this);</span><br><span class=\"line\">        // </span><br><span class=\"line\">        pane = new JPanel();</span><br><span class=\"line\">        pane.setLayout(new FlowLayout());</span><br><span class=\"line\">        pane.add(msgText);</span><br><span class=\"line\">        pane.add(sentBtn);</span><br><span class=\"line\"></span><br><span class=\"line\">        con.add(JSPane, BorderLayout.CENTER);</span><br><span class=\"line\">        con.add(pane, BorderLayout.SOUTH);</span><br><span class=\"line\">        mainJframe.setSize(500, 400);</span><br><span class=\"line\">        mainJframe.setLocation(600, 200);</span><br><span class=\"line\">        mainJframe.setVisible(true);</span><br><span class=\"line\">        mainJframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class=\"line\"></span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            serverSocket = new ServerSocket(8888);</span><br><span class=\"line\">            showArea.append(&quot;  \\n&quot;);</span><br><span class=\"line\">            // </span><br><span class=\"line\">            connectToClient = serverSocket.accept();</span><br><span class=\"line\">            inFromClient = new DataInputStream(connectToClient.getInputStream());</span><br><span class=\"line\">            outToClient = new DataOutputStream(connectToClient.getOutputStream());</span><br><span class=\"line\">            // </span><br><span class=\"line\">            thread = new Thread(this);</span><br><span class=\"line\">            thread.setPriority(Thread.MIN_PRIORITY);</span><br><span class=\"line\">            thread.start();</span><br><span class=\"line\">        &#125; catch (IOException e) &#123;</span><br><span class=\"line\">            // TODO Auto-generated catch block</span><br><span class=\"line\">            // </span><br><span class=\"line\">            showArea.append(&quot;  \\n&quot;);</span><br><span class=\"line\">            // </span><br><span class=\"line\">            msgText.setEditable(false);</span><br><span class=\"line\">            // </span><br><span class=\"line\">            sentBtn.setEnabled(false);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    /*</span><br><span class=\"line\">     * (non-Javadoc)</span><br><span class=\"line\">     * </span><br><span class=\"line\">     * @see java.lang.Runnable#run()</span><br><span class=\"line\">     */</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">        public void run() &#123;</span><br><span class=\"line\">            // TODO Auto-generated method stub</span><br><span class=\"line\">            // </span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    showArea.append(&quot;  &quot; + inFromClient.readUTF() + &quot;\\n&quot;);</span><br><span class=\"line\">                    Thread.sleep(1000);</span><br><span class=\"line\">                &#125; catch (IOException | InterruptedException e) &#123;</span><br><span class=\"line\">                    // TODO Auto-generated catch block</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    /*</span><br><span class=\"line\">     * (non-Javadoc)</span><br><span class=\"line\">     * </span><br><span class=\"line\">     * @see</span><br><span class=\"line\">     * java.awt.event.ActionListener#actionPerformed(java.awt.event.ActionEvent)</span><br><span class=\"line\">     */</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">        public void actionPerformed(ActionEvent e) &#123;</span><br><span class=\"line\">            // TODO Auto-generated method stub</span><br><span class=\"line\">            // </span><br><span class=\"line\">            String s = msgText.getText();</span><br><span class=\"line\">            // </span><br><span class=\"line\">            if (s.length() &gt; 0) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    outToClient.writeUTF(s);</span><br><span class=\"line\">                    outToClient.flush();</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    showArea.append(&quot;  &quot; + msgText.getText() + &quot;\\n&quot;);</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    msgText.setText(null);</span><br><span class=\"line\">                &#125; catch (IOException e1) &#123;</span><br><span class=\"line\">                    // TODO Auto-generated catch block</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    showArea.append(&quot;  &quot; + &quot;&quot; + msgText.getText() + &quot;&quot; + &quot;\\n&quot;);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        // </span><br><span class=\"line\">        new ChatServer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"client\"><a href=\"#client\" class=\"headerlink\" title=\"client\"></a>client</h1><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"serverSocket\"><a href=\"#serverSocket\" class=\"headerlink\" title=\"serverSocket\"></a>serverSocket</h3><h3 id=\"send\"><a href=\"#send\" class=\"headerlink\" title=\"send\"></a>send</h3><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/**</span><br><span class=\"line\"> * </span><br><span class=\"line\"> */</span><br><span class=\"line\">package com.yatai.web;</span><br><span class=\"line\"></span><br><span class=\"line\">import java.awt.BorderLayout;</span><br><span class=\"line\">import java.awt.Container;</span><br><span class=\"line\">import java.awt.FlowLayout;</span><br><span class=\"line\">import java.awt.event.ActionEvent;</span><br><span class=\"line\">import java.awt.event.ActionListener;</span><br><span class=\"line\">import java.io.DataInputStream;</span><br><span class=\"line\">import java.io.DataOutputStream;</span><br><span class=\"line\">import java.io.IOException;</span><br><span class=\"line\">import java.net.Socket;</span><br><span class=\"line\"></span><br><span class=\"line\">import javax.swing.JButton;</span><br><span class=\"line\">import javax.swing.JFrame;</span><br><span class=\"line\">import javax.swing.JPanel;</span><br><span class=\"line\">import javax.swing.JScrollPane;</span><br><span class=\"line\">import javax.swing.JTextArea;</span><br><span class=\"line\">import javax.swing.JTextField;</span><br><span class=\"line\"></span><br><span class=\"line\">/**</span><br><span class=\"line\"> * @author  2014528</span><br><span class=\"line\"> */</span><br><span class=\"line\">public class ChatClient implements ActionListener, Runnable &#123;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private JTextArea showArea;</span><br><span class=\"line\">    private JTextField msgText;</span><br><span class=\"line\">    private JFrame mainJframe;</span><br><span class=\"line\">    private JButton sentBtn;</span><br><span class=\"line\">    private JScrollPane JSPane;</span><br><span class=\"line\">    private JPanel pane;</span><br><span class=\"line\">    private Container con;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    private Thread thread = null;</span><br><span class=\"line\">    private Socket connectToServer;</span><br><span class=\"line\">    private DataInputStream inFromServer;</span><br><span class=\"line\">    private DataOutputStream outToServer;</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * </span><br><span class=\"line\">     */</span><br><span class=\"line\">    public ChatClient() &#123;</span><br><span class=\"line\">        // TODO Auto-generated constructor stub</span><br><span class=\"line\">        // </span><br><span class=\"line\">        mainJframe = new JFrame(&quot;&quot;);</span><br><span class=\"line\">        con = mainJframe.getContentPane();</span><br><span class=\"line\">        showArea = new JTextArea();</span><br><span class=\"line\">        showArea.setEditable(false);</span><br><span class=\"line\">        showArea.setLineWrap(true);</span><br><span class=\"line\">        showArea.setWrapStyleWord(true);</span><br><span class=\"line\">        JSPane = new JScrollPane(showArea);</span><br><span class=\"line\">        msgText = new JTextField();</span><br><span class=\"line\">        msgText.setColumns(35);</span><br><span class=\"line\">        msgText.addActionListener(this);</span><br><span class=\"line\">        sentBtn = new JButton(&quot;Send&quot;);</span><br><span class=\"line\">        sentBtn.addActionListener(this);</span><br><span class=\"line\">        pane = new JPanel();</span><br><span class=\"line\">        pane.setLayout(new FlowLayout());</span><br><span class=\"line\">        pane.add(msgText);</span><br><span class=\"line\">        pane.add(sentBtn);</span><br><span class=\"line\">        con.add(JSPane, BorderLayout.CENTER);</span><br><span class=\"line\">        con.add(pane, BorderLayout.SOUTH);</span><br><span class=\"line\">        mainJframe.setSize(500, 400);</span><br><span class=\"line\">        mainJframe.setLocation(80, 200);</span><br><span class=\"line\">        mainJframe.setVisible(true);</span><br><span class=\"line\">        mainJframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class=\"line\"></span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            connectToServer = new Socket(&quot;localhost&quot;, 8888);</span><br><span class=\"line\">            inFromServer = new DataInputStream(connectToServer.getInputStream());</span><br><span class=\"line\">            outToServer = new DataOutputStream(connectToServer.getOutputStream());</span><br><span class=\"line\">            showArea.append(&quot;  \\n&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">            // </span><br><span class=\"line\">            thread = new Thread(this);</span><br><span class=\"line\">            thread.setPriority(Thread.MIN_PRIORITY);</span><br><span class=\"line\">            thread.start();</span><br><span class=\"line\">        &#125; catch (IOException e) &#123;</span><br><span class=\"line\">            // TODO Auto-generated catch block</span><br><span class=\"line\">            // </span><br><span class=\"line\">            // </span><br><span class=\"line\">            showArea.append(&quot;  \\n&quot;);</span><br><span class=\"line\">            // </span><br><span class=\"line\">            msgText.setEditable(false);</span><br><span class=\"line\">            msgText.setEnabled(false);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    /*</span><br><span class=\"line\">     * (non-Javadoc)</span><br><span class=\"line\">     * </span><br><span class=\"line\">     * @see java.lang.Runnable#run()</span><br><span class=\"line\">     */</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">        public void run() &#123;</span><br><span class=\"line\">            // TODO Auto-generated method stub</span><br><span class=\"line\">            // </span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    showArea.append(&quot;  &quot; + inFromServer.readUTF() + &quot;\\n&quot;);</span><br><span class=\"line\">                    Thread.sleep(1000);</span><br><span class=\"line\">                &#125; catch (IOException | InterruptedException e) &#123;</span><br><span class=\"line\">                    // TODO Auto-generated catch block</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    /*</span><br><span class=\"line\">     * (non-Javadoc)</span><br><span class=\"line\">     * </span><br><span class=\"line\">     * @see</span><br><span class=\"line\">     * java.awt.event.ActionListener#actionPerformed(java.awt.event.ActionEvent)</span><br><span class=\"line\">     */</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">        public void actionPerformed(ActionEvent e) &#123;</span><br><span class=\"line\">            // TODO Auto-generated method stub</span><br><span class=\"line\">            // </span><br><span class=\"line\">            String s = msgText.getText();</span><br><span class=\"line\">            // </span><br><span class=\"line\">            if (s.length() &gt; 0) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    outToServer.writeUTF(s);</span><br><span class=\"line\">                    outToServer.flush();</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    showArea.append(&quot;  &quot; + msgText.getText() + &quot;\\n&quot;);</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    msgText.setText(null);</span><br><span class=\"line\">                &#125; catch (IOException e1) &#123;</span><br><span class=\"line\">                    // TODO Auto-generated catch block</span><br><span class=\"line\">                    // </span><br><span class=\"line\">                    showArea.append(&quot;  &quot; + &quot;&quot; + msgText.getText() + &quot;&quot; + &quot;\\n&quot;);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new ChatClient();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"Java","date":"2018-01-23T06:35:57.000Z","_content":"![pic](http://www.wailian.work/images/2018/01/23/60f198516cee4ab511cb190a85599d3e1d88302a4d1ba-iBehXn_fw658.jpg)\n\n# \n\nCPU\n\n# \n\n## \n\nnew new Thread(r) \n\n## \n\nstart()start()start()run()start()\n\n## \n\nCPUrun()\n\n## \n\nCPU\n\n:\n\n1. Thread.sleep(int millsecond)CPU\n\n2. \n\n3. wait()notify()notifyAll()\n\n4. IOsystem.in\n\n## \n\n\n\n# \n\n## Thread\n\n```\npublic class Thread1 extends Thread {\n    public void run() {\n        // \n    }\n\n    public class Main {\n\n    public static void main(String[] args) {\n        Thread1 mTh1=new Thread1();\n        Thread1 mTh2=new Thread1();\n        mTh1.start();\n        mTh2.start();\n    }\n}\n```\n\nmainjavamainmain()mainstart\n\n\nstart()Runnable\n\n\n\nThread.sleep()CPU\n\n\n\n## Runable()\n\n```\npublic class Thread2 implements Runnable{\n    private String name;\n\n    public Thread2(String name) {\n        this.name=name;\n    }\n\n    @Override\n    public void run() {\n    // \n    }\n}\npublic class Main {\n\n    public static void main(String[] args) {\n        new Thread(new Thread2(\"C\")).start();\n        new Thread(new Thread2(\"D\")).start();\n    }\n}\n```\n\n## \n\nThreadRunable\n\n\nRunnableThread\n1.  \n2. java\n3. \n4. RunablecallableThread\n\nmainjavaCPU\n\nJava2mainjavaJVMJVM\n\n# \n\n![](http://www.wailian.work/images/2018/01/23/20170717150938439.jpg)\n\n# \n\nJava()\nJava1~10Thread\n\n```\nstatic int MAX_PRIORITY  = 10;  //\nstatic int MIN_PRIORITY  = 1;   //\nstatic int NORM_PRIORITY = 5;   //\n```\nThreadsetPriority()getPriority()\n\n# \n\nThread.sleep(long millis)millisRunnablesleep()\n\n# \n\nObjectwait() notify()  notifyAll() Object wait(0) \n\n# \n\nThread.yield() \n\n# \n\njoin()join()\n\n# \n\nObjectnotify() wait  notifyAll()\n\nThreadsuspend()resume()JDK1.5\n\n# \n\n## sleep(long millis)\n\n\n\n# join\n\njoinThreadjoin()join()\n\n## \n\njoin()\n\n```\npublic class Main {\n\n    public static void main(String[] args) {\n        System.out.println(\"!\");\n        Thread1 mTh1=new Thread1(\"A\");\n        Thread1 mTh2=new Thread1(\"B\");\n        mTh1.start();\n        mTh2.start();\n        try {\n            mTh1.join();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        try {\n            mTh2.join();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(\"!\");\n    }\n}\n```\n\n# yield():\n\nThread.yield()\n\nyield()yield()yield()\n\nyield()//yield()\n\n# sleep()yield()\n\nsleep()sleep()yield()yield()\n\nsleep yield  CPU yield() CPU yield()\n\nsleep  yield()  CPU  sleep  I\\O \n\n# wait\n\nwait() notify  notifyAll notify  notifyAll notifynotifyAllnotifynotifyAll\n\nwait()wait()ThreadThread.wait()JavaThread.sleep()wait() ObjectwaitObject\n\nsynchronizedwaitsynchronizedsynchronizedsynchronized\n\n## loop wait  notify If \n\nwaitsynchronizedwhileifwaitififwhilewhileifwait\n\nwhilewaitwaitnotify\n\nwaitnotifyPRODUCERCONSUMERProducerConsumerProducerConsumerThreadProducerConsumerrun()MainLinkedListJavaLinkedListLinkedListLinkedListwhile(queue.size == maxSize)synchronizedPRODUCERCONSUMERnotifyPRODUCERwaitnotify\n\n```\nimport java.util.LinkedList;\nimport java.util.Queue;\nimport java.util.Random;\n/**\n* Simple Java program to demonstrate How to use wait, notify and notifyAll()\n* method in Java by solving producer consumer problem.\n*/\npublic class ProducerConsumerInJava {\n    public static void main(String args[]) {\n        System.out.println(\"How to use wait and notify method in Java\");\n        System.out.println(\"Solving Producer Consumper Problem\");\n        Queue<Integer> buffer = new LinkedList<>();\n        int maxSize = 10;\n        Thread producer = new Producer(buffer, maxSize, \"PRODUCER\");\n        Thread consumer = new Consumer(buffer, maxSize, \"CONSUMER\");\n        producer.start(); consumer.start(); }\n    }\n    /**\n    * Producer Thread will keep producing values for Consumer\n    * to consumer. It will use wait() method when Queue is full\n    * and use notify() method to send notification to Consumer\n    * Thread.\n    */\n    class Producer extends Thread\n    {\n        private Queue<Integer> queue;\n        private int maxSize;\n        public Producer(Queue<Integer> queue, int maxSize, String name){\n            super(name); this.queue = queue; this.maxSize = maxSize;\n        }\n        @Override public void run()\n        {\n            while (true)\n                {\n                    synchronized (queue) {\n                        while (queue.size() == maxSize) {\n                            try {\n                                System.out .println(\"Queue is full, \" + \"Producer thread waiting for \" + \"consumer to take something from queue\");\n                                queue.wait();\n                            } catch (Exception ex) {\n                                ex.printStackTrace(); }\n                            }\n                            Random random = new Random();\n                            int i = random.nextInt();\n                            System.out.println(\"Producing value : \" + i); queue.add(i); queue.notifyAll();\n                        }\n                    }\n                }\n            }\n    /**\n    * Consumer Thread will consumer values form shared queue.\n    * It will also use wait() method to wait if queue is\n    * empty. It will also use notify method to send\n    * notification to producer thread after consuming values\n    * from queue.\n    */\n    class Consumer extends Thread {\n        private Queue<Integer> queue;\n        private int maxSize;\n        public Consumer(Queue<Integer> queue, int maxSize, String name){\n            super(name);\n            this.queue = queue;\n            this.maxSize = maxSize;\n        }\n        @Override public void run() {\n            while (true) {\n                synchronized (queue) {\n                    while (queue.isEmpty()) {\n                        System.out.println(\"Queue is empty,\" + \"Consumer thread is waiting\" + \" for producer thread to put something in queue\");\n                        try {\n                            queue.wait();\n                        } catch (Exception ex) {\n                            ex.printStackTrace();\n                        }\n                    }\n                    System.out.println(\"Consuming value : \" + queue.remove()); queue.notifyAll();\n                }\n            }\n        }\n    }\n```\n\n![](http://www.wailian.work/images/2018/01/23/20170805131528961.png)\n\ndebugdebugPRODUCERCONSUMERCPUwait()EclipseStep intoStep over\n\n# \n\n```\npublic class ProducerConsumerWithQueue {\n    private int queueSize = 10;\n    private ArrayBlockingQueue<Integer> queue = new ArrayBlockingQueue<Integer>(queueSize);\n\n    public static void main(String[] args) {\n        ProducerConsumerWithQueue test = new ProducerConsumerWithQueue();\n        Producer producer = test.new Producer();\n        Consumer consumer = test.new Consumer();\n\n        producer.start();\n        consumer.start();\n    }\n\n    class Consumer extends Thread {\n\n        @Override\n        public void run() {\n            while (true) {\n                try {\n                    queue.take();\n                    System.out.println(\"\" + queue.size() + \"\");\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }\n\n    class Producer extends Thread {\n\n        @Override\n        public void run() {\n            while (true) {\n                try {\n                    queue.put(1);\n                    System.out.println(\"\" + (queueSize - queue.size()));\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }\n}\n```\n\n## \n\n| \\|     |    ||\n| --------   | -----:   | :----: |\n| | add(e)      |   offer(e)    |put(e)|offer(e,time,unit)\n| | remove()|poll()|take()|poll(time,unit)\n| | element()|  peek()    ||\n\n# \n\n```\n/**\n* \n*\n*/\npublic class ThreadA {\n    public static void main(String[] args) throws InterruptedException{\n        ThreadB b = new ThreadB();\n        //\n        b.start();\n        //Abwait()notify()\n        synchronized (b) {\n            System.out.println(\"b\");\n            //A\n            b.wait();\n            System.out.println(\"b\" + b.total);\n        }\n    }\n}\n\n\n\n/**\n* 1+2+3 ... +100\n*\n*/\nclass ThreadB extends Thread {\n    int total;\n\n    public void run() {\n        synchronized (this) {\n            for (int i = 0; i < 101; i++) {\n                total += i;\n            }\n            //A\n            notify();\n            System.out.println(\"\");\n        }\n    }\n}\n```\n\n\n\nb\n\nb5050\n\nb.wait()\n\nb\nb0\n\n\nb.wait()ThreadBThreadA\n\nThreadBb.wait()\n\nb.wait()Thread.currentThread.wait()\n\nb.wait()Thread.currentThread.wait()\n\nException in thread main java.lang.IllegalMonitorStateException\nat java.lang.Object.wait(Native Method)\nat java.lang.Object.wait(Object.java:485)\nat pa.com.thread.ThreadA.main(ThreadA.java:18)\nb\n\n\nThread.currentThread.wait()\n\n\n\nThreadAb\n\nThreadAbb.wait()ThreadBbrun()notify()ThreadAThreadA\n\nThreadBbsynchronized(this)thisThreadBb\n\nThread.currentThread.wait()ThreadAwait()ThreadAbwait()b.wait()\n\nwait()sleep()\n\nb.wait()Thread.sleep(1000)\n\nb\nb0\n\n\nThread.sleep(1000)ThreadA1ThreadAThreadB\n\n\n\nwait()wait()  wait()\n\nsleep()\n\n\n\nwaitnotifynotifyAllObjectfinal nativeObjectwait\n\n```\nwait();//1\nthis.wait();//2\nsuper.wait();//3\n```\n\nvoid wait()\n\nnotify()notifyAllIllegalMonitorStateException\n\n# synchronized\n\n\n\n```\npublic class Seller implements Runnable {\n    private String name;\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    @Override\n    public void run() {\n        synchronized (this) {\n            if (Synchronized.ticket > 0) {\n                System.out.println(\",\" + Synchronized.ticket);\n                Synchronized.ticket--;\n                try {\n                    Thread.sleep(100);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }\n}\n```\n\n```\npublic class Synchronized {\n    static Integer ticket = 100;\n\n    public static void main(String[] args) {\n        Seller s = new Seller();\n        Thread t1 = new Thread(s);\n        Thread t2 = new Thread(s);\n        Thread t3 = new Thread(s);\n        Thread t4 = new Thread(s);\n        Thread t5 = new Thread(s);\n        Thread t6 = new Thread(s);\n\n        t1.start();\n        t2.start();\n        t3.start();\n        t4.start();\n        t5.start();\n        t6.start();\n    }\n}\n```\n\n[](https://github.com/wangweiye01/mutiThreading)\n","source":"_posts/java-thread.md","raw":"---\ntitle: Java\ndate: 2018-01-23 14:35:57\ntags:\n---\n![pic](http://www.wailian.work/images/2018/01/23/60f198516cee4ab511cb190a85599d3e1d88302a4d1ba-iBehXn_fw658.jpg)\n\n# \n\nCPU\n\n# \n\n## \n\nnew new Thread(r) \n\n## \n\nstart()start()start()run()start()\n\n## \n\nCPUrun()\n\n## \n\nCPU\n\n:\n\n1. Thread.sleep(int millsecond)CPU\n\n2. \n\n3. wait()notify()notifyAll()\n\n4. IOsystem.in\n\n## \n\n\n\n# \n\n## Thread\n\n```\npublic class Thread1 extends Thread {\n    public void run() {\n        // \n    }\n\n    public class Main {\n\n    public static void main(String[] args) {\n        Thread1 mTh1=new Thread1();\n        Thread1 mTh2=new Thread1();\n        mTh1.start();\n        mTh2.start();\n    }\n}\n```\n\nmainjavamainmain()mainstart\n\n\nstart()Runnable\n\n\n\nThread.sleep()CPU\n\n\n\n## Runable()\n\n```\npublic class Thread2 implements Runnable{\n    private String name;\n\n    public Thread2(String name) {\n        this.name=name;\n    }\n\n    @Override\n    public void run() {\n    // \n    }\n}\npublic class Main {\n\n    public static void main(String[] args) {\n        new Thread(new Thread2(\"C\")).start();\n        new Thread(new Thread2(\"D\")).start();\n    }\n}\n```\n\n## \n\nThreadRunable\n\n\nRunnableThread\n1.  \n2. java\n3. \n4. RunablecallableThread\n\nmainjavaCPU\n\nJava2mainjavaJVMJVM\n\n# \n\n![](http://www.wailian.work/images/2018/01/23/20170717150938439.jpg)\n\n# \n\nJava()\nJava1~10Thread\n\n```\nstatic int MAX_PRIORITY  = 10;  //\nstatic int MIN_PRIORITY  = 1;   //\nstatic int NORM_PRIORITY = 5;   //\n```\nThreadsetPriority()getPriority()\n\n# \n\nThread.sleep(long millis)millisRunnablesleep()\n\n# \n\nObjectwait() notify()  notifyAll() Object wait(0) \n\n# \n\nThread.yield() \n\n# \n\njoin()join()\n\n# \n\nObjectnotify() wait  notifyAll()\n\nThreadsuspend()resume()JDK1.5\n\n# \n\n## sleep(long millis)\n\n\n\n# join\n\njoinThreadjoin()join()\n\n## \n\njoin()\n\n```\npublic class Main {\n\n    public static void main(String[] args) {\n        System.out.println(\"!\");\n        Thread1 mTh1=new Thread1(\"A\");\n        Thread1 mTh2=new Thread1(\"B\");\n        mTh1.start();\n        mTh2.start();\n        try {\n            mTh1.join();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        try {\n            mTh2.join();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(\"!\");\n    }\n}\n```\n\n# yield():\n\nThread.yield()\n\nyield()yield()yield()\n\nyield()//yield()\n\n# sleep()yield()\n\nsleep()sleep()yield()yield()\n\nsleep yield  CPU yield() CPU yield()\n\nsleep  yield()  CPU  sleep  I\\O \n\n# wait\n\nwait() notify  notifyAll notify  notifyAll notifynotifyAllnotifynotifyAll\n\nwait()wait()ThreadThread.wait()JavaThread.sleep()wait() ObjectwaitObject\n\nsynchronizedwaitsynchronizedsynchronizedsynchronized\n\n## loop wait  notify If \n\nwaitsynchronizedwhileifwaitififwhilewhileifwait\n\nwhilewaitwaitnotify\n\nwaitnotifyPRODUCERCONSUMERProducerConsumerProducerConsumerThreadProducerConsumerrun()MainLinkedListJavaLinkedListLinkedListLinkedListwhile(queue.size == maxSize)synchronizedPRODUCERCONSUMERnotifyPRODUCERwaitnotify\n\n```\nimport java.util.LinkedList;\nimport java.util.Queue;\nimport java.util.Random;\n/**\n* Simple Java program to demonstrate How to use wait, notify and notifyAll()\n* method in Java by solving producer consumer problem.\n*/\npublic class ProducerConsumerInJava {\n    public static void main(String args[]) {\n        System.out.println(\"How to use wait and notify method in Java\");\n        System.out.println(\"Solving Producer Consumper Problem\");\n        Queue<Integer> buffer = new LinkedList<>();\n        int maxSize = 10;\n        Thread producer = new Producer(buffer, maxSize, \"PRODUCER\");\n        Thread consumer = new Consumer(buffer, maxSize, \"CONSUMER\");\n        producer.start(); consumer.start(); }\n    }\n    /**\n    * Producer Thread will keep producing values for Consumer\n    * to consumer. It will use wait() method when Queue is full\n    * and use notify() method to send notification to Consumer\n    * Thread.\n    */\n    class Producer extends Thread\n    {\n        private Queue<Integer> queue;\n        private int maxSize;\n        public Producer(Queue<Integer> queue, int maxSize, String name){\n            super(name); this.queue = queue; this.maxSize = maxSize;\n        }\n        @Override public void run()\n        {\n            while (true)\n                {\n                    synchronized (queue) {\n                        while (queue.size() == maxSize) {\n                            try {\n                                System.out .println(\"Queue is full, \" + \"Producer thread waiting for \" + \"consumer to take something from queue\");\n                                queue.wait();\n                            } catch (Exception ex) {\n                                ex.printStackTrace(); }\n                            }\n                            Random random = new Random();\n                            int i = random.nextInt();\n                            System.out.println(\"Producing value : \" + i); queue.add(i); queue.notifyAll();\n                        }\n                    }\n                }\n            }\n    /**\n    * Consumer Thread will consumer values form shared queue.\n    * It will also use wait() method to wait if queue is\n    * empty. It will also use notify method to send\n    * notification to producer thread after consuming values\n    * from queue.\n    */\n    class Consumer extends Thread {\n        private Queue<Integer> queue;\n        private int maxSize;\n        public Consumer(Queue<Integer> queue, int maxSize, String name){\n            super(name);\n            this.queue = queue;\n            this.maxSize = maxSize;\n        }\n        @Override public void run() {\n            while (true) {\n                synchronized (queue) {\n                    while (queue.isEmpty()) {\n                        System.out.println(\"Queue is empty,\" + \"Consumer thread is waiting\" + \" for producer thread to put something in queue\");\n                        try {\n                            queue.wait();\n                        } catch (Exception ex) {\n                            ex.printStackTrace();\n                        }\n                    }\n                    System.out.println(\"Consuming value : \" + queue.remove()); queue.notifyAll();\n                }\n            }\n        }\n    }\n```\n\n![](http://www.wailian.work/images/2018/01/23/20170805131528961.png)\n\ndebugdebugPRODUCERCONSUMERCPUwait()EclipseStep intoStep over\n\n# \n\n```\npublic class ProducerConsumerWithQueue {\n    private int queueSize = 10;\n    private ArrayBlockingQueue<Integer> queue = new ArrayBlockingQueue<Integer>(queueSize);\n\n    public static void main(String[] args) {\n        ProducerConsumerWithQueue test = new ProducerConsumerWithQueue();\n        Producer producer = test.new Producer();\n        Consumer consumer = test.new Consumer();\n\n        producer.start();\n        consumer.start();\n    }\n\n    class Consumer extends Thread {\n\n        @Override\n        public void run() {\n            while (true) {\n                try {\n                    queue.take();\n                    System.out.println(\"\" + queue.size() + \"\");\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }\n\n    class Producer extends Thread {\n\n        @Override\n        public void run() {\n            while (true) {\n                try {\n                    queue.put(1);\n                    System.out.println(\"\" + (queueSize - queue.size()));\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }\n}\n```\n\n## \n\n| \\|     |    ||\n| --------   | -----:   | :----: |\n| | add(e)      |   offer(e)    |put(e)|offer(e,time,unit)\n| | remove()|poll()|take()|poll(time,unit)\n| | element()|  peek()    ||\n\n# \n\n```\n/**\n* \n*\n*/\npublic class ThreadA {\n    public static void main(String[] args) throws InterruptedException{\n        ThreadB b = new ThreadB();\n        //\n        b.start();\n        //Abwait()notify()\n        synchronized (b) {\n            System.out.println(\"b\");\n            //A\n            b.wait();\n            System.out.println(\"b\" + b.total);\n        }\n    }\n}\n\n\n\n/**\n* 1+2+3 ... +100\n*\n*/\nclass ThreadB extends Thread {\n    int total;\n\n    public void run() {\n        synchronized (this) {\n            for (int i = 0; i < 101; i++) {\n                total += i;\n            }\n            //A\n            notify();\n            System.out.println(\"\");\n        }\n    }\n}\n```\n\n\n\nb\n\nb5050\n\nb.wait()\n\nb\nb0\n\n\nb.wait()ThreadBThreadA\n\nThreadBb.wait()\n\nb.wait()Thread.currentThread.wait()\n\nb.wait()Thread.currentThread.wait()\n\nException in thread main java.lang.IllegalMonitorStateException\nat java.lang.Object.wait(Native Method)\nat java.lang.Object.wait(Object.java:485)\nat pa.com.thread.ThreadA.main(ThreadA.java:18)\nb\n\n\nThread.currentThread.wait()\n\n\n\nThreadAb\n\nThreadAbb.wait()ThreadBbrun()notify()ThreadAThreadA\n\nThreadBbsynchronized(this)thisThreadBb\n\nThread.currentThread.wait()ThreadAwait()ThreadAbwait()b.wait()\n\nwait()sleep()\n\nb.wait()Thread.sleep(1000)\n\nb\nb0\n\n\nThread.sleep(1000)ThreadA1ThreadAThreadB\n\n\n\nwait()wait()  wait()\n\nsleep()\n\n\n\nwaitnotifynotifyAllObjectfinal nativeObjectwait\n\n```\nwait();//1\nthis.wait();//2\nsuper.wait();//3\n```\n\nvoid wait()\n\nnotify()notifyAllIllegalMonitorStateException\n\n# synchronized\n\n\n\n```\npublic class Seller implements Runnable {\n    private String name;\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    @Override\n    public void run() {\n        synchronized (this) {\n            if (Synchronized.ticket > 0) {\n                System.out.println(\",\" + Synchronized.ticket);\n                Synchronized.ticket--;\n                try {\n                    Thread.sleep(100);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }\n}\n```\n\n```\npublic class Synchronized {\n    static Integer ticket = 100;\n\n    public static void main(String[] args) {\n        Seller s = new Seller();\n        Thread t1 = new Thread(s);\n        Thread t2 = new Thread(s);\n        Thread t3 = new Thread(s);\n        Thread t4 = new Thread(s);\n        Thread t5 = new Thread(s);\n        Thread t6 = new Thread(s);\n\n        t1.start();\n        t2.start();\n        t3.start();\n        t4.start();\n        t5.start();\n        t6.start();\n    }\n}\n```\n\n[](https://github.com/wangweiye01/mutiThreading)\n","slug":"java-thread","published":1,"updated":"2019-12-24T02:00:57.350Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckc5n3k5w00250j9k18tfkz2o","content":"<p><img src=\"http://www.wailian.work/images/2018/01/23/60f198516cee4ab511cb190a85599d3e1d88302a4d1ba-iBehXn_fw658.jpg\" alt=\"pic\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>CPU</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>new new Thread(r) </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>start()start()start()run()start()</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>CPUrun()</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>CPU</p>\n<p>:</p>\n<ol>\n<li><p>Thread.sleep(int millsecond)CPU</p>\n</li>\n<li><p></p>\n</li>\n<li><p>wait()notify()notifyAll()</p>\n</li>\n<li><p>IOsystem.in</p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Thread\"><a href=\"#Thread\" class=\"headerlink\" title=\"Thread\"></a>Thread</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Thread1 extends Thread &#123;</span><br><span class=\"line\">    public void run() &#123;</span><br><span class=\"line\">        // </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public class Main &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        Thread1 mTh1=new Thread1();</span><br><span class=\"line\">        Thread1 mTh2=new Thread1();</span><br><span class=\"line\">        mTh1.start();</span><br><span class=\"line\">        mTh2.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>mainjavamainmain()mainstart</p>\n<p><br>start()Runnable</p>\n<p></p>\n<p>Thread.sleep()CPU</p>\n<p></p>\n<h2 id=\"Runable-\"><a href=\"#Runable-\" class=\"headerlink\" title=\"Runable()\"></a>Runable()</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Thread2 implements Runnable&#123;</span><br><span class=\"line\">    private String name;</span><br><span class=\"line\"></span><br><span class=\"line\">    public Thread2(String name) &#123;</span><br><span class=\"line\">        this.name=name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void run() &#123;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">public class Main &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new Thread(new Thread2(&quot;C&quot;)).start();</span><br><span class=\"line\">        new Thread(new Thread2(&quot;D&quot;)).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ThreadRunable</p>\n<p><br>RunnableThread</p>\n<ol>\n<li> </li>\n<li>java</li>\n<li></li>\n<li>RunablecallableThread</li>\n</ol>\n<p>mainjavaCPU</p>\n<p>Java2mainjavaJVMJVM</p>\n<h1 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"http://www.wailian.work/images/2018/01/23/20170717150938439.jpg\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Java()<br>Java1~10Thread</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">static int MAX_PRIORITY  = 10;  //</span><br><span class=\"line\">static int MIN_PRIORITY  = 1;   //</span><br><span class=\"line\">static int NORM_PRIORITY = 5;   //</span><br></pre></td></tr></table></figure>\n<p>ThreadsetPriority()getPriority()</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Thread.sleep(long millis)millisRunnablesleep()</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Objectwait() notify()  notifyAll() Object wait(0) </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Thread.yield() </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>join()join()</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Objectnotify() wait  notifyAll()</p>\n<p>Threadsuspend()resume()JDK1.5</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"sleep-long-millis\"><a href=\"#sleep-long-millis\" class=\"headerlink\" title=\"sleep(long millis)\"></a>sleep(long millis)</h2><p></p>\n<h1 id=\"join\"><a href=\"#join\" class=\"headerlink\" title=\"join\"></a>join</h1><p>joinThreadjoin()join()</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>join()</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Main &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        System.out.println(&quot;!&quot;);</span><br><span class=\"line\">        Thread1 mTh1=new Thread1(&quot;A&quot;);</span><br><span class=\"line\">        Thread1 mTh2=new Thread1(&quot;B&quot;);</span><br><span class=\"line\">        mTh1.start();</span><br><span class=\"line\">        mTh2.start();</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            mTh1.join();</span><br><span class=\"line\">        &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            mTh2.join();</span><br><span class=\"line\">        &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(&quot;!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"yield-\"><a href=\"#yield-\" class=\"headerlink\" title=\"yield():\"></a>yield():</h1><p>Thread.yield()</p>\n<p>yield()yield()yield()</p>\n<p>yield()//yield()</p>\n<h1 id=\"sleep-yield-\"><a href=\"#sleep-yield-\" class=\"headerlink\" title=\"sleep()yield()\"></a>sleep()yield()</h1><p>sleep()sleep()yield()yield()</p>\n<p>sleep yield  CPU yield() CPU yield()</p>\n<p>sleep  yield()  CPU  sleep  I\\O </p>\n<h1 id=\"wait\"><a href=\"#wait\" class=\"headerlink\" title=\"wait\"></a>wait</h1><p>wait() notify  notifyAll notify  notifyAll notifynotifyAllnotifynotifyAll</p>\n<p>wait()wait()ThreadThread.wait()JavaThread.sleep()wait() ObjectwaitObject</p>\n<p>synchronizedwaitsynchronizedsynchronizedsynchronized</p>\n<h2 id=\"loop-wait--notify-If-\"><a href=\"#loop-wait--notify-If-\" class=\"headerlink\" title=\"loop wait  notify If \"></a>loop wait  notify If </h2><p>waitsynchronizedwhileifwaitififwhilewhileifwait</p>\n<p>whilewaitwaitnotify</p>\n<p>waitnotifyPRODUCERCONSUMERProducerConsumerProducerConsumerThreadProducerConsumerrun()MainLinkedListJavaLinkedListLinkedListLinkedListwhile(queue.size == maxSize)synchronizedPRODUCERCONSUMERnotifyPRODUCERwaitnotify</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import java.util.LinkedList;</span><br><span class=\"line\">import java.util.Queue;</span><br><span class=\"line\">import java.util.Random;</span><br><span class=\"line\">/**</span><br><span class=\"line\">* Simple Java program to demonstrate How to use wait, notify and notifyAll()</span><br><span class=\"line\">* method in Java by solving producer consumer problem.</span><br><span class=\"line\">*/</span><br><span class=\"line\">public class ProducerConsumerInJava &#123;</span><br><span class=\"line\">    public static void main(String args[]) &#123;</span><br><span class=\"line\">        System.out.println(&quot;How to use wait and notify method in Java&quot;);</span><br><span class=\"line\">        System.out.println(&quot;Solving Producer Consumper Problem&quot;);</span><br><span class=\"line\">        Queue&lt;Integer&gt; buffer = new LinkedList&lt;&gt;();</span><br><span class=\"line\">        int maxSize = 10;</span><br><span class=\"line\">        Thread producer = new Producer(buffer, maxSize, &quot;PRODUCER&quot;);</span><br><span class=\"line\">        Thread consumer = new Consumer(buffer, maxSize, &quot;CONSUMER&quot;);</span><br><span class=\"line\">        producer.start(); consumer.start(); &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    /**</span><br><span class=\"line\">    * Producer Thread will keep producing values for Consumer</span><br><span class=\"line\">    * to consumer. It will use wait() method when Queue is full</span><br><span class=\"line\">    * and use notify() method to send notification to Consumer</span><br><span class=\"line\">    * Thread.</span><br><span class=\"line\">    */</span><br><span class=\"line\">    class Producer extends Thread</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        private Queue&lt;Integer&gt; queue;</span><br><span class=\"line\">        private int maxSize;</span><br><span class=\"line\">        public Producer(Queue&lt;Integer&gt; queue, int maxSize, String name)&#123;</span><br><span class=\"line\">            super(name); this.queue = queue; this.maxSize = maxSize;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        @Override public void run()</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            while (true)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    synchronized (queue) &#123;</span><br><span class=\"line\">                        while (queue.size() == maxSize) &#123;</span><br><span class=\"line\">                            try &#123;</span><br><span class=\"line\">                                System.out .println(&quot;Queue is full, &quot; + &quot;Producer thread waiting for &quot; + &quot;consumer to take something from queue&quot;);</span><br><span class=\"line\">                                queue.wait();</span><br><span class=\"line\">                            &#125; catch (Exception ex) &#123;</span><br><span class=\"line\">                                ex.printStackTrace(); &#125;</span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                            Random random = new Random();</span><br><span class=\"line\">                            int i = random.nextInt();</span><br><span class=\"line\">                            System.out.println(&quot;Producing value : &quot; + i); queue.add(i); queue.notifyAll();</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">    /**</span><br><span class=\"line\">    * Consumer Thread will consumer values form shared queue.</span><br><span class=\"line\">    * It will also use wait() method to wait if queue is</span><br><span class=\"line\">    * empty. It will also use notify method to send</span><br><span class=\"line\">    * notification to producer thread after consuming values</span><br><span class=\"line\">    * from queue.</span><br><span class=\"line\">    */</span><br><span class=\"line\">    class Consumer extends Thread &#123;</span><br><span class=\"line\">        private Queue&lt;Integer&gt; queue;</span><br><span class=\"line\">        private int maxSize;</span><br><span class=\"line\">        public Consumer(Queue&lt;Integer&gt; queue, int maxSize, String name)&#123;</span><br><span class=\"line\">            super(name);</span><br><span class=\"line\">            this.queue = queue;</span><br><span class=\"line\">            this.maxSize = maxSize;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        @Override public void run() &#123;</span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                synchronized (queue) &#123;</span><br><span class=\"line\">                    while (queue.isEmpty()) &#123;</span><br><span class=\"line\">                        System.out.println(&quot;Queue is empty,&quot; + &quot;Consumer thread is waiting&quot; + &quot; for producer thread to put something in queue&quot;);</span><br><span class=\"line\">                        try &#123;</span><br><span class=\"line\">                            queue.wait();</span><br><span class=\"line\">                        &#125; catch (Exception ex) &#123;</span><br><span class=\"line\">                            ex.printStackTrace();</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    System.out.println(&quot;Consuming value : &quot; + queue.remove()); queue.notifyAll();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://www.wailian.work/images/2018/01/23/20170805131528961.png\" alt=\"\"></p>\n<p>debugdebugPRODUCERCONSUMERCPUwait()EclipseStep intoStep over</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class ProducerConsumerWithQueue &#123;</span><br><span class=\"line\">    private int queueSize = 10;</span><br><span class=\"line\">    private ArrayBlockingQueue&lt;Integer&gt; queue = new ArrayBlockingQueue&lt;Integer&gt;(queueSize);</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        ProducerConsumerWithQueue test = new ProducerConsumerWithQueue();</span><br><span class=\"line\">        Producer producer = test.new Producer();</span><br><span class=\"line\">        Consumer consumer = test.new Consumer();</span><br><span class=\"line\"></span><br><span class=\"line\">        producer.start();</span><br><span class=\"line\">        consumer.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    class Consumer extends Thread &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void run() &#123;</span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    queue.take();</span><br><span class=\"line\">                    System.out.println(&quot;&quot; + queue.size() + &quot;&quot;);</span><br><span class=\"line\">                &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    class Producer extends Thread &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void run() &#123;</span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    queue.put(1);</span><br><span class=\"line\">                    System.out.println(&quot;&quot; + (queueSize - queue.size()));</span><br><span class=\"line\">                &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><table>\n<thead>\n<tr>\n<th>\\</th>\n<th style=\"text-align:right\"></th>\n<th style=\"text-align:center\"></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td></td>\n<td style=\"text-align:right\">add(e)</td>\n<td style=\"text-align:center\">offer(e)</td>\n<td>put(e)</td>\n<td>offer(e,time,unit)</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:right\">remove()</td>\n<td style=\"text-align:center\">poll()</td>\n<td>take()</td>\n<td>poll(time,unit)</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:right\">element()</td>\n<td style=\"text-align:center\">peek()</td>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/**</span><br><span class=\"line\">* </span><br><span class=\"line\">*</span><br><span class=\"line\">*/</span><br><span class=\"line\">public class ThreadA &#123;</span><br><span class=\"line\">    public static void main(String[] args) throws InterruptedException&#123;</span><br><span class=\"line\">        ThreadB b = new ThreadB();</span><br><span class=\"line\">        //</span><br><span class=\"line\">        b.start();</span><br><span class=\"line\">        //Abwait()notify()</span><br><span class=\"line\">        synchronized (b) &#123;</span><br><span class=\"line\">            System.out.println(&quot;b&quot;);</span><br><span class=\"line\">            //A</span><br><span class=\"line\">            b.wait();</span><br><span class=\"line\">            System.out.println(&quot;b&quot; + b.total);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">/**</span><br><span class=\"line\">* 1+2+3 ... +100</span><br><span class=\"line\">*</span><br><span class=\"line\">*/</span><br><span class=\"line\">class ThreadB extends Thread &#123;</span><br><span class=\"line\">    int total;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void run() &#123;</span><br><span class=\"line\">        synchronized (this) &#123;</span><br><span class=\"line\">            for (int i = 0; i &lt; 101; i++) &#123;</span><br><span class=\"line\">                total += i;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            //A</span><br><span class=\"line\">            notify();</span><br><span class=\"line\">            System.out.println(&quot;&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>b<br><br>b5050</p>\n<p>b.wait()</p>\n<p>b<br>b0<br></p>\n<p>b.wait()ThreadBThreadA</p>\n<p>ThreadBb.wait()</p>\n<p>b.wait()Thread.currentThread.wait()</p>\n<p>b.wait()Thread.currentThread.wait()</p>\n<p>Exception in thread main java.lang.IllegalMonitorStateException<br>at java.lang.Object.wait(Native Method)<br>at java.lang.Object.wait(Object.java:485)<br>at pa.com.thread.ThreadA.main(ThreadA.java:18)<br>b<br></p>\n<p>Thread.currentThread.wait()</p>\n<p></p>\n<p>ThreadAb</p>\n<p>ThreadAbb.wait()ThreadBbrun()notify()ThreadAThreadA</p>\n<p>ThreadBbsynchronized(this)thisThreadBb</p>\n<p>Thread.currentThread.wait()ThreadAwait()ThreadAbwait()b.wait()</p>\n<p>wait()sleep()</p>\n<p>b.wait()Thread.sleep(1000)</p>\n<p>b<br>b0<br></p>\n<p>Thread.sleep(1000)ThreadA1ThreadAThreadB</p>\n<p></p>\n<p>wait()wait()  wait()</p>\n<p>sleep()</p>\n<p></p>\n<p>waitnotifynotifyAllObjectfinal nativeObjectwait</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wait();//1</span><br><span class=\"line\">this.wait();//2</span><br><span class=\"line\">super.wait();//3</span><br></pre></td></tr></table></figure>\n<p>void wait()</p>\n<p>notify()notifyAllIllegalMonitorStateException</p>\n<h1 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h1><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Seller implements Runnable &#123;</span><br><span class=\"line\">    private String name;</span><br><span class=\"line\"></span><br><span class=\"line\">    public String getName() &#123;</span><br><span class=\"line\">        return name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void setName(String name) &#123;</span><br><span class=\"line\">        this.name = name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void run() &#123;</span><br><span class=\"line\">        synchronized (this) &#123;</span><br><span class=\"line\">            if (Synchronized.ticket &gt; 0) &#123;</span><br><span class=\"line\">                System.out.println(&quot;,&quot; + Synchronized.ticket);</span><br><span class=\"line\">                Synchronized.ticket--;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    Thread.sleep(100);</span><br><span class=\"line\">                &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Synchronized &#123;</span><br><span class=\"line\">    static Integer ticket = 100;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        Seller s = new Seller();</span><br><span class=\"line\">        Thread t1 = new Thread(s);</span><br><span class=\"line\">        Thread t2 = new Thread(s);</span><br><span class=\"line\">        Thread t3 = new Thread(s);</span><br><span class=\"line\">        Thread t4 = new Thread(s);</span><br><span class=\"line\">        Thread t5 = new Thread(s);</span><br><span class=\"line\">        Thread t6 = new Thread(s);</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\">        t3.start();</span><br><span class=\"line\">        t4.start();</span><br><span class=\"line\">        t5.start();</span><br><span class=\"line\">        t6.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://github.com/wangweiye01/mutiThreading\" target=\"_blank\" rel=\"noopener\"></a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><img src=\"http://www.wailian.work/images/2018/01/23/60f198516cee4ab511cb190a85599d3e1d88302a4d1ba-iBehXn_fw658.jpg\" alt=\"pic\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>CPU</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>new new Thread(r) </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>start()start()start()run()start()</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>CPUrun()</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>CPU</p>\n<p>:</p>\n<ol>\n<li><p>Thread.sleep(int millsecond)CPU</p>\n</li>\n<li><p></p>\n</li>\n<li><p>wait()notify()notifyAll()</p>\n</li>\n<li><p>IOsystem.in</p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"Thread\"><a href=\"#Thread\" class=\"headerlink\" title=\"Thread\"></a>Thread</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Thread1 extends Thread &#123;</span><br><span class=\"line\">    public void run() &#123;</span><br><span class=\"line\">        // </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public class Main &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        Thread1 mTh1=new Thread1();</span><br><span class=\"line\">        Thread1 mTh2=new Thread1();</span><br><span class=\"line\">        mTh1.start();</span><br><span class=\"line\">        mTh2.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>mainjavamainmain()mainstart</p>\n<p><br>start()Runnable</p>\n<p></p>\n<p>Thread.sleep()CPU</p>\n<p></p>\n<h2 id=\"Runable-\"><a href=\"#Runable-\" class=\"headerlink\" title=\"Runable()\"></a>Runable()</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Thread2 implements Runnable&#123;</span><br><span class=\"line\">    private String name;</span><br><span class=\"line\"></span><br><span class=\"line\">    public Thread2(String name) &#123;</span><br><span class=\"line\">        this.name=name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void run() &#123;</span><br><span class=\"line\">    // </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">public class Main &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        new Thread(new Thread2(&quot;C&quot;)).start();</span><br><span class=\"line\">        new Thread(new Thread2(&quot;D&quot;)).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ThreadRunable</p>\n<p><br>RunnableThread</p>\n<ol>\n<li> </li>\n<li>java</li>\n<li></li>\n<li>RunablecallableThread</li>\n</ol>\n<p>mainjavaCPU</p>\n<p>Java2mainjavaJVMJVM</p>\n<h1 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"http://www.wailian.work/images/2018/01/23/20170717150938439.jpg\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Java()<br>Java1~10Thread</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">static int MAX_PRIORITY  = 10;  //</span><br><span class=\"line\">static int MIN_PRIORITY  = 1;   //</span><br><span class=\"line\">static int NORM_PRIORITY = 5;   //</span><br></pre></td></tr></table></figure>\n<p>ThreadsetPriority()getPriority()</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Thread.sleep(long millis)millisRunnablesleep()</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Objectwait() notify()  notifyAll() Object wait(0) </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Thread.yield() </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>join()join()</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Objectnotify() wait  notifyAll()</p>\n<p>Threadsuspend()resume()JDK1.5</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"sleep-long-millis\"><a href=\"#sleep-long-millis\" class=\"headerlink\" title=\"sleep(long millis)\"></a>sleep(long millis)</h2><p></p>\n<h1 id=\"join\"><a href=\"#join\" class=\"headerlink\" title=\"join\"></a>join</h1><p>joinThreadjoin()join()</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>join()</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Main &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        System.out.println(&quot;!&quot;);</span><br><span class=\"line\">        Thread1 mTh1=new Thread1(&quot;A&quot;);</span><br><span class=\"line\">        Thread1 mTh2=new Thread1(&quot;B&quot;);</span><br><span class=\"line\">        mTh1.start();</span><br><span class=\"line\">        mTh2.start();</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            mTh1.join();</span><br><span class=\"line\">        &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            mTh2.join();</span><br><span class=\"line\">        &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(&quot;!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"yield-\"><a href=\"#yield-\" class=\"headerlink\" title=\"yield():\"></a>yield():</h1><p>Thread.yield()</p>\n<p>yield()yield()yield()</p>\n<p>yield()//yield()</p>\n<h1 id=\"sleep-yield-\"><a href=\"#sleep-yield-\" class=\"headerlink\" title=\"sleep()yield()\"></a>sleep()yield()</h1><p>sleep()sleep()yield()yield()</p>\n<p>sleep yield  CPU yield() CPU yield()</p>\n<p>sleep  yield()  CPU  sleep  I\\O </p>\n<h1 id=\"wait\"><a href=\"#wait\" class=\"headerlink\" title=\"wait\"></a>wait</h1><p>wait() notify  notifyAll notify  notifyAll notifynotifyAllnotifynotifyAll</p>\n<p>wait()wait()ThreadThread.wait()JavaThread.sleep()wait() ObjectwaitObject</p>\n<p>synchronizedwaitsynchronizedsynchronizedsynchronized</p>\n<h2 id=\"loop-wait--notify-If-\"><a href=\"#loop-wait--notify-If-\" class=\"headerlink\" title=\"loop wait  notify If \"></a>loop wait  notify If </h2><p>waitsynchronizedwhileifwaitififwhilewhileifwait</p>\n<p>whilewaitwaitnotify</p>\n<p>waitnotifyPRODUCERCONSUMERProducerConsumerProducerConsumerThreadProducerConsumerrun()MainLinkedListJavaLinkedListLinkedListLinkedListwhile(queue.size == maxSize)synchronizedPRODUCERCONSUMERnotifyPRODUCERwaitnotify</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import java.util.LinkedList;</span><br><span class=\"line\">import java.util.Queue;</span><br><span class=\"line\">import java.util.Random;</span><br><span class=\"line\">/**</span><br><span class=\"line\">* Simple Java program to demonstrate How to use wait, notify and notifyAll()</span><br><span class=\"line\">* method in Java by solving producer consumer problem.</span><br><span class=\"line\">*/</span><br><span class=\"line\">public class ProducerConsumerInJava &#123;</span><br><span class=\"line\">    public static void main(String args[]) &#123;</span><br><span class=\"line\">        System.out.println(&quot;How to use wait and notify method in Java&quot;);</span><br><span class=\"line\">        System.out.println(&quot;Solving Producer Consumper Problem&quot;);</span><br><span class=\"line\">        Queue&lt;Integer&gt; buffer = new LinkedList&lt;&gt;();</span><br><span class=\"line\">        int maxSize = 10;</span><br><span class=\"line\">        Thread producer = new Producer(buffer, maxSize, &quot;PRODUCER&quot;);</span><br><span class=\"line\">        Thread consumer = new Consumer(buffer, maxSize, &quot;CONSUMER&quot;);</span><br><span class=\"line\">        producer.start(); consumer.start(); &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    /**</span><br><span class=\"line\">    * Producer Thread will keep producing values for Consumer</span><br><span class=\"line\">    * to consumer. It will use wait() method when Queue is full</span><br><span class=\"line\">    * and use notify() method to send notification to Consumer</span><br><span class=\"line\">    * Thread.</span><br><span class=\"line\">    */</span><br><span class=\"line\">    class Producer extends Thread</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        private Queue&lt;Integer&gt; queue;</span><br><span class=\"line\">        private int maxSize;</span><br><span class=\"line\">        public Producer(Queue&lt;Integer&gt; queue, int maxSize, String name)&#123;</span><br><span class=\"line\">            super(name); this.queue = queue; this.maxSize = maxSize;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        @Override public void run()</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            while (true)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    synchronized (queue) &#123;</span><br><span class=\"line\">                        while (queue.size() == maxSize) &#123;</span><br><span class=\"line\">                            try &#123;</span><br><span class=\"line\">                                System.out .println(&quot;Queue is full, &quot; + &quot;Producer thread waiting for &quot; + &quot;consumer to take something from queue&quot;);</span><br><span class=\"line\">                                queue.wait();</span><br><span class=\"line\">                            &#125; catch (Exception ex) &#123;</span><br><span class=\"line\">                                ex.printStackTrace(); &#125;</span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                            Random random = new Random();</span><br><span class=\"line\">                            int i = random.nextInt();</span><br><span class=\"line\">                            System.out.println(&quot;Producing value : &quot; + i); queue.add(i); queue.notifyAll();</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">    /**</span><br><span class=\"line\">    * Consumer Thread will consumer values form shared queue.</span><br><span class=\"line\">    * It will also use wait() method to wait if queue is</span><br><span class=\"line\">    * empty. It will also use notify method to send</span><br><span class=\"line\">    * notification to producer thread after consuming values</span><br><span class=\"line\">    * from queue.</span><br><span class=\"line\">    */</span><br><span class=\"line\">    class Consumer extends Thread &#123;</span><br><span class=\"line\">        private Queue&lt;Integer&gt; queue;</span><br><span class=\"line\">        private int maxSize;</span><br><span class=\"line\">        public Consumer(Queue&lt;Integer&gt; queue, int maxSize, String name)&#123;</span><br><span class=\"line\">            super(name);</span><br><span class=\"line\">            this.queue = queue;</span><br><span class=\"line\">            this.maxSize = maxSize;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        @Override public void run() &#123;</span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                synchronized (queue) &#123;</span><br><span class=\"line\">                    while (queue.isEmpty()) &#123;</span><br><span class=\"line\">                        System.out.println(&quot;Queue is empty,&quot; + &quot;Consumer thread is waiting&quot; + &quot; for producer thread to put something in queue&quot;);</span><br><span class=\"line\">                        try &#123;</span><br><span class=\"line\">                            queue.wait();</span><br><span class=\"line\">                        &#125; catch (Exception ex) &#123;</span><br><span class=\"line\">                            ex.printStackTrace();</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    System.out.println(&quot;Consuming value : &quot; + queue.remove()); queue.notifyAll();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"http://www.wailian.work/images/2018/01/23/20170805131528961.png\" alt=\"\"></p>\n<p>debugdebugPRODUCERCONSUMERCPUwait()EclipseStep intoStep over</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class ProducerConsumerWithQueue &#123;</span><br><span class=\"line\">    private int queueSize = 10;</span><br><span class=\"line\">    private ArrayBlockingQueue&lt;Integer&gt; queue = new ArrayBlockingQueue&lt;Integer&gt;(queueSize);</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        ProducerConsumerWithQueue test = new ProducerConsumerWithQueue();</span><br><span class=\"line\">        Producer producer = test.new Producer();</span><br><span class=\"line\">        Consumer consumer = test.new Consumer();</span><br><span class=\"line\"></span><br><span class=\"line\">        producer.start();</span><br><span class=\"line\">        consumer.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    class Consumer extends Thread &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void run() &#123;</span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    queue.take();</span><br><span class=\"line\">                    System.out.println(&quot;&quot; + queue.size() + &quot;&quot;);</span><br><span class=\"line\">                &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    class Producer extends Thread &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void run() &#123;</span><br><span class=\"line\">            while (true) &#123;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    queue.put(1);</span><br><span class=\"line\">                    System.out.println(&quot;&quot; + (queueSize - queue.size()));</span><br><span class=\"line\">                &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><table>\n<thead>\n<tr>\n<th>\\</th>\n<th style=\"text-align:right\"></th>\n<th style=\"text-align:center\"></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td></td>\n<td style=\"text-align:right\">add(e)</td>\n<td style=\"text-align:center\">offer(e)</td>\n<td>put(e)</td>\n<td>offer(e,time,unit)</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:right\">remove()</td>\n<td style=\"text-align:center\">poll()</td>\n<td>take()</td>\n<td>poll(time,unit)</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:right\">element()</td>\n<td style=\"text-align:center\">peek()</td>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/**</span><br><span class=\"line\">* </span><br><span class=\"line\">*</span><br><span class=\"line\">*/</span><br><span class=\"line\">public class ThreadA &#123;</span><br><span class=\"line\">    public static void main(String[] args) throws InterruptedException&#123;</span><br><span class=\"line\">        ThreadB b = new ThreadB();</span><br><span class=\"line\">        //</span><br><span class=\"line\">        b.start();</span><br><span class=\"line\">        //Abwait()notify()</span><br><span class=\"line\">        synchronized (b) &#123;</span><br><span class=\"line\">            System.out.println(&quot;b&quot;);</span><br><span class=\"line\">            //A</span><br><span class=\"line\">            b.wait();</span><br><span class=\"line\">            System.out.println(&quot;b&quot; + b.total);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">/**</span><br><span class=\"line\">* 1+2+3 ... +100</span><br><span class=\"line\">*</span><br><span class=\"line\">*/</span><br><span class=\"line\">class ThreadB extends Thread &#123;</span><br><span class=\"line\">    int total;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void run() &#123;</span><br><span class=\"line\">        synchronized (this) &#123;</span><br><span class=\"line\">            for (int i = 0; i &lt; 101; i++) &#123;</span><br><span class=\"line\">                total += i;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            //A</span><br><span class=\"line\">            notify();</span><br><span class=\"line\">            System.out.println(&quot;&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>b<br><br>b5050</p>\n<p>b.wait()</p>\n<p>b<br>b0<br></p>\n<p>b.wait()ThreadBThreadA</p>\n<p>ThreadBb.wait()</p>\n<p>b.wait()Thread.currentThread.wait()</p>\n<p>b.wait()Thread.currentThread.wait()</p>\n<p>Exception in thread main java.lang.IllegalMonitorStateException<br>at java.lang.Object.wait(Native Method)<br>at java.lang.Object.wait(Object.java:485)<br>at pa.com.thread.ThreadA.main(ThreadA.java:18)<br>b<br></p>\n<p>Thread.currentThread.wait()</p>\n<p></p>\n<p>ThreadAb</p>\n<p>ThreadAbb.wait()ThreadBbrun()notify()ThreadAThreadA</p>\n<p>ThreadBbsynchronized(this)thisThreadBb</p>\n<p>Thread.currentThread.wait()ThreadAwait()ThreadAbwait()b.wait()</p>\n<p>wait()sleep()</p>\n<p>b.wait()Thread.sleep(1000)</p>\n<p>b<br>b0<br></p>\n<p>Thread.sleep(1000)ThreadA1ThreadAThreadB</p>\n<p></p>\n<p>wait()wait()  wait()</p>\n<p>sleep()</p>\n<p></p>\n<p>waitnotifynotifyAllObjectfinal nativeObjectwait</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wait();//1</span><br><span class=\"line\">this.wait();//2</span><br><span class=\"line\">super.wait();//3</span><br></pre></td></tr></table></figure>\n<p>void wait()</p>\n<p>notify()notifyAllIllegalMonitorStateException</p>\n<h1 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h1><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Seller implements Runnable &#123;</span><br><span class=\"line\">    private String name;</span><br><span class=\"line\"></span><br><span class=\"line\">    public String getName() &#123;</span><br><span class=\"line\">        return name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void setName(String name) &#123;</span><br><span class=\"line\">        this.name = name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void run() &#123;</span><br><span class=\"line\">        synchronized (this) &#123;</span><br><span class=\"line\">            if (Synchronized.ticket &gt; 0) &#123;</span><br><span class=\"line\">                System.out.println(&quot;,&quot; + Synchronized.ticket);</span><br><span class=\"line\">                Synchronized.ticket--;</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    Thread.sleep(100);</span><br><span class=\"line\">                &#125; catch (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class Synchronized &#123;</span><br><span class=\"line\">    static Integer ticket = 100;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void main(String[] args) &#123;</span><br><span class=\"line\">        Seller s = new Seller();</span><br><span class=\"line\">        Thread t1 = new Thread(s);</span><br><span class=\"line\">        Thread t2 = new Thread(s);</span><br><span class=\"line\">        Thread t3 = new Thread(s);</span><br><span class=\"line\">        Thread t4 = new Thread(s);</span><br><span class=\"line\">        Thread t5 = new Thread(s);</span><br><span class=\"line\">        Thread t6 = new Thread(s);</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\">        t3.start();</span><br><span class=\"line\">        t4.start();</span><br><span class=\"line\">        t5.start();</span><br><span class=\"line\">        t6.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://github.com/wangweiye01/mutiThreading\" target=\"_blank\" rel=\"noopener\"></a></p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"ckc5n3jwd000r0j9ksaqynoez","category_id":"ckc5n3jwg000t0j9k89extb4f","_id":"ckc5n3jx000110j9ki10s69uv"},{"post_id":"ckc5n3jx100120j9kkglfh2f6","category_id":"ckc5n3jwg000t0j9k89extb4f","_id":"ckc5n3jx600160j9k6pn4j0ik"},{"post_id":"ckc5n3jx9001a0j9khwlhnghl","category_id":"ckc5n3jx700180j9k7g1xw1ht","_id":"ckc5n3jxe001f0j9k2qnzmetu"},{"post_id":"ckc5n3jx500150j9kjt6zlfdg","category_id":"ckc5n3jx700180j9k7g1xw1ht","_id":"ckc5n3jxg001i0j9k2kj9lg7b"},{"post_id":"ckc5n3jxd001d0j9k48viaaln","category_id":"ckc5n3jx700180j9k7g1xw1ht","_id":"ckc5n3jxi001k0j9kfuc23wpt"},{"post_id":"ckc5n3jx600170j9kruzoezp8","category_id":"ckc5n3jx700180j9k7g1xw1ht","_id":"ckc5n3jxj001m0j9kott213sw"},{"post_id":"ckc5n3jxe001e0j9kljzzs8gk","category_id":"ckc5n3jx700180j9k7g1xw1ht","_id":"ckc5n3jxk001o0j9kzx9ru27u"},{"post_id":"ckc5n3jxf001h0j9k55ebuvqd","category_id":"ckc5n3jx700180j9k7g1xw1ht","_id":"ckc5n3jxl001q0j9kf0pogfoq"},{"post_id":"ckc5n3jx800190j9k2gx8afze","category_id":"ckc5n3jx700180j9k7g1xw1ht","_id":"ckc5n3jxm001s0j9kxhx0ig3c"},{"post_id":"ckc5n3jxh001j0j9kx3hqse6m","category_id":"ckc5n3jx700180j9k7g1xw1ht","_id":"ckc5n3jxn001u0j9kwhit5waw"},{"post_id":"ckc5n3jxi001l0j9kht4vk5xw","category_id":"ckc5n3jx700180j9k7g1xw1ht","_id":"ckc5n3jxp001w0j9ki9dtd3lb"},{"post_id":"ckc5n3jxj001n0j9ksxhhwnxt","category_id":"ckc5n3jx700180j9k7g1xw1ht","_id":"ckc5n3jxr001y0j9kioblzx6h"},{"post_id":"ckc5n3k3f00220j9knsz833iq","category_id":"ckc5n3jwg000t0j9k89extb4f","_id":"ckc5n3k3m00240j9k7cm4h2pv"}],"PostTag":[{"post_id":"ckc5n3jwe000s0j9k30riapwx","tag_id":"ckc5n3jwv000v0j9kqn2w2cl8","_id":"ckc5n3jwz000z0j9kqfnmrpg5"}],"Tag":[{"name":"","_id":"ckc5n3jwv000v0j9kqn2w2cl8"}]}}